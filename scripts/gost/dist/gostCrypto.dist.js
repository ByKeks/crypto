/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(b,d){"function"===typeof define&&define.amd?define(d):"object"===typeof exports?module.exports=d():b.GostRandom=d()})(this,function(){function b(){}var d=this.crypto||this.msCrypto,g=this.TypeMismatchError||Error,h=this.QuotaExceededError||Error,f={seed:new Uint8Array(1024),getIndex:0,setIndex:0,set:function(a){1024<=this.setIndex&&(this.setIndex=0);this.seed[this.setIndex++]=a},get:function(){1024<=this.getIndex&&(this.getIndex=0);return this.seed[this.getIndex++]}};if("undefiend"!==typeof document){try{document.addEventListener("mousemove",
function(a){f.set((new Date).getTime()&255^(a.clientX||a.pageX)&255^(a.clientY||a.pageY)&255)},!1)}catch(k){}try{document.addEventListener("keydown",function(a){f.set((new Date).getTime()&255^a.keyCode&255)},!1)}catch(l){}}b.prototype.getRandomValues=function(a){if(!a.byteLength)throw new g("Array is not of an integer type (Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, or Uint32Array)");if(65536<a.byteLength)throw new h("Byte length of array can't be greate then 65536");var e=new Uint8Array(a.buffer,
a.byteOffset,a.byteLength);if(d&&d.getRandomValues)d.getRandomValues(e);else for(var c=0,b=e.length;c<b;c++)e[c]=Math.floor(256*Math.random())&255;c=0;for(b=e.length;c<b;c++)e[c]^=f.get();return a};return b});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(x,f){"function"===typeof define&&define.amd?define(["gostRandom"],f):"object"===typeof exports?module.exports=f(require("gostRandom")):x.gostCrypto=f(x.GostRandom)})(this,function(x){function f(a,c){if("string"===typeof a||a instanceof String)a={name:a};var d=a.name;if(!d)throw new u("Algorithm name not defined");var e=d.split("/"),e=e[0].split("-").concat(e.slice(1)),b={},d=e[0].replace(/[\.\s]/g,""),e=e.slice(1);if(0<=d.indexOf("28147"))b={name:"GOST 28147",version:1989,mode:(a.mode||
("sign"===c||"verify"===c?"MAC":"wrapKey"===c||"unwrapKey"===c?"KW":"ES")).toUpperCase(),length:a.length||64};else if(0<=d.indexOf("3412"))b={name:"GOST R 34.12",version:2015,mode:(a.mode||("sign"===c||"verify"===c?"MAC":"wrapKey"===c||"unwrapKey"===c?"KW":"ES")).toUpperCase(),length:a.length||64};else if(0<=d.indexOf("3411"))b={name:"GOST R 34.11",version:2012,mode:(a.mode||("deriveKey"===c||"deriveBits"===c?"KDF":"sign"===c||"verify"===c?"HMAC":"HASH")).toUpperCase(),length:a.length||256};else if(0<=
d.indexOf("3410"))b={name:"GOST R 34.10",version:2012,mode:(a.mode||("deriveKey"===c||"deriveBits"===c?"DH":"SIGN")).toUpperCase(),length:a.length||256};else if(0<=d.indexOf("SHA"))b={name:"SHA",version:160===(a.length||160)?1:2,mode:(a.mode||("deriveKey"===c||"deriveBits"===c?"KDF":"sign"===c||"verify"===c?"HMAC":"HASH")).toUpperCase(),length:a.length||160};else if(0<=d.indexOf("RC2"))b={name:"RC2",version:1,mode:(a.mode||("sign"===c||"verify"===c?"MAC":"wrapKey"===c||"unwrapKey"===c?"KW":"ES")).toUpperCase(),
length:a.length||32};else if(0<=d.indexOf("PBKDF2"))b=f(a.hash,"digest"),b.mode="PBKDF2";else if(0<=d.indexOf("PFXKDF"))b=f(a.hash,"digest"),b.mode="PFXKDF";else if(0<=d.indexOf("CPKDF"))b=f(a.hash,"digest"),b.mode="CPKDF";else if(0<=d.indexOf("HMAC"))b=f(a.hash,"digest"),b.mode="HMAC";else throw new q("Algorithm not supported");e.forEach(function(a){a=a.toUpperCase();if(/^[0-9]+$/.test(a))if(0<=["8","16","32"].indexOf(a)||"128"===b.length&&"64"===a)if("ES"===b.mode)b.shiftBits=parseInt(a);else if("MAC"===
b.mode)b.macLength=parseInt(a);else throw new q("Algorithm "+b.name+" mode "+a+" not supported");else 0<="89 94 01 12 15 1989 1994 2001 2012 2015".split(" ").indexOf(a)?(a=parseInt(a),b.version=1900>a?80>a?2E3+a:1900+a:a):0<=["1"].indexOf(a)&&"SHA"===b.name?(b.version=1,b.length=160):0<=["256","384","512"].indexOf(a)&&"SHA"===b.name?(b.version=2,b.length=parseInt(a)):0<=["40","128"].indexOf(a)&&"RC2"===b.name?(b.version=1,b.length=parseInt(a)):0<=["64","128","256","512"].indexOf(a)?b.length=parseInt(a):
0<=["1000","2000"].indexOf(a)&&(b.iterations=parseInt(a));else if(0<="E-TEST E-A E-B E-C E-D E-SC E-Z D-TEST D-A D-SC".split(" ").indexOf(a))b.sBox=a;else if(0<="S-TEST S-A S-B S-C S-D X-A X-B X-C".split(" ").indexOf(a))b.namedParam=a;else if(0<="S-256-TEST S-256-A S-256-B S-256-C P-256 T-512-TEST T-512-A T-512-B X-256-A X-256-B T-256-TEST T-256-A T-256-B S-256-B T-256-C S-256-C".split(" ").indexOf(a))b.namedCurve=a;else if(0<=["SC","CP"].indexOf(a))b.procreator=a;else if("GOST 28147"===b.name||"GOST R 34.12"===
b.name||"RC2"===b.name)if(0<=["ES","MAC","KW"].indexOf(a))b.mode=a;else if(0<=["ECB","CFB","OFB","CTR","CBC"].indexOf(a))b.mode="ES",b.block=a;else if(0<=["CPKW","NOKW","SCKW"].indexOf(a))b.mode="KW",b.keyWrapping=a.replace("KW","");else if(0<=["ZEROPADDING","PKCS5PADDING","NOPADDING","RANDOMPADDING","BITPADDING"].indexOf(a))b.padding=a.replace("PADDING","");else if(0<=["NOKM","CPKM"].indexOf(a))b.keyMeshing=a.replace("KM","");else throw new q("Algorithm "+b.name+" mode "+a+" not supported");else if("GOST R 34.11"===
b.name||"SHA"===b.name)if(0<="HASH KDF HMAC PBKDF2 PFXKDF CPKDF".split(" ").indexOf(a))b.mode=a;else throw new q("Algorithm "+b.name+" mode "+a+" not supported");else if("GOST R 34.10"===b.name){var c=a.replace(/[\.\s]/g,"");if(0<=c.indexOf("GOST")&&0<=c.indexOf("3411"))b.hash=a;else if(["SIGN","DH","KW"].indexOf(a))b.mode=a;else throw new q("Algorithm "+b.name+" mode "+a+" not supported");}});b.procreator=b.procreator||"CP";switch(b.name){case "GOST 28147":case "GOST R 34.12":b.keySize=32;break;
case "RC2":b.keySize=Math.ceil(b.length/8);break;case "GOST R 34.11":case "SHA":b.keySize=b.length/8;break;case "GOST R 34.10":b.keySize=b.length/(1994===b.version?4:8)}if("ES"===b.mode&&(a.block&&(b.block=a.block),b.block&&(b.block=b.block.toUpperCase()),a.padding&&(b.padding=a.padding),b.padding&&(b.padding=b.padding.toUpperCase()),a.shiftBits&&(b.shiftBits=a.shiftBits),a.keyMeshing&&(b.keyMeshing=a.keyMeshing),b.keyMeshing&&(b.keyMeshing=b.keyMeshing.toUpperCase()),"importKey"!==c&&"generateKey"!==
c)){b.block=b.block||"ECB";b.padding=b.padding||("CBC"===b.block||"ECB"===b.block?"ZERO":"NO");if("CFB"===b.block||"OFB"===b.block)b.shiftBits=b.shiftBits||b.length;b.keyMeshing=b.keyMeshing||"NO"}"KW"===b.mode&&(a.keyWrapping&&(b.keyWrapping=a.keyWrapping),b.keyWrapping&&(b.keyWrapping=b.keyWrapping.toUpperCase()),"importKey"!==c&&"generateKey"!==c&&(b.keyWrapping=b.keyWrapping||"NO"));"sBox namedParam namedCurve curve param modulusLength".split(" ").forEach(function(c){a[c]&&(b[c]=a[c])});"importKey"!==
c&&"generateKey"!==c&&("GOST 28147"===b.name?b.sBox=b.sBox||("SC"===b.procreator?"E-SC":"E-A"):"GOST R 34.12"===b.name&&64===b.length?b.sBox="E-Z":"GOST R 34.11"===b.name&&1994===b.version?b.sBox=b.sBox||("SC"===b.procreator?"D-SC":"D-A"):"GOST R 34.10"===b.name&&1994===b.version?b.namedParam=b.namedParam||("DH"===b.mode?"X-A":"S-A"):"GOST R 34.10"===b.name&&2001===b.version?b.namedCurve=b.namedCurve||(256===b.length?"SC"===b.procreator?"P-256":"DH"===b.mode?"X-256-A":"S-256-A":"T-512-A"===b.mode):
"GOST R 34.10"===b.name&&2012===b.version&&(b.namedCurve=b.namedCurve||(256===b.length?"SC"===b.procreator?"P-256":"DH"===b.mode?"X-256-A":"S-256-A":"T-512-A"===b.mode)));switch(b.mode){case "DH":a.ukm&&(b.ukm=a.ukm);a["public"]&&(b["public"]=a["public"]);break;case "SIGN":case "KW":a.ukm&&(b.ukm=a.ukm);break;case "ES":case "MAC":a.iv&&(b.iv=a.iv);break;case "KDF":a.label&&(b.label=a.label);a.contex&&(b.context=a.contex);break;case "PBKDF2":a.salt&&(b.salt=a.salt);a.iterations&&(b.iterations=a.iterations);
break;case "PFXKDF":a.salt&&(b.salt=a.salt);a.iterations&&(b.iterations=a.iterations);a.diversifier&&(b.diversifier=a.diversifier);break;case "CPKDF":a.salt&&(b.salt=a.salt),a.iterations&&(b.iterations=a.iterations)}if(c&&("ES"!==b.mode&&"SIGN"!==b.mode&&"MAC"!==b.mode&&"HMAC"!==b.mode&&"KW"!==b.mode&&"DH"!==b.mode&&"generateKey"===c||"ES"!==b.mode&&("encrypt"===c||"decrypt"===c)||"SIGN"!==b.mode&&"MAC"!==b.mode&&"HMAC"!==b.mode&&("sign"===c||"verify"===c)||"HASH"!==b.mode&&"digest"===c||"KW"!==b.mode&&
("wrapKey"===c||"unwrapKey"===c)||"DH"!==b.mode&&"PBKDF2"!==b.mode&&"PFXKDF"!==b.mode&&"CPKDF"!==b.mode&&"KDF"!==b.mode&&("deriveKey"===c||"deriveBits"===c)))throw new q("Algorithm mode "+b.mode+" not valid for method "+c);a.hash&&(b.hash=a.hash);b.hash&&(("string"===typeof b.hash||b.hash instanceof String)&&b.procreator&&(b.hash=b.hash+"/"+b.procreator),b.hash=f(b.hash,"digest"));a.id&&(b.id=a.id);return b}function l(a){if(!k||!k.subtle||!a)return!1;var c="string"===typeof a||a instanceof String?
c=a:a.name;if(!c)return!1;c=c.toUpperCase();return 0<c.indexOf("KDF")&&a.hash?l(a.hash):-1===c.indexOf("GOST")&&-1===c.indexOf("SHA")&&-1===c.indexOf("RC2")&&-1===c.indexOf("DES")}function C(a,c){if(!a.algorithm)throw new u("Key algorithm not defined");if(!a.algorithm.name)throw new u("Key algorithm name not defined");var d=a.algorithm.name,e="GOST 28147"===d||"GOST R 34.12"===d||"RC2"===d,b="GOST R 34.11"===d||"SHA"===d,n="GOST R 34.10"===d;if(!e&&!n&&!b)throw new q("Key algorithm "+d+" is unsupproted");
if(!a.type)throw new u("Key type not defined");if((e||b)&&"secret"!==a.type||n&&"public"!==a.type&&"private"!==a.type)throw new D("Key type "+a.type+" is not valid for algorithm "+d);if(!a.usages||!a.usages.indexOf)throw new u("Key usages not defined");d=0;for(e=a.usages.length;d<e;d++)if(b=a.usages[d],("encrypt"===b||"decrypt"===b)&&"secret"!==a.type||"sign"===b&&"public"===a.type||"verify"===b&&"private"===a.type)throw new H("Key type "+a.type+" is not valid for "+b);if(c&&-1===a.usages.indexOf(c))throw new E("Key usages is not contain method "+
c);if(!a.buffer)throw new u("Key buffer is not defined");d=8*a.buffer.byteLength;e=8*a.algorithm.keySize;if("secret"===a.type&&d!==(e||256)&&(0<=a.usages.indexOf("encrypt")||0<=a.usages.indexOf("decrypt"))||"private"===a.type&&256!==d&&512!==d||"public"===a.type&&512!==d&&1024!==d)throw new u("Key buffer has wrong size "+d+" bit");}function p(a,c,d){C(d,a);if(c){var e;switch(c.mode){case "ES":e=["sBox","keyMeshing","padding","block"];break;case "SIGN":e="namedCurve namedParam sBox curve param modulusLength".split(" ");
break;case "MAC":e=["sBox"];break;case "KW":e=["keyWrapping","ukm"];break;case "DH":e="namedCurve namedParam sBox ukm curve param modulusLength".split(" ");break;case "KDF":e=["context","label"];break;case "PBKDF2":e=["sBox","iterations","salt"];break;case "PFXKDF":e=["sBox","iterations","salt","diversifier"];break;case "CPKDF":e=["sBox","salt"]}e&&e.forEach(function(a){d.algorithm[a]&&(c[a]=d.algorithm[a])})}return d.buffer}function y(a,c,d,e,b){a={type:b||"secret",extractable:c||"false",algorithm:a,
usages:d||[],buffer:e};C(a);return a}function I(a,c,d,e,b,n){if(!e||!e.indexOf)throw new u("Key usages not defined");var f=e.filter(function(a){return"sign"!==a});e=e.filter(function(a){return"verify"!==a});return{publicKey:y(a,d,f,b,"public"),privateKey:y(c,d,e,n,"private")}}function F(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),d=0,e=a.length;d<e;d++)c[e-d-1]=a[d];return c.buffer}function G(){for(var a=0,c=arguments.length;a<c;a++){var d=arguments[a].split("."),
d=z+d[0]+A+"."+d[1],e=document.querySelector('script[src="'+d+'"]');e||(e=document.createElement("script"),e.setAttribute("src",d),document.head.appendChild(e))}}function s(a,c,d){return new Promise(function(e,b){try{if(w){var n=++J;v.push({id:n,resolve:e,reject:b});w.postMessage({id:n,algorithm:a,method:c,args:d})}else g.gostEngine?e(g.gostEngine.execute(a,c,d)):b(new B("Module gostEngine not found"))}catch(f){b(f)}})}function r(a){try{a()}catch(c){}}function h(){}var g=this,k=g.crypto||g.msCrypto,
u=g.SyntaxError||Error,D=g.DataError||Error,q=g.NotSupportedError||Error,B=g.OperationError||Error,H=g.InvalidAccessError||Error,E=g.InvalidAccessError||Error;g.Promise||(g.Promise=function(){function a(a){return a&&null===a.oncomplete&&null===a.onerror?new c(function(c,b){a.oncomplete=function(){c(a.result)};a.onerror=function(){b(new B(a.toString()))}}):a}function c(d){function e(a){try{a()}catch(b){}}var b="pending",n,f=[],g=[];try{d(function(a){"pending"===b&&(b="fulfilled",n=a,f.forEach(e))},
function(a){"pending"===b&&(b="rejected",n=a,g.forEach(e))})}catch(m){"pending"===b&&(b="rejected",n=m,g.forEach(e))}this.then=function(d,e){return new c(function(c,m){function k(){var b;try{b=d?d(n):n}catch(e){m(e);return}(b=a(b))&&b.then&&b.then.call?b.then(c,m):c(b)}function l(){var b;try{b=e?e(n):n}catch(d){m(d);return}(b=a(b))&&b.then&&b.then.call?b.then(c,m):m(b)}"fulfilled"===b?k():"rejected"===b?l():(f.push(k),g.push(l))})};this["catch"]=function(a){return this.then(void 0,a)}}c.all=function(a){return new c(function(c,
b){function n(a){m++;return function(b){g[a]=b;m--;0===m&&c(g)}}function f(a){0<m&&b(a);m=0}for(var g=[],m=0,k=0,l=a.length;k<l;k++){var h=a[k];h.then&&h.then.call?h.then(n(k),f):g[k]=h}0===m&&c(g)})};return c}());var z="",A="";"undefined"!==typeof document&&function(){for(var a=/^(.*)gostCrypto(.*)\.js$/i,c=document.querySelectorAll("script"),d=0,e=c.length;d<e;d++){var b=c[d].getAttribute("src");if(b=a.exec(b))z=b[1],A=b[2]}}();var w,v=[],J=0;if(!g.importScripts&&!g.gostEngine)try{w=new Worker(z+
"gostEngine"+A+".js"),w.onmessage=function(a){for(var c=a.data.id,d=0,e=v.length;d<e&&v[d].id!==c;d++);d<e&&(c=v[d],v.splice(d,1),a.data.error?c.reject(new B(a.data.error)):c.resolve(a.data.result))},w.onerror=function(a){for(var c=0,d=v.length;c<d;c++)v[c].reject(a.error);v=[]}}catch(K){w=!1}g.importScripts||(g.importScripts=G);w||g.gostEngine||G("gostEngine.js");var t={};h.prototype.encrypt=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.encrypt(a,c,d);a=f(a,"encrypt");
return s(a,"encrypt",[p("encrypt",a,c),d])})};h.prototype.decrypt=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.decrypt(a,c,d);a=f(a,"decrypt");return s(a,"decrypt",[p("decrypt",a,c),d])})};h.prototype.sign=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.sign(a,c,d);a=f(a,"sign");return s(a,"sign",[p("sign",a,c),d]).then(function(c){return"SC"===a.procreator?t.asn1.GostSignature.encode(c):c})})};h.prototype.verify=function(a,c,d,e){return(new Promise(r)).then(function(){if(l(a))return k.subtle.verify(a,
c,d,e);a=f(a,"verify");return s(a,"verify",[p("verify",a,c),"SC"===a.procreator?t.asn1.GostSignature.decode(d):d,e])})};h.prototype.digest=function(a,c){return(new Promise(r)).then(function(){if(l(a))return k.subtle.digest(a,c);a=f(a,"digest");return s(a,"digest",[c])})};h.prototype.generateKey=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.generateKey(a,c,d);var e=a.privateKey,b=a.publicKey;a=f(a,"generateKey");e=e?f(e,"generateKey"):a;b=b?f(b,"generateKey"):a;return s(a,
"generateKey",[]).then(function(f){return f.publicKey&&f.privateKey?I(b,e,c,d,f.publicKey,f.privateKey):y(a,c,d,f)})})};h.prototype.deriveKey=function(a,c,d,e,b){return(new Promise(r)).then(function(){if(l(a))return k.subtle.deriveKey(a,c,d,e,b);a=f(a,"deriveKey");d=f(d,"generateKey");a.keySize=d.keySize;a["public"]&&(a["public"].algorithm=f(a["public"].algorithm),a["public"]=p("deriveKey",a,a["public"]));return s(a,"deriveKey",[p("deriveKey",a,c)]).then(function(a){return y(d,e,b,a)})})};h.prototype.deriveBits=
function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.deriveBits(a,c,d);a=f(a,"deriveBits");a["public"]&&(a["public"]=p("deriveBits",a,a["public"]));return s(a,"deriveBits",[p("deriveBits",a,c),d])})};h.prototype.importKey=function(a,c,d,e,b){return(new Promise(r)).then(function(){if(l(d))return k.subtle.importKey(a,c,d,e,b);var g,h,p;if("raw"===a)d=f(d,"importKey"),p=c,b&&b.indexOf&&(h=d.name.toUpperCase().replace(/[\.\s]/g,""),0<=h.indexOf("3410")&&0<=b.indexOf("sign")?
g="private":0<=h.indexOf("3410")&&0<=b.indexOf("verify")&&(g="public"));else{if("pkcs8"===a)h=t.asn1.GostPrivateKeyInfo.decode(c);else if("spki"===a)h=t.asn1.GostSubjectPublicKeyInfo.decode(c);else throw new q("Key format not supported");d=f(h.algorithm,"importKey");p=h.buffer;g=h.type;!1!==e&&(e=e||h.extractable);if(b)for(var m=0;m<b.length;m++){if(0>h.usages.indexOf(b[m]))throw D("Key usage not valid for this key");}else b=h.usages}return y(d,e,b,p,g)})};h.prototype.exportKey=function(a,c){return(new Promise(r)).then(function(){if(c&&
l(c.algorithm))return k.subtle.exportKey(a,c);if(!c.extractable)throw new E("Key not extractable");var d=p(null,null,c);if("raw"===a)return d;if("pkcs8"===a&&c.algorithm&&c.algorithm.id)return t.asn1.GostPrivateKeyInfo.encode(c);if("spki"===a&&c.algorithm&&c.algorithm.id)return t.asn1.GostSubjectPublicKeyInfo.encode(c);throw new q("Key format not supported");})};h.prototype.wrapKey=function(a,c,d,e){return(new Promise(r)).then(function(){if(l(e))return k.subtle.wrapKey(a,c,d,e);e=f(e,"wrapKey");var b=
p(null,null,c);"SC"===e.procreator&&"private"===c.type&&(b=F(b));return s(e,"wrapKey",[p("wrapKey",e,d),b]).then(function(b){if("raw"===a)return b;throw new q("Key format not supported");})})};h.prototype.unwrapKey=function(a,c,d,e,b,g,h){return(new Promise(r)).then(function(){if(l(e))return k.subtle.unwrapKey(a,c,d,e,b,g,h);e=f(e,"unwrapKey");b=f(b,"importKey");if("raw"!==a)throw new q("Key format not supported");return s(e,"unwrapKey",[p("unwrapKey",e,d),c]).then(function(a){var c;if(b&&b.name){var d=
b.name.toUpperCase().replace(/[\.\s]/g,"");0<=d.indexOf("3410")&&0<=h.indexOf("sign")?c="private":0<=d.indexOf("3410")&&0<=h.indexOf("verify")&&(c="public")}"SC"===e.procreator&&"private"===c&&(a=F(a));return y(b,g,h,a,c)})})};t.subtle=new h;t.getRandomValues=function(a){var c=(x=x||g.GostRandom)?new x:k;if(c.getRandomValues)c.getRandomValues(a);else throw new q("Random generator not found");};return t});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(e,b){"function"===typeof define&&define.amd?define(["gostCrypto"],b):"object"===typeof exports?module.exports=b(require("gostCrypto")):e.GostSecurity=b(e.gostCrypto)})(this,function(e){function b(){for(var a={},b=0,c=arguments.length;b<c;b++){var d=arguments[b];if("object"===typeof d)for(var e in d)a[e]=d[e]}return a}function h(){}var f={"1.2.643.2.2":"CryptoPro","1.2.643.2.2.3":"id-GostR3411-94-with-GostR3410-2001","1.2.643.2.2.4":"id-GostR3411-94-with-GostR3410-94","1.2.643.2.2.9":"id-GostR3411-94",
"1.2.643.2.2.10":"id-HMACGostR3411-94","1.2.643.2.2.13.0":"id-Gost28147-89-None-KeyWrap","1.2.643.2.2.13.1":"id-Gost28147-89-CryptoPro-KeyWrap","1.2.643.2.2.14.0":"id-Gost28147-89-None-KeyMeshing","1.2.643.2.2.14.1":"id-Gost28147-89-CryptoPro-KeyMeshing","1.2.643.2.2.19":"id-GostR3410-2001","1.2.643.2.2.20":"id-GostR3410-94","1.2.643.2.2.20.1":"id-GostR3410-94-a","1.2.643.2.2.20.2":"id-GostR3410-94-aBis","1.2.643.2.2.20.3":"id-GostR3410-94-b","1.2.643.2.2.20.4":"id-GostR3410-94-bBis","1.2.643.2.2.21":"id-Gost28147-89",
"1.2.643.2.2.22":"id-Gost28147-89-MAC","1.2.643.2.2.30.0":"id-GostR3411-94-TestParamSet","1.2.643.2.2.30.1":"id-GostR3411-94-CryptoProParamSet","1.2.643.2.2.30.2":"id-GostR3411-94-CryptoPro-B-ParamSet","1.2.643.2.2.30.3":"id-GostR3411-94-CryptoPro-C-ParamSet","1.2.643.2.2.30.4":"id-GostR3411-94-CryptoPro-D-ParamSet","1.2.643.2.2.31.0":"id-Gost28147-89-TestParamSet","1.2.643.2.2.31.1":"id-Gost28147-89-CryptoPro-A-ParamSet","1.2.643.2.2.31.2":"id-Gost28147-89-CryptoPro-B-ParamSet","1.2.643.2.2.31.3":"id-Gost28147-89-CryptoPro-C-ParamSet",
"1.2.643.2.2.31.4":"id-Gost28147-89-CryptoPro-D-ParamSet","1.2.643.2.2.31.5":"id-Gost28147-89-CryptoPro-Oscar-1-1-ParamSet","1.2.643.2.2.31.6":"id-Gost28147-89-CryptoPro-Oscar-1-0-ParamSet","1.2.643.2.2.31.7":"id-Gost28147-89-CryptoPro-RIC-1-ParamSet ","1.2.643.2.2.31.12":"id-Gost28147-89-CryptoPro-tc26-1","1.2.643.2.2.31.13":"id-Gost28147-89-CryptoPro-tc26-2","1.2.643.2.2.31.14":"id-Gost28147-89-CryptoPro-tc26-3","1.2.643.2.2.31.15":"id-Gost28147-89-CryptoPro-tc26-4","1.2.643.2.2.31.16":"id-Gost28147-89-CryptoPro-tc26-5",
"1.2.643.2.2.31.17":"id-Gost28147-89-CryptoPro-tc26-6","1.2.643.2.2.32.0":"id-GostR3410-94-TestParamSet","1.2.643.2.2.32.2":"id-GostR3410-94-CryptoPro-A-ParamSet","1.2.643.2.2.32.3":"id-GostR3410-94-CryptoPro-B-ParamSet","1.2.643.2.2.32.4":"id-GostR3410-94-CryptoPro-C-ParamSet","1.2.643.2.2.32.5":"id-GostR3410-94-CryptoPro-D-ParamSet","1.2.643.2.2.33.1":"id-GostR3410-94-CryptoPro-XchA-ParamSet","1.2.643.2.2.33.2":"id-GostR3410-94-CryptoPro-XchB-ParamSet","1.2.643.2.2.33.3":"id-GostR3410-94-CryptoPro-XchC-ParamSet",
"1.2.643.2.2.34.2":"temporaryAccessToRC","1.2.643.2.2.34.3":"internetContentSignature","1.2.643.2.2.34.4":"adminRC","1.2.643.2.2.34.5":"operatorRC","1.2.643.2.2.34.6":"userRC","1.2.643.2.2.34.7":"clientRC","1.2.643.2.2.34.8":"serverRC","1.2.643.2.2.34.9":"sysAdminRC","1.2.643.2.2.34.10":"arcAdminRC","1.2.643.2.2.34.11":"authorityPersonRC","1.2.643.2.2.34.12":"clientCC","1.2.643.2.2.34.13":"sysAdminCC","1.2.643.2.2.34.14":"arcAdminCC","1.2.643.2.2.34.15":"accessIPSecCA","1.2.643.2.2.34.16":"auditAdminHSM",
"1.2.643.2.2.34.21":"adminHSM","1.2.643.2.2.34.22":"serverAdminHSH","1.2.643.2.2.34.24":"winlogonCA","1.2.643.2.2.34.25":"timestampServiceUser","1.2.643.2.2.34.26":"statusServiceUser","1.2.643.2.2.34.27":"arcAdminHSM","1.2.643.2.2.34.28":"auditorHSM","1.2.643.2.2.35.0":"id-GostR3410-2001-CryptoPro-TestParamSet","1.2.643.2.2.35.1":"id-GostR3410-2001-CryptoPro-A-ParamSet","1.2.643.2.2.35.2":"id-GostR3410-2001-CryptoPro-B-ParamSet","1.2.643.2.2.35.3":"id-GostR3410-2001-CryptoPro-C-ParamSet","1.2.643.2.2.36.0":"id-GostR3410-2001-CryptoPro-XchA-ParamSet",
"1.2.643.2.2.36.1":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","1.2.643.2.2.37.1":"id-CryptoPro-GostPrivateKeys-V1","1.2.643.2.2.37.2":"id-CryptoPro-GostPrivateKeys-V2","1.2.643.2.2.37.2.1":"id-CryptoPro-GostPrivateKeys-V2-Full","1.2.643.2.2.37.2.2":"id-CryptoPro-GostPrivateKeys-V2-PartOf","1.2.643.2.2.37.3.1":"intermediateCertificates","1.2.643.2.2.37.3.2":"trustedCertificatesSignature","1.2.643.2.2.37.3.3":"trustedCertificatesExchange","1.2.643.2.2.37.3.10":"keyValidity","1.2.643.2.2.38.1":"personalBaseProlicy",
"1.2.643.2.2.38.2":"networkBasePolicy","1.2.643.2.2.47.1":"id-CryptoPro-ocsp-treats-exp-key-or-exp-cert-rev","1.2.643.2.2.47.2":"id-CryptoPro-ocsp-crl-locator","1.2.643.2.2.47.3":"id-CryptoPro-ocsp-instant-revocation-indicator","1.2.643.2.2.47.4":"id-CryptoPro-ocsp-revocation-announcement-reference","1.2.643.2.2.47.5":"id-CryptoPro-ocsp-historical-request","1.2.643.2.2.49.2":"limitedLicense","1.2.643.2.2.96":"id-GostR3410-2001-CryptoPro-ESDH","1.2.643.2.2.97":"id-GostR3410-94-CryptoPro-ESDH","1.2.643.2.2.98":"id-GostR3410-2001DH",
"1.2.643.2.2.99":"id-GostR3410-94DH","1.2.643.2.45.1.1.1":"signatureComment","1.2.643.2.45.1.1.2":"resourceName","1.2.643.2.45.1.1.3":"signatureUsage","1.2.643.3.131.1.1":"INN","1.2.643.3.141.1.1":"RNS FSS","1.2.643.3.141.1.2":"KP FSS","1.2.643.7.1":"tc26","1.2.643.7.1.1.1.1":"id-tc26-gost3410-12-256","1.2.643.7.1.1.1.2":"id-tc26-gost3410-12-512","1.2.643.7.1.1.2.1":"id-tc26-gost3411-94","1.2.643.7.1.1.2.2":"id-tc26-gost3411-12-256","1.2.643.7.1.1.2.3":"id-tc26-gost3411-12-512","1.2.643.7.1.1.3.1":"id-tc26-signwithdigest-gost3410-12-94",
"1.2.643.7.1.1.3.2":"id-tc26-signwithdigest-gost3410-12-256","1.2.643.7.1.1.3.3":"id-tc26-signwithdigest-gost3410-12-512","1.2.643.7.1.1.4.1":"id-tc26-hmac-gost-3411-12-256","1.2.643.7.1.1.4.2":"id-tc26-hmac-gost-3411-12-512","1.2.643.7.1.1.6.1":"id-tc26-agreement-gost-3410-12-256","1.2.643.7.1.1.6.2":"id-tc26-agreement-gost-3410-12-512","1.2.643.7.1.2.1.1.0":"id-tc26-gost-3410-12-256-paramSetTest","1.2.643.7.1.2.1.1.1":"id-tc26-gost-3410-12-256-paramSetA","1.2.643.7.1.2.1.1.2":"id-tc26-gost-3410-12-256-paramSetB",
"1.2.643.7.1.2.1.2.0":"id-tc26-gost-3410-12-512-paramSetTest","1.2.643.7.1.2.1.2.1":"id-tc26-gost-3410-12-512-paramSetA","1.2.643.7.1.2.1.2.2":"id-tc26-gost-3410-12-512-paramSetB","1.2.643.7.1.2.1.2.3":"id-tc26-gost-3410-12-512-paramSetC","1.2.643.7.1.2.1.2.4":"id-tc26-gost-3410-12-512-paramSetD","1.2.643.7.1.2.5.1.1":"id-tc26-gost-28147-param-Z","1.2.643.100.1":"OGRN","1.2.643.100.2.1":"SMEV-person","1.2.643.100.2.2":"SMEV-government","1.2.643.100.3":"SNILS","1.2.643.100.4":"KPP","1.2.643.100.5":"OGRNIP",
"1.2.643.100.6":"internal-government","1.2.643.100.111":"subjectSignTool","1.2.643.100.112":"issuerSignTool","1.2.643.100.113.1":"signToolClassKC1","1.2.643.100.113.2":"signToolClassKC2","1.2.643.100.113.3":"signToolClassKC3","1.2.643.100.113.4":"signToolClassKB1","1.2.643.100.113.5":"signToolClassKB2","1.2.643.100.113.6":"signToolClassKA1","1.2.643.100.114.1":"issuerToolClassKC1","1.2.643.100.114.2":"issuerToolClassKC2","1.2.643.100.114.3":"issuerToolClassKC3","1.2.643.100.114.4":"issuerToolClassKB2",
"1.2.643.100.114.5":"issuerToolClassKB1","1.2.643.100.114.6":"issuerToolClassKA1","1.2.840.10040.4":"x9cm","1.2.840.10040.4.1":"dsa","1.2.840.10040.4.3":"dsa-with-SHA1","1.2.840.10045":"ansi-x962","1.2.840.10045.1":"id-fieldType","1.2.840.10045.1.1":"id-prime-Field","1.2.840.10045.1.2":"id-characteristic-two-field","1.2.840.10045.2.1":"ecPublicKey","1.2.840.10045.3.0":"characteristicTwo","1.2.840.10045.3.1.1":"secp192r1","1.2.840.10045.3.1.2":"prime192v2","1.2.840.10045.3.1.3":"prime192v3","1.2.840.10045.3.1.4":"prime239v1",
"1.2.840.10045.3.1.5":"prime239v2","1.2.840.10045.3.1.6":"prime239v3","1.2.840.10045.3.1.7":"secp256r1","1.2.840.10045.4":"ecdsa","1.2.840.10045.4.1":"ecdsa-with-SHA1","1.2.840.10045.4.2":"ecdsa-with-Recommended","1.2.840.10045.4.4":"ecdsa-with-SHA2","1.2.840.10045.4.4.1":"ecdsa-with-SHA224","1.2.840.10045.4.4.2":"ecdsa-with-SHA256","1.2.840.10045.4.4.3":"ecdsa-with-SHA384","1.2.840.10045.4.4.4":"ecdsa-with-SHA512","1.2.840.113533.7.66.13":"PasswordBasedMac","1.3.6.1.4.1.22554.1.1.2.1.2":"pbeWithSHAAndAES128-CBC",
"1.3.6.1.4.1.22554.1.1.2.1.22":"pbeWithSHAAndAES192-CBC","1.3.6.1.4.1.22554.1.1.2.1.42":"pbeWithSHAAndAES256-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.2":"pbeWithSHA256AndAES128-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.22":"pbeWithSHA256AndAES192-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.42":"pbeWithSHA256AndAES256-CBC","1.2.840.113549":"rsa","1.2.840.113549.1.1.1":"rsaEncryption","1.2.840.113549.1.1.2":"md2withRSAEncryption","1.2.840.113549.1.1.3":"md4withRSAEncryption","1.2.840.113549.1.1.4":"md5withRSAEncryption","1.2.840.113549.1.1.5":"sha1withRSAEncryption",
"1.2.840.113549.1.1.7":"rsaes-oaep","1.2.840.113549.1.1.8":"mgf1","1.2.840.113549.1.1.9":"pSpecified","1.2.840.113549.1.1.10":"rsassa-pss","1.2.840.113549.1.1.11":"sha256withRSAEncryption","1.2.840.113549.1.1.12":"sha384withRSAEncryption","1.2.840.113549.1.1.13":"sha512withRSAEncryption","1.2.840.113549.1.2.7":"hmacWithSHA1","1.2.840.113549.1.2.8":"hmacWithSHA224","1.2.840.113549.1.2.9":"hmacWithSHA256","1.2.840.113549.1.2.10":"hmacWithSHA384","1.2.840.113549.1.2.11":"hmacWithSHA512","1.2.840.113549.1.3.1":"dhKeyAgreement",
"1.2.840.113549.1.5.12":"PBKDF2","1.2.840.113549.1.5.13":"PBES2","1.2.840.113549.1.5.14":"PBMAC1","1.2.840.113549.1.7.1":"data","1.2.840.113549.1.7.2":"signedData","1.2.840.113549.1.7.3":"envelopedData","1.2.840.113549.1.7.4":"signedAndEnvelopedData","1.2.840.113549.1.7.5":"digestedData","1.2.840.113549.1.7.6":"encryptedData","1.2.840.113549.1.9.1":"emailAddress","1.2.840.113549.1.9.2":"unstructuredName","1.2.840.113549.1.9.3":"contentType","1.2.840.113549.1.9.4":"messageDigest","1.2.840.113549.1.9.5":"signingTime",
"1.2.840.113549.1.9.6":"countersignature","1.2.840.113549.1.9.7":"challengePassword","1.2.840.113549.1.9.8":"unstructuredAddress","1.2.840.113549.1.9.9":"extendedCertificateAttributes","1.2.840.113549.1.9.10":"issuerAndSerialNumber","1.2.840.113549.1.9.11":"passwordCheck","1.2.840.113549.1.9.12":"publicKey","1.2.840.113549.1.9.13":"signingDescription","1.2.840.113549.1.9.14":"extensionRequest","1.2.840.113549.1.9.15":"sMimeCapabilities","1.2.840.113549.1.9.16":"sMimeObjectIdentifierRegistry","1.2.840.113549.1.9.16.1.2":"authData",
"1.2.840.113549.1.9.16.1.4 ":"timestampToken","1.2.840.113549.1.9.16.1.17 ":"firmwareLoadReceipt","1.2.840.113549.1.9.16.1.21":"encKeyWithID","1.2.840.113549.1.9.16.1.23":"authEnvelopedData","1.2.840.113549.1.9.16.2":"sMimeAttributes","1.2.840.113549.1.9.16.2.1":"receiptRequest","1.2.840.113549.1.9.16.2.12":"signingCertificate","1.2.840.113549.1.9.16.2.14":"timeStampToken","1.2.840.113549.1.9.16.2.2":"securityLabel","1.2.840.113549.1.9.16.2.3":"mlExpansionHistory","1.2.840.113549.1.9.16.2.34":"unsignedData",
"1.2.840.113549.1.9.16.2.47":"signingCertificateV2","1.2.840.113549.1.9.16.3.5":"ESDH","1.2.840.113549.1.9.20":"friendlyName","1.2.840.113549.1.9.21":"localKeyId","1.2.840.113549.1.9.22":"certTypes","1.2.840.113549.1.9.22.1":"x509Certificate","1.2.840.113549.1.9.22.2":"sdsiCertificate","1.2.840.113549.1.9.23":"crlTypes","1.2.840.113549.1.9.23.1":"x509CRL","1.2.840.113549.1.9.24":"secretTypes","1.2.840.113549.1.9.24.1":"secret","1.2.840.113549.1.9.25.1":"pkcs15Token","1.2.840.113549.1.9.25.2":"encryptedPrivateKeyInfo",
"1.2.840.113549.1.9.25.3":"randomNonce","1.2.840.113549.1.9.25.4":"sequenceNumber","1.2.840.113549.1.9.25.5":"pkcs7PDU","1.2.840.113549.1.9.26.1":"pkcs9String","1.2.840.113549.1.9.26.2":"signingTimeString","1.2.840.113549.1.9.27.1":"caseIgnoreMatch","1.2.840.113549.1.9.27.2":"signingTimeMatch","1.2.840.113549.1.12.0.1":"pkcs-12","1.2.840.113549.1.12.1":"pbe","1.2.840.113549.1.12.1.1":"pbeWithSHAAnd128BitRC4","1.2.840.113549.1.12.1.2":"pbeWithSHAAnd40BitRC4","1.2.840.113549.1.12.1.3":"pbeWithSHAAnd3-KeyTripleDES-CBC",
"1.2.840.113549.1.12.1.4":"pbeWithSHAAnd2-KeyTripleDES-CBC","1.2.840.113549.1.12.1.5":"pbeWithSHAAnd128BitRC2-CBC","1.2.840.113549.1.12.1.6":"pbewithSHAAnd40BitRC2-CBC","1.2.840.113549.1.12.1.80":"pbeUnknownGost","1.2.840.113549.1.12.2.1":"pkcs8-key-shrouding","1.2.840.113549.1.12.3.1":"keyBagId","1.2.840.113549.1.12.3.2":"certAndCRLBagId","1.2.840.113549.1.12.3.3":"secretBagId","1.2.840.113549.1.12.3.4":"safeContentsId","1.2.840.113549.1.12.3.5":"pkcs-8ShroudedKeyBagId","1.2.840.113549.1.12.4.1":"x509CertCRLBagId",
"1.2.840.113549.1.12.4.2":"pkcs-12-SDSICertBag","1.2.840.113549.1.12.10.1.1":"keyBag","1.2.840.113549.1.12.10.1.2":"pkcs8ShroudedKeyBag","1.2.840.113549.1.12.10.1.3":"certBag","1.2.840.113549.1.12.10.1.4":"crlBag","1.2.840.113549.1.12.10.1.5":"secretBag","1.2.840.113549.1.12.10.1.6":"safeContentsBag","1.2.840.113549.2.5":"md-5","1.2.840.113549.3.7":"des-EDE3-CBC","1.3.132.0.34":"secp384r1","1.3.132.0.35":"secp521r1","1.3.132.112":"ecDH","1.3.14.3.2.26":"sha1","1.3.6.1.4.1.311.2.1.14":"msCertExtensions",
"1.3.6.1.4.1.311.17.1":"keyProviderNameAttr","1.3.6.1.4.1.311.17.2":"localMachineKeyset","1.3.6.1.4.1.311.17.3.20":"certKeyIdentifierPropId","1.3.6.1.4.1.5849":"SignalCom","1.3.6.1.4.1.5849.1.1.1":"id-sc-gost28147-ecb","1.3.6.1.4.1.5849.1.1.2":"id-sc-gost28147-gamma","1.3.6.1.4.1.5849.1.1.3":"id-sc-gost28147-gfb","1.3.6.1.4.1.5849.1.1.4":"id-sc-gost28147-mac","1.3.6.1.4.1.5849.1.1.5":"id-sc-gostR3410-94","1.3.6.1.4.1.5849.1.1.6.1.1.1":"id-sc-gostR3410-94-default","1.3.6.1.4.1.5849.1.1.6.1.1.2":"id-sc-gostR3410-94-test",
"1.3.6.1.4.1.5849.1.2.1":"id-sc-gostR3411-94","1.3.6.1.4.1.5849.1.3.1":"id-sc-gostR3411-94-with-gostR3410-94","1.3.6.1.4.1.5849.1.3.2":"id-sc-gostR3411-94-with-gostR3410-2001","1.3.6.1.4.1.5849.1.4.1":"id-sc-cmsGostWrap","1.3.6.1.4.1.5849.1.4.2":"id-sc-cmsGost28147Wrap","1.3.6.1.4.1.5849.1.5.1":"id-sc-pbeWithGost3411AndGost28147","1.3.6.1.4.1.5849.1.5.2":"id-sc-pbeWithGost3411AndGost28147CFB","1.3.6.1.4.1.5849.1.6.2":"id-sc-gostR3410-2001","1.3.6.1.4.1.5849.1.7.2":"id-sc-hmacWithGostR3411","1.3.6.1.4.1.5849.1.8.1":"id-sc-r3410-ESDH-r3411kdf",
"1.3.6.1.4.1.5849.1.8.3":"id-sc-ecdh-singlePass-cofactor-r3411kdf","1.3.6.1.4.1.5849.2.2.1":"id-sc-gostR3410-2001-publicKey","1.3.6.1.5.5.7.0.12":"attribute-cert","1.3.6.1.5.5.7.1.1":"authorityInfoAccess","1.3.6.1.5.5.7.1.4":"auditIdentity","1.3.6.1.5.5.7.1.6":"aaControls","1.3.6.1.5.5.7.1.10":"ac-proxying","1.3.6.1.5.5.7.1.11":"subjectInfoAccess","1.3.6.1.5.5.7.3.1":"serverAuth","1.3.6.1.5.5.7.3.2":"clientAuth","1.3.6.1.5.5.7.3.3":"codeSigning","1.3.6.1.5.5.7.3.4":"emailProtection","1.3.6.1.5.5.7.3.5":"ipsecEndSystem",
"1.3.6.1.5.5.7.3.6":"ipsecTunnel","1.3.6.1.5.5.7.3.7":"ipsecUser","1.3.6.1.5.5.7.3.8":"timeStamping","1.3.6.1.5.5.7.3.9":"OCSPSigning","1.3.6.1.5.5.7.5.1":"regCtrl","1.3.6.1.5.5.7.5.1.1":"regToken","1.3.6.1.5.5.7.5.1.2":"authenticator","1.3.6.1.5.5.7.5.1.3":"pkiPublicationInfo","1.3.6.1.5.5.7.5.1.4":"pkiArchiveOptions","1.3.6.1.5.5.7.5.1.5":"oldCertID","1.3.6.1.5.5.7.5.1.6":"protocolEncrKey","1.3.6.1.5.5.7.5.2":"regInfoAttr","1.3.6.1.5.5.7.5.2.1":"UTF8Pairs","1.3.6.1.5.5.7.5.2.2":"certReq","1.3.6.1.5.5.7.6.2":"noSignature",
"1.3.6.1.5.5.7.7.1":"statusInfo","1.3.6.1.5.5.7.7.2":"identification","1.3.6.1.5.5.7.7.3":"identityProof","1.3.6.1.5.5.7.7.4":"dataReturn","1.3.6.1.5.5.7.7.5":"transactionId","1.3.6.1.5.5.7.7.6":"senderNonce","1.3.6.1.5.5.7.7.7":"recipientNonce","1.3.6.1.5.5.7.7.8":"addExtensions","1.3.6.1.5.5.7.7.9":"encryptedPOP","1.3.6.1.5.5.7.7.10":"decryptedPOP","1.3.6.1.5.5.7.7.11":"lraPOPWitness","1.3.6.1.5.5.7.7.15":"getCert","1.3.6.1.5.5.7.7.16":"getCRL","1.3.6.1.5.5.7.7.17":"revokeRequest","1.3.6.1.5.5.7.7.18":"regInfo",
"1.3.6.1.5.5.7.7.19":"responseInfo","1.3.6.1.5.5.7.7.21":"queryPending","1.3.6.1.5.5.7.7.22":"popLinkRandom","1.3.6.1.5.5.7.7.23":"popLinkWitness","1.3.6.1.5.5.7.7.24":"confirmCertAcceptance","1.3.6.1.5.5.7.7.25":"statusInfoV2","1.3.6.1.5.5.7.7.26":"trustedAnchors","1.3.6.1.5.5.7.7.27":"authPublish","1.3.6.1.5.5.7.7.28":"batchRequests","1.3.6.1.5.5.7.7.29":"batchResponses","1.3.6.1.5.5.7.7.30":"publishCert","1.3.6.1.5.5.7.7.31":"modCertTemplate","1.3.6.1.5.5.7.7.32":"controlProcessed","1.3.6.1.5.5.7.7.33":"popLinkWitnessV2",
"1.3.6.1.5.5.7.7.34":"identityProofV2","1.3.6.1.5.5.7.9.1":"dateOfBirth","1.3.6.1.5.5.7.9.2":"placeOfBirth","1.3.6.1.5.5.7.9.3":"gender","1.3.6.1.5.5.7.9.4":"countryOfCitizenship","1.3.6.1.5.5.7.9.5":"countryOfResidence","1.3.6.1.5.5.7.10.1":"authenticationInfo","1.3.6.1.5.5.7.10.2":"accessIdentity","1.3.6.1.5.5.7.10.3":"chargingIdentity","1.3.6.1.5.5.7.10.4":"group","1.3.6.1.5.5.7.10.6":"encAttrs","1.3.6.1.5.5.7.12.2":"PKIData","1.3.6.1.5.5.7.12.3":"PKIResponse","1.3.6.1.5.5.7.48.1.1":"ocsp-basic",
"1.3.6.1.5.5.7.48.1.2":"ocsp-nonce","1.3.6.1.5.5.7.48.1.3":"ocsp-crl","1.3.6.1.5.5.7.48.1.4":"ocsp-response","1.3.6.1.5.5.7.48.1.5":"ocsp-nocheck","1.3.6.1.5.5.7.48.1.6":"ocsp-archive-cutoff","1.3.6.1.5.5.7.48.1.7":"ocsp-service-locator","2.16.840.1.101.2.1.2.78.2":"encryptedKeyPkg","2.16.840.1.101.2.1.2.78.3":"keyPackageReceipt","2.16.840.1.101.2.1.2.78.5":"aKeyPackage","2.16.840.1.101.2.1.2.78.6":"keyPackageError","2.16.840.1.101.3.4":"nistAlgorithms","2.16.840.1.101.3.4.1":"aes","2.16.840.1.101.3.4.1.1":"aes128-ECB",
"2.16.840.1.101.3.4.1.2":"aes128-CBC","2.16.840.1.101.3.4.1.3":"aes128-OFB","2.16.840.1.101.3.4.1.4":"aes128-CFB","2.16.840.1.101.3.4.1.5":"aes128-wrap","2.16.840.1.101.3.4.1.6":"aes128-GCM","2.16.840.1.101.3.4.1.7":"aes128-CCM","2.16.840.1.101.3.4.1.8":"aes128-wrap-pad","2.16.840.1.101.3.4.1.21":"aes192-ECB","2.16.840.1.101.3.4.1.22":"aes192-CBC","2.16.840.1.101.3.4.1.23":"aes192-OFB","2.16.840.1.101.3.4.1.24":"aes192-CFB","2.16.840.1.101.3.4.1.25":"aes192-wrap","2.16.840.1.101.3.4.1.26":"aes192-GCM",
"2.16.840.1.101.3.4.1.27":"aes192-CCM","2.16.840.1.101.3.4.1.28":"aes192-wrap-pad","2.16.840.1.101.3.4.1.41":"aes256-ECB","2.16.840.1.101.3.4.1.42":"aes256-CBC","2.16.840.1.101.3.4.1.43":"aes256-OFB","2.16.840.1.101.3.4.1.44":"aes256-CFB","2.16.840.1.101.3.4.1.45":"aes256-wrap","2.16.840.1.101.3.4.1.46":"aes256-GCM","2.16.840.1.101.3.4.1.47":"aes256-CCM","2.16.840.1.101.3.4.1.48":"aes256-wrap-pad","2.16.840.1.101.3.4.2.1":"sha256","2.16.840.1.101.3.4.2.2":"sha384","2.16.840.1.101.3.4.2.3":"sha512",
"2.16.840.1.113730.3.1.216":"userPKCS12","2.5.1.5.55":"clearance","2.5.4.0":"objectClass","2.5.4.1":"aliasedEntryName","2.5.4.2":"knowldgeinformation","2.5.4.3":"commonName","2.5.4.5":"serialName","2.5.4.6":"countryName","2.5.4.7":"localityName","2.5.4.8":"stateOrProvinceName","2.5.4.9":"streetAddress","2.5.4.10":"organizationName","2.5.4.11":"organizationalUnitName","2.5.4.12":"title","2.5.4.13":"description","2.5.4.14":"searchGuide","2.5.4.15":"businessCategory","2.5.4.16":"postalAddress","2.5.4.17":"postalCode",
"2.5.4.18":"postOfficeBox","2.5.4.19":"physicalDeliveryOfficeName","2.5.4.20":"telephoneNumber","2.5.4.21":"telexNumber","2.5.4.22":"teletexTerminalIdentifier","2.5.4.23":"facsimileTelephoneNumber","2.5.4.24":"x121Address","2.5.4.25":"internationalISDNNumber","2.5.4.26":"registeredAddress","2.5.4.27":"destinationIndicator","2.5.4.28":"preferredDeliveryMethod","2.5.4.29":"presentationAddress","2.5.4.30":"supportedApplicationContext","2.5.4.31":"member","2.5.4.32":"owner","2.5.4.33":"roleOccupant",
"2.5.4.34":"seeAlso","2.5.4.35":"userPassword","2.5.4.36":"userCertificate","2.5.4.37":"cACertificate","2.5.4.38":"authorityRevocationList","2.5.4.39":"certificateRevocationList","2.5.4.40":"crossCertificatePair","2.5.4.41":"name","2.5.4.42":"givenName","2.5.4.43":"initials","2.5.4.44":"generationQualifier","2.5.4.45":"uniqueIdentifier","2.5.4.46":"dnQualifier","2.5.4.47":"enhancedSearchGuide","2.5.4.48":"protocolInformation","2.5.4.49":"distinguishedName","2.5.4.50":"uniqueMember","2.5.4.51":"houseIdentifier",
"2.5.4.52":"supportedAlgorithms","2.5.4.53":"deltaRevocationList","2.5.4.58":"attributeCertificate","2.5.4.65":"pseudonym","2.5.4.72":"role","2.5.29.1":"authorityKeyIdentifierX","2.5.29.2":"keyAttributesX","2.5.29.3":"certificatePoliciesX","2.5.29.4":"keyUsageRestriction","2.5.29.5":"policyMapping","2.5.29.6":"subtreesConstraint","2.5.29.7":"subjectAltNameX","2.5.29.8":"issuerAltNameX","2.5.29.9":"subjectDirectoryAttributes","2.5.29.10":"basicConstraintsX","2.5.29.11":"nameConstraintsX","2.5.29.12":"policyConstraintsX",
"2.5.29.13":"basicConstraintsY","2.5.29.14":"subjectKeyIdentifier","2.5.29.15":"keyUsage","2.5.29.16":"privateKeyUsagePeriod","2.5.29.17":"subjectAltName","2.5.29.18":"issuerAltName","2.5.29.19":"basicConstraints","2.5.29.20":"cRLNumber","2.5.29.21":"cRLReason","2.5.29.22":"expirationDate","2.5.29.23":"instructionCode","2.5.29.24":"invalidityDate","2.5.29.25":"cRLDistributionPointsX","2.5.29.26":"issuingDistributionPointX","2.5.29.27":"deltaCRLIndicator","2.5.29.28":"issuingDistributionPoint","2.5.29.29":"certificateIssuer",
"2.5.29.30":"nameConstraints","2.5.29.31":"cRLDistributionPoints","2.5.29.32":"certificatePolicies","2.5.29.33":"policyMappings","2.5.29.34":"policyConstraintsY","2.5.29.35":"authorityKeyIdentifier","2.5.29.36":"policyConstraints","2.5.29.37":"extKeyUsage","2.5.29.46":"freshestCRL","2.5.29.54":"inhibitAnyPolicy","2.5.29.55":"targetInformation","2.5.29.56":"noRevAvail"},k={},c;for(c in f)k[f[c]]=c;var a={"id-GostR3411-94-with-GostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94","id-GostR3411-94-with-GostR3410-94":"GOST R 34.10-94/GOST R 34.11-94",
"id-GostR3411-94":"GOST R 34.11-94","id-HMACGostR3411-94":{name:"HMAC",hash:{name:"GOST R 34.11-94"}},"id-Gost28147-89-None-KeyWrap":"GOST 28147-89-KW","id-Gost28147-89-CryptoPro-KeyWrap":"GOST 28147-89-CPKW","id-GostR3410-2001":"GOST R 34.10-2001","id-GostR3410-94":"GOST R 34.10-94","id-GostR3410-94-a":"GOST R 34.10-94","id-GostR3410-94-aBis":"GOST R 34.10-94","id-GostR3410-94-b":"GOST R 34.10-94","id-GostR3410-94-bBis":"GOST R 34.10-94","id-Gost28147-89":"GOST 28147-89","id-Gost28147-89-MAC":"GOST 28147-89-MAC",
"id-GostR3410-2001-CryptoPro-ESDH":"GOST R 34.10-2001-DH/GOST R 34.11-94","id-GostR3410-94-CryptoPro-ESDH":"GOST R 34.10-94-DH/GOST R 34.11-94","id-GostR3410-2001DH":"GOST R 34.10-2001-DH","id-GostR3410-94DH":"GOST R 34.10-94-DH","id-tc26-gost3410-12-256":"GOST R 34.10-256","id-tc26-gost3410-12-512":"GOST R 34.10-512","id-tc26-gost3411-94":"GOST R 34.11-94","id-tc26-gost3411-12-256":"GOST R 34.11-256","id-tc26-gost3411-12-512":"GOST R 34.11-512","id-tc26-signwithdigest-gost3410-12-94":"GOST R 34.10-256/GOST R 34.11-94",
"id-tc26-signwithdigest-gost3410-12-256":"GOST R 34.10-256/GOST R 34.11-256","id-tc26-signwithdigest-gost3410-12-512":"GOST R 34.10-512/GOST R 34.11-512","id-tc26-hmac-gost-3411-12-256":{name:"HMAC",hash:{name:"GOST R 34.11-256"}},"id-tc26-hmac-gost-3411-12-512":{name:"HMAC",hash:{name:"GOST R 34.11-512"}},"id-tc26-agreement-gost-3410-12-256":"GOST R 34.10-256-DH/GOST R 34.11-256","id-tc26-agreement-gost-3410-12-512":"GOST R 34.10-512-DH/GOST R 34.11-256","id-sc-gost28147-ecb":"GOST 28147-89-ECB/SC",
"id-sc-gost28147-gamma":"GOST 28147-89-CTR/SC","id-sc-gost28147-gfb":"GOST 28147-89-CFB/SC","id-sc-gost28147-mac":"GOST 28147-89-MAC/SC","id-sc-gostR3410-94":"GOST R 34.10-94/SC","id-sc-gostR3410-94-default":"GOST R 34.10-94/SC","id-sc-gostR3410-94-test":"GOST R 34.10-94/SC/S-TEST","id-sc-gostR3411-94":"GOST R 34.11-94/SC","id-sc-gostR3411-94-with-gostR3410-94":"GOST R 34.10-94/GOST R 34.11-94/SC","id-sc-gostR3411-94-with-gostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94/SC","id-sc-cmsGostWrap":"GOST 28147-89-SCKW/SC",
"id-sc-cmsGost28147Wrap":"GOST 28147-89-KW/SC","id-sc-pbeWithGost3411AndGost28147":{derivation:{name:"GOST R 34.11-94-PBKDF2/SC"},encryption:{name:"GOST 28147-ECB/SC"}},"id-sc-pbeWithGost3411AndGost28147CFB":{derivation:{name:"GOST R 34.11-94-PBKDF2/SC"},encryption:{name:"GOST 28147-CFB/SC"}},"id-sc-gostR3410-2001":"GOST R 34.10-2001/SC","id-sc-hmacWithGostR3411":{name:"HMAC",hash:{name:"GOST R 34.11-94/SC"}},"id-sc-r3410-ESDH-r3411kdf":"GOST R 34.10-2001-DH/GOST R 34.11-94/SC",noSignature:"NONE",
rsaEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},sha1withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}},sha256withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},sha384withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}},sha512withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},"rsaes-oaep":"RSA-OAEP","rsassa-pss":"RSA-PSS",ecdsa:"ECDSA","ecdsa-with-SHA1":{name:"ECDSA",hash:{name:"SHA-1"}},"ecdsa-with-SHA256":{name:"ECDSA",hash:{name:"SHA-256"}},
"ecdsa-with-SHA384":{name:"ECDSA",hash:{name:"SHA-384"}},"ecdsa-with-SHA512":{name:"ECDSA",hash:{name:"SHA-512"}},"pbeWithSHAAndAES128-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-1"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHAAndAES192-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-1"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHAAndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-1"}},encryption:{name:"AES-CBC",length:256}},"pbeWithSHA256AndAES128-CBC":{derivation:{name:"PBKDF2",
hash:{name:"SHA-256"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHA256AndAES192-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-256"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHA256AndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-256"}},encryption:{name:"AES-CBC",length:256}},"pbeWithSHAAnd3-KeyTripleDES-CBC":{derivation:{name:"PFXKDF",hash:"SHA-1"},encryption:{name:"3DES",block:"CBC"}},"pbeWithSHAAnd2-KeyTripleDES-CBC":{derivation:{name:"PFXKDF",hash:"SHA-1"},encryption:{name:"2DES",
block:"CBC"}},"pbeWithSHAAnd128BitRC2-CBC":{derivation:{name:"PFXKDF",hash:"SHA-1"},encryption:{name:"RC2",block:"CBC",length:128}},"pbewithSHAAnd40BitRC2-CBC":{derivation:{name:"PFXKDF",hash:"SHA-1"},encryption:{name:"RC2",block:"CBC",length:40}},pbeUnknownGost:{derivation:{name:"PFXKDF",hash:"GOST R 34.11"},encryption:{name:"GOST 28147-89-CFB"}},ecDH:"ECDH",dhKeyAgreement:"DH","aes128-CBC":{name:"AES-CBC",length:128},"aes128-CFB":{name:"AES-CFB",length:128},"aes128-GCM":{name:"AES-GCM",length:128},
"aes128-wrap":{name:"AES-KW",length:128},"aes192-CBC":{name:"AES-CBC",length:192},"aes192-CFB":{name:"AES-CFB",length:192},"aes192-GCM":{name:"AES-GCM",length:192},"aes192-wrap":{name:"AES-KW",length:192},"aes256-CBC":{name:"AES-CBC",length:256},"aes256-CFB":{name:"AES-CFB",length:256},"aes256-GCM":{name:"AES-GCM",length:256},"aes256-wrap":{name:"AES-KW",length:256},sha1:"SHA-1",sha256:"SHA-256",sha384:"SHA-384",sha512:"SHA-512",PBKDF2:"PBKDF2",PBES2:{derivation:{name:"PBKDF2"},encryption:{}},PBMAC1:{derivation:{name:"PBKDF2"},
hmac:{}},hmacWithSHA1:"SHA-1-HMAC",hmacWithSHA256:{name:"HMAC",hash:{name:"SHA-256"}},hmacWithSHA384:{name:"HMAC",hash:{name:"SHA-384"}},hmacWithSHA512:{name:"HMAC",hash:{name:"SHA-512"}}};for(c in a){var d=a[c];"string"===typeof d&&(d={name:d});d.id=c;a[c]=d}var g={"CP-94":{title:"Crypto-Pro GOST R 34.10-94 Cryptographic Service Provider",signature:a["id-GostR3411-94-with-GostR3410-94"],publicKey:{id:"id-GostR3410-94",name:"GOST R 34.10-94",namedParam:"X-A"},privateKey:{id:"id-GostR3410-94DH",name:"GOST R 34.10-94-DH",
namedParam:"X-A"},digest:a["id-GostR3411-94"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-HMACGostR3411-94"],agreement:a["id-GostR3410-94-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89",block:"CFB",sBox:"E-A",keyMeshing:"CP"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:2E3}},"CP-01":{title:"Crypto-Pro GOST R 34.10-2001 Cryptographic Service Provider",signature:a["id-GostR3411-94-with-GostR3410-2001"],
publicKey:{id:"id-GostR3410-2001",name:"GOST R 34.10-2001",namedCurve:"X-256-A"},privateKey:{id:"id-GostR3410-2001DH",name:"GOST R 34.10-2001-DH",namedCurve:"X-256-A"},digest:{id:"id-GostR3411-94",name:"GOST R 34.11-94",sBox:"D-A"},wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-HMACGostR3411-94"],agreement:a["id-GostR3410-2001-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",
iterations:2E3}},"TC-256":{title:"Crypto-Pro GOST R 34.10-2012 Cryptographic Service Provider",signature:a["id-tc26-signwithdigest-gost3410-12-256"],publicKey:{id:"id-tc26-gost3410-12-256",name:"GOST R 34.10-256",namedCurve:"T-256-A"},privateKey:{id:"id-tc26-agreement-gost-3410-12-256",name:"GOST R 34.10-256-DH/GOST R 34.11-256",namedCurve:"T-256-A"},digest:a["id-tc26-gost3411-12-256"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-tc26-hmac-gost-3411-12-256"],
agreement:a["id-tc26-agreement-gost-3410-12-256"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-256-12-PBKDF2",iterations:2E3}},"TC-512":{title:"Crypto-Pro GOST R 34.10-2012 Strong Cryptographic Service Provider",signature:a["id-tc26-signwithdigest-gost3410-12-512"],publicKey:{id:"id-tc26-gost3410-12-512",name:"GOST R 34.10-512",namedCurve:"T-512-A"},privateKey:{id:"id-tc26-agreement-gost-3410-12-512",name:"GOST R 34.10-512-DH/GOST R 34.11-256",
namedCurve:"T-512-A"},digest:a["id-tc26-gost3411-12-512"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-tc26-hmac-gost-3411-12-512"],agreement:a["id-tc26-agreement-gost-3410-12-512"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-256-PBKDF2",iterations:2E3}},"SC-94":{title:"Signal-COM GOST Cryptographic Provider",signature:a["id-sc-gostR3411-94-with-gostR3410-94"],publicKey:{id:"id-sc-gostR3410-94",
name:"GOST R 34.10-94/SC",namedParam:"S-A"},privateKey:{id:"id-sc-gostR3410-94",name:"GOST R 34.10-94/SC",modulusLength:1024,param:{p:"0xB4E25EFB018E3C8B87505E2A67553C5EDC56C2914B7E4F89D23F03F03377E70A2903489DD60E78418D3D851EDB5317C4871E40B04228C3B7902963C4B7D85D52B9AA88F2AFDBEB28DA8869D6DF846A1D98924E925561BD69300B9DDD05D247B5922D967CBB02671881C57D10E5EF72D3E6DAD4223DC82AA1F7D0294651A480DF",q:"0x972432A437178B30BD96195B773789AB2FFF15594B176DD175B63256EE5AF2CF",a:"0x8FD36731237654BBE41F5F1F8453E71CA414FFC22C25D915309E5D2E62A2A26C7111F3FC79568DAFA028042FE1A52A0489805C0DE9A1A469C844C7CABBEE625C3078888C1D85EEA883F1AD5BC4E6776E8E1A0750912DF64F79956499F1E182475B0B60E2632ADCD8CF94E9C54FD1F3B109D81F00BF2AB8CB862ADF7D40B9369A"}},
digest:a["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/SC"},hmac:a["id-sc-hmacWithGostR3411"],wrapping:["id-sc-cmsGostWrap"],agreement:a["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])}}},
"SC-01":{title:"Signal-COM ECGOST Cryptographic Provider",signature:a["id-sc-gostR3411-94-with-gostR3410-2001"],publicKey:{id:"id-sc-gostR3410-2001",name:"GOST R 34.10-2001/SC",namedCurve:"P-256"},privateKey:{id:"id-sc-gostR3410-2001",name:"GOST R 34.10-2001/SC",curve:{p:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF",a:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC",b:"0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B",x:"0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296",
y:"0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",q:"0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"}},digest:a["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/SC"},hmac:a["id-sc-hmacWithGostR3411"],wrapping:a["id-sc-cmsGostWrap"],agreement:a["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",
iterations:2048},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])}}},"RSA-2048":{title:"Microsoft Strong Cryptographic Provider",signature:a.sha256withRSAEncryption,publicKey:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:a.sha256},privateKey:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:a.sha256},digest:a.sha256,encryption:a["aes256-CFB"],
hmac:a.hmacWithSHA256},"ECDSA-256":{title:"Microsoft Base DSS and Diffie-Hellman Cryptographic Provider",signature:a["ecdsa-with-SHA256"],publicKey:{id:"ecdsa",name:"ECDSA",namedCurve:"P-256"},privateKey:{id:"ecdsa",name:"ECDSA",namedCurve:"P-256"},digest:a.sha256,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA256,agreement:a.ecDH}};"CP-94 CP-01 TC-256 TC-512 SC-94 SC-01".split(" ").forEach(function(a){a=g[a];a.hmac=b(a.hmac,{hash:a.digest});a.derivation=b(a.derivation,{hash:a.digest,hmac:a.hmac});
a.pbes=a.pbes||{id:"PBES2",derivation:a.derivation,encryption:a.encryption};a.pbmac=a.pbmac||{id:"PBMAC1",derivation:a.derivation,hmac:a.hmac};a.agreement=b(a.agreement,{wrapping:a.wrapping})});["RSA-2048","ECDSA-256"].forEach(function(a){a=g[a];a.derivation=a.derivation||{id:"PBKDF2",name:"PBKDF2",iterations:2048,hash:a.digest};a.pbes=a.pbes||{id:"PBES2",derivation:a.derivation,encryption:a.encryption};a.pbmac=a.pbmac||{id:"PBMAC1",derivation:a.derivation,hmac:a.hmac}});h.prototype={names:f,identifiers:k,
algorithms:a,parameters:{"id-GostR3410-94-TestParamSet":{namedParam:"S-TEST"},"id-GostR3410-94-CryptoPro-A-ParamSet":{namedParam:"S-A"},"id-GostR3410-94-CryptoPro-B-ParamSet":{namedParam:"S-B"},"id-GostR3410-94-CryptoPro-C-ParamSet":{namedParam:"S-C"},"id-GostR3410-94-CryptoPro-D-ParamSet":{namedParam:"S-D"},"id-GostR3410-94-CryptoPro-XchA-ParamSet":{namedParam:"X-A"},"id-GostR3410-94-CryptoPro-XchB-ParamSet":{namedParam:"X-B"},"id-GostR3410-94-CryptoPro-XchC-ParamSet":{namedParam:"X-C"},"id-GostR3410-2001-CryptoPro-TestParamSet":{namedCurve:"S-256-TEST"},
"id-GostR3410-2001-CryptoPro-A-ParamSet":{namedCurve:"S-256-A"},"id-GostR3410-2001-CryptoPro-B-ParamSet":{namedCurve:"S-256-B"},"id-GostR3410-2001-CryptoPro-C-ParamSet":{namedCurve:"S-256-C"},"id-GostR3410-2001-CryptoPro-XchA-ParamSet":{namedCurve:"X-256-A"},"id-GostR3410-2001-CryptoPro-XchB-ParamSet":{namedCurve:"X-256-B"},"id-tc26-gost-3410-12-256-paramSetTest":{namedCurve:"T-256-TEST"},"id-tc26-gost-3410-12-256-paramSetA":{namedCurve:"T-256-A"},"id-tc26-gost-3410-12-256-paramSetB":{namedCurve:"T-256-B"},
"id-tc26-gost-3410-12-512-paramSetTest":{namedCurve:"T-512-TEST"},"id-tc26-gost-3410-12-512-paramSetA":{namedCurve:"T-512-A"},"id-tc26-gost-3410-12-512-paramSetB":{namedCurve:"T-512-B"},"id-tc26-gost-3410-12-512-paramSetC":{namedCurve:"T-512-C"},"id-tc26-gost-3410-12-512-paramSetD":{namedCurve:"T-512-D"},secp256r1:{namedCurve:"P-256"},secp384r:{namedCurve:"P-384"},secp521r:{namedCurve:"P-521"},"id-GostR3411-94-TestParamSet":{sBox:"D-TEST"},"id-GostR3411-94-CryptoProParamSet":{sBox:"D-A"},"id-GostR3411-94-CryptoPro-A-ParamSet":{sBox:"D-B"},
"id-GostR3411-94-CryptoPro-B-ParamSet":{sBox:"D-C"},"id-GostR3411-94-CryptoPro-C-ParamSet":{sBox:"D-D"},"id-Gost28147-89-TestParamSet":{block:"CTR",sBox:"E-TEST"},"id-Gost28147-89-CryptoPro-A-ParamSet":{block:"CFB",sBox:"E-A",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-B-ParamSet":{block:"CFB",sBox:"E-B",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-C-ParamSet":{block:"CFB",sBox:"E-C",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-D-ParamSet":{block:"CFB",sBox:"E-D",keyMeshing:"CP"},"id-Gost28147-89-None-KeyMeshing":{keyMeshing:"NO"},
"id-Gost28147-89-CryptoPro-KeyMeshing":{keyMeshing:"CP"},"id-tc26-gost-28147-param-Z":{block:"CFB",sBox:"E-Z"}},attributes:{sBox:{"D-TEST":"id-GostR3411-94-TestParamSet","D-A":"id-GostR3411-94-CryptoProParamSet","D-B":"id-GostR3411-94-CryptoPro-A-ParamSet","D-C":"id-GostR3411-94-CryptoPro-B-ParamSet","D-D":"id-GostR3411-94-CryptoPro-C-ParamSet","E-TEST":"id-Gost28147-89-TestParamSet","E-A":"id-Gost28147-89-CryptoPro-A-ParamSet","E-B":"id-Gost28147-89-CryptoPro-B-ParamSet","E-C":"id-Gost28147-89-CryptoPro-C-ParamSet",
"E-D":"id-Gost28147-89-CryptoPro-D-ParamSet","E-Z":"id-tc26-gost-28147-param-Z","D-256":"id-tc26-gost3411-12-256","D-512":"id-tc26-gost3411-12-512"},namedParam:{"S-TEST":"id-GostR3410-94-TestParamSet","S-A":"id-GostR3410-94-CryptoPro-A-ParamSet","S-B":"id-GostR3410-94-CryptoPro-B-ParamSet","S-C":"id-GostR3410-94-CryptoPro-C-ParamSet","S-D":"id-GostR3410-94-CryptoPro-D-ParamSet","X-A":"id-GostR3410-94-CryptoPro-XchA-ParamSet","X-B":"id-GostR3410-94-CryptoPro-XchB-ParamSet","X-C":"id-GostR3410-94-CryptoPro-XchC-ParamSet"},
namedCurve:{"S-256-TEST":"id-GostR3410-2001-CryptoPro-TestParamSet","S-256-A":"id-GostR3410-2001-CryptoPro-A-ParamSet","S-256-B":"id-GostR3410-2001-CryptoPro-B-ParamSet","S-256-C":"id-GostR3410-2001-CryptoPro-C-ParamSet","X-256-A":"id-GostR3410-2001-CryptoPro-XchA-ParamSet","X-256-B":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","P-256":"secp256r1","T-256-TEST":"id-tc26-gost-3410-12-256-paramSetTest","T-256-A":"id-tc26-gost-3410-12-256-paramSetA","T-256-B":"id-tc26-gost-3410-12-256-paramSetB","T-512-TEST":"id-tc26-gost-3410-12-512-paramSetTest",
"T-512-A":"id-tc26-gost-3410-12-512-paramSetA","T-512-B":"id-tc26-gost-3410-12-512-paramSetB"}},providers:g};e.security=new h});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(B,s){"function"===typeof define&&define.amd?define(["gostCrypto"],s):"object"===typeof exports?module.exports=s(require("gostCrypto")):B.GostCoding=s(B.gostCrypto)})(this,function(B){function s(c){if(c instanceof v)return c;if(c&&c.buffer&&c.buffer instanceof v)return 0===c.byteOffset&&c.byteLength===c.buffer.byteLength?c.buffer:(new Uint8Array(new Uint8Array(c,c.byteOffset,c.byteLength))).buffer;throw new y("CryptoOperationData required");}function A(){}var y=this.DataError||this.Error,
v=this.ArrayBuffer,C=this.Date,D={decode:function(c){c=c.replace(/[^A-Za-z0-9\+\/]/g,"");for(var m=c.length,p=3*m+1>>2,q=new Uint8Array(p),g,a=0,h=0,e=0;e<m;e++){g=e&3;var d=c.charCodeAt(e),d=64<d&&91>d?d-65:96<d&&123>d?d-71:47<d&&58>d?d+4:43===d?62:47===d?63:0,a=a|d<<18-6*g;if(3===g||1===m-e){for(g=0;3>g&&h<p;g++,h++)q[h]=a>>>(16>>>g&24)&255;a=0}}return q.buffer},encode:function(c){c=new Uint8Array(s(c));for(var m=2,p="",q=c.length,g=0,a=0;a<q;a++)if(m=a%3,0<a&&0===4*a/3%96&&(p+="\r\n"),g|=c[a]<<
(16>>>m&24),2===m||1===q-a){for(var h=18;0<=h;h-=6)var e=g>>>h&63,e=26>e?e+65:52>e?e+71:62>e?e-4:62===e?43:63===e?47:65,p=p+String.fromCharCode(e);g=0}return p.substr(0,p.length-2+m)+(2===m?"":1===m?"=":"==")}};A.prototype.Base64=D;var z=function(){var c={1026:128,1027:129,8218:130,1107:131,8222:132,8230:133,8224:134,8225:135,8364:136,8240:137,1033:138,8249:139,1034:140,1036:141,1035:142,1039:143,1106:144,8216:145,8217:146,8220:147,8221:148,8226:149,8211:150,8212:151,8482:153,1113:154,8250:155,1114:156,
1116:157,1115:158,1119:159,160:160,1038:161,1118:162,1032:163,164:164,1168:165,166:166,167:167,1025:168,169:169,1028:170,171:171,172:172,173:173,174:174,1031:175,176:176,177:177,1030:178,1110:179,1169:180,181:181,182:182,183:183,1105:184,8470:185,1108:186,187:187,1112:188,1029:189,1109:190,1111:191},m={},p;for(p in c)m[c[p]]=p;return{decode:function(q,g){g=(g||"win1251").toLowerCase().replace("-","");for(var a=[],h=0,e=q.length;h<e;h++){var d=q.charCodeAt(h);if("utf8"===g)128>d?a.push(d):(2048>d?
a.push(192+(d>>>6)):(65536>d?a.push(224+(d>>>12)):(2097152>d?a.push(240+(d>>>18)):(67108864>d?a.push(248+(d>>>24)):(a.push(252+(d>>>30)),a.push(128+(d>>>24&63))),a.push(128+(d>>>18&63))),a.push(128+(d>>>12&63))),a.push(128+(d>>>6&63))),a.push(128+(d&63)));else if("unicode"===g||"ucs2"===g||"utf16"===g)if(55296>d||57344<=d&&65536>=d)a.push(d>>>8),a.push(d&255);else{if(65536<=d&&1114112>d){var d=d-65536,b=((1047552&d)>>10)+55296,d=(1023&d)+56320;a.push(b>>>8);a.push(b&255);a.push(d>>>8);a.push(d&255)}}else"utf32"===
g||"ucs4"===g?(a.push(d>>>24&255),a.push(d>>>16&255),a.push(d>>>8&255),a.push(d&255)):"win1251"===g?(128<=d&&(d=1040<=d&&1104>d?d-848:c[d]||0),a.push(d)):a.push(d&255)}return(new Uint8Array(a)).buffer},encode:function(c,g){g=(g||"win1251").toLowerCase().replace("-","");for(var a=[],h=new Uint8Array(s(c)),e=0,d=h.length;e<d;e++){var b=h[e];if("utf8"===g)b=252<=b&&254>b&&e+5<d?1073741824*(b-252)+(h[++e]-128<<24)+(h[++e]-128<<18)+(h[++e]-128<<12)+(h[++e]-128<<6)+h[++e]-128:b>>248&&252>b&&e+4<d?(b-248<<
24)+(h[++e]-128<<18)+(h[++e]-128<<12)+(h[++e]-128<<6)+h[++e]-128:b>>240&&248>b&&e+3<d?(b-240<<18)+(h[++e]-128<<12)+(h[++e]-128<<6)+h[++e]-128:224<=b&&240>b&&e+2<d?(b-224<<12)+(h[++e]-128<<6)+h[++e]-128:192<=b&&224>b&&e+1<d?(b-192<<6)+h[++e]-128:b;else if("unicode"===g||"ucs2"===g||"utf16"===g){if(b=(b<<8)+h[++e],55296<=b&&57344>b)var k=b-55296<<10,b=h[++e],b=(b<<8)+h[++e],b=k+(b-56320)+65536}else"utf32"===g||"ucs4"===g?(b=(b<<8)+h[++e],b=(b<<8)+h[++e],b=(b<<8)+h[++e]):"win1251"===g&&128<=b&&(b=192<=
b&&256>b?b+848:m[b]||0);a.push(String.fromCharCode(b))}return a.join("")}}}();A.prototype.Chars=z;var G={decode:function(c,m){c=c.replace(/[^A-fa-f0-9]/g,"");var p=Math.ceil(c.length/2),q=new Uint8Array(p);c=(0<c.length%2?"0":"")+c;if(m&&("string"!==typeof m||0>m.toLowerCase().indexOf("little")))for(var g=0;g<p;g++)q[g]=parseInt(c.substr(2*(p-g-1),2),16);else for(g=0;g<p;g++)q[g]=parseInt(c.substr(2*g,2),16);return q.buffer},encode:function(c,m){var p=[],q=new Uint8Array(s(c)),g=q.length;if(m&&("string"!==
typeof m||0>m.toLowerCase().indexOf("little")))for(var a=0;a<g;a++){var h=g-a-1;p[h]=(0<h&&0===h%32?"\r\n":"")+("00"+q[a].toString(16)).slice(-2)}else for(a=0;a<g;a++)p[a]=(0<a&&0===a%32?"\r\n":"")+("00"+q[a].toString(16)).slice(-2);return p.join("")}};A.prototype.Hex=G;var E={decode:function(c){c=(c||"").replace(/[^\-A-fa-f0-9]/g,"");0===c.length&&(c="0");var m=!1;"-"===c.charAt(0)&&(m=!0,c=c.substring(1));for(;"0"===c.charAt(0)&&1<c.length;)c=c.substring(1);c=(0<c.length%2?"0":"")+c;if(!m&&!/^[0-7]/.test(c)||
m&&!/^[0-7]|8[0]+$/.test(c))c="00"+c;for(var p=c.length/2,q=new Uint8Array(p),g=0,p=p-1;0<=p;--p){var a=parseInt(c.substr(2*p,2),16);m&&0<a+g&&(a=256-a-g,g=1);q[p]=a}return q.buffer},encode:function(c){c=new Uint8Array(s(c));if(0===c.length)return"0x00";for(var m=[],p=127<c[0],q=0,g=c.length-1;0<=g;--g){var a=c[g];p&&0<a+q&&(a=256-a-q,q=1);m[g]=("00"+a.toString(16)).slice(-2)}for(m=m.join("");"0"===m.charAt(0);)m=m.substring(1);return(p?"-":"")+"0x"+m}};A.prototype.Int16=E;var F=function(){function c(q,
g){var a=q.object;void 0===a&&(a=q);var h=q.tagClass=q.tagClass||0;if(0===h){var e=q.tagNumber;if("undefined"===typeof e)if("string"===typeof a)e=""===a?5:/^\-?0x[0-9a-fA-F]+$/.test(a)?2:/^(\d+\.)+\d+$/.test(a)?6:/^[01]+$/.test(a)?3:/^(true|false)$/.test(a)?1:/^[0-9a-fA-F]+$/.test(a)?4:19;else if("number"===typeof a)e=2;else if("boolean"===typeof a)e=1;else if(a instanceof Array)e=16;else if(a instanceof C)e=24;else if(a instanceof v||a&&a.buffer instanceof v)e=4;else throw new y("Unrecognized type for "+
a);}var d=q.tagConstructed;"undefined"===typeof d&&(d=q.tagConstructed=a instanceof Array);var b;if(a instanceof v||a&&a.buffer instanceof v)b=new Uint8Array(s(a)),3===e&&(a=new Uint8Array(s(b)),b=new Uint8Array(a.length+1),b[0]=0,b.set(a,1));else if(d)if(a instanceof Array){for(var k=0,n=[],m=0,l=0,f=a.length;l<f;l++)n[l]=c(a[l],g),k+=n[l].length;17===e&&n.sort(function(a,b){for(var c=0,d=Math.min(a.length,b.length);c<d;c++){var e=a[c]-b[c];if(0!==e)return e}return a.length-b.length});"CER"===g&&
(n[f]=new Uint8Array(2),k+=2);b=new Uint8Array(k);l=0;for(f=n.length;l<f;l++)b.set(n[l],m),m+=n[l].length}else throw new y("Constracted block can't be primitive");else switch(e){case 1:b=new Uint8Array(1);b[0]=a?255:0;break;case 2:case 10:b=E.decode("number"===typeof a?"0x"+a.toString(16):a);break;case 3:if("string"===typeof a)for(l=7-(a.length+7)%8,f=Math.ceil(a.length/8),b=new Uint8Array(f+1),b[0]=l,l=0;l<f;l++){for(k=n=0;8>k;k++)var u=8*l+k,n=(n<<1)+(u<a.length?"1"===a.charAt(u)?1:0:0);b[l+1]=
n}break;case 4:b=G.decode("number"===typeof a?a.toString(16):a);break;case 6:a=a.match(/\d+/g);b=[];for(l=1;l<a.length;l++){f=+a[l];n=[];1===l&&(f+=40*a[0]);do n.push(f&127),f>>>=7;while(f);for(k=n.length-1;0<=k;--k)b.push(n[k]+(0===k?0:128))}b=new Uint8Array(b);break;case 12:b=z.decode(a,"utf8");break;case 18:case 22:case 19:case 20:case 21:case 25:case 26:case 27:l=0;for(f=a.length;l<f;l++)255<a.charCodeAt(l)&&(e=12);b=12===e?z.decode(a,"utf8"):z.decode(a,"ascii");break;case 23:case 24:b=a.original;
if(!b){b=new C(a);b.setMinutes(b.getMinutes()+b.getTimezoneOffset());for(f=b.getMilliseconds().toString();0<f.length&&"0"===f.charAt(f.length-1);)f=f.substring(0,f.length-1);0<f.length&&(f="."+f);b=(23===e?b.getYear().toString().slice(-2):b.getFullYear().toString())+("00"+(b.getMonth()+1)).slice(-2)+("00"+b.getDate()).slice(-2)+("00"+b.getHours()).slice(-2)+("00"+b.getMinutes()).slice(-2)+("00"+b.getSeconds()).slice(-2)+f+"Z"}b=z.decode(b,"ascii");break;case 28:b=z.decode(a,"utf32");break;case 30:b=
z.decode(a,"utf16")}b||(b=new Uint8Array(0));b instanceof v&&(b=new Uint8Array(b));if(!d&&"CER"===g)switch(e){case 3:u=1;case 4:case 12:case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:case 28:case 30:u=u||0;k=0;n=[];m=0;l=u;for(f=b.length;l<f;l+=1E3-u)n[l]=c({object:new Unit8Array(b.buffer,l,Math.min(1E3-u,f-l)),tagNumber:e,tagClass:0,tagConstructed:!1},g),k+=n[l].length;n[f]=new Uint8Array(2);b=new Uint8Array(k+2);l=0;for(f=n.length;l<f;l++)b.set(n[l],m),m+=n[l].length}q.tagNumber=
0===h?e:e=q.tagNumber||0;q.content=b;u=[];f=3===h?192:2===h?128:1===h?64:0;d&&(f|=32);if(31>e)u.push(f|e&31);else{f|=31;u.push(f);f=e;l=[];do l.push(f&127),f>>>=7;while(f);for(k=l.length-1;0<=k;--k)u.push(l[k]+(0===k?0:128))}if(d&&"CER"===g)u.push(128);else if(d=b.length,127<d){f=d;d=[];do d.push(f&255),f>>>=8;while(f);u.push(d.length+128);for(k=d.length-1;0<=k;--k)u.push(d[k])}else u.push(d);d=q.header=new Uint8Array(u);q.typeName=1===h?"Application_"+e:2===h?"["+e.toString()+"]":3===h?"Private_"+
e:p[e]||"Universal_"+e.toString();h=new Uint8Array(d.length+b.length);h.set(d,0);h.set(b,d.length);return h}function m(c,g){var a=g||0,h=c[a++],e=h>>6,d=0!==(h&32),b=h&31;if(31===b){b=0;do{if(9007199254740864<b)throw new y("Convertor not supported tag number more then (2^53 - 1) at position "+g);h=c[a++];b=(b<<7)+(h&127)}while(h&128)}var h=c[a++],k=h&127;if(k!==h){if(6<k)throw new y("Length over 48 bits not supported at position "+g);if(0===k)k=null;else{for(var n=h=0;n<k;++n)h=(h<<8)+c[a++];k=h}}var x=
a,l=null;if(d)if(l=[],null!==k){for(h=x+k;a<h;){var f=m(c,a);l.push(f);a+=f.header.length+f.content.length}if(a!==h)throw new y("Content size is not correct for container starting at offset "+x);}else try{for(;;){f=m(c,a);a+=f.header.length+f.content.length;if(0===f.tagClass&&0===f.tagNumber)break;l.push(f)}k=a-x}catch(u){throw new y("Exception "+u+" while decoding undefined length content at offset "+x);}var w="",a=new Uint8Array(c.buffer,g,x-g),t=h=new Uint8Array(c.buffer,x,k);if(null!==l&&0===
e){var r;switch(b){case 3:r=1;case 4:case 12:case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:case 28:case 30:r=r||0;if(0===l.length)throw new y("No constructed encoding content of string type at offset "+x);for(var k=r,n=0,s=l.length;n<s;n++){f=l[n];if(f.tagClass!==e||f.tagNumber!==b||f.tagConstructed)throw new y("Invalid constructed encoding of string type at offset "+x);k+=f.content.length-r}for(var t=new Uint8Array(k),n=0,s=l.length,v=r;n<s;n++)f=l[n],0<r?t.set(f.content.subarray(1),
v):t.set(f.content,v),v+=f.content.length-r;d=!1;l=null}}if(null===l){if(null===k)throw new y("Invalid tag with undefined length at offset "+x);if(0===e)switch(b){case 1:w=0!==t[0];break;case 2:case 10:if(6<k)w=E.encode(t);else{r=t[0];127<t[0]&&(r-=256);for(n=1;n<k;n++)r=256*r+t[n];w=r}break;case 3:if(5<k)w=(new Uint8Array(t.subarray(1))).buffer;else{x=t[0];f=[];for(n=k-1;1<=n;--n){k=t[n];for(v=x;8>v;++v)f.push(k>>v&1?"1":"0");x=0}w=f.reverse().join("")}break;case 4:w=(new Uint8Array(t)).buffer;break;
case 6:f="";for(n=l=s=0;n<k;++n)r=t[n],s=(s<<7)+(r&127),l+=7,r&128||(""===f?(r=80>s?40>s?0:1:2,f=r+"."+(s-40*r)):f+="."+s.toString(),l=s=0);if(0<l)throw new y("Incompleted OID at offset "+x);w=f;break;case 16:case 17:w=[];break;case 12:w=z.encode(t,"utf8");break;case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:w=z.encode(t,"ascii");break;case 28:w=z.encode(t,"utf32");break;case 30:w=z.encode(t,"utf16");break;case 23:case 24:k=23===b;f=z.encode(t,"ascii");r=(k?/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/:
/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/).exec(f);if(!r)throw new y('Unrecognized time format "'+f+'" at offset '+x);k&&(r[1]=+r[1],r[1]+=50>r[1]?2E3:1900);k=new C(r[1],+r[2]-1,+r[3],+(r[4]||0),+(r[5]||0),+(r[6]||0),+(r[7]||0));n=k.getTimezoneOffset();if(r[8]||23===b)"Z"!==r[8].toUpperCase()&&r[9]&&(n+=parseInt(r[9])),k.setMinutes(k.getMinutes()-n);k.original=f;w=k}else w=(new Uint8Array(t)).buffer}else w=
l;return{tagConstructed:d,tagClass:e,tagNumber:b,header:a,content:h,typeName:1===e?"Application_"+b:2===e?"["+b.toString()+"]":3===e?"Private_"+b:p[b]||"Universal_"+b.toString(),object:w}}var p={0:"EOC",1:"BOOLEAN",2:"INTEGER",3:"BIT STRING",4:"OCTET STRING",5:"NULL",6:"OBJECT IDENTIFIER",7:"ObjectDescriptor",8:"EXTERNAL",9:"REAL",10:"ENUMERATED",11:"EMBEDDED PDV",12:"UTF8String",16:"SEQUENCE",17:"SET",18:"NumericString",19:"PrintableString",20:"TeletexString",21:"VideotexString",22:"IA5String",23:"UTCTime",
24:"GeneralizedTime",25:"GraphicString",26:"VisibleString",27:"GeneralString",28:"UniversalString",30:"BMPString"};return{encode:function(m,g){return c(m,g).buffer},decode:function(c){return m(new Uint8Array(s(c)),0)}}}();A.prototype.BER=F;A.prototype.PEM={encode:function(c,m){return(m?"-----BEGIN "+m.toUpperCase()+"-----\r\n":"")+D.encode(c instanceof v?c:F.encode(c))+(m?"\r\n-----END "+m.toUpperCase()+"-----":"")},decode:function(c,m,p,q){var g=/([A-Za-z0-9\+\/\s\=]+)/g.exec(c);g[1].length!==c.length&&
(g=!1);!g&&m&&(g=(new RegExp("-----\\s?BEGIN "+m.toUpperCase()+"-----([A-Za-z0-9\\+\\/\\s\\=]+)-----\\s?END "+m.toUpperCase()+"-----","g")).exec(c));g||(g=/-----\s?BEGIN [A-Z0-9\s]+-----([A-Za-z0-9\+\/\s\=]+)-----\s?END [A-Z0-9\s]+-----/g.exec(c));c=g&&g[1+(q||0)];if(!c)throw new y("Not valid PEM format");c=D.decode(c);p&&(c=F.decode(c));return c}};B.coding=new A;return A});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(x,w){"function"===typeof define&&define.amd?define(["gostCrypto","gostCoding","gostSecurity"],w):"object"===typeof exports?module.exports=w(require("gostCrypto"),require("gostCoding"),require("gostSecurity")):x.GostASN1=w(x.gostCrypto,x.GostCoding,x.GostSecurity)})(this,function(x){function w(){for(var a={},c=0,H=arguments.length;c<H;c++){var b=arguments[c];if("object"===typeof b)for(var d in b)a[d]=b[d]}return a}function ta(a){a instanceof Q&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),
b=0,d=a.length;b<d;b++)c[d-b-1]=a[b];return c.buffer}function da(a){return a instanceof Q||a.buffer instanceof Q}function fc(a,c){return a.length>=c?a:Array(c-a.length+1).join("0")+a}function Fa(a){return 2>=a?a:4>=a?4:8>=a?8:16>=a?16:32>=a?32:64>=a?64:128>=a?128:256>=a?256:512>a?512:1024>a?1024:void 0}function M(a){if(a)throw Error("Invalid format");}function ea(a,c,b,d){"object"!==typeof b&&(b={value:b});void 0!==d&&(b.enumerable=d);Object.defineProperty(a,c,b)}function Ga(a,c,b){for(var d in c)ea(a,
d,c[d],b)}function R(a,c,b,d,e,f){M(void 0===c);c={tagNumber:b,tagClass:d||0,tagConstructed:e||!1,object:c};a=a||"DER";if("DER"===a||"CER"===a)c=S.encode(c,a);"PEM"===a&&(c=ua.encode(c,f));return c}function X(a,c,b,d,e){M(void 0===a);"string"===typeof a&&(a=ua.decode(a,e,!1));a instanceof Q&&(a=S.decode(a));b=b||0;d=d||!1;void 0===a.tagNumber&&(a=R(!0,a.object,c,b,a.object instanceof Array),16===c||17===c||4===c&&!a.tagConstructed||(a=S.decode(S.encode(a))));M(a.tagClass!==b||a.tagNumber!==c||a.tagConstructed!==
d);return 0===b&&5===c?null:a.object}function q(a,c,b,d){"function"!==typeof c&&(d=b,b=c,c=function(){a.apply(this,arguments)});c.prototype=Object.create(a.prototype,{constructor:{value:c},superclass:{value:a.prototype}});b&&Ga(c.prototype,b);if(a!==Object)for(var e in a)c[e]=a[e];c.super=a;d&&Ga(c,d,!0);return c}function Ha(){}var Q=this.ArrayBuffer,F=x.security.algorithms,db=x.security.names,eb=x.security.identifiers,Y=x.security.attributes,Z=x.security.parameters,S=x.coding.BER,ua=x.coding.PEM,
fb=x.coding.Hex,gb=x.coding.Int16,T={encode:function(a,c){return"0x"+fb.encode(a,c)},decode:function(a,c,b){"number"===typeof a&&(a=a.toString(16));a=a.replace("0x","");b=b||Fa(a.length);return fb.decode(fc(a,b),c)}},b=q(Object,function(a){this.object=a},{_set:function(a,c,b){a.property(c).set.call(this,b)},_get:function(a,c){return a.property(c).get.call(this)},_call:function(a,c,b){return a.method(c).apply(this,b)},hasProperty:function(a){return this.hasOwnProperty(a)||!!this.constructor.property(a)},
encode:function(){return this.object}},{decode:function(a){return new this(a)},property:function(a){for(var c=this.prototype;c;){var b=Object.getOwnPropertyDescriptor(c,a);if(b)return b;c=c.superclass}},method:function(a){for(var c=this.prototype;c;){if(c[a])return c[a];c=c.superclass}}}),C=function(a){return q(b,{encode:function(c){return R(c,this.object,a)}},{decode:function(c){return new this(X(c,a))}})},$=C(1),aa=C(22),va=C(19),gc=C(20),U=C(12),hc=C(23),G=C(24),ic=C(28),Ia=C(30),na=q(C(5),{object:{get:function(){return null},
set:function(a){M(null!==a)}}}),hb=function(a){function c(c){return q(C(a),function(a){b.super.call(this,a)},{encode:function(b){return R(b,c[this.object],a)}},{decode:function(b){b=X(b,a);for(var d in c)if(b===c[d])return new this(d);M(!0)}})}var b=q(C(a),function(a){if(this instanceof b)b.super.apply(this,arguments);else return c(a)});return b},h=hb(2),ib=hb(10),g=function(){function a(a){return a?q(a,{encode:function(c){return R(c,a.method("encode").call(this,!0),4)}},{decode:function(c){return a.decode.call(this,
X(c,4))}}):c}var c=q(C(4),function(b){if(this instanceof c)c.super.apply(this,arguments);else return a(b)});return c}(),n=function(){function a(a){return a?q(a,{encode:function(c){return R(c,a.method("encode").call(this,!0),3)}},{decode:function(c){return a.decode.call(this,X(c,3))}}):d}function c(a){return q(b,function(a,c){b.call(this,a);this.numbits=c||0},{encode:function(c){var b=this.object,d=[];if(b instanceof Array){for(var e=0,f=b.length;e<f;e++){var H=a[b[e]];void 0!==H&&(d[H]="1")}e=0;for(f=
Math.max(d.length,this.numbits);e<f;e++)d[e]||(d[e]="0");d=d.join("")}else d="0";return R(c,d,3)}},{decode:function(c){c=X(c,3);var b=[],d;for(d in a)"1"===c.charAt(a[d])&&b.push(d);return new this(b,c.length)}})}var d=q(C(3),function(b){if(this instanceof d)d.super.apply(this,arguments);else return"object"===typeof b?c(b):a(b)});return d}(),v=function(a){a.combine=function(c,b){for(var d in a.prototype)a.prototype.hasOwnProperty(d)&&!c.hasProperty(d)&&ea(c,d,function(a){return{get:function(){return this[b]&&
this[b][a]},set:function(c){this[b]||(this[b]={});this[b][a]=c},configurable:!1,enumerable:!0}}(d))};return a},f=function(a,c){var d=q(b,function(a,c){ea(this,"items",{writable:!0,value:{}});"string"===typeof a||a instanceof Q?this.decode(a):void 0!==a&&(this.object=a,c&&this.check())},{object:{get:function(){return this},set:function(c){if(c instanceof d){this.items=c.items;for(var b in a){var e=this.getItemClass(b,this.items);e.combine&&e.combine(this,b)}}else{var f={};for(b in a){var g=c[b],e=
this.getItemClass(b,f);void 0!==g?f[b]=new e(g):e.combine&&(f[b]=new e(c));e.combine&&e.combine(this,b)}this.items=f}}},getItemClass:function(c,b){return a[c]},encode:function(b){var d=[],e=this.items,f;for(f in a)if(e[f]){var H=e[f].encode(!0);void 0!==H&&d.push(H)}return R(b,d,16,0,!0,c)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(b){b=X(b,16,0,!0,c);var d=
0,e=new this,f=e.items={},H;for(H in a){var g=e.getItemClass(H,f),h=g.decode(b[d]);void 0!==h&&(f[H]=h,g.combine&&g.combine(e,H),d++)}return e}}),e;for(e in a)ea(d.prototype,e,function(c){return{get:function(){return this.items[c]&&this.items[c].object},set:function(a){if(void 0!==a){var b=this.getItemClass(c,this.items);this.items[c]=new b(a)}else delete this.items[c]},configurable:!1,enumerable:!a[c].combine}}(e)),a[e].combine&&a[e].combine(d.prototype,e);return d},I=function(a,c,d,e,g){return function(h,
l){c=c||"type";d=d||"value";l=l||e||b;var k=f(a,g),k=q(k,{getItemClass:function(e,f){var g=a[e];if(d===e){var ma,k=f&&f[c];k&&(k=k.object,h&&(ma="function"===typeof h?h(k):h[k]));ma=ma||l||b;g=g===b?ma:g(ma)}return g}});ea(k.prototype,c,{get:function(){return this.items[c]&&this.items[c].object},set:function(){M(!0)},configurable:!1,enumerable:!0});return k}},l=q(b,{encode:function(a){var c=this.object,c=/^(\d+\.)+\d+$/.test(c)?c:eb[c];M(!c);return R(a,c,6)}},{decode:function(a){a=X(a,6);return new this(db[a]||
a)}}),d=function(a,c){return q(c,function(){c.apply(this,arguments)},{encode:function(b){b=c.method("encode").call(this,b);if("string"===typeof b||b instanceof Q)return b;b=4===b.tagNumber||0!==b.tagClass||b.object instanceof Array?{object:b.object}:{object:S.decode(S.encode(b)).content};b.tagNumber=a;b.tagClass=2;b.tagConstructed=b.object instanceof Array;return b}},{decode:function(b){void 0!==b.tagNumber&&(M(2!==b.tagClass||b.tagNumber!==a),b={object:b.object});return c.decode.call(this,b)}})},
jb=function(a){return function(c,d){c=c||b;var e=function(f,g){var h="function"===typeof c&&void 0!==f?c(f,g):c;if(d){var k=q(b,function(a){if(this instanceof k)ea(this,"items",{writable:!0,value:{}}),b.call(this,a||{});else return e.apply(this,arguments)},{object:{get:function(){this.read();return this},set:function(a){if(a instanceof k)a.read(),this.items=a.items;else{var c={},b;for(b in a)c[b]=this.createItem(a[b],b);this.items=c}this.reset()}},createItem:function(a,c){if(d){var b={};b[d.typeName]=
c;b[d.valueName]=a}else b=a;return new h(b)},getItemValue:function(a){a=this.items[a];return d?a.object[d.valueName]:a.object},setItemValue:function(a,c){var b=this.items[a];d?b.object[d.valueName]=c:b.object=c},isItemType:function(a){return d?eb[a]:!isNaN(parseInt(a))},reset:function(){var a=this.items,c;for(c in this)this.hasOwnProperty(c)&&!this.items[c]&&this.isItemType(c)&&delete this[c];for(c in a)this[c]=this.getItemValue(c)},read:function(){var a=this.items,c;for(c in this)this.isItemType(c)&&
(this.items[c]?this.getItemValue(c)!==this[c]&&this.setItemValue(c,this[c]):(a[c]=this.createItem(this[c],c),this[c]=this.getItemValue(c)))},encode:function(c){this.read();var b=this.items,d=[],e;for(e in b){var f=b[e].encode(!0);void 0!==f&&d.push(f)}return R(c,d,a,0,!0)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(c){c=X(c,a,0,!0);for(var b=new this,e=b.items=
{},f=0,g=c.length;f<g;f++){var k=h.decode(c[f]);e[d?k.object[d.typeName]:f]=k}b.reset();return b}});return k}var l=q(b,function(a){if(this instanceof l)Ga(this,{items:{writable:!0,value:[]},values:{writable:!0,value:[]}}),b.call(this,a||[]);else return e.apply(this,arguments)},{object:{get:function(){this.read();return this.values},set:function(a){if(a instanceof l)a.read(),this.items=a.items;else{for(var c=[],b=0,d=a.length;b<d;b++)c[b]=new h(a[b]);this.items=c}this.reset()}},encode:function(c){this.read();
for(var b=this.items,d=[],e=0,f=b.length;e<f;e++){var g=b[e].encode(!0);void 0!==g&&d.push(g)}return R(c,d,a,0,!0)},reset:function(){for(var a=0,c=this.items.length;a<c;a++)this.values.push(this.items[a].object)},read:function(){for(var a=this.items,c=this.values,b=0,d=c.length;b<d;b++)this.items[b]?a[b].object!==c[b]&&(a[b].object=c[b]):(a[b]=new h(c[b]),c[b]=a[b].object)}},{decode:function(c){c=X(c,a,0,!0);var b=new this;b.items=[];for(var d=0,e=c.length;d<e;d++)b.items.push(h.decode(c[d]));b.reset();
return b}});return l};return e()}},k=jb(16),y=jb(17),N=function(a,c){if(c){var d=q(b,{encode:function(b){return(new a(c.encode(this.object))).encode(b)}},{decode:function(b){return new this(c.decode(a.decode(b).object))}}),e;for(e in a)d[e]||(d[e]=a[e]);return d}return a},z=function(a){return N(y(a),{encode:function(a){return[a]},decode:function(a){return a[0]}})},r=function(a,c){return q(b,{object:{get:function(){return this.item&&this.item.object},set:function(d){if(d instanceof b)for(var e in a)if(d instanceof
a[e]){this.item=d;return}e="function"===typeof c?c(d):c;M(!e||!a[e]);this.item=d=new a[e](d)}},encode:function(a){return this.item.encode(a)}},{decode:function(c){for(var b in a)try{var d=a[b].decode(c);if(void 0!==d)return new this(d)}catch(e){}M(!0)}})},O=function(a){a=a||b;return q(a,{encode:function(){return S.encode(a.method("encode").call(this,!0))}},{encode:function(a,b){return(new this(a)).encode(b)},decode:function(c){return a.decode.call(this,S.decode(c))}})},ga=function(a){return a||b},
u=function(a){a=a||b;return q(a,{encode:function(c){c=a.method("encode").call(this,c);return"string"===typeof c||c instanceof Q?c:{object:[c]}}},{decode:function(c){return"string"===typeof c||c instanceof Q?("string"===typeof c&&(c=ua.decode(c,void 0,!1)),c instanceof Q&&(c=S.decode(c)),a.decode.call(this,c)):a.decode.call(this,c.object[0])}})},V=function(a,c){a=a||b;return q(a,{encode:function(b){return this.object===c?void 0:a.method("encode").call(this,b)}},{decode:function(b){if(void 0===b)return new this(c);
try{return a.decode.call(this,b)}catch(d){}}})},e=function(a){a=a||b;return q(a,{},{decode:function(c){if(void 0!==c)try{return a.decode.call(this,c)}catch(b){}}})},fa=r({teletexString:gc,printableString:va,universalString:ic,utf8String:U,bmpString:Ia},function(a){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?"printableString":"utf8String"}),ba=r({utcTime:hc,generalTime:G},function(a){return 2050<=a.getYear()?"generalTime":"utcTime"}),Ja=I({type:l,value:b}),Ka=
{typeName:"type",valueName:"value"},kb=z(Ja({serialName:va,countryName:va,dnQualifier:va,emailAddress:aa,domainComponent:aa},fa)),jc=k(kb,Ka)(),W=r({rdnSequence:jc},"rdnSequence"),kc=v(f({notBefore:ba,notAfter:ba})),lb=I({type:l,value:b}),D=y(lb,Ka),La=k(lb,Ka),lc=f({a:h,b:h,seed:e(n)}),mc=g(q(b,{encode:function(){var a=this.object,c=Math.max(Fa(a.x.length-2),Fa(a.y.length-2))/2,b=new Uint8Array(2*c+1);b[0]=4;b.set(new Uint8Array(T.decode(a.x,!1,c)),1);b.set(new Uint8Array(T.decode(a.y,!1,c)),c+1);
return b.buffer}},{decode:function(a){var c=(a.byteLength-1)/2;return new this({x:T.encode(new Uint8Array(a,1,c)),y:T.encode(new Uint8Array(a,c+1,c))})}})),nc=f({fieldType:l,parameters:h}),oc=f({version:h,fieldID:nc,curve:lc,base:mc,order:h,cofactor:e(h)}),pc=f({publicKeyParamSet:l,digestParamSet:l,encryptionParamSet:e(l)}),qc=function(a,c){a=a||b;return q(a,{encode:function(b){return this.object===c?(new na(null)).encode(b):a.method("encode").call(this,b)}},{decode:function(b){if(void 0!==b){if(null===
b||5===b.tagNumber&&0===b.tagClass)return new this(c);try{return a.decode.call(this,b)}catch(d){}}}})}(l,"id-GostR3411-94-CryptoProParamSet"),rc=r({namedParameters:l,ecParameters:oc,implicitly:e(na)},function(a){return"string"===typeof a||a instanceof String?"namedParameters":"ecParameters"}),E=function(a,c){return N(f({algorithm:l,parameters:e(a)}),c)},p=function(){var a=E(b),c=q(b,function(a){if(this instanceof c)c.super.apply(this,arguments);else return d(a)},{encode:function(c){return(new a(this.object)).encode(c)}},
{decode:function(c){return new this(a.decode(c).object)}}),d=function(a){return q(b,{encode:function(c){var b=this.object,d=a[b.id];if(d)return(new d(b)).encode(c);throw Error("Algorithm not supported");}},{decode:function(c){"string"===typeof c&&(c=ua.decode(c,void 0,!1));c instanceof Q&&(c=S.decode(c));var b=a[db[c.object[0].object]];if(b)return new this(b.decode(c).object);throw Error("Algorithm not supported");}})};return c}(),wa=E(rc,{encode:function(a){return{algorithm:a.id,parameters:"string"===
typeof a.namedCurve?Y.namedCurve[a.namedCurve]:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.curve.p},curve:{a:a.curve.a,b:a.curve.b},base:{x:a.curve.x,y:a.curve.y},order:a.curve.q,cofactor:1}}},decode:function(a){var c=a.parameters;a=F[a.algorithm];if("string"===typeof c||c instanceof String)a=w(a,Z[c]);else if("object"===typeof c)a=w(a,{curve:{p:c.fieldID.parameters,a:c.curve.a,b:c.curve.b,x:c.base.x,y:c.base.y,q:c.order}});else throw new DataError("Invalid key paramters");return a}}),
J=E(pc,{encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:Y[c][a[c]],digestParamSet:Y.sBox[b],encryptionParamSet:a.encParams&&a.encParams.sBox?Y.sBox[a.encParams.sBox]:void 0}}},decode:function(a){var c=a.parameters;a=w(F[a.algorithm],Z[c.publicKeyParamSet],Z[c.digestParamSet]);
c.encryptionParamSet&&(a.encParams=Z[c.encryptionParamSet]);return a}}),s=E(b,{encode:function(a){return{algorithm:a.id}},decode:function(a){return F[a.algorithm]}}),t=E(na,{encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return F[a.algorithm]}}),mb=E(qc,{encode:function(a){return{algorithm:a.id,parameters:Y.sBox[a.sBox||"D-A"]}},decode:function(a){return w(F[a.algorithm],Z[a.parameters])}}),ca=p({ecdsa:wa,noSignature:t,rsaEncryption:t,"id-sc-gostR3410-2001":wa,"id-GostR3410-2001":J,
"id-GostR3410-94":J,"id-GostR3410-2001DH":J,"id-GostR3410-94DH":J,"id-tc26-gost3410-12-256":J,"id-tc26-gost3410-12-512":J,"id-tc26-agreement-gost-3410-12-256":J,"id-tc26-agreement-gost-3410-12-512":J,"id-sc-gost28147-gfb":s,"id-Gost28147-89":s}),P=p({noSignature:t,rsaEncryption:t,sha1withRSAEncryption:t,sha256withRSAEncryption:t,sha384withRSAEncryption:t,sha512withRSAEncryption:t,ecdsa:s,"ecdsa-with-SHA1":s,"ecdsa-with-SHA256":s,"ecdsa-with-SHA384":s,"ecdsa-with-SHA512":s,"id-GostR3410-94":t,"id-GostR3410-2001":t,
"id-GostR3411-94-with-GostR3410-2001":s,"id-GostR3411-94-with-GostR3410-94":s,"id-tc26-gost3410-12-256":t,"id-tc26-gost3410-12-512":t,"id-tc26-signwithdigest-gost3410-12-94":s,"id-tc26-signwithdigest-gost3410-12-256":s,"id-tc26-signwithdigest-gost3410-12-512":s,"id-sc-gostR3410-94":t,"id-sc-gostR3410-2001":t,"id-sc-gostR3411-94-with-gostR3410-94":t,"id-sc-gostR3411-94-with-gostR3410-2001":t}),ha=p({sha1:t,sha256:t,sha384:t,sha512:t,"id-GostR3411-94":mb,"id-tc26-gost3411-94":mb,"id-tc26-gost3411-12-256":t,
"id-tc26-gost3411-12-512":t,"id-sc-gostR3411-94":s}),nb=f({iv:g,encryptionParamSet:l}),sc=f({encryptionParamSet:l,ukm:e(g)}),Ma=E(nb,{encode:function(a){return{algorithm:a.id,parameters:{iv:a.iv,encryptionParamSet:Y.sBox[a.sBox||"E-A"]}}},decode:function(a){var c=w(F[a.algorithm],Z[a.parameters.encryptionParamSet]);c.iv=a.parameters.iv;return c}}),Na=E(g,{encode:function(a){return{algorithm:a.id,parameters:a.iv}},decode:function(a){var c=w(F[a.algorithm]);c.iv=a.parameters||new Uint8Array([0,0,0,
0,0,0,0,0]);return c}}),xa=E(sc,{encode:function(a){return{algorithm:a.id,parameters:{encryptionParamSet:Y.sBox[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=w(F[a.algorithm],Z[a.parameters.encryptionParamSet]);a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}}),ob=p({"id-Gost28147-89-None-KeyWrap":xa,"id-Gost28147-89-CryptoPro-KeyWrap":xa}),ya=E(ob,{encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=w(F[a.algorithm]);c.wrapping=a.parameters;return c}}),
oa=p({ecdsa:wa,rsaEncryption:t,"id-sc-gost28147-gfb":Na,"id-Gost28147-89":Ma,"id-sc-gostR3410-2001":wa,"id-GostR3410-2001":J,"id-GostR3410-94":J,"id-tc26-gost3410-12-256":J,"id-tc26-gost3410-12-512":J,"id-GostR3410-94-CryptoPro-ESDH":ya,"id-GostR3410-2001-CryptoPro-ESDH":ya,"id-tc26-agreement-gost-3410-12-256":ya,"id-tc26-agreement-gost-3410-12-512":ya,"id-sc-r3410-ESDH-r3411kdf":t,"id-Gost28147-89-None-KeyWrap":xa,"id-Gost28147-89-CryptoPro-KeyWrap":xa,"id-sc-cmsGostWrap":s,"id-sc-cmsGost28147Wrap":s,
"pbeWithSHAAndAES128-CBC":m,"pbeWithSHAAndAES192-CBC":m,"pbeWithSHAAndAES256-CBC":m,"pbeWithSHA256AndAES128-CBC":m,"pbeWithSHA256AndAES192-CBC":m,"pbeWithSHA256AndAES256-CBC":m,"id-sc-pbeWithGost3411AndGost28147":m,"id-sc-pbeWithGost3411AndGost28147CFB":m,"pbeWithSHAAnd3-KeyTripleDES-CBC":m,"pbeWithSHAAnd2-KeyTripleDES-CBC":m,"pbeWithSHAAnd128BitRC2-CBC":m,"pbewithSHAAnd40BitRC2-CBC":m,pbeUnknownGost:m,PBES2:Oa}),tc=p({"id-sc-gost28147-gfb":Na,"id-Gost28147-89":Ma}),Pa=p({"id-Gost28147-89-MAC":nb,
"id-HMACGostR3411-94":s,"id-tc26-hmac-gost-3411-12-256":s,"id-tc26-hmac-gost-3411-12-512":s,hmacWithSHA1:s,hmacWithSHA224:s,hmacWithSHA256:s,hmacWithSHA384:s,hmacWithSHA512:s,"id-sc-gost28147-mac":s,"id-sc-hmacWithGostR3411":s}),uc=f({salt:r({specified:g,otherSource:p},function(a){return da(a)?"specified":"otherSource"}),iterationCount:h,keyLength:e(h),prf:Pa}),vc=E(uc,{encode:function(a){return{algorithm:a.id,parameters:{salt:a.salt,iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=
w(F[a.algorithm]);c.salt=a.parameters.salt;c.iterations=a.parameters.iterationCount;c.hmac=a.parameters.prf;c.hash=c.hmac.hash;return c}}),Qa=p({PBKDF2:vc}),pb=f({salt:g,iterationCount:h}),m=E(pb,{paramType:pb,encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=w(F[a.algorithm]);c.derivation=w(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}}),wc=f({keyDerivationFunc:Qa,
encryptionScheme:tc}),Oa=E(wc,{encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,encryptionScheme:a.encryption}}},decode:function(a){var c=w(F[a.algorithm]);c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}});p({"pbeWithSHAAndAES128-CBC":m,"pbeWithSHAAndAES192-CBC":m,"pbeWithSHAAndAES256-CBC":m,"pbeWithSHA256AndAES128-CBC":m,"pbeWithSHA256AndAES192-CBC":m,"pbeWithSHA256AndAES256-CBC":m,"id-sc-pbeWithGost3411AndGost28147":m,
"id-sc-pbeWithGost3411AndGost28147CFB":m,"pbeWithSHAAnd3-KeyTripleDES-CBC":m,"pbeWithSHAAnd2-KeyTripleDES-CBC":m,"pbeWithSHAAnd128BitRC2-CBC":m,"pbewithSHAAnd40BitRC2-CBC":m,pbeUnknownGost:m,PBES2:Oa});var xc=f({keyDerivationFunc:Qa,messageAuthScheme:Pa}),yc=E(xc,{encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,messageAuthScheme:a.hmac}}},decode:function(a){var c=w(F[a.algorithm]);c.derivation=a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;
return c}});p({PBMAC1:yc});var zc=p({"id-sc-gost28147-gfb":Na,"id-Gost28147-89":Ma,"pbeWithSHAAndAES128-CBC":m,"pbeWithSHAAndAES192-CBC":m,"pbeWithSHAAndAES256-CBC":m,"pbeWithSHA256AndAES128-CBC":m,"pbeWithSHA256AndAES192-CBC":m,"pbeWithSHA256AndAES256-CBC":m,"id-sc-pbeWithGost3411AndGost28147":m,"id-sc-pbeWithGost3411AndGost28147CFB":m,"pbeWithSHAAnd3-KeyTripleDES-CBC":m,"pbeWithSHAAnd2-KeyTripleDES-CBC":m,"pbeWithSHAAnd128BitRC2-CBC":m,"pbewithSHAAnd40BitRC2-CBC":m,pbeUnknownGost:m,PBES2:Oa}),qb=
N(n(O(h)),{encode:function(a){return gb.encode(ta(a))},decode:function(a){return ta(gb.decode(a))}}),rb=N(n(O(g)),{encode:function(a){var c=new Uint8Array(a.byteLength+1),b=ta(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){M(0===(a.byteLength&1));var c=new Uint8Array(a.byteLength-1),b=c.byteLength/2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,1,b),b);return ta(c)}}),K=n(O(g)),ia=f({algorithm:ca,subjectPublicKey:n},
"PUBLIC KEY"),Ra=function(a){return q(N(I({algorithm:ca,subjectPublicKey:b},"algorithm","subjectPublicKey")(function(c){return a[c.id]}),{encode:function(a){return{algorithm:a.algorithm,subjectPublicKey:a.buffer}},decode:function(a){return{algorithm:a.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a.subjectPublicKey}}}),{object:{get:function(){return this},set:function(a){for(var b in a)this[b]=a[b]}}})}({"id-sc-gostR3410-2001":rb,"id-sc-gostR3410-94":qb,
"id-GostR3410-2001":K,"id-GostR3410-94":K,"id-tc26-gost3410-12-256":K,"id-tc26-gost3410-12-512":K}),sb=N(g(O(h)),{encode:function(a){return T.encode(a,!0)},decode:function(a){return T.decode(a,!0)}}),Ac=function(a){return I({version:h,privateKeyAlgorithm:ca,privateKeyWrapped:N(g(O(f({keyData:h,keyMac:h}))),{encode:function(a){var b=a.byteLength-4;return{keyData:T.encode(new Uint8Array(a,0,b)),keyMac:T.encode(new Uint8Array(a,b,4))}},decode:function(a){var b=T.decode(a.keyData);a=T.decode(a.keyMac);
var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b));d.set(new Uint8Array(a),b.byteLength);return d}}),attributes:b},"privateKeyAlgorithm","attributes")(function(b){return e(d(0,ga(D({"id-sc-gostR3410-2001-publicKey":z(a[b.id])}))))})}({"id-sc-gostR3410-2001":rb,"id-sc-gostR3410-94":qb,"id-GostR3410-2001":K,"id-GostR3410-94":K,"id-GostR3410-2001DH":K,"id-GostR3410-94DH":K,"id-tc26-gost3410-12-256":K,"id-tc26-gost3410-12-512":K,"id-tc26-agreement-gost-3410-12-256":K,"id-tc26-agreement-gost-3410-12-512":K}),
Sa=f({version:h,privateKeyAlgorithm:ca,privateKey:g,attributes:e(d(0,D||b))},"PRIVATE KEY"),Bc=f({version:h,privateKeyAlgorithm:ca,privateKey:g,attributes:e(d(0,D||b)),publicKey:e(d(1,n||b))}),Cc=k(Bc),Dc=function(a){return q(N(I({version:h,privateKeyAlgorithm:ca,privateKey:b,attributes:e(d(0,D||b))},"privateKeyAlgorithm","privateKey")(function(b){return a[b.id]}),{encode:function(a){return{version:0,privateKeyAlgorithm:a.algorithm,privateKey:a.buffer}},decode:function(a){return{algorithm:a.privateKeyAlgorithm,
type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:a.privateKey}}}),{object:{get:function(){return this},set:function(a){for(var b in a)this[b]=a[b]}}})}({"id-sc-gostR3410-2001":sb,"id-sc-gostR3410-94":sb,"id-GostR3410-2001":g,"id-GostR3410-94":g,"id-GostR3410-2001DH":g,"id-GostR3410-94DH":g,"id-tc26-gost3410-12-256":g,"id-tc26-gost3410-12-512":g,"id-tc26-agreement-gost-3410-12-256":g,"id-tc26-agreement-gost-3410-12-512":g}),tb=f({encryptionAlgorithm:oa,encryptedData:g},
"ENCRYPTED PRIVATE KEY"),Ec=f({cA:V($,!1),pathLenConstraint:e(h)}),Fc=n({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Gc=k(l),Hc=f({type:l,value:d(0,u(b))}),Ic=f({nameAssigner:e(d(0,fa||b)),partyName:e(d(1,fa||b))}),Jc=f({}),A=r({otherName:d(0,Hc||b),rfc822Name:d(1,fa||b),dNSName:d(2,fa||b),x400Address:d(3,Jc||b),directoryName:d(4,u(W)),ediPartyName:d(5,Ic||b),uniformResourceIdentifier:d(6,fa||b),iPAddress:d(7,
g||b),registeredID:d(8,l||b)},function(a){return"string"===typeof a||a instanceof String?0<=a.indexOf("@")?"rfc822Name":"dNSName":da(a)?"iPAddress":"directoryName"}),B=k(A),Ta=f({keyIdentifier:e(d(0,g||b)),authorityCertIssuer:e(d(1,B||b)),authorityCertSerialNumber:e(d(2,h||b))}),Kc=f({notBefore:e(d(0,G||b)),notAfter:e(d(1,G||b))}),Lc=f({policyQualifierId:l,qualifier:b}),Mc=f({policyIdentifier:l,policyQualifiers:e(k(Lc))}),Nc=f({issuerDomainPolicy:l,subjectDomainPolicy:l}),Oc=f({base:A,minimum:V(d(0,
h||b),0),maximum:e(d(1,h||b))}),ub=k(Oc),Pc=f({permittedSubtrees:e(d(0,ub||b)),excludedSubtrees:e(d(1,ub||b))}),Qc=f({requireExplicitPolicy:e(d(0,h||b)),inhibitPolicyMapping:e(d(1,h||b))}),Ua=n({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),vb=r({fullName:d(0,B||b),nameRelativeToCRLIssuer:d(1,kb||b)},function(a){return a instanceof Array?"fullName":"nameRelativeToCRLIssuer"}),Rc=f({distributionPoint:e(d(0,
u(vb))),reasons:e(d(1,Ua||b)),cRLIssuer:e(d(2,B||b))}),za=k(Rc),Va=f({accessMethod:l,accessLocation:A}),wb=function(a,b){var d=I({extnID:l,critical:V($,!1),extnValue:function(a){return g(O(a))}},"extnID","extnValue"),e=q(d(a),{object:{get:function(){var a=this._get(e.super,"object");a&&"object"===typeof a.extnValue&&this.defineValue(a.extnValue);return a},set:function(a){this._set(e.super,"object",a);a&&a.extnValue&&(void 0!==a.extnValue.critical?this.critical=a.extnValue.critical:void 0===this.critical&&
b&&(this.critical=b(this.extnID,a.extnValue)))}},extnValue:{get:function(){var a=this._get(e.super,"extnValue");"object"===typeof a&&this.defineValue(a);return a},set:function(a){this._set(e.super,"extnValue",a);a&&(void 0!==a.critical?this.critical=a.critical:void 0===this.critical&&b&&(this.critical=b(this.extnID,a)))}},defineValue:function(a){if("object"===typeof a&&!Object.getOwnPropertyDescriptor(a,"critical")){var b=this;ea(a,"critical",{get:function(){return b.critical},set:function(a){b.critical=
a},enumerable:!0,configurable:!1})}}});return e},ja=k(wb,{typeName:"extnID",valueName:"extnValue"}),Aa=ja({authorityKeyIdentifier:Ta,subjectKeyIdentifier:g,keyUsage:Fc,privateKeyUsagePeriod:Kc,certificatePolicies:k(Mc),policyMappings:k(Nc),subjectAltName:B,issuerAltName:B,subjectDirectoryAttributes:La,basicConstraints:Ec,nameConstraints:Pc,policyConstraints:Qc,extKeyUsage:Gc,cRLDistributionPoints:za,inhibitAnyPolicy:h,freshestCRL:za,authorityInfoAccess:k(Va),subjectInfoAccess:k(Va)},function(a,b){return"keyUsage"===
a||"basicConstraints"===a&&void 0===b.pathLenConstraint}),Sc=f({r:h,s:h}),xb=v(f({version:d(0,u(h)),serialNumber:h,signature:P,issuer:W,validity:kc,subject:W,subjectPublicKeyInfo:ia,issuerUniqueID:e(d(1,n||b)),subjectUniqueID:e(d(2,n||b)),extensions:e(d(3,u(Aa)))})),ka=f({tbsCertificate:xb,signatureAlgorithm:P,signatureValue:n},"CERTIFICATE"),Tc=D({challengePassword:z(fa),extensionRequest:z(Aa),msCertExtensions:z(Aa),extendedCertificateAttributes:z(D)}),yb=v(f({version:h,subject:W,subjectPublicKeyInfo:ia,
attributes:d(0,Tc||b)})),zb=f({requestInfo:yb,signatureAlgorithm:P,signatureValue:n},"CERTIFICATE REQUEST"),Ab=ib({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),Uc=f({distributionPoint:e(d(0,u(vb))),onlyContainsUserCerts:V(d(1,$||b),!1),onlyContainsCACerts:V(d(2,$||b),!1),onlySomeReasons:e(d(3,Ua||b)),indirectCRL:V(d(4,$||b),!1),onlyContainsAttributeCerts:V(d(5,$||b),!1)}),
Vc=ja({authorityKeyIdentifier:Ta,issuerAltName:B,cRLNumber:h,deltaCRLIndicator:h,issuingDistributionPoint:Uc,freshestCRL:za},function(a){return"cRLNumber"===a}),Wc=ja({cRLReason:Ab,instructionCode:l,invalidityDate:G,certificateIssuer:B}),Bb=v(f({version:e(h),signature:P,issuer:W,thisUpdate:ba,nextUpdate:e(ba),revokedCertificates:e(k(f({userCertificate:h,revocationDate:ba,crlEntryExtensions:e(Wc)}))),crlExtensions:e(d(0,u(Vc)))})),Wa=f({tbsCertList:Bb,signatureAlgorithm:P,signatureValue:n},"CRL"),
Xa=f({digestedObjectType:ib({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:e(l),digestAlgorithm:ha,objectDigest:n}),Ba=f({issuer:B,serial:h,issuerUID:e(n)}),Xc=f({issuerName:e(B),baseCertificateID:e(d(0,Ba||b)),objectDigestInfo:e(d(1,Xa||b))}),Yc=f({targetCertificate:Ba,targetName:e(A),certDigestInfo:e(Xa)}),Zc=r({targetName:d(0,u(A)),targetGroup:d(1,u(A)),targetCert:d(2,Yc||b)}),$c=k(Zc),ad=ja({auditIdentity:g,targetInformation:$c,authorityKeyIdentifier:Ta,authorityInfoAccess:k(Va),
cRLDistributionPoints:za,noRevAvail:na},function(a){return"auditIdentity"===a||"targetInformation"===a}),bd=f({baseCertificateID:e(d(0,Ba||b)),entityName:e(d(1,B||b)),objectDigestInfo:e(d(2,Xa||b))}),cd=r({v1Form:B,v2Form:d(0,Xc||b)},"v2Form"),Cb=f({notBeforeTime:G,notAfterTime:G}),Db=f({service:A,ident:A,authInfo:e(g)}),dd=f({roleAuthority:e(d(0,B||b)),roleName:d(1,u(A))}),ed=n({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),fd=f({type:d(0,l||b),value:d(1,b||b)}),gd=
f({policyId:d(0,l||b),classList:V(d(1,ed||b),["unclassified"]),securityCategories:e(d(2,ga(y(fd))))}),Eb=f({policyAuthority:e(d(0,B||b)),values:k(r({octets:g,oid:l,string:U},function(a){return da?"octets":getIdentifier(a)?"oid":"string"}))}),Fb=v(f({version:h,holder:bd,issuer:cd,signature:P,serialNumber:h,attrCertValidityPeriod:Cb,attributes:La({authenticationInfo:y(Db),accessIdentity:y(Db),chargingIdentity:z(Eb),group:z(Eb),role:y(dd),clearance:y(gd)}),issuerUniqueID:e(n),extensions:e(ad)})),Gb=
f({acinfo:Fb,signatureAlgorithm:P,signatureValue:n},"ATTRIBUTE CERTIFICATE"),la=g,pa=g;f({keyInfo:ob,entityUInfo:e(d(0,u(g))),suppPubInfo:d(2,u(g))});var L=N(f({encryptedKey:g,maskKey:e(d(0,g||b)),macKey:g}),{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey,d=a.maskKey;a=a.macKey;if(d)for(var d=new Int32Array(d),e=new Int32Array(b),f=0,g=d.length/e.length;f<
g;f++)for(var h=0,k=e.length;h<k;h++)e[h]=e[h]+d[k*f+h]&4294967295;d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),32);return d.buffer}}),hd=f({encryptionParamSet:l,ephemeralPublicKey:e(d(0,Ra||b)),ukm:g}),Ca=N(f({sessionEncryptedKey:L,transportParameters:e(d(0,hd||b))}),{encode:function(a){var b=a.algorithm;return{sessionEncryptedKey:a.sessionEncryptedKey,transportParameters:{encryptionParamSet:Y.sBox[b.wrapping.sBox||"E-A"],ephemeralPublicKey:b["public"],
ukm:b.ukm}}},decode:function(a){return{algorithm:{wrapping:Z[a.transportParameters.encryptionParamSet],ukm:a.transportParameters.ukm,"public":a.transportParameters.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),Hb=N(f({sessionEncryptedKey:L,ukm:f({ephemeralPublicKey:Ra,addedukm:e(d(0,u(g)))})}),{encode:function(a){var b=a.algorithm;return{sessionEncryptedKey:a.sessionEncryptedKey,ukm:{ephemeralPublicKey:b["public"],addedukm:b.ukm}}},decode:function(a){return{algorithm:{ukm:a.ukm.addedukm,
"public":a.ukm.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),id=function(a){return function(c){return(c=a[c.id])?O(c):b}}({"id-sc-gostR3410-2001":Hb,"id-sc-gostR3410-94":Hb,"id-GostR3410-2001":Ca,"id-GostR3410-94":Ca,"id-tc26-gost3410-12-256":Ca,"id-tc26-gost3410-12-512":Ca,"id-GostR3410-94-CryptoPro-ESDH":L,"id-GostR3410-2001-CryptoPro-ESDH":L,"id-tc26-agreement-gost-3410-12-256":L,"id-tc26-agreement-gost-3410-12-512":L,"id-sc-r3410-ESDH-r3411kdf":L,"id-Gost28147-89-None-KeyWrap":L,
"id-Gost28147-89-CryptoPro-KeyWrap":L,"id-sc-cmsGostWrap":L,"id-sc-cmsGost28147Wrap":L}),jd=n({kccaSoftPassword:0,kccaReservePrimary:1,kccaPrimaryKeyAbsent:2,kccaFKCShared:3}),kd=n({pkaExportable:0,pkaUserProtect:1,pkaExchange:2,pkaEphemeral:3,pkaNonCachable:4,pkaDhAllowed:5}),Ib=f({attributes:e(kd),privateKeyAlgorithm:e(d(0,ca||b))}),Jb=f({path:aa,hmac:g}),ld=f({containerAlgoritmIdentifier:e(d(0,p||b)),containerName:e(aa),attributes:jd,primaryPrivateKeyParameters:Ib,hmacPassword:e(d(2,g||b)),secondaryEncryptedPrivateKey:e(d(3,
L||b)),secondaryPrivateKeyParameters:e(d(4,Ib||b)),primaryCertificate:e(d(5,ga(g(O(ka))))),secondaryCertificate:e(d(6,ga(g(O(ka))))),encryptionContainerName:e(d(7,aa||b)),primaryCertificateLink:e(d(8,Jb||b)),secondaryCertificateLink:e(d(9,Jb||b)),primaryFP:e(d(10,g||b)),secondaryFP:e(d(11,g||b)),passwordPolicy:e(p),containerSecurityLevel:e(h),extensions:e(d(12,ga(ja({keyValidity:f({notBefore:e(d(0,G||b)),notAfter:e(d(1,G||b))})})))),secondaryEncryptionContainerName:e(d(13,aa||b))}),md=f({keyContainerContent:ld,
hmacKeyContainerContent:g}),nd=f({containerName:aa,extElem1:e(b)}),od=f({primaryKey:g,secondaryKey:e(g),hmacKey:e(g)}),pd=f({mask:g,randomStatus:g,hmacRandom:g}),qa=l,pa=g,Ya=k(h),qd=f({bodyPartPath:Ya,identifier:l,content:b}),Da=D({contentType:z(qa),messageDigest:z(g),signingTime:z(ba)}),Kb=D(function(a){return{countersignature:y(rd),unsignedData:y(qd)}[a]}),ra=f({issuer:W,serialNumber:h}),sd=r({issuerAndSerialNumber:ra,subjectKeyIdentifier:d(0,pa||b)},function(a){return da(a)?"subjectKeyIdentifier":
"issuerAndSerialNumber"}),Lb=f({version:h,sid:sd,digestAlgorithm:ha,signedAttrs:e(d(0,Da||b)),signatureAlgorithm:P,signatureValue:g,unsignedAttrs:e(d(1,Kb||b))}),rd=Lb,td=y(Lb),ud=y(ha),vd=v(f({version:h,certificate:ka,attributes:D})),wd=f({extendedCertificateInfo:vd,signatureAlgorithm:P,signatureValue:n}),xd=f({otherCertFormat:l,otherCert:b}),yd=v(f({version:h,subject:r({baseCertificateID:d(0,Ba||b),subjectName:d(1,B||b)},function(a){return a.issuer?"baseCertificateID":"subjectName"}),issuer:B,signature:P,
serialNumber:h,attCertValidityPeriod:Cb,attributes:La,issuerUniqueID:e(n),extensions:e(Aa)})),zd=f({acInfo:yd,signatureAlgorithm:P,signatureValue:n}),Za=f({eContentType:qa,eContent:e(d(0,u(g)))}),Ad=r({certificate:ka,extendedCertificate:d(0,wd||b),v1AttrCert:d(1,zd||b),v2AttrCert:d(2,Gb||b),other:d(3,xd||b)},function(a){return a.holder?"AttributeCertificateV2":a.certificate?"ExtendedCertificate":a.otherCertFormat?"other":"certificate"}),Bd=f({otherRevInfoFormat:l,otherRevInfo:b}),Cd=r({crl:Wa,other:d(1,
Bd||b)},function(a){return a.otherRevInfoFormat?"other":"crl"}),Mb=y(Ad),Nb=y(Cd),Dd=f({version:h,digestAlgorithms:ud,encapContentInfo:Za,certificates:e(d(0,Mb||b)),crls:e(d(1,Nb||b)),signerInfos:td}),Ed=r({issuerAndSerialNumber:ra,subjectKeyIdentifier:d(0,pa||b)},function(a){return da(a)?"subjectKeyIdentifier":"issuerAndSerialNumber"}),Fd=f({version:h,rid:Ed,keyEncryptionAlgorithm:oa,encryptedKey:la}),Ob=f({keyAttrId:l,keyAttr:e(b)}),Gd=f({subjectKeyIdentifier:pa,date:e(G),other:e(Ob)}),Hd=r({issuerAndSerialNumber:ra,
rKeyId:d(0,Gd||b)},function(a){return da(a)?"rKeyId":"issuerAndSerialNumber"}),Id=f({rid:Hd,encryptedKey:la}),Jd=k(Id),Pb=f({algorithm:ca,publicKey:n});f({ephemeralPublicKey:Pb,addedukm:e(d(0,u(g)))});var Kd=r({issuerAndSerialNumber:ra,subjectKeyIdentifier:d(0,pa||b),originatorKey:d(1,Pb||b)},function(a){return da(a)?"subjectKeyIdentifier":a.algorithm?"originatorKey":"issuerAndSerialNumber"}),Ld=f({version:h,originator:d(0,u(Kd)),ukm:e(d(1,u(g))),keyEncryptionAlgorithm:oa,recipientEncryptedKeys:Jd}),
Md=f({keyIdentifier:g,date:e(G),other:e(Ob)}),Nd=f({version:h,kekid:Md,keyEncryptionAlgorithm:oa,encryptedKey:la}),Od=f({version:h,friendlyName:e(d(0,Qa||b)),keyEncryptionAlgorithm:oa,encryptedKey:la}),Pd=f({oriType:l,oriValue:b}),Qd=r({ktri:Fd,kari:d(1,Ld||b),kekri:d(2,Nd||b),pwri:d(3,Od||b),ori:d(4,Pd||b)},function(a){return a.rid?"ktri":a.originator?"kari":a.kekid?"kekri":a.oriType?"ori":"pwri"}),$a=f({certs:e(d(0,Mb||b)),crls:e(d(1,Nb||b))}),ab=y(Qd),bb=f({contentType:qa,contentEncryptionAlgorithm:zc,
encryptedContent:e(d(0,g||b))}),Ea=f({version:h,originatorInfo:e(d(0,$a||b)),recipientInfos:ab,encryptedContentInfo:bb,unprotectedAttrs:e(d(1,D||b))}),Rd=f({version:h,digestAlgorithm:ha,encapContentInfo:Za,digest:g}),Qb=f({version:h,encryptedContentInfo:bb,unprotectedAttrs:e(d(1,D||b))}),Sd=f({version:h,originatorInfo:e(d(0,$a||b)),recipientInfos:ab,macAlgorithm:Pa,digestAlgorithm:e(d(1,ha)),encapContentInfo:Za,authAttrs:e(d(2,Da||b)),mac:g,unauthAttrs:e(d(3,D||b))}),Td=f({version:h,originatorInfo:e(d(0,
$a||b)),recipientInfos:ab,authEncryptedContentInfo:bb,authAttrs:e(d(1,Da||b)),mac:g,unauthAttrs:e(d(2,D||b))}),Ud=r({encrypted:Qb,enveloped:d(0,Ea||b),authEnveloped:d(1,Td||b)},function(a){return a.encryptedContentInfo?a.recipientInfos?"enveloped":"encrypted":"authEnveloped"}),qa=l,sa=I({contentType:qa,content:function(a){return d(0,u(a))}},"contentType","content",void 0,"CMS")({data:g,signedData:v(Dd),envelopedData:v(Ea),digestedData:v(Rd),encryptedData:v(Qb),authData:v(Sd),encryptedKeyPkg:v(Ud),
aKeyPackage:v(Cc)}),Vd=f({digestAlgorithm:ha,digest:g}),Wd=D({friendlyName:z(Ia),keyProviderNameAttr:z(Ia),localKeyId:z(g),certKeyIdentifierPropId:z(g)}),Xd=I({certId:l,certValue:function(a){return d(0,u(a))}},"certId","certValue")({x509Certificate:g(O(ka)),sdsiCertificate:aa},g),Yd=I({crlId:l,crlValue:function(a){return d(0,u(a))}},"crlId","crlValue")({x509CRL:g(O(Wa))},g),Zd=I({secretTypeId:l,secretValue:function(a){return d(0,u(a))}},"secretTypeId","secretValue")({secret:g},g),$d=I({bagId:l,bagValue:function(a){return d(0,
u(a))},bagAttributes:e(Wd)},"bagId","bagValue")(function(a){return{keyBag:v(Sa),pkcs8ShroudedKeyBag:v(tb),certBag:v(Xd),crlBag:v(Yd),secretBag:v(Zd),safeContentsBag:Rb}[a]}),Rb=k($d),ae=k(sa),be=f({mac:Vd,macSalt:g,iterations:V(h,1)}),ce=f({version:h,authSafe:sa,macData:e(be)},"PFX"),de=f({issuer:A,serialNumber:h}),ee=f({intendedAlg:e(d(0,p||b)),symmAlg:e(d(1,p||b)),encSymmKey:e(d(2,n||b)),keyAlg:e(d(3,p||b)),valueHint:e(d(4,g||b)),encValue:n}),la=r({encryptedValue:ee,envelopedData:d(0,Ea||b)},function(a){return a.encryptedContentInfo?
"envelopedData":"encryptedValue"}),fe=r({encryptedPrivKey:d(0,la),keyGenParameters:d(1,g||b),archiveRemGenPrivKey:d(2,$||b)}),ge=f({pubMethod:h({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:e(A)}),Sb=f({action:h({dontPublish:0,pleasePublish:1}),pubInfos:e(k(ge))}),he=h({encrCert:0,challengeResp:1}),Ub=r({thisMessage:d(0,n||b),subsequentMessage:d(1,he||b),dhMAC:d(2,n||b),agreeMAC:d(3,Tb||b),encryptedKey:d(4,Ea||b)});f({salt:g,owf:p,iterationCount:h,mac:p});var Tb=f({algId:p,value:n}),ie=f({authInfo:r({sender:d(0,
u(A)),publicKeyMAC:Tb}),publicKey:ia}),je=f({poposkInput:e(d(0,ie)),algorithmIdentifier:p,signature:n}),ke=r({raVerified:d(0,na||b),signature:d(1,je||b),keyEncipherment:d(2,Ub||b),keyAgreement:d(3,Ub||b)}),le=k(Ja({regToken:U,authenticator:U,pkiPublicationInfo:Sb,pkiArchiveOptions:fe,oldCertID:de,protocolEncrKey:ia})),me=f({notBefore:e(d(0,ba||b)),notAfter:e(d(1,ba||b))}),Vb=f({version:e(d(0,h||b)),serialNumber:e(d(1,h||b)),signingAlg:e(d(2,p||b)),issuer:e(d(3,W||b)),validity:e(d(4,me||b)),subject:e(d(5,
W||b)),publicKey:e(d(6,ia||b)),issuerUID:e(d(7,n||b)),subjectUID:e(d(8,n||b)),extensions:e(d(9,ja||b))}),Wb=f({certReqId:h,certTemplate:Vb,controls:e(le)}),ne=f({privateKey:Sa,identifier:e(r({string:U,generalName:A},function(a){return"string"===typeof a||a instanceof String?"string":"generalName"}))}),Xb=f({certReq:Wb,popo:e(ke),regInfo:e(k(Ja({utf8Pairs:U,certReq:Wb,encKeyWithID:ne})))});k(Xb);var Yb=f({pendToken:g,pendTime:G}),Zb=h({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,
partial:7}),$b=h({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),oe=f({cMCStatus:Zb,bodyList:k(h),statusString:e(U),otherInfo:e(r({failInfo:$b,pendInfo:Yb}))}),pe=f({pkiDataReference:h,certReferences:k(h),extensions:k(wb)}),qe=f({pkiDataBodyid:h,bodyIds:k(h)}),re=f({issuerName:A,serialNumber:h}),se=f({issuerName:W,cRLName:e(A),time:e(G),reasons:e(Ua)}),
te=f({issuerName:W,serialNumber:h,reason:Ab,invalidityDate:e(G),passphrase:e(g),comment:e(U)}),ue=f({bodyPartID:h,thePOPAlgID:p,thePOP:g}),ac=r({bodyPartID:h,bodyPartPath:Ya}),ve=f({cMCStatus:Zb,bodyList:k(ac),statusString:e(U),otherInfo:e(r({failInfo:$b,pendInfo:Yb,extendedFailInfo:f({failInfoOID:l,failInfoValue:b})}))}),we=f({seqNumber:h,hashAlgorithm:p,anchorHashes:k(g)}),cb=k(h),xe=f({hashAlg:p,certHashes:k(g),pubInfo:Sb}),ye=f({pkiDataReference:Ya,certReferences:cb,replace:V($,!0),certTemplate:Vb}),
ze=f({bodyList:k(ac)}),Ae=f({proofAlgID:p,macAlgId:p,witness:g}),Be=f({keyGenAlgorithm:p,macAlgorithm:p,witness:g}),Ce=f({bodyPartID:h,certificationRequest:zb}),bc=f({bodyPartID:h,contentInfo:sa}),cc=f({bodyPartID:h,otherMsgType:l,otherMsgValue:b}),dc=r({tcr:d(0,Ce||b),crm:d(1,Xb||b),orm:d(2,ga(f({bodyPartID:h,requestMessageType:l,requestMessageValue:b})))}),De=f({request:dc,cms:sa,thePOPAlgID:p,witnessAlgID:p,witness:g}),ec=I({bodyPartID:h,attrType:l,attrValues:function(a){return y(a)}},"attrType",
"attrValues",b)({statusInfo:oe,identification:U,identityProof:g,dataReturn:g,transactionId:h,senderNonce:g,recipientNonce:g,addExtensions:pe,encryptedPOP:De,decryptedPOP:ue,lraPOPWitness:qe,getCert:re,getCRL:se,revokeRequest:te,regInfo:g,responseInfo:g,queryPending:g,popLinkRandom:g,popLinkWitness:g,confirmCertAcceptance:ra,statusInfoV2:ve,trustedAnchors:we,authPublish:h,batchRequests:cb,batchResponses:cb,publishCert:xe,modCertTemplate:ye,controlProcessed:ze,popLinkWitnessV2:Be,identityProofV2:Ae}),
Ee=f({controlSequence:k(ec),reqSequence:k(dc),cmsSequence:k(bc),otherMsgSequence:k(cc)},"PKI REQUEST"),Fe=f({controlSequence:k(ec),cmsSequence:k(bc),otherMsgSequence:k(cc)},"PKI RESPONSE");Ha.prototype={GostPrivateKeyInfo:Dc,GostSubjectPublicKeyInfo:Ra,GostKeyContainer:md,GostKeyContainerName:nd,GostPrivateKeys:od,GostPrivateMasks:pd,GostSignature:Sc,GostEncryptedKey:id,GostWrappedPrivateKey:Ac,PrivateKeyInfo:Sa,EncryptedPrivateKeyInfo:tb,SubjectPublicKeyInfo:ia,TBSCertificate:xb,Certificate:ka,CertificationRequestInfo:yb,
CertificationRequest:zb,TBSCertList:Bb,CertificateList:Wa,AttributeCertificateInfo:Fb,AttributeCertificate:Gb,SignedAttributes:Da,UnsignedAttributes:Kb,ContentInfo:sa,SafeContents:Rb,AuthenticatedSafe:ae,PFX:ce,PKIData:Ee,PKIResponse:Fe};x.asn1=new Ha;return Ha});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(m,u){"function"===typeof define&&define.amd?define(["gostCrypto","gostASN1"],u):"object"===typeof exports?module.exports=u(require("gostCrypto"),require("gostASN1")):m.GostCert=u(m.gostCrypto,m.GostASN1)})(this,function(m){function u(a){for(var b=1,c=arguments.length;b<c;b++){var d=arguments[b];if("object"===typeof d)for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a}function t(a){var b=function(){};b.prototype=a.prototype;for(var b=[new b],c=1;c<arguments.length;c++)b.push(arguments[c]);
return u.apply(this,b)}function v(a){var b=new P;b.setHours(0,0,0,0);a&&b.setDate(b.getDate()+a);return b}function q(a){try{a()}catch(b){}}function Q(){var a=new Uint8Array(4);m.getRandomValues(a);a[0]&=127;return R.Int16.encode(a)}function B(a,b){for(var c in a)if(a[c]!==b[c])return!1;for(c in b)if(a[c]!==b[c])return!1;return!0}function x(a,b){var c=a.extensions&&a.extensions.subjectKeyIdentifier,d;if((d=a&&b&&(!b.issuer||B(a.issuer,b.issuer))&&(!b.serialNumber||H(a.serialNumber,b.serialNumber)))&&
!(d=!b.subjectKeyIdentifier))a:if(d=b.subjectKeyIdentifier,c=new Uint8Array(c),d=new Uint8Array(d),c.length!==d.length)d=!1;else{for(var e=0,g=c.length;e<g;e++)if(c[e]!==d[e]){d=!1;break a}d=!0}return d&&(!b.subject||B(a.subject,b.subject))&&(!b.date||a.notBefore.getTime()<=b.date.getTime()&&a.notAfter.getTime()>b.date.getTime())}function C(a,b,c){a={subject:a.issuer,date:c};if(b=b&&b.authorityKeyIdentifier)a.subjectKeyIdentifier=b.keyIdentifier,b.authorityCertIssuer&&b.authorityCertIssuer[0]&&b.authorityCertSerialNumber&&
(a.issuer=b.authorityCertIssuer[0],a.serialNumber=b.authorityCertSerialNumber);return a}function z(a,b){for(var c=[],d=0,e=a.length;d<e;d++)x(a[d],b)&&c.push(a[d]);return c}function I(a,b){return(!b.issuer||B(a.issuer,b.issuer))&&(!b.date||a.thisUpdate.getTime()<b.date.getTime())}function J(a,b){for(var c=[],d=0,e=a.length;d<e;d++)I(a[d],b)&&c.push(a[d]);return c}function E(a){a=a.id;for(var b in s){var c=s[b];if(c.publicKey.id===a)return c}}function K(a,b,c){for(var d in b){var e=a,g=d,h=b[d];"object"!==
typeof h&&(h={value:h});void 0!==c&&(h.enumerable=c);y.defineProperty(e,g,h)}}function t(a,b,c,d){"function"!==typeof b&&(d=c,c=b,b=function(){a.apply(this,arguments)});b.prototype=y.create(a.prototype,{constructor:{value:b},superclass:{value:a.prototype}});c&&K(b.prototype,c,!0);if(a!==y)for(var e in a)b[e]=a[e];b.super=a;d&&K(b,d,!0);return b}function r(){}function L(a){try{f.CertificationRequest.call(this,a,!0)}catch(b){a=a||{},f.CertificationRequest.call(this,{version:0,subject:a.subject||l.subject,
subjectPublicKeyInfo:a.subjectPublicKeyInfo||{algorithm:{id:"noSignature"},subjectPublicKey:new D(0)},attributes:a.attributes||{extensionRequest:{keyUsage:l.userKeyUsage,extKeyUsage:l.userExtKeyUsage}},signatureAlgorithm:{id:"noSignature"},signatureValue:new D(0)})}}function M(a,b){this.certificates=a;this.crls=b}function N(a){this.certStore=a}function F(){}function O(a,b,c){this.trustedCACerts=a||[];this.requireCRL=b||!1;this.requireCA=c||!0}var n=this.Promise,y=this.Object,D=this.ArrayBuffer,P=
this.Date,k=m.subtle,R=m.coding,f=m.asn1,s=m.security.providers,H=function(){var a=function(a){var b=typeof a;return"undefined"===b||""===a?"0":"number"===b||a instanceof Number?a.toString(16).toLowerCase():a.replace("0x","").toLowerCase()},b=function(a,b){return(Array(b+1).join("0")+a).slice(-b)};return function(c,d){c=a(c);d=a(d);var e=Math.max(c.length,d.length);return b(c,e)===b(d,e)}}(),l={providerName:"CP-01",subject:{countryName:"RU",commonName:"Anonymous"},caKeyUsage:"digitalSignature nonRepudiation keyEncipherment dataEncipherment keyAgreement keyCertSign cRLSign".split(" "),
caExtKeyUsage:"serverAuth clientAuth codeSigning emailProtection ipsecEndSystem ipsecTunnel ipsecUser timeStamping OCSPSigning".split(" "),userKeyUsage:["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement"],userExtKeyUsage:["clientAuth","emailProtection"],days:7305};r.prototype.options=l;var w=function(a){try{f.Certificate.call(this,a,!0)}catch(b){try{a=new f.CertificationRequest(a,!0)}catch(c){}a=a||{};f.Certificate.call(this,{version:2,serialNumber:a.serialNumber||
Q(),signature:a.signature||{id:"noSignature"},issuer:a.subject||l.subject,notBefore:a.notBefore||v(),notAfter:a.notAfter||v(a.days||l.days),subject:a.subject||l.subject,subjectPublicKeyInfo:a.subjectPublicKeyInfo||{algorithm:{id:"noSignature"},subjectPublicKey:new D(0)},extensions:a.attributes&&(a.attributes.extensionRequest||a.attributes.msCertExtensions)||a.extensions,signatureAlgorithm:{id:"noSignature"},signatureValue:new D(0)})}};t(f.Certificate,w,{sign:function(a,b){var c=this,d=c.subjectPublicKeyInfo;
return(new n(q)).then(function(){if(!d||!d.algorithm||"noSignature"===d.algorithm)throw Error("Key pair was not generated for the certificate");if(!a)throw Error("The private key of the issuer is not defined");b=b||c;return k.digest("SHA-1",d.subjectPublicKey)}).then(function(d){var g=b.getProvider()||s[l.providerName];c.signature&&"noSignature"!==c.signature.id||(c.signature=g.signature);c.signatureAlgorithm=c.signature;c.issuer=b.subject;c.extensions||(c.extensions={});var g=c.extensions,h=b.extensions;
if(c===b)g.keyUsage=g.keyUsage||l.caKeyUsage,g.extKeyUsage=g.extKeyUsage||l.caExtKeyUsage,g.basicConstraints=g.basicConstraints||{cA:!0};else{if(!b.checkUsage("keyCertSign",c.notBefore))throw Error("The issuer's certificate is not valid for signing a certificate");g.keyUsage=g.keyUsage||l.userKeyUsage;g.extKeyUsage=g.extKeyUsage||l.userExtKeyUsage;g.basicConstraints=g.basicConstraints||{cA:0<=g.keyUsage.indexOf("keyCertSign")};if(g.basicConstraints.cA){var G=h&&h.basicConstraints&&h.pathLenConstraint;
if(void 0!==G)if(0<G)g.basicConstraints.pathLenConstraint=G-1;else throw Error("Path length constraint exceeded");}}g.subjectKeyIdentifier=d;h&&h.subjectKeyIdentifier&&(g.authorityKeyIdentifier={keyIdentifier:h.subjectKeyIdentifier,authorityCertIssuer:[b.issuer],authorityCertSerialNumber:b.serialNumber});return k.importKey("pkcs8",f.PrivateKeyInfo.encode(a),a.privateKeyAlgorithm,!1,["sign"])}).then(function(a){return k.sign(c.signatureAlgorithm,a,f.TBSCertificate.encode(c))}).then(function(a){c.signatureValue=
a;return c})},generate:function(a){var b=this,c,d;(d=a?s[a]:this.getProvider()||s[l.providerName])&&(a=u(d.publicKey,{privateKey:d.privateKey}));return(new n(q)).then(function(){return k.generateKey(a,"true",["sign","verify"])}).then(function(a){c=a.privateKey;return k.exportKey("spki",a.publicKey)}).then(function(a){b.subjectPublicKeyInfo=new f.SubjectPublicKeyInfo(a);return k.exportKey("pkcs8",c)}).then(function(a){return new f.PrivateKeyInfo(a)})},getPublicKey:function(){var a=this.subjectPublicKeyInfo,
b="rsaEncryption"===a.algorithm.id?["verify"]:["verify","deriveKey","deriveBits"];return k.importKey("spki",f.SubjectPublicKeyInfo.encode(a),a.algorithm,"false",b)},getProvider:function(){return E(this.subjectPublicKeyInfo.algorithm)},verify:function(a,b,c){var d=this,e=d.extensions;return(new n(q)).then(function(){c=c||v();if(d.notBefore.getTime()>c.getTime()||d.notAfter.getTime()<=c.getTime())throw Error("The certificate has not yet started or expired");for(var b in e)if(e[b].critical&&0>"authorityKeyIdentifier subjectKeyIdentifier keyUsage certificatePolicies policyMappings basicConstraints nameConstraints policyConstraints extKeyUsage".split(" ").indexOf(b))throw Error("The critical extension '"+
b+"' is unrecognized");b=C(d,e,d.notBefore);!a&&x(d,b)&&(a=d);if(a){if(!x(a,b)||!a.checkUsage("keyCertSign",d.notBefore))throw Error("The issuer's certificate is not valid");return a.verifySignature(f.TBSCertificate.encode(d),d.signatureValue,d.signatureAlgorithm)}return!0}).then(function(a){if(!a)throw Error("The certificate has invalid signature");if(b){if(!I(b,{issuer:d.issuer,date:c}))throw Error("The issuer's CRL is not valid");if(b.isRevoked(d.serialNumber))throw Error("The certificate is revoked");
}return d})},verifySignature:function(a,b,c){return this.getPublicKey().then(function(d){return k.verify(c,d,b,a)})},checkUsage:function(a,b){var c=this.extensions;b=b||v();return this.notBefore.getTime()<=b.getTime()&&this.notAfter.getTime()>b.getTime()&&(!c||!(0<["keyCertSign","cRLSign"].indexOf(a)&&c.basicConstraints&&!c.basicConstraints.cA||c.keyUsage&&0>c.keyUsage.indexOf(a)&&c.extKeyUsage&&0>c.extKeyUsage.indexOf(a)))}});r.prototype.X509=w;var A=function(a){A.super.call(this,a);this.version||
(this.version=1);this.revokedCertificates||(this.revokedCertificates=[]);this.thisUpdate||(this.thisUpdate=v())};t(f.CertificateList,A,{sign:function(a,b){var c=this;return(new n(q)).then(function(){if(!a)throw Error("The issuer's private key is not defined");if(!b)throw Error("The issuer's certificate is not defined");if(!c.issuer)c.issuer=b.issuer;else if(!B(c.issuer,b.issuer))throw Error("The CRL prototype and authority certificate have different issuers");if(!b.checkUsage("cRLSign",c.thisUpdate))throw Error("The issuer's certificate is not valid for signing a CRL");
var d=b.getProvider()||s[l.providerName];c.signature||(c.signature=d.signature);c.signatureAlgorithm=c.signature;c.issuer=b.subject;c.crlExtensions||(c.crlExtensions={});var d=c.crlExtensions,e=b.extensions;e&&e.subjectKeyIdentifier&&(d.authorityKeyIdentifier={keyIdentifier:e.subjectKeyIdentifier,authorityCertIssuer:[b.issuer],authorityCertSerialNumber:b.serialNumber});d.cRLNumber=d.cRLNumber||0;return k.importKey("pkcs8",f.PrivateKeyInfo.encode(a),a.privateKeyAlgorithm,!1,["sign"])}).then(function(a){return k.sign(c.signatureAlgorithm,
a,f.TBSCertList.encode(c))}).then(function(a){c.signatureValue=a;return c})},verify:function(a,b){var c=this,d=c.crlExtensions;return(new n(q)).then(function(){b=b||v();if(!c.thisUpdate.getTime()>b.getTime())throw Error("The CRL has not yet started");if(a){if(!x(a,C(c,d,c.thisUpdate))||!a.checkUsage("cRLSign",c.thisUpdate))throw Error("The issuer's certificate is not valid");if(!c.signatureValue||!c.signatureAlgorithm)throw Error("The has no signature");return a.verifySignature(f.TBSCertList.encode(c),
c.signatureValue,c.signatureAlgorithm)}}).then(function(a){if(!a)throw Error("The CRL has invalid signature");return c})},isRevoked:function(a,b){var c=this.revokedCertificates;b=b||v();for(var d=0;d<c.length;d++)if(b.getTime()>=c[d].revocationDate.getTime()&&H(c[d].userCertificate,a))return!0;return!1}});r.prototype.CRL=A;t(f.CertificationRequest,L,{generate:function(a){var b=this,c,d;(d=a?s[a]:this.getProvider()||s[l.providerName])&&(a=u(d.publicKey,{privateKey:d.privateKey}));return(new n(q)).then(function(){return k.generateKey(a,
"true",["sign","verify"])}).then(function(a){c=a.privateKey;return k.exportKey("spki",a.publicKey)}).then(function(a){b.subjectPublicKeyInfo=new f.SubjectPublicKeyInfo(a);return k.exportKey("pkcs8",c)}).then(function(a){c=new f.PrivateKeyInfo(a);return b.sign(c)}).then(function(){return c})},getProvider:function(){return E(this.subjectPublicKeyInfo.algorithm)},sign:function(a){var b=this,c=b.subjectPublicKeyInfo;return(new n(q)).then(function(){if(!c||!c.algorithm||"noSignature"===c.algorithm)throw Error("Key pair was not generated for the certificate");
if(!a)throw Error("The private key is not defined");var d=E(c.algorithm)||s[l.providerName];b.signatureAlgorithm=d.signature;return k.importKey("pkcs8",f.PrivateKeyInfo.encode(a),a.privateKeyAlgorithm,!1,["sign"])}).then(function(a){return k.sign(b.signatureAlgorithm,a,f.CertificationRequestInfo.encode(b))}).then(function(a){b.signatureValue=a;return b})},verify:function(){var a=this,b=a.subjectPublicKeyInfo;return(new n(q)).then(function(){return k.importKey("spki",f.SubjectPublicKeyInfo.encode(b),
b.algorithm,"false",["verify"])}).then(function(b){return k.verify(a.signatureAlgorithm,b,a.signatureValue,f.CertificationRequestInfo.encode(a))}).then(function(b){if(!b)throw Error("The certification request has invalid signature");return a})}});r.prototype.Request=L;t(y,M,{getCertificates:function(a){return z(this.certificates,a)},getCRLs:function(a){return J(this.certificates,a)}});r.prototype.CertStore=M;t(y,N,{build:function(a,b){var c=this;return(new n(q)).then(function(){for(var d=new w(a),
e=[],g=!1,h=[];d;){var f=[],k=[];e.push(d);if(!g){var f=c.certStore.getCRLs({issuer:d.issuer,date:b}),l=C(d,d.extensions,d.notBefore);x(d,l)?g=!0:k=c.certStore.getCertificates(l)}k=0<k.length&&new w(k[0]);(f=0<f.length&&new A(f[0]))&&h.push(f.verify(k,b));h.push(d.verify(k,f,b));d=k}if(!g)throw Error("Root certificate is not found");return n.all(h).then(function(a){for(var b=0;b<a;b++)if(!a[b])throw Error("Certification path is not validated");return e})})}});r.prototype.CertPath=N;t(y,F,{getValidCertificate:function(a,
b,c){}});r.prototype.CertificateTrustPolicy=F;t(F,O,{getValidCertificate:function(a,b,c,d){var e=this,g;return(new n(q)).then(function(){b=b||[];c=c||[];var h=z(e.trustedCACerts,a);if(0<h.length)return new w(h[0]);h=z(b,a);if(0!==h.length){var h=new w(h[0]),f=!1,k=[];for(g=[];h;){var l=[],p=[];g.push(h);if(!f){l=J(c,{issuer:h.issuer,date:d});if(0===l.length&&e.requireCRL)return;a=C(h,h.extensions,h.notBefore);p=z(e.trustedCACerts,a);if(0===p.length){if(!x(h,a))if(p=z(b,a),0<p.length){var m=p[0].extensions;
if(e.requireCA&&(!m||!m.basicConstraints||!m.basicConstraints.cA||void 0!==m.basicConstraints.pathLenConstraint&&m.basicConstraints.pathLenConstraint<g.length-1))return}else return}else f=!0}p=0<p.length&&new w(p[0]);(l=0<l.length&&new A(l[0]))&&k.push(l.verify(p,d));k.push(h.verify(p,l,d));h=p}if(!f)throw Error("Trusted root certificate is not found");return n.all(k).then(function(a){for(var b=0;b<a;b++)if(!a[b])throw Error("Certification path is not validated");return g[0]})}})}});r.prototype.TrustedCAPolicy=
O;m.cert=new r;return r});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(p,k){"function"===typeof define&&define.amd?define(["gostCrypto","gostASN1","gostCert"],k):"object"===typeof exports?module.exports=k(require("gostCrypto"),require("gostASN1"),require("gostCert")):p.GostCMS=k(p.gostCrypto,p.GostASN1,p.GostCert)})(this,function(p){function k(){for(var a={},b=0,c=arguments.length;b<c;b++){var d=arguments[b];if("object"===typeof d)for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a}function P(a,b,c){for(var d in b){var e=a,f=d,g=b[d];"object"!==typeof g&&
(g={value:g});void 0!==c&&(g.enumerable=c);D.defineProperty(e,f,g)}}function y(a,b,c,d){"function"!==typeof b&&(d=c,c=b,b=function(){a.apply(this,arguments)});b.prototype=D.create(a.prototype,{constructor:{value:b},superclass:{value:a.prototype}});c&&P(b.prototype,c,!0);if(a!==D)for(var e in a)b[e]=a[e];b.super=a;d&&P(b,d,!0);return b}function l(a){try{a()}catch(b){}}function E(a,b){var c=new Uint8Array(a),d=new Uint8Array(b);if(c.length!==d.length)return!1;for(var e=0,f=c.length;e<f;e++)if(c[e]!==
d[e])return!1;return!0}function F(a,b){for(var c in a)if(a[c]!==b[c])return!1;for(c in b)if(a[c]!==b[c])return!1;return!0}function G(a,b,c){for(var d=!1,e=0,f=a.length;e<f;e++)if(c(a[e],b)){d=!0;break}d||a.push(b)}function H(a,b){var c=a.content;switch(a.contentType){case "data":a.contentType=b.contentType;a.content=b.content;break;case "digestedData":case "signedData":case "authData":c.encapContentInfo={eContentType:b.contentType,eContent:b.content};break;case "envelopedData":case "encryptedData":c.encryptedContentInfo=
{contentType:b.contentType,encryptedContent:b.content}}}function Q(a){var b=a.content;switch(a.contentType){case "data":return{contentType:a.contentType,content:a.content};case "digestedData":case "signedData":case "authData":return a=b.encapContentInfo,{contentType:a.eContentType,content:a.eContent};case "envelopedData":case "encryptedData":return a=b.encryptedContentInfo,{contentType:a.contentType,content:a.encryptedContent}}}function I(a){var b;if(a){if("string"===typeof a)try{a=A.PEM.decode(a)}catch(c){a=
A.Chars.decode(a)}if(a instanceof w)try{a=t.ContentInfo.decode(a)}catch(d){a={contentType:"data",content:a}}b=a.contentType;if(!b)throw Error("Invalid content object");a=a.content;a instanceof w||(a=a.encode());return{contentType:b,content:a}}return a={contentType:"data"}}function z(a){try{a=new t.ContentInfo(a.content,!0)}catch(b){}switch(a.contentType){case "data":return new q(a);case "digestedData":return new J(a);case "signedData":return new K(a);case "encryptedData":return new L(a);case "envelopedData":return new M(a);
default:return new t.ContentInfo(a)}}function B(a,b){return a instanceof w?b.extensions&&E(a,b.extensions.subjectKeyIdentifier):F(b.issuer,a.issuer)&&N(b.serialNumber,a.serialNumber)}function C(a){a=new Uint8Array(a);p.getRandomValues(a);return a.buffer}function T(a){switch(a.id){case "pbewithSHAAnd40BitRC2-CBC":case "pbeWithSHAAnd128BitRC2-CBC":return 8;case "pbeUnknownGost":return 16;case "sha1":return 20;default:return 32}}function R(a,b){if(!b)return new w(0);if(b instanceof w)return b;if("string"!==
typeof b)throw Error("The password must be string or raw data type");if(0<=a.name.indexOf("CPKDF")){for(var c=[],d=0;d<b.length;d++){var e=b.charCodeAt(d);c.push(e&255);c.push(e>>>8&255);c.push(0);c.push(0)}return(new Uint8Array(c)).buffer}return 0<=a.name.indexOf("PFXKDF")?A.Chars.decode(b+"\x00","unicode"):A.Chars.decode(b,"utf8")}function x(){}function q(a,b){t.ContentInfo.call(this,a||b||{contentType:"data"});if(b&&this.contentType!==(b.contentType||"data"))throw Error("Invalid content type");
}function J(a){q.call(this,a,{contentType:"digestedData",version:0,digestAlgorithm:v[r.providerName].digest,encapContentInfo:{eContentType:"data"},digest:new w(0)})}function K(a){q.call(this,a,{contentType:"signedData",version:1,digestAlgorithms:[],encapContentInfo:{eContentType:"data"},signerInfos:[]})}function L(a){q.call(this,a,{contentType:"encryptedData",version:0,encryptedContentInfo:{contentType:"data",contentEncryptionAlgorithm:v[r.providerName].encryption}})}function M(a){q.call(this,a,{contentType:"envelopedData",
version:0,recipientInfos:[],encryptedContentInfo:{contentType:"data",contentEncryptionAlgorithm:v[r.providerName].encryption}})}var m=this.Promise,D=this.Object,w=this.ArrayBuffer,U=this.Date,h=p.subtle,t=p.asn1,A=p.coding,V=p.cert,v=p.security.providers,N=function(){var a=function(a){var b=typeof a;return"undefined"===b||""===a?"0":"number"===b||a instanceof Number?a.toString(16).toLowerCase():a.replace("0x","").toLowerCase()},b=function(a,b){return(Array(b+1).join("0")+a).slice(-b)};return function(c,
d){c=a(c);d=a(d);var e=Math.max(c.length,d.length);return b(c,e)===b(d,e)}}(),r={providerName:"CP-01",autoAddCert:!1,useKeyIdentifier:!1};x.prototype.options=r;y(t.ContentInfo,q,{isDetached:{value:!1,enumerable:!0,writable:!0},writeDetached:function(a){this.isDetached=a},encode:function(a){if(this.isDetached){var b=Q(this);H(this,{contentType:b.contentType});a=t.ContentInfo.method("encode").call(this,a);H(this,b);return a}return t.ContentInfo.method("encode").call(this,a)},"enclose\u0421ontent":function(a){var b=
this;return(new m(l)).then(function(){b.setEnclosed(a);return b})},setEnclosed:function(a){H(this,I(a))},getEnclosed:function(){return z(Q(this))}});x.prototype.DataContentInfo=q;y(q,J,{encloseContent:function(a,b){var c=this;return(new m(l)).then(function(){c.setEnclosed(a);if(b){var d=v[b];c.digestAlgorithm=d&&d.digest||b}return h.digest(c.digestAlgorithm,c.encapContentInfo.eContent)}).then(function(a){c.digest=a})},verify:function(a){var b=this;return(new m(l)).then(function(){a&&b.setEnclosed(a);
if(!b.encapContentInfo||!b.encapContentInfo.eContent)throw Error("Detached content is not found");return h.digest(b.digestAlgorithm,b.encapContentInfo.eContent)}).then(function(a){if(!E(a,b.digest))throw Error("Message digest is not verified");return z({contentType:b.encapContentInfo.eContentType,content:b.encapContentInfo.eContent})})}});x.prototype.DigestedDataContentInfo=J;y(q,K,{addSignature:function(a,b,c,d){var e=this,f,g,n;return(new m(l)).then(function(){if(!a||!b)throw Error("Signer key or certificate is not defined");
b instanceof Array?(n=b,b=n[0]):n=[b];var s=b.getProvider()||v[r.providerName],S=r.useKeyIdentifier&&b.extensions&&b.extensions.subjectKeyIdentifier;g=e.encapContentInfo.eContent;f={version:S?2:0,sid:S?b.extensions.subjectKeyIdentifier:{issuer:b.issuer,serialNumber:b.serialNumber},digestAlgorithm:s.digest,signatureAlgorithm:b.subjectPublicKeyInfo.algorithm};d&&(f.unsignedAttrs=d);if(c)return"object"!==typeof c&&(c={}),h.digest(f.digestAlgorithm,g)}).then(function(b){b&&(c.contentType=e.encapContentInfo.eContentType,
c.messageDigest=b,c.signingTime=new U,f.signedAttrs=c,g=t.SignedAttributes.encode(f.signedAttrs));return h.importKey("pkcs8",t.PrivateKeyInfo.encode(a),a.privateKeyAlgorithm,!1,["sign"])}).then(function(a){var b=k(f.signatureAlgorithm,{hash:f.digestAlgorithm});return h.sign(b,a,g)}).then(function(a){f.signatureValue=a;G(e.digestAlgorithms,f.digestAlgorithm,function(a,b){return a.id===b.id});if(r.autoAddCert){e.certificates||(e.certificates=[]);a=0;for(var b=n.length;a<b;a++)G(e.certificates,n[a],
function(a,b){return F(a.issuer,b.issuer)&&N(a.serialNumber,b.serialNumber)})}e.signerInfos.push(f)})},isDegenerate:{get:function(){return!(this.signerInfos&&0<this.signerInfos.length)}},verify:function(a,b){var c=this,d;return(new m(l)).then(function(){b&&c.setEnclosed(b);if(!c.signerInfos||0===c.signerInfos.length)throw Error("No signatures found");return m.all(c.signerInfos.map(function(b,d){var g=b.sid,g=g instanceof w?{subjectKeyIdentifier:g}:{issuer:g.issuer,serialNumber:g.serialNumber},h;b.signedAttrs&&
b.signedAttrs.signingTime&&(h=b.signedAttrs.signingTime);return a.getValidCertificate(g,c.certificates,c.crls,h).catch(function(){})}))}).then(function(a){var b=[];a.forEach(function(a){a&&b.push(c.verifySignature(a).then(function(a){d=a},function(){}))});if(0===b.length)throw Error("Valid verification path not found");return m.all(b)}).then(function(){if(!d)throw Error("Verification path found but no valid signature");return d})},verifySignature:function(a,b){var c=this,d,e,f;return(new m(l)).then(function(){b&&
c.setEnclosed(b);e=c.encapContentInfo&&c.encapContentInfo.eContent;if(!e)throw Error("Detached content is not found");for(var g=0;g<c.signerInfos.length;g++)if(B(c.signerInfos[g].sid,a)){d=c.signerInfos[g];break}if(!d)throw Error("Signature not found for the certificate");if(d.signedAttrs){f=d.signedAttrs.messageDigest;if(!f)throw Error("Message digest must present in signed attributes");e=d.signedAttrs.encode()}if(!e)throw Error("Data for verification not found");g=k(d.signatureAlgorithm,{hash:d.digestAlgorithm});
return a.verifySignature(e,d.signatureValue,g)}).then(function(a){if(!a)throw Error("Signature not verified");if(d.signedAttrs)return h.digest(d.digestAlgorithm,c.encapContentInfo.eContent)}).then(function(a){if(a&&!E(a,f))throw Error("Message digest not verified");return z({contentType:c.encapContentInfo.eContentType,content:c.encapContentInfo.eContent})})}});x.prototype.SignedDataContentInfo=K;y(q,L,{encloseContent:function(a,b,c){var d=this,e,f;return(new m(l)).then(function(){a=I(a);if(!a.content)throw Error("Content for encryption must be specified");
var d="string"===typeof b?"pbes":"encryption";if(c){var n=v[c];c=n&&n[d]||c}else c=v[r.providerName][d];if(c.derivation){f=k(c.derivation);e=k(c.encryption);f.salt=C(T(c));var s;return h.importKey("raw",R(f,b),f,!1,["deriveKey","deriveBits"]).then(function(a){s=a;if(0<=f.name.indexOf("PFXKDF"))return f.diversifier=2,h.deriveBits(f,s,64)}).then(function(a){a&&(e.iv=a);f.diversifier=1;return h.deriveKey(f,s,e,!1,["encrypt"])}).then(function(a){return a})}e=k(c);if(b instanceof w)return h.importKey("raw",
b,e,!1,["encrypt"]);if("secret"===b.type)return b;throw Error("Content encryption key must be raw data or secret key type");}).then(function(b){e.iv||(e.iv=C(8));return h.encrypt(e,b,a.content)}).then(function(b){c.derivation?(delete f.diversifier,c=k(c,{derivation:f,encryption:e})):c=e;d.encryptedContentInfo={contentType:a.contentType,contentEncryptionAlgorithm:c,encryptedContent:b};return d})},getEnclosed:function(a,b){var c=this,d,e,f;return(new m(l)).then(function(){b&&c.setEnclosed(b);f=c.encryptedContentInfo.encryptedContent;
if(!f)throw Error("Encrypted content must be specified");d=k(c.encryptedContentInfo.contentEncryptionAlgorithm);if(d.derivation){e=k(d.derivation);d=k(d.encryption);var g;return h.importKey("raw",R(e,a),e,!1,["deriveKey","deriveBits"]).then(function(a){g=a;if(0<=e.name.indexOf("PFXKDF"))return e.diversifier=2,h.deriveBits(e,g,64)}).then(function(a){a&&(d.iv=a);e.diversifier=1;return h.deriveKey(e,g,d,!1,["decrypt"])})}if(a instanceof w)return h.importKey("raw",a,d,!1,["decrypt"]);if("secret"===a.type)return a;
throw Error("Decryption key must be raw data or secret key type");}).then(function(a){return h.decrypt(d,a,f)}).then(function(a){return z({contentType:c.encryptedContentInfo.contentType,content:a})})}});x.prototype.EncryptedDataContentInfo=L;y(q,M,{encloseContent:function(a,b){var c=this;return(new m(l)).then(function(){a=I(a);if(!a.content)throw Error("Content for encryption must be specified");if(b){var c=v[b];b=c&&c.encryption||b}else b=v[r.providerName].encryption;return h.generateKey(b,!0,["encrypt"])}).then(function(d){c.contentEncryptionKey=
d;b.iv||(b.iv=C(8));return h.encrypt(b,d,a.content)}).then(function(d){c.encryptedContentInfo={contentType:a.contentType,contentEncryptionAlgorithm:b,encryptedContent:d};return c})},addRecipient:function(a,b,c,d){var e=this,f,g,n,s;return(new m(l)).then(function(){a=new V.X509(a);b&&"string"!==typeof b&&!b.algorithm&&(d=c,c=b,b=void 0);g=b?v[b]:a.getProvider();if(!e.contentEncryptionKey)throw Error("The content encryption key is not assigned");if(d){var f;d instanceof Array?(f=d,d=f[0]):f=[d];if(r.autoAddCert){e.originatorInfo?
e.originatorInfo.certs||(e.originatorInfo.certs=[]):e.originatorInfo={certs:[]};for(var O=0,n=f.length;O<n;O++)G(e.originatorInfo.certs,f[O],function(a,b){return F(a.issuer,b.issuer)&&N(a.serialNumber,b.serialNumber)})}g?b=k(g.agreement):g=a.getProvider();if(a.subjectPublicKeyInfo.algorithm.namedCurve!==d.subjectPublicKeyInfo.algorithm.namedCurve)throw Error("The sender and the recipient have different public key algorithms");return h.importKey("pkcs8",c.encode(),c.privateKeyAlgorithm,!1,["deriveKey"])}g?
b=k(a.subjectPublicKeyInfo.algorithm):g=a.getProvider();return h.generateKey(b,!0,["deriveKey"]).then(function(a){b["public"]=a.publicKey;return a.privateKey})}).then(function(b){f=b;return h.importKey("spki",a.subjectPublicKeyInfo.encode(),a.subjectPublicKeyInfo.algorithm,!1,["deriveKey","deriveBits"])}).then(function(a){b.ukm=C(8);n=k(g.agreement,{sBox:b.sBox,ukm:b.ukm,"public":a});s=k(b.wrapping||g.wrapping,{ukm:b.ukm});return h.deriveKey(n,f,s,!0,["wrapKey"])}).then(function(a){b.wrapping=s;return h.wrapKey("raw",
e.contentEncryptionKey,a,s)}).then(function(c){var f=r.useKeyIdentifier&&a.extensions&&a.extensions.subjectKeyIdentifier?a.extensions.subjectKeyIdentifier:{issuer:a.issuer,serialNumber:a.serialNumber};if(d){var g=d.subjectPublicKeyInfo;c={version:3,originator:{algorithm:g.algorithm,publicKey:g.subjectPublicKey},ukm:b.ukm,keyEncryptionAlgorithm:b,recipientEncryptedKeys:[{rid:f,encryptedKey:t.GostEncryptedKey(b).encode(c)}]}}else c={version:0,rid:f,keyEncryptionAlgorithm:b,encryptedKey:t.GostEncryptedKey(b).encode({algorithm:b,
sessionEncryptedKey:c})};e.recipientInfos.push(c);return e})},getEnclosed:function(a,b,c,d){var e=this,f,g,n,s,p;return(new m(l)).then(function(){var a=b.getProvider();c&&e.setEnclosed(c);g=e.encryptedContentInfo.encryptedContent;if(!g)throw Error("Encrypted content must be specified");p=e.encryptedContentInfo.contentEncryptionAlgorithm;for(var m=0;m<e.recipientInfos.length;m++){var l=e.recipientInfos[m],u=k(l.keyEncryptionAlgorithm);if(l.rid){if(B(l.rid,b))return m=t.GostEncryptedKey(u).decode(l.encryptedKey).object,
f=m.sessionEncryptedKey,u=k(u,m.algorithm),n=k(a.agreement,{ukm:u.ukm,sBox:u.sBox}),s=k(a.wrapping,u.wrapping,{ukm:u.ukm}),u["public"]}else{var q=l.recipientEncryptedKeys;if(q)for(var r=0;r<q.length;r++)if(B(q[r].rid,b)){u=k(a.agreement,u,{ukm:l.ukm});f=t.GostEncryptedKey(u).decode(q[r].encryptedKey).object;n=u;s=k(u.wrapping||a.wrapping,{ukm:l.ukm});a=l.originator;if(a.algorithm)return a=new t.SubjectPublicKeyInfo({algorithm:a.algorithm,subjectPublicKey:a.publicKey}),h.importKey("spki",a.encode(),
a.algorithm,!1,["deriveKey","deriveBits"]);if(d&&B(a,d))return importKey("pkcs",d.subjectPublicKeyInfo.encode(),d.subjectPublicKeyInfo.algorithm,!1,["deriveKey","deriveBits"]);throw Error("Originator certificate not specified or not valid");}}}throw Error("Recipient not found or format not supported");}).then(function(b){n["public"]=b;return h.importKey("pkcs8",a.encode(),a.privateKeyAlgorithm,!1,["deriveKey","deriveBits"])}).then(function(a){return h.deriveKey(n,a,s,!0,["unwrapKey"])}).then(function(a){return h.unwrapKey("raw",
f,a,s,p,!1,["decrypt"])}).then(function(a){return h.decrypt(p,a,g)}).then(function(a){return z({contentType:e.encryptedContentInfo.contentType,content:a})})}});x.prototype.EnvelopedDataContentInfo=M;p.cms=new x;return x});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(n,p){"function"===typeof define&&define.amd?define(["gostCrypto","gostASN1","gostCert","gostCMS"],p):"object"===typeof exports?module.exports=p(require("gostCrypto"),require("gostASN1"),require("gostCert"),require("gostCMS")):n.GostKeys=p(n.gostCrypto,n.GostASN1,n.GostCert,n.GostCMS)})(this,function(n){function p(a){for(var b=1,c=arguments.length;b<c;b++){var e=arguments[b];if("object"===typeof e)for(var d in e)e.hasOwnProperty(d)&&(a[d]=e[d])}return a}function E(a,b,c){for(var e in b){var d=
a,f=e,g=b[e];"object"!==typeof g&&(g={value:g});void 0!==c&&(g.enumerable=c);y.defineProperty(d,f,g)}}function w(a,b,c,e){"function"!==typeof b&&(e=c,c=b,b=function(){a.apply(this,arguments)});b.prototype=y.create(a.prototype,{constructor:{value:b},superclass:{value:a.prototype}});c&&E(b.prototype,c,!0);if(a!==y)for(var d in a)b[d]=a[d];b.super=a;e&&E(b,e,!0);return b}function F(a){a=new Uint8Array(a);n.getRandomValues(a);return a.buffer}function l(a){try{a()}catch(b){}}function J(a){var b=new N;
a&&b.setDate(b.getDate()+a);return b}function z(a,b){var c=new Uint8Array(a),e=new Uint8Array(b);if(c.length!==e.length)return!1;for(var d=0,f=c.length;d<f;d++)if(c[d]!==e[d])return!1;return!0}function O(a){switch(a.id){case "pbewithSHAAnd40BitRC2-CBC":case "pbeWithSHAAnd128BitRC2-CBC":return 8;case "pbeUnknownGost":return 16;case "sha1":return 20;default:return 32}}function G(a,b){if(!b)return new P(0);if(0<=a.name.indexOf("CPKDF")){for(var c=[],e=0;e<b.length;e++){var d=b.charCodeAt(e);c.push(d&
255);c.push(d>>>8&255);c.push(0);c.push(0)}return(new Uint8Array(c)).buffer}return 0<=a.name.indexOf("PFXKDF")?C.Chars.decode(b+"\x00","unicode"):C.Chars.decode(b,"utf8")}function u(){}function x(a){h.PrivateKeyInfo.call(this,a)}function K(a){h.EncryptedPrivateKeyInfo.call(this,a)}function D(a){if(a){var b=this;["mk.db3","masks.db3","kek.opq","rand.opq"].forEach(function(c){b[c]=a[c]})}}function H(a,b){h.GostWrappedPrivateKey.call(this,a);D.call(this,b)}function L(a){a&&(this.header=h.GostKeyContainer.decode(a.header),
this.name=h.GostKeyContainerName.decode(a.name),this.primary=h.GostPrivateKeys.decode(a.primary),this.masks=h.GostPrivateMasks.decode(a.masks),a.primary2&&a.masks2&&(this.primary2=h.GostPrivateKeys.decode(a.primary2),this.masks2=h.GostPrivateMasks.decode(a.masks2)))}function M(a){h.PFX.call(this,a||{vesion:3,authSafe:{contentType:"data"}})}var k=this.Promise,y=this.Object,P=this.ArrayBuffer,N=this.Date,f=n.subtle,h=n.asn1,C=n.coding,q=n.security.providers,r=n.cert,A=n.cms,B={providerName:"CP-01",
days:7305};u.prototype.options=B;w(h.PrivateKeyInfo,x,{getPrivateKey:function(){var a="rsaEncryption"===this.privateKeyAlgorithm.id?["sign"]:["sign","deriveKey","deriveBits"];return f.importKey("pkcs8",this.encode(),this.privateKeyAlgorithm,"true",a)},setPrivateKey:function(a){var b=this;return f.exportKey("pkcs8",a).then(function(a){h.PrivateKeyInfo.call(b,a);return b})},generate:function(a,b){var c=this;return(new k(l)).then(function(){a instanceof r.Request||(a=new r.Request(a));return a.generate(b)}).then(function(b){h.PrivateKeyInfo.call(c,
b);return a})}});u.prototype.PKCS8=x;w(h.EncryptedPrivateKeyInfo,K,{getKey:function(a){var b=this,c;return(new k(l)).then(function(){c=new A.EncryptedDataContentInfo({contentType:"encryptedData",version:0,encryptedContentInfo:{contentType:"data",contentEncryptionAlgorithm:b.encryptionAlgorithm,encryptedContent:b.encryptedData}});return c.getEnclosed(a)}).then(function(a){return x.decode(a.content)})},getPrivateKey:function(a){return this.getKey(a).then(function(a){return a.getPrivateKey()})},setKey:function(a,
b,c){var e=this,d;return(new k(l)).then(function(){a=new x(a);d=new A.EncryptedDataContentInfo;return d.encloseContent(b,a.encode(),c||B.providerName)}).then(function(){e.encryptionAlgorithm=d.encryptedContentInfo.contentEncryptionAlgorithm;e.encryptedData=d.encryptedContentInfo.encryptedContent;return e})},setPrivateKey:function(a,b,c){var e=this;return(new x).setPrivateKey(a).then(function(a){return e.setKey(a,b,c)})},generate:function(a,b,c,e){var d=this;return(new k(l)).then(function(){a instanceof
r.Request||(a=new r.Request(a));return a.generate(c)}).then(function(a){return d.setKey(a,b,e)}).then(function(){return a})}});u.prototype.PKCS8Encrypted=K;w(y,D,{getEncryptionKey:function(a){var b=q["SC-01"].wrapping,c=q["SC-01"].encryption,e=q["SC-01"].derivation,d=this["masks.db3"],v=this["mk.db3"],g=this["kek.opq"];return(new k(l)).then(function(){if(!d||!v||!g)throw Error("Not enougth key container files");if(32<d.byteLength){if(a)return f.importKey("raw",C.Chars.decode(a),e,!1,["deriveKey",
"deriveBits"]).then(function(a){return f.deriveKey(p(e,{salt:new Uint8Array([0,0,0,0,0,0,0,0])}),a,c,!1,["decrypt"])}).then(function(a){return(new A.EncryptedDataContentInfo(d)).getEnclosed(a)}).then(function(a){return a.verify()}).then(function(a){return a.content});throw Error("Key password is required");}if(a)throw Error("Key password is not required");return d}).then(function(a){d=a;a=new Uint8Array(v.byteLength+d.byteLength);a.set(new Uint8Array(v),0);a.set(new Uint8Array(d),v.byteLength);return f.importKey("raw",
a.buffer,b,!1,["unwrapKey"])}).then(function(a){return f.unwrapKey("raw",g,a,b,c,!1,["wrapKey","unwrapKey"])})},generateContainer:function(a){var b=this,c=q["SC-01"].wrapping,e=q["SC-01"].encryption,d=q["SC-01"].derivation,v=q["SC-01"].digest,g,h;return(new k(l)).then(function(){return f.generateKey(c,!0,["wrapKey"])}).then(function(c){h=c;c=h.buffer.byteLength;b["mk.db3"]=(new Uint8Array(new Uint8Array(h.buffer,0,c-32))).buffer;c=(new Uint8Array(new Uint8Array(h.buffer,c-32,32))).buffer;if(a){var g=
new A.EncryptedDataContentInfo,k=new A.DigestedDataContentInfo;return k.encloseContent(c,v).then(function(){k={contentType:"digestedData",content:k.encode()};return f.importKey("raw",C.Chars.decode(a),d,!1,["deriveKey","deriveBits"])}).then(function(a){return f.deriveKey(p(d,{salt:new Uint8Array([0,0,0,0,0,0,0,0])}),a,e,!1,["encrypt"])}).then(function(a){return g.encloseContent(k,a,e)}).then(function(){return g.encode()})}return c}).then(function(a){b["masks.db3"]=a;return f.generateKey(e,!1,["wrapKey",
"unwrapKey"])}).then(function(a){g=a;return f.wrapKey("raw",a,h,c)}).then(function(a){b["kek.opq"]=a;return f.generateKey(e,!1,["wrapKey","unwrapKey"])}).then(function(a){return f.wrapKey("raw",a,h,c)}).then(function(a){b["rand.opq"]=a;return g})}});u.prototype.SignalComKeyContainer=D;w(h.GostWrappedPrivateKey,H,{getKey:function(a){return this.getPrivateKey(a).then(function(a){return(new x).setPrivateKey(a)})},getPrivateKey:function(a){var b=this,c=q["SC-01"].wrapping,e;return(new k(l)).then(function(){return b.getEncryptionKey(a,
!0)}).then(function(a){return f.unwrapKey("raw",b.privateKeyWrapped,a,c,b.privateKeyAlgorithm,!0,["sign","deriveKey","deriveBits"])}).then(function(a){return(e=b.attributes&&b.attributes["id-sc-gostR3410-2001-publicKey"])?f.generateKey(p(a.algorithm,{ukm:a.buffer}),a.extractable,a.usages):{privateKey:a}}).then(function(a){if(e&&!z(a.publicKey.buffer,e))throw Error("Check public key failed");return a.privateKey})},setKey:function(a,b){var c=this;return(new x(a)).getPrivateKey().then(function(a){return c.setPrivateKey(a,
b)})},setPrivateKey:function(a,b){var c=this,e=q["SC-01"].wrapping,d;return(new k(l)).then(function(){return c.getEncryptionKey(b)["catch"](function(){return c.generateContainer(b)})}).then(function(b){return f.wrapKey("raw",a,b,e)}).then(function(b){d=b;return f.generateKey(p(a.algorithm,{ukm:a.buffer}),!0,["sign","verify"])}).then(function(b){c.object={version:0,privateKeyAlgorithm:a.algorithm,privateKeyWrapped:d,attributes:{"id-sc-gostR3410-2001-publicKey":b.publicKey.buffer}};return c})},changePassword:function(a,
b){var c=this;return c.getPrivateKey(a).then(function(a){return c.setPrivateKey(a,b)})},generate:function(a,b,c){var e=this,d;return(new k(l)).then(function(){a instanceof r.Request||(a=new r.Request(a));return a.generate(c)}).then(function(a){d=a;return e.setKey(d,b)}).then(function(){return a})}});E(H.prototype,D.prototype);u.prototype.SignalComPrivateKeyInfo=H;w(y,L,function(){function a(a){return 0<=a.name.indexOf("-512")||512===a.length}function b(a){return!(0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||
1994===a.version||2001===a.version)}function c(a,c,I){var d={name:"CPKDF",hash:b(a)?"GOST R 34.11-256":"GOST R 34.11-94/"+(a.sBox||"D-A"),salt:I,iterations:c?2E3:2};return f.importKey("raw",G(d,c),d,!1,["deriveKey","deriveBits"]).then(function(a){return f.deriveKey(d,a,"GOST 28147",!1,["sign","verify","encrypt","decrypt"])})}function e(a,b,I){var d=p({name:"GOST 28147-MAC"},a.encParams);return c(a,b,I).then(function(a){return f.sign(d,a,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]))})}function d(a,
b){var c=p({name:"GOST 28147-MAC"},a.encParams),d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return f.importKey("raw",d,c,!1,["sign"]).then(function(a){return f.sign(c,a,b.encode())})}function v(a,b,c){var d=p({name:"GOST 28147-MAC"},a.encParams);a=64===b.byteLength?(new Uint8Array(new Uint8Array(b,32,32))).buffer:b;return f.importKey("raw",a,d,!1,["sign"]).then(function(a){return f.sign(d,a,c)})}function g(b){var c=F(a(b)?64:32),d=F(12);return v(b,c,d).then(function(a){return new h.GostPrivateMasks({mask:c,
randomStatus:d,hmacRandom:a})})}function n(a){return f.generateKey(p(a.algorithm,{ukm:a.buffer}),!0,["sign","verify"]).then(function(a){return(new Uint8Array(new Uint8Array(a.publicKey.buffer,0,8))).buffer})}function q(a,b,c,d,e){var m={name:"GOST 28147-ECB",sBox:a.encParams&&a.encParams.sBox},t=p(a,{mode:"KW"}),g;t.name=t.name.replace("-DH","");var h;return f.decrypt(m,b,c).then(function(a){h=a;return f.importKey("raw",d,t,"false",["sign","unwrapKey"])}).then(function(b){return f.unwrapKey("raw",
h,b,t,a,"true",["sign"])}).then(function(a){g=a;return n(g)}).then(function(a){if(!z(a,e))throw Error("Incorrect fp");return g})}function u(a,b,c,d){var e={name:"GOST 28147-ECB",sBox:a.encParams&&a.encParams.sBox},m=p(a,{mode:"KW"});m.name=m.name.replace("-DH","");return f.importKey("raw",d,m,!1,["sign","wrapKey"]).then(function(a){return f.wrapKey("raw",c,a,m)}).then(function(a){return f.encrypt(e,b,a)})}function w(a,b,d,e,s){var f=a.primaryPrivateKeyParameters.privateKeyAlgorithm;return(new k(l)).then(function(){if(b.hmacKey)throw Error("Old key format");
if(12>d.randomStatus.byteLength)throw Error("Invalid random status length");return v(f,d.mask,d.randomStatus)}).then(function(a){if(!z(a,d.hmacRandom))throw Error("Imita for mask is invalid");return c(f,e,new Uint8Array(d.randomStatus,0,12))}).then(function(c){return s&&b.secondaryKey?q(a.secondaryPrivateKeyParameters.privateKeyAlgorithm,c,b.secondaryKey,d.mask,a.secondaryFP):q(f,c,b.primaryKey,d.mask,a.primaryFP)})}function y(a,b,d,e,f,g){return c(a,e,new Uint8Array(d.randomStatus,0,12)).then(function(b){return u(a,
b,g,d.mask)}).then(function(a){b||(b=new h.GostPrivateKeys);f?b.secondaryKey=a:b.primaryKey=a;return b})}return{getKey:function(a,b){return this.getPrivateKey(a,b).then(function(a){return(new x).setPrivateKey(a)})},getPrivateKey:function(a,b){var c=this,d=c.header.keyContainerContent;return w(d,c.primary,c.masks,a,b)["catch"](function(e){if(c.primary2&&c.masks2)return w(d,c.primary2,c.masks2,a,b);throw e;})},getCertificate:function(a){var b=this.header.keyContainerContent;return(new k(l)).then(function(){return a?
new r.X509(b.secondaryCertificate):new r.X509(b.primaryCertificate)})},getContainerName:function(){return this.name.containerName},setKey:function(a,b,c,d){var e=this;return(new x(a)).getPrivateKey().then(function(a){return e.setPrivateKey(a,b,c,d)})},setPrivateKey:function(a,b,c,f){var s=this,m,t;return(new k(l)).then(function(){s.header=s.header||new h.GostKeyContainer({keyContainerContent:{containerAlgoritmIdentifier:{algorithm:"id-CryptoPro-GostPrivateKeys-V2-Full"},attributes:["kccaReservePrimary",
"kccaPrimaryKeyAbsent"],extensions:{keyValidity:{notAfter:J(f||B.days)}}}});m=s.header.keyContainerContent;var b=c?m.secondaryPrivateKeyParameters:m.primaryPrivateKeyParameters;if(b)t=b.privateKeyAlgorithm;else if(t=p(a.algorithm,{sBox:"D-A",encParams:{block:"CFB",sBox:"E-A",keyMeshing:"CP"}}),b={attributes:["pkaExportable","pkaExchange","pkaDhAllowed"],privateKeyAlgorithm:t},c){if(!m.primaryPrivateKeyParameters)throw Error("Primary key must be defined first");m.secondaryPrivateKeyParameters=b}else m.primaryPrivateKeyParameters=
b,b=m.attributes.indexOf("kccaPrimaryKeyAbsent"),0<=b&&m.attributes.splice(b,1);var d=[];[0,1].forEach(function(a){var b="masks"+(0<a?"2":"");s[b]||d.push(g(t).then(function(a){s[b]=a}))});return k.all(d)}).then(function(){var d=[];[0,1].forEach(function(e){var f="primary"+(0<e?"2":"");d.push(y(t,s[f],s["masks"+(0<e?"2":"")],b,c,a).then(function(a){s[f]=a}))});return k.all(d)}).then(function(){return n(a).then(function(a){c?m.secondaryFP=a:m.primaryFP=a})}).then(function(){var a=m.attributes.indexOf("kccaSoftPassword");
if(b)return 0>a&&m.attributes.push("kccaSoftPassword"),e(t,b,m.primaryFP);0<=a&&m.attributes.splice(a,1)}).then(function(a){a&&(m.hmacPassword=a);return d(t,m)}).then(function(a){s.header.hmacKeyContainerContent=a;return s})},setCertificate:function(a,b,c){var e=this,f,g;return(new k(l)).then(function(){e.header=e.header||new h.GostKeyContainer({keyContainerContent:{containerAlgoritmIdentifier:{algorithm:"id-CryptoPro-GostPrivateKeys-V2-Full"},attributes:["kccaReservePrimary","kccaPrimaryKeyAbsent"],
extensions:{keyValidity:{notAfter:J(c||B.days)}}}});f=e.header.keyContainerContent;a=new r.X509(a);g=f.primaryPrivateKeyParameters&&f.primaryPrivateKeyParameters.privateKeyAlgorithm||p(a.subjectPublicKeyInfo.algorithm,{sBox:"D-A",encParams:{block:"CFB",sBox:"E-A",keyMeshing:"CP"}});return a.getPublicKey()}).then(function(c){if(b){if(f.secondaryFP&&!z(f.secondaryFP,new Uint8Array(c.buffer,0,f.secondaryFP.byteLength)))throw Error("The public key of the certificate does not match the private key");f.secondaryCertificate=
a}else{if(f.primaryFP&&!z(f.primaryFP,new Uint8Array(c.buffer,0,f.primaryFP.byteLength)))throw Error("The public key of the certificate does not match the private key");f.primaryCertificate=a}return d(g,f)}).then(function(a){e.header.hmacKeyContainerContent=a;return e})},setContainerName:function(a){this.name=new h.GostKeyContainerName({containerName:a})},verify:function(a){var b=this,c,f;return(new k(l)).then(function(){c=b.header.keyContainerContent;f=c.primaryPrivateKeyParameters.privateKeyAlgorithm;
return d(f,c)}).then(function(d){if(!z(d,b.header.hmacKeyContainerContent))throw Error("Container is not valid.");d=0<=c.attributes.indexOf("kccaSoftPassword");if(!a&&d)throw Error("Password is required");if(a&&!d)throw Error("Password is not reqiured.");return a?e(f,a,c.primaryFP).then(function(a){if(!z(a,c.hmacPassword))throw Error("Password is not valid.");return b}):b})},changePassword:function(a,b){var c=this,d;return(new k(l)).then(function(){d=c.header.keyContainerContent;if(!d.primaryPrivateKeyParameters)throw Error("Private key not yet defined");
return c.getPrivateKey(a).then(function(a){return c.setPrivateKey(a,b)})}).then(function(){return d.secondaryPrivateKeyParameters?c.getPrivateKey(a,!0).then(function(a){return c.setPrivateKey(a,b,!0)}):c})},generate:function(a,b,c){var d=this,e,f;return(new k(l)).then(function(){a instanceof r.Request||(a=new r.Request(a));return a.generate(c)}).then(function(a){f=a;return d.setKey(f,b)}).then(function(){e=new r.X509(a);return e.sign(f)}).then(function(){return d.setCertificate(e)}).then(function(){return a})},
encode:function(a){return{header:this.header.encode(a),name:this.name.encode(a),masks:this.masks.encode(a),primary:this.primary.encode(a),masks2:this.masks2.encode(a),primary2:this.primary2.encode(a)}}}}());u.prototype.CryptoProKeyContainer=L;w(h.PFX,M,{encloseContent:function(a,b,c){var e=this;return(new k(l)).then(function(){a=new h.AuthenticatedSafe(a);e.authSafe={contentType:"data",content:a.encode()};if(void 0!==b){var d,k,g,l;(l=c?q[c]:q[B.providerName])?(d=l.digest,g=l.derivation,k=l.hmac):
(d=c,g={name:0<=d.name.indexOf("SHA")?"PFXKDF":"PBKDF2",hash:d,iterations:2E3,diversifier:3},k={name:"HMAC",hash:d});g=p(g,{salt:F(O(d))});return f.importKey("raw",G(g,b),g,!1,["deriveKey"]).then(function(a){return f.deriveKey(g,a,k,!1,["verify"])}).then(function(a){return f.sign(k,a,e.autoSafe.content)}).then(function(a){e.macData={mac:{digestAlgorithm:d,digest:a},macSalt:g.salt,iterations:g.iterations};return e})}})},verify:function(a){var b=this,c=b.authSafe;return(new k(l)).then(function(){if("data"===
c.contentType){if(b.macData){if("string"!==typeof a)throw Error("Password must be defined for the MAC verification");var e=b.macData.mac.digestAlgorithm,d={name:0<=e.name.indexOf("SHA")?"PFXKDF":"PBKDF2",hash:e,salt:b.macData.macSalt,iterations:b.macData.iterations,diversifier:3},h={name:"HMAC",hash:e};return f.importKey("raw",G(d,a),d,!1,["deriveKey"]).then(function(a){return f.deriveKey(d,a,h,!1,["verify"])}).then(function(a){return f.verify(h,a,b.macData.mac.digest,c.content)}).then(function(a){if(!a)throw Error("MAC is not verified");
return b})}}else throw Error("Unsupported format");})}});u.prototype.PKCS12=M;n.keys=new u;return u});
