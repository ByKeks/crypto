/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(B,x){"function"===typeof define&&define.amd?define(["gostObject","gostCoding"],x):"object"===typeof exports?module.exports=x(require("gostObject"),require("gostCoding")):B.gostSyntax=x(B.gostObject,B.gostCoding)})(this,function(B,x){function D(a){return(B||(B=E.gostObject)).algorithms[a]}function Da(a){return(B||(B=E.gostObject)).names[a]}function ab(a){return(B||(B=E.gostObject)).identifiers[a]}function ba(a){return(B||(B=E.gostObject)).attributes[a]}function ca(a){return(B||(B=E.gostObject)).parameters[a]}
function T(){return(x||(x=E.gostCoding)).BER}function U(){return(x||(x=E.gostCoding)).Hex}function w(){for(var a={},c=0,l=arguments.length;c<l;c++){var b=arguments[c];if("object"===typeof b)for(var d in b)a[d]=b[d]}return a}function V(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),l=0,b=a.length;l<b;l++)c[b-l-1]=a[l];return c.buffer}function N(a,c,l,b){var d;if("undefined"===typeof a)throw new I("Invalid value");null===a?d=new String(""):"string"===typeof a||
a instanceof String?d=new String(a.toString()):"number"===typeof a||a instanceof Number?d=new Number(a.toString()):"boolean"===typeof a||a instanceof Boolean?d=new Boolean(a?!0:!1):a instanceof Array?d=a.slice(0):a instanceof Date?d=new Date(a.getTime()):a instanceof ArrayBuffer?d=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(d=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);d.tagNumber="undefined"!==typeof c?c:5;d.tagClass="undefined"!==
typeof l?l:0;d.tagConstructed="undefined"!==typeof b?b:!1;return d}function O(a,c,l,b){if("undefined"===typeof a)throw new I("Invalid value");l="undefined"!==typeof l?l:0;b="undefined"!==typeof b?b:!1;if(void 0!==a.tagClass&&(c!==a.tagNumber&&!(c instanceof Array&&0<=c.indexOf(a.tagNumber))||l!==a.tagClass||b!==a.tagConstructed))throw new I("Invalid format");b=a;0===l&&5===c?b=null:a instanceof String?b=a.toString():a instanceof Number?b=parseFloat(a):a instanceof Boolean?b=a?!0:!1:a instanceof Array?
(b=a.slice(0),b.buffer=a.buffer?a.buffer:(new Uint8Array(new Uint8Array(a.header.buffer,a.header.byteOffset,a.header.byteLength+a.content.byteLength))).buffer):a instanceof Date?b=new Date(a.getTime()):a instanceof ArrayBuffer?b=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(b=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);return b}var E=this,I=E.DataError||Error,bb=E.NotSupportedError||Error,P=function(a){return{encode:function(c){return N(c,
a)},decode:function(c){return O(c,a)}}},W=P(1),Ea=P(22),cc=P(19),dc=P(20),Q=P(12),ec=P(23),J=P(24),fc=P(28),cb=P(30),ma={encode:function(){return N(null,5)},decode:function(a){return O(a,5)}},db=function(a){var c=P(a);a=function(a){return{encode:function(b){b=a[b];if("undefined"===typeof b)throw new I("Invalid value");return c.encode(b)},decode:function(b){b=c.decode(b);for(var d in a)if(b===a[d])return d}}};a.encode=c.encode;a.decode=c.decode;return a},g=db(2),eb=db(10),fb=function(a,c){var b=function(b){c&&
c.call&&(b=c(b));return{encode:function(c){b&&(c=b.encode(c));return N(c,a)},decode:function(c){c=O(c,a);b&&(c=b.decode(c));return c}}};b.encode=function(c){return N(c,a)};b.decode=function(c){return O(c,a)};return b},h=fb(4),q=fb(3,function(a){if(!a||a.encode&&a.decode)return a;var c=[],b;for(b in a)c[a[b]]=b;return{encode:function(a){if(a instanceof Array){for(var b="",l=0;l<c.length;l++)b=c[l]&&0<=a.indexOf(c[l])?b+"1":b+"0";for(;1<b.length&&"0"===b.charAt(b.length-1);)b=b.substring(0,b.length-
1)}else b="0";return b},decode:function(a){for(var b=[],l=0;l<a.length;l++)"1"===a.charAt(l)&&c[l]&&b.push(c[l]);return b}}}),d=function(a){return{encode:function(c){var b=[],d;for(d in a){var e=a[d].encode(c[d]);void 0!==e&&b.push(e)}return N(b,16,0,!0)},decode:function(c){c=O(c,16,0,!0);var b={},d=0,e;for(e in a){var f=a[e].decode(c[d]);void 0!==f&&(b[e]=f,d++)}b.buffer=c.buffer;return b}}},k={encode:function(a){if(!/^(\d+\.)+\d+$/.test(a)&&(a=ab(a),!a))throw new I("Invalid object identifier value");
return N(a,6)},decode:function(a){a=O(a,6);return Da(a)||a}},b=function(a,c){return{encode:function(b){b=c.encode(b);return N(b,a,2,b instanceof Array)},decode:function(b){return c.decode(O(b,a,2,b instanceof Array))}}},gb=function(a){return function(c,b,d){c=c||y;var e=function(e,f){var g=c.call?c(e):c;return{encode:function(c){var d=[];if(b)for(var e in c)"buffer"!==e&&d.push(g.encode(b(e,c[e],f)));else{e=0;for(var h=c.length;e<h;e++)d.push(g.encode(c[e]))}return N(d,a,0,!0)},decode:function(c){var b=
d?{}:[];c=O(c,a,0,!0);if(d)for(var l=0;l<c.length;l++)d(b,g.decode(c[l]));else for(var l=0,e=c.length;l<e;l++)b.push(g.decode(c[l]));b.buffer=c.buffer;return b}}};e.encode=function(b){for(var l=[],d=0,e=b.length;d<e;d++)l.push(c.encode(b[d]));return N(l,a,0,!0)};e.decode=function(b){b=O(b,a,0,!0);for(var l=[],d=0,e=b.length;d<e;d++)l.push(c.decode(b[d]));l.buffer=b.buffer;return l};return e}},m=gb(16),C=gb(17),F=function(a){return{encode:function(c){return N([a.encode(c)],17,0,!0)},decode:function(c){c=
O(c,17,0,!0);return a.decode(c[0])}}},p=function(a,c,b){return a instanceof Array?{encode:function(d){if(c){var e=c(d);if(void 0!==e&&0<=e&&e<a.length){var f=b?b.encode(d,e):d,g=a[e].encode(f);if(void 0!==g)return g}}for(e=0;e<a.length;e++)try{if(f=b?b.encode(d,e):d,g=a[e].encode(f),void 0!==g)return g}catch(h){}throw new I("Invalid format");},decode:function(c){for(var d=0;d<a.length;d++)try{var e=a[d].decode(c);if(void 0!==e)return b?b.decode(e,d):e}catch(f){}throw new I("Invalid format");}}:{encode:function(c){for(var b in a){var d=
c[b];if(void 0!==d)return a[b].encode(d)}throw new I("Invalid format");},decode:function(c){var b={},d;for(d in a)try{var l=a[d].decode(c);if(void 0!==l)return b[d]=l,b}catch(e){}throw new I("Invalid format");}}},K=function(){var a=function(a){return{encode:function(b){b=a.encode(b);return T().encode(b)},decode:function(b){b=T().decode(b);return a.decode(b)}}};a.encode=function(a){return T().encode(a)};a.decode=function(a){return T().decode(a)};return a}(),f=function(a){return{encode:function(c){return a.encode(c)},
decode:function(c){return a.decode(c)}}},t=function(a){return{encode:function(c){return[a.encode(c)]},decode:function(c){return a.decode(c[0])}}},y={encode:function(a){return a},decode:function(a){return a}},L=function(a,c){return{encode:function(b){return b===c||void 0===b?void 0:a.encode(b)},decode:function(b){if(void 0===b)return c;try{return a.decode(b)}catch(d){}}}},e=function(a){return{encode:function(c){return void 0===c?void 0:a.encode(c)},decode:function(c){if(void 0!==c)try{return a.decode(c)}catch(b){}}}},
hb=function(a,c,b){b=b||y;var d=function(d,e){d=d||{};e=e||b;var f=function(a){var c;d&&(c=d.call?d(a):d[a]);return c||e};return{encode:function(b){var d=f(c.encode(b));return a(d).encode(b)},decode:function(b){var d=f(c.decode(b));return a(d).decode(b)}}};d.encode=function(c){return a(b).encode(c)};d.decode=function(c){return a(b).decode(c)};return d},X=function(a,c,b,e){c=c||"type";b=b||k;return hb(function(c){return d(a(c))},{encode:function(a){return a[c]},decode:function(a){return b.decode(a[0])}},
e)},da=p([Q,cc,dc,fc,cb],function(a){if(a&&1<a.length){var c=a.charCodeAt(a.length-1);if(5>c)return c}return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?1:0},{encode:function(a){return a.replace(/[\u0000-\u0004]/g,"")},decode:function(a,c){return a+String.fromCharCode(c)}}),Y=p([J,ec],function(a){return 2050<=a.getYear()?0:1}),Fa=y,Ga=X(function(a){return{type:k,value:a}},"type",k,Fa),ib=F(Ga({emailAddress:Ea,domainComponent:Ea},da)),gc=m(ib,function(a,c){return{type:a,
value:c}},function(a,c){a[c.type]=c.value})(),R=p([gc]),hc=function(){var a={commonName:"CN",serialName:"SN",countryName:"C",localityName:"L",stateOrProvinceName:"ST",streetAddress:"STREET",organizationName:"O",organizationalUnitName:"OU",title:"TITLE",name:"NAME",givenName:"GNAME",initials:"INITIALS",distinguishedName:"DN",emailAddress:"EMAIL"},c=[],b;for(b in a)c[a[b]]=b;return{encode:function(c){var b=[],d;for(d in c)"buffer"!==d&&b.push((a[d]||ab(d))+"="+c[d]);return b.join(",")},decode:function(a){a=
a.split(",");for(var b=0,d=a.length;b<d;b++){var e=a[b].split("="),l=e[0].trim();e[1].trim();c[l]||Da(l)}}}}(),ic=d({notBefore:Y,notAfter:Y}),jb=X(function(a){return{type:k,value:a}}),G=C(jb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),Ha=m(jb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),jc=d({a:g,b:g,seed:e(q)}),kc=h({encode:function(a){return U().decode("04"+a.x.replace("0x","")+a.y.replace("0x",""))},decode:function(a){a=U().encode(a).replace(/[^A-fa-f0-9]/g,
"").substring(2);return{x:"0x"+a.substring(0,a.length/2),y:"0x"+a.substring(a.length/2)}}}),lc=d({fieldType:k,parameters:g}),mc=d({version:g,fieldID:lc,curve:jc,base:kc,order:g,cofactor:e(g)}),nc=d({publicKeyParamSet:k,digestParamSet:k,encryptionParamSet:L(k,"id-Gost28147-89-CryptoPro-A-ParamSet")}),oc=function(a,c){return{encode:function(b){return b===c||void 0===b?ma.encode(null):a.encode(b)},decode:function(b){return void 0===b?void 0:null===b?c:a.decode(b)}}}(k,"id-GostR3411-94-CryptoProParamSet"),
pc=p({namedParameters:k,ecParameters:mc,implicitly:e(ma)}),n=function(){var a=function(a){return d({algorithm:k,parameters:e(a)})},c=function(c){return{encode:function(b){var d=c[b.id];if(d)return a(d.paramType).encode(d.encode(b));throw new bb("Algorithm not supported");},decode:function(b){var d=c[Da(b[0])];if(d)return d.decode(a(d.paramType).decode(b));throw new bb("Algorithm not supported");}}};c.encode=function(c){return a(y).encode(c)};c.decode=function(c){return a(y).decode(c)};return c}(),
Z={paramType:pc,encode:function(a){var c;c="string"===typeof a.namedCurve?{namedParameters:ba("namedCurve")[a.namedCurve]}:{ecParameters:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.p},curve:{a:a.a,b:a.b},base:{x:a.x,y:a.y},order:a.q,cofactor:1}};return{algorithm:a.id,parameters:c}},decode:function(a){var c=a.parameters;a=D(a.algorithm);if(c.namedParameters)a=w(a,ca(c.namedParameters));else if(c.ecParameters)a=w(a,{p:c.ecParameters.fieldID.parameters,a:c.ecParameters.curve.a,b:c.ecParameters.curve.b,
x:c.ecParameters.base.x,y:c.ecParameters.base.y,q:c.ecParameters.order});else throw new I("Invalid key paramters");return a}},H={paramType:nc,encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:ba(c)[a[c]],digestParamSet:ba("sBox")[b]}}},decode:function(a){var c=a.parameters;
return w(D(a.algorithm),ca(c.publicKeyParamSet),ca(c.digestParamSet))}},r={encode:function(a){return{algorithm:a.id}},decode:function(a){return D(a.algorithm)}},u={paramType:ma,encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return D(a.algorithm)}},kb={paramType:oc,encode:function(a){return{algorithm:a.id,parameters:ba("sBox")[a.sBox||"D-A"]}},decode:function(a){return w(D(a.algorithm),ca(a.parameters))}},sa=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":H,
"id-GostR3410-94":H,"id-tc26-gost3410-12-256":H,"id-tc26-gost3410-12-512":H}),M=n({noSignature:u,rsaEncryption:u,sha1withRSAEncryption:u,sha256withRSAEncryption:u,sha384withRSAEncryption:u,sha512withRSAEncryption:u,ecdsa:r,"ecdsa-with-SHA1":r,"ecdsa-with-SHA256":r,"ecdsa-with-SHA384":r,"ecdsa-with-SHA512":r,"id-GostR3410-94":u,"id-GostR3410-2001":u,"id-GostR3411-94-with-GostR3410-2001":r,"id-GostR3411-94-with-GostR3410-94":r,"id-tc26-gost3410-12-256":u,"id-tc26-gost3410-12-512":u,"id-tc26-signwithdigest-gost3410-12-94":r,
"id-tc26-signwithdigest-gost3410-12-256":r,"id-tc26-signwithdigest-gost3410-12-512":r,"id-sc-gostR3410-94":u,"id-sc-gostR3410-2001":u,"id-sc-gostR3411-94-with-gostR3410-94":u,"id-sc-gostR3411-94-with-gostR3410-2001":u}),ea=n({sha1:u,sha256:u,sha384:u,sha512:u,"id-GostR3411-94":kb,"id-tc26-gost3411-94":kb,"id-tc26-gost3411-12-256":u,"id-tc26-gost3411-12-512":u,"id-sc-gostR3411-94":r}),lb=d({iv:h,encryptionParamSet:k}),qc=d({encryptionParamSet:k,ukm:e(h)}),mb={paramType:lb,encode:function(a){return{algorithm:a.id,
parameters:{iv:a.iv,encryptionParamSet:ba("sBox")[a.sBox||"E-A"]}}},decode:function(a){var c=w(D(a.algorithm),ca(a.parameters.encryptionParamSet));c.iv=a.parameters.iv;return c}},nb={paramType:h,encode:function(a){return{algorithm:a.id,parameters:a.iv}},decode:function(a){var c=w(D(a.algorithm));c.iv=a.parameters||new Uint8Array([0,0,0,0,0,0,0,0]);return c}},fa={paramType:qc,encode:function(a){return{algorithm:a.id,parameters:{encryptionParamSet:ba("sBox")[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=
w(D(a.algorithm),ca(a.parameters.encryptionParamSet));a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}},ob=n({"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa}),$={paramType:ob,encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=w(D(a.algorithm));c.wrapping=a.parameters;return c}},ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":H,"id-GostR3410-94":H,"id-tc26-gost3410-12-256":H,"id-tc26-gost3410-12-512":H,
"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r}),rc=n({"id-sc-gost28147-gfb":nb,"id-Gost28147-89":mb}),Ia=n({"id-Gost28147-89-MAC":lb,"id-HMACGostR3411-94":r,"id-tc26-hmac-gost-3411-12-256":r,"id-tc26-hmac-gost-3411-12-512":r,hmacWithSHA1:r,hmacWithSHA224:r,
hmacWithSHA256:r,hmacWithSHA384:r,hmacWithSHA512:r,"id-sc-gost28147-mac":r,"id-sc-hmacWithGostR3411":r}),sc={paramType:d({salt:p({specified:h,otherSource:n}),iterationCount:g,keyLength:e(g),prf:Ia}),encode:function(a){return{algorithm:a.id,parameters:{salt:{specified:a.salt},iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=w(D(a.algorithm));c.salt=a.parameters.salt.specified;c.iterations=a.parameters.iterationCount;c.hmac=a.parameters.prf;return c}},Ja=n({PBKDF2:sc}),s={paramType:d({salt:h,
iterationCount:g}),encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=w(D(a.algorithm));c.derivation=w(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}},Ka={paramType:d({keyDerivationFunc:Ja,encryptionScheme:rc}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,encryptionScheme:a.encryption}}},decode:function(a){var c=w(D(a.algorithm));
c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}};n({"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Ka});var tc={paramType:d({keyDerivationFunc:Ja,messageAuthScheme:Ia}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,
messageAuthScheme:a.hmac}}},decode:function(a){var c=w(D(a.algorithm));c.derivation=a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;return c}};n({PBMAC1:tc});var uc=n({"id-sc-gost28147-gfb":nb,"id-Gost28147-89":mb,"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Ka}),
ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":H,"id-GostR3410-94":H,"id-tc26-gost3410-12-256":H,"id-tc26-gost3410-12-512":H,"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r,"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,
"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Ka}),vc=h({encode:function(a){var c=new Uint8Array(a.byteLength+1),b=V(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){var c=new Uint8Array(a.byteLength-1),b=c.byteLength/2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,
1,b),b);return V(c)}}),aa=d({algorithm:sa,subjectPublicKey:q}),La=function(a){return{encode:function(c){return aa.encode({algorithm:c.algorithm,subjectPublicKey:K.encode(a[c.algorithm.id].encode(c.buffer))})},decode:function(c){c=aa.decode(c);return{algorithm:c.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a[c.algorithm.id].decode(K.decode(c.subjectPublicKey))}}}}({"id-sc-gostR3410-2001":vc,"id-sc-gostR3410-94":{encode:function(a){return g.encode((x||(x=
E.gostCoding)).Int16.encode(V(a)))},decode:function(a){return V((x||(x=E.gostCoding)).Int16.decode(g.decode(a)))}},"id-GostR3410-2001":h,"id-GostR3410-94":h,"id-tc26-gost3410-12-256":h,"id-tc26-gost3410-12-512":h}),pb={encode:function(a){return K(g).encode("0x"+U().encode(a,!0))},decode:function(a){return U().decode(K(g).decode(a).replace("0x",""),!0)}},ta=y,na=d({version:g,privateKeyAlgorithm:sa,privateKey:h,attributes:e(b(0,f(G)))}),wc=d({version:g,privateKeyAlgorithm:sa,privateKey:h,attributes:e(b(0,
f(G))),publicKey:e(b(1,f(q)))}),xc=m(wc),yc=function(a){return{encode:function(c){return na.encode({version:0,privateKeyAlgorithm:c.algorithm,privateKey:a[c.algorithm.id].encode(c.buffer)})},decode:function(c){c=na.decode(c);return{algorithm:c.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:a[c.privateKeyAlgorithm.id].decode(c.privateKey)}}}}({"id-sc-gostR3410-2001":pb,"id-sc-gostR3410-94":pb,"id-GostR3410-2001":ta,"id-GostR3410-94":ta,"id-tc26-gost3410-12-256":ta,
"id-tc26-gost3410-12-512":ta}),qb=d({encryptionAlgorithm:ga,encryptedData:h}),zc=d({cA:L(W,!1),pathLenConstraint:e(g)}),Ac=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Bc=m(k),Cc=m({type:k,value:b(0,t(y))}),Dc=d({nameAssigner:e(b(0,f(da))),partyName:e(b(1,f(da)))}),Ec=d({}),z=p({otherName:b(0,f(Cc)),rfc822Name:b(1,f(da)),dNSName:b(2,f(da)),x400Address:b(3,f(Ec)),directoryName:b(4,t(R)),ediPartyName:b(5,
f(Dc)),uniformResourceIdentifier:b(6,f(da)),iPAddress:b(7,f(h)),registeredID:b(8,f(k))}),A=m(z),Ma=d({keyIdentifier:e(b(0,f(h))),authorityCertIssuer:e(b(1,f(A))),authorityCertSerialNumber:e(b(2,f(g)))}),Fc=d({notBefore:e(b(0,f(J))),notAfter:e(b(1,f(J)))}),Gc=d({policyQualifierId:k,qualifier:y}),Hc=d({policyIdentifier:k,policyQualifiers:e(m(Gc))}),Ic=d({issuerDomainPolicy:k,subjectDomainPolicy:k}),Jc=d({base:z,minimum:L(b(0,f(g)),0),maximum:e(b(1,f(g)))}),rb=m(Jc),Kc=d({permittedSubtrees:e(b(0,f(rb))),
excludedSubtrees:e(b(1,f(rb)))}),Lc=d({requireExplicitPolicy:e(b(0,f(g))),inhibitPolicyMapping:e(b(1,f(g)))}),Na=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),sb=p({fullName:b(0,f(A)),nameRelativeToCRLIssuer:b(1,f(ib))}),Mc=d({distributionPoint:e(b(0,t(sb))),reasons:e(b(1,f(Na))),cRLIssuer:e(b(2,f(A)))}),ua=m(Mc),Oa=d({accessMethod:k,accessLocation:z}),tb=X(function(a){return{extnID:k,critical:L(W,
!1),extnValue:h(K(a))}},"extnID"),oa=m(tb,function(a,c,b){return{extnID:a,critical:b&&b(a,c),extnValue:c}},function(a,c){return a[c.extnID]=c.extnValue}),va=oa({authorityKeyIdentifier:Ma,subjectKeyIdentifier:h,keyUsage:Ac,privateKeyUsagePeriod:Fc,certificatePolicies:m(Hc),policyMappings:m(Ic),subjectAltName:A,issuerAltName:A,subjectDirectoryAttributes:Ha,basicConstraints:zc,nameConstraints:Kc,policyConstraints:Lc,extKeyUsage:Bc,cRLDistributionPoints:ua,inhibitAnyPolicy:g,freshestCRL:ua,authorityInfoAccess:m(Oa),
subjectInfoAccess:m(Oa)},function(a,c){return"keyUsage"===a||"basicConstraints"===a&&void 0===c.pathLenConstraint}),wa=function(){var a=d({r:g,s:g});return{encode:function(c){c=V(c);var b=c.byteLength/2,d="0x"+U().encode(new Uint8Array(c,0,b));c="0x"+U().encode(new Uint8Array(c,b,b));return T().encode(a.encode({r:c,s:d}))},decode:function(c){var b=a.decode(T().decode(c));c=new Uint8Array(U().decode(b.r.replace("0x","")));var b=new Uint8Array(U().decode(b.s.replace("0x",""))),d=new Uint8Array(b.length+
c.length);d.set(b,0);d.set(c,b.length);return V(d.buffer)}}}(),S={encode:function(a){return V(a)},decode:function(a){return V(a)}},ub=function(a){return function(c){var b=a[c.id];return{encode:function(a){b&&(a=b.encode(a));return a},decode:function(a){if(a instanceof ArrayBuffer)return b&&(a=b.decode(a)),a;throw new I("Invalid signature value");}}}}({noSignature:h,"id-GostR3410-94":S,"id-GostR3410-2001":S,"id-GostR3411-94-with-GostR3410-2001":S,"id-GostR3411-94-with-GostR3410-94":S,"id-tc26-gost3410-12-256":S,
"id-tc26-gost3410-12-512":S,"id-tc26-signwithdigest-gost3410-12-94":S,"id-tc26-signwithdigest-gost3410-12-256":S,"id-tc26-signwithdigest-gost3410-12-512":S,"id-sc-gostR3410-94":wa,"id-sc-gostR3410-2001":wa,"id-sc-gostR3411-94-with-gostR3410-94":wa,"id-sc-gostR3411-94-with-gostR3410-2001":wa}),ha=function(a){return{encode:function(c){c=w(c);c.signatureValue=ub(c.signatureAlgorithm).encode(c.signatureValue);return a.encode(c)},decode:function(c){c=a.decode(c);c.signatureValue=ub(c.signatureAlgorithm).decode(c.signatureValue);
return c}}},vb=d({version:b(0,t(g)),serialNumber:g,signature:M,issuer:R,validity:ic,subject:R,subjectPublicKeyInfo:aa,issuerUniqueID:e(b(1,f(q))),subjectUniqueID:e(b(2,f(q))),extensions:e(b(3,t(va)))}),xa=ha(d({tbsCertificate:vb,signatureAlgorithm:M,signatureValue:q})),Nc=G({challengePassword:F(da),extensionRequest:F(va),msCertExtensions:F(va),extendedCertificateAttributes:F(G)}),wb=d({version:g,subject:R,subjectPublicKeyInfo:aa,attributes:b(0,f(Nc))}),xb=ha(d({requestInfo:wb,signatureAlgorithm:M,
signatureValue:q})),yb=eb({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),Oc=d({distributionPoint:e(b(0,t(sb))),onlyContainsUserCerts:L(b(1,f(W)),!1),onlyContainsCACerts:L(b(2,f(W)),!1),onlySomeReasons:e(b(3,f(Na))),indirectCRL:L(b(4,f(W)),!1),onlyContainsAttributeCerts:L(b(5,f(W)),!1)}),Pc=oa({authorityKeyIdentifier:Ma,issuerAltName:A,cRLNumber:g,deltaCRLIndicator:g,issuingDistributionPoint:Oc,
freshestCRL:ua},function(a){return"cRLNumber"===a}),Qc=oa({cRLReason:yb,instructionCode:k,invalidityDate:J,certificateIssuer:A}),zb=d({version:e(g),signature:M,issuer:R,thisUpdate:Y,nextUpdate:e(Y),revokedCertificates:e(m(d({userCertificate:g,revocationDate:Y,crlEntryExtensions:e(Qc)}))),crlExtensions:e(b(0,t(Pc)))}),Pa=ha(d({tbsCertList:zb,signatureAlgorithm:M,signatureValue:q})),Qa=d({digestedObjectType:eb({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:e(k),digestAlgorithm:ea,
objectDigest:q}),ya=d({issuer:A,serial:g,issuerUID:e(q)}),Rc=d({issuerName:e(A),baseCertificateID:e(b(0,f(ya))),objectDigestInfo:e(b(1,f(Qa)))}),Sc=d({targetCertificate:ya,targetName:e(z),certDigestInfo:e(Qa)}),Tc=p({targetName:b(0,t(z)),targetGroup:b(1,t(z)),targetCert:b(2,f(Sc))}),Uc=m(Tc),Vc=oa({auditIdentity:h,targetInformation:Uc,authorityKeyIdentifier:Ma,authorityInfoAccess:m(Oa),cRLDistributionPoints:ua,noRevAvail:ma},function(a){return"auditIdentity"===a||"targetInformation"===a}),Wc=d({baseCertificateID:e(b(0,
f(ya))),entityName:e(b(1,f(A))),objectDigestInfo:e(b(2,f(Qa)))}),Xc=p({v1Form:A,v2Form:b(0,f(Rc))}),Ab=d({notBeforeTime:J,notAfterTime:J}),Bb=d({service:z,ident:z,authInfo:e(h)}),Yc=d({roleAuthority:e(b(0,f(A))),roleName:b(1,t(z))}),Zc=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),$c=d({type:b(0,f(k)),value:b(1,f(y))}),ad=d({policyId:b(0,f(k)),classList:L(b(1,f(Zc)),["unclassified"]),securityCategories:e(b(2,f(C($c))))}),Cb=d({policyAuthority:e(b(0,f(A))),values:m(p({octets:h,
oid:k,string:Q}))}),Db=d({version:g,holder:Wc,issuer:Xc,signature:M,serialNumber:g,attrCertValidityPeriod:Ab,attributes:Ha({authenticationInfo:C(Bb),accessIdentity:C(Bb),chargingIdentity:F(Cb),group:F(Cb),role:C(Yc),clearance:C(ad)}),issuerUniqueID:e(q),extensions:e(Vc)}),Eb=ha(d({acinfo:Db,signatureAlgorithm:M,signatureValue:q})),ia=h,pa=h;d({ephemeralPublicKey:Fb,addedukm:e(b(0,t(h)))});d({keyInfo:ob,entityUInfo:e(b(0,t(h))),suppPubInfo:b(2,t(h))});var ja=d({encryptedKey:h,maskKey:e(b(0,f(h))),
macKey:h}),bd=d({encryptionParamSet:k,ephemeralPublicKey:e(b(0,f(La))),ukm:h}),Gb=d({sessionEncryptedKey:ja,transportParameters:e(b(0,f(bd)))}),Hb=d({sessionEncryptedKey:ja,ukm:d({ephemeralPublicKey:La,addedukm:e(b(0,t(h)))})}),Ra=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,8,32))).buffer;a=(new Uint8Array(new Uint8Array(a,40,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(c){var b=a.ukm,d=c.encryptedKey;c=c.macKey;var e=new Uint8Array(b.byteLength+d.byteLength+
c.byteLength);e.set(new Uint8Array(b),0);e.set(new Uint8Array(d),8);e.set(new Uint8Array(c),40);return e}}},ka=function(a){var c=Ra(a);return{encode:function(a){return ja.encode(c.encode(a))},decode:function(a){return c.decode(ja.decode(a))}}},za=function(a){return{encode:function(c){return Gb.encode({sessionEncryptedKey:Ra(a).encode(c),transportParameters:{encryptionParamSet:ba("sBox")[a.wrapping.sBox||"E-A"],ephemeralPublicKey:a["public"],ukm:a.ukm}})},decode:function(c){c=Gb.decode(c);a.wrapping=
ca(c.transportParameters.encryptionParamSet);a.ukm=c.transportParameters.ukm;a["public"]=c.transportParameters.ephemeralPublicKey;return Ra(a).decode(c.sessionEncryptedKey)}}},Sa=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey;a=a.macKey;var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),
32);return d}}},Ib=function(a){return{encode:function(b){return Hb.encode({sessionEncryptedKey:Sa(a).encode(b),ukm:{ephemeralPublicKey:a["public"],addedukm:a.ukm}})},decode:function(b){b=Hb.decode(b);a.ukm=b.ukm.addedukm;a["public"]=b.ukm.ephemeralPublicKey;return Sa(a).decode(b.sessionEncryptedKey)}}},Ta=function(a){var b=Sa(a);return{encode:function(a){return ja.encode(b.encode(a))},decode:function(a){return b.decode(ja.decode(a))}}},Aa=function(a){return function(b){var d=a[b.id],d=d&&d.call&&
d(b)||d;return{encode:function(a){d&&(a=d.encode(a));return a},decode:function(a){d&&(a=d.decode(a));return a}}}}({"id-sc-gostR3410-2001":Ib,"id-sc-gostR3410-94":Ib,"id-GostR3410-2001":za,"id-GostR3410-94":za,"id-tc26-gost3410-12-256":za,"id-tc26-gost3410-12-512":za,"id-GostR3410-94-CryptoPro-ESDH":ka,"id-GostR3410-2001-CryptoPro-ESDH":ka,"id-tc26-agreement-gost-3410-12-256":ka,"id-tc26-agreement-gost-3410-12-512":ka,"id-sc-r3410-ESDH-r3411kdf":Ta,"id-Gost28147-89-None-KeyWrap":ka,"id-Gost28147-89-CryptoPro-KeyWrap":ka,
"id-sc-cmsGostWrap":Ta,"id-sc-cmsGost28147Wrap":Ta}),Ua=function(a){return{encode:function(b){b=w(b);b.encryptedKey=K(Aa(b.keyEncryptionAlgorithm)).encode(b.encryptedKey);return a.encode(b)},decode:function(b){b=a.decode(b);b.encryptedKey=K(Aa(b.keyEncryptionAlgorithm)).decode(b.encryptedKey);return b}}},la=k,pa=h,Va=m(g),cd=d({bodyPartPath:Va,identifier:k,content:y}),Ba=G({contentType:F(la),messageDigest:F(h),signingTime:F(Y)}),ed=G({countersignature:C(dd),unsignedData:C(cd)}),qa=d({issuer:R,serialNumber:g}),
fd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),Jb=ha(d({version:g,sid:fd,digestAlgorithm:ea,signedAttrs:e(b(0,f(Ba))),signatureAlgorithm:M,signatureValue:h,unsignedAttrs:e(b(1,f(ed)))})),dd=Jb,gd=C(Jb),hd=C(ea),id=d({version:g,certificate:xa,attributes:G}),jd=d({extendedCertificateInfo:id,signatureAlgorithm:M,signatureValue:q}),kd=d({otherCertFormat:k,otherCert:y}),ld=d({version:g,subject:p({baseCertificateID:b(0,f(ya)),subjectName:b(1,f(A))}),issuer:A,signature:M,serialNumber:g,
attCertValidityPeriod:Ab,attributes:Ha,issuerUniqueID:e(q),extensions:e(va)}),md=ha(d({acInfo:ld,signatureAlgorithm:M,signatureValue:q})),Wa=d({eContentType:la,eContent:e(b(0,t(h)))}),nd=p({certificate:xa,extendedCertificate:b(0,f(jd)),v1AttrCert:b(1,f(md)),v2AttrCert:b(2,f(Eb)),other:b(3,f(kd))}),od=d({otherRevInfoFormat:k,otherRevInfo:y}),pd=p({crl:Pa,other:b(1,f(od))}),Kb=C(nd),Lb=C(pd),qd=d({version:g,digestAlgorithms:hd,encapContentInfo:Wa,certificates:e(b(0,f(Kb))),crls:e(b(1,f(Lb))),signerInfos:gd}),
rd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),sd=Ua(d({version:g,rid:rd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Mb=d({keyAttrId:k,keyAttr:e(y)}),td=d({subjectKeyIdentifier:pa,date:e(J),other:e(Mb)}),ud=p({issuerAndSerialNumber:qa,rKeyId:b(0,f(td))}),vd=d({rid:ud,encryptedKey:ia}),wd=m(vd),Fb=d({algorithm:sa,publicKey:q}),xd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa)),originatorKey:b(1,f(Fb))}),yd=function(a){return{encode:function(b){b=w(b);var d=b.keyEncryptionAlgorithm,
e=K(Aa(d));b.recipientEncryptedKeys=b.recipientEncryptedKeys.map(function(a){a=w(a);a.encryptedKey=e.encode(a.encryptedKey);return a});b.ukm=b.ukm||d.ukm;return a.encode(b)},decode:function(b){b=a.decode(b);var d=b.keyEncryptionAlgorithm;d.ukm=d.ukm||b.ukm;var e=K(Aa(d));b.recipientEncryptedKeys.forEach(function(a){a.encryptedKey=e.decode(a.encryptedKey)});return b}}}(d({version:g,originator:b(0,t(xd)),ukm:e(b(1,t(h))),keyEncryptionAlgorithm:ga,recipientEncryptedKeys:wd})),zd=d({keyIdentifier:h,date:e(J),
other:e(Mb)}),Ad=Ua(d({version:g,kekid:zd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Bd=Ua(d({version:g,keyDerivationAlgorithm:e(b(0,f(Ja))),keyEncryptionAlgorithm:ga,encryptedKey:ia})),Cd=d({oriType:k,oriValue:y}),Dd=p({ktri:sd,kari:b(1,f(yd)),kekri:b(2,f(Ad)),pwri:b(3,f(Bd)),ori:b(4,f(Cd))}),Xa=d({certs:e(b(0,f(Kb))),crls:e(b(1,f(Lb)))}),Ya=C(Dd),Za=d({contentType:la,contentEncryptionAlgorithm:uc,encryptedContent:e(b(0,f(h)))}),Ca=d({version:g,originatorInfo:e(b(0,f(Xa))),recipientInfos:Ya,encryptedContentInfo:Za,
unprotectedAttrs:e(b(1,f(G)))}),Ed=d({version:g,digestAlgorithm:ea,encapContentInfo:Wa,digest:h}),Nb=d({version:g,encryptedContentInfo:Za,unprotectedAttrs:e(b(1,f(G)))}),Fd=d({version:g,originatorInfo:e(b(0,f(Xa))),recipientInfos:Ya,macAlgorithm:Ia,digestAlgorithm:e(b(1,ea)),encapContentInfo:Wa,authAttrs:e(b(2,f(Ba))),mac:h,unauthAttrs:e(b(3,f(G)))}),Gd=d({version:g,originatorInfo:e(b(0,f(Xa))),recipientInfos:Ya,authEncryptedContentInfo:Za,authAttrs:e(b(1,f(Ba))),mac:h,unauthAttrs:e(b(2,f(G)))}),
Hd=p({encrypted:Nb,enveloped:b(0,f(Ca)),authEnveloped:b(1,f(Gd))}),la=k,ra=X(function(a){return{contentType:la,content:b(0,t(a))}},"contentType",la)({data:h,signedData:qd,envelopedData:Ca,digestedData:Ed,encryptedData:Nb,authData:Fd,encryptedKeyPkg:Hd,aKeyPackage:xc}),Id=d({digestAlgorithm:ea,digest:h}),Jd=G({friendlyName:F(cb),localKeyId:F(h)}),Kd=X(function(a){return{certId:k,certValue:b(0,t(a))}},"certId",k)({x509Certificate:h(K(xa)),sdsiCertificate:Ea},h),Ld=X(function(a){return{crlId:k,crlValue:b(0,
t(a))}},"crlId",k)({x509CRL:h(K(Pa))},h),Md=X(function(a){return{secretTypeId:k,secretValue:b(0,t(a))}},"secretTypeId",k)({secret:h},h),Nd=X(function(a){return{bagId:k,bagValue:b(0,t(a)),bagAttributes:e(Jd)}},"bagId",k)(function(a){return{keyBag:na,pkcs8ShroudedKeyBag:qb,certBag:Kd,crlBag:Ld,secretBag:Md,safeContentsBag:Ob}[a]}),Ob=m(Nd),Od=m(ra),Pd=d({mac:Id,macSalt:h,iterations:L(g,1)}),Qd=d({version:g,authSafe:ra,macData:e(Pd)}),Rd=d({issuer:z,serialNumber:g}),Sd=d({intendedAlg:e(b(0,f(n))),symmAlg:e(b(1,
f(n))),encSymmKey:e(b(2,f(q))),keyAlg:e(b(3,f(n))),valueHint:e(b(4,f(h))),encValue:q}),ia=p({encryptedValue:Sd,envelopedData:b(0,f(Ca))}),Td=p({encryptedPrivKey:b(0,ia),keyGenParameters:b(1,f(h)),archiveRemGenPrivKey:b(2,f(W))}),Ud=d({pubMethod:g({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:e(z)}),Pb=d({action:g({dontPublish:0,pleasePublish:1}),pubInfos:e(m(Ud))}),Vd=g({encrCert:0,challengeResp:1}),Rb=p({thisMessage:b(0,f(q)),subsequentMessage:b(1,f(Vd)),dhMAC:b(2,f(q)),agreeMAC:b(3,f(Qb)),encryptedKey:b(4,
f(Ca))});d({salt:h,owf:n,iterationCount:g,mac:n});var Qb=d({algId:n,value:q}),Wd=d({authInfo:p({sender:b(0,t(z)),publicKeyMAC:Qb}),publicKey:aa}),Xd=d({poposkInput:e(b(0,Wd)),algorithmIdentifier:n,signature:q}),Yd=p({raVerified:b(0,f(ma)),signature:b(1,f(Xd)),keyEncipherment:b(2,f(Rb)),keyAgreement:b(3,f(Rb))}),Zd=m(Ga({regToken:Q,authenticator:Q,pkiPublicationInfo:Pb,pkiArchiveOptions:Td,oldCertID:Rd,protocolEncrKey:aa})),$d=d({notBefore:e(b(0,f(Y))),notAfter:e(b(1,f(Y)))}),Sb=d({version:e(b(0,f(g))),
serialNumber:e(b(1,f(g))),signingAlg:e(b(2,f(n))),issuer:e(b(3,f(R))),validity:e(b(4,f($d))),subject:e(b(5,f(R))),publicKey:e(b(6,f(aa))),issuerUID:e(b(7,f(q))),subjectUID:e(b(8,f(q))),extensions:e(b(9,f(oa)))}),Tb=d({certReqId:g,certTemplate:Sb,controls:e(Zd)}),ae=d({privateKey:na,identifier:e(p([Q,z]))}),Ub=d({certReq:Tb,popo:e(Yd),regInfo:e(m(Ga({utf8Pairs:Q,certReq:Tb,encKeyWithID:ae})))});m(Ub);var Vb=d({pendToken:h,pendTime:J}),Wb=g({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,
popRequired:6,partial:7}),Xb=g({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),be=d({cMCStatus:Wb,bodyList:m(g),statusString:e(Q),otherInfo:e(p({failInfo:Xb,pendInfo:Vb}))}),ce=d({pkiDataReference:g,certReferences:m(g),extensions:m(tb)}),de=d({request:Yb,cms:ra,thePOPAlgID:n,witnessAlgID:n,witness:h}),ee=d({pkiDataBodyid:g,bodyIds:m(g)}),fe=d({issuerName:z,
serialNumber:g}),ge=d({issuerName:R,cRLName:e(z),time:e(J),reasons:e(Na)}),he=d({issuerName:R,serialNumber:g,reason:yb,invalidityDate:e(J),passphrase:e(h),comment:e(Q)}),ie=d({bodyPartID:g,thePOPAlgID:n,thePOP:h}),Zb=p({bodyPartID:g,bodyPartPath:Va}),je=d({cMCStatus:Wb,bodyList:m(Zb),statusString:e(Q),otherInfo:e(p({failInfo:Xb,pendInfo:Vb,extendedFailInfo:d({failInfoOID:k,failInfoValue:Fa})}))}),ke=d({seqNumber:g,hashAlgorithm:n,anchorHashes:m(h)}),$a=m(g),le=d({hashAlg:n,certHashes:m(h),pubInfo:Pb}),
me=d({pkiDataReference:Va,certReferences:$a,replace:L(W,!0),certTemplate:Sb}),ne=d({bodyList:m(Zb)}),oe=d({proofAlgID:n,macAlgId:n,witness:h}),pe=d({keyGenAlgorithm:n,macAlgorithm:n,witness:h}),$b=hb(function(a){return d({bodyPartID:g,attrType:k,attrValues:C(a)},{encode:function(a){return a.attrType},decode:function(a){return k.decode(a[1])}},Fa)({statusInfo:be,identification:Q,identityProof:h,dataReturn:h,transactionId:g,senderNonce:h,recipientNonce:h,addExtensions:ce,encryptedPOP:de,decryptedPOP:ie,
lraPOPWitness:ee,getCert:fe,getCRL:ge,revokeRequest:he,regInfo:h,responseInfo:h,queryPending:h,popLinkRandom:h,popLinkWitness:h,confirmCertAcceptance:qa,statusInfoV2:je,trustedAnchors:ke,authData:g,batchRequests:$a,batchResponses:$a,publishCert:le,modCertTemplate:me,controlProcessed:ne,popLinkWitnessV2:pe,identityProofV2:oe})}),qe=d({bodyPartID:g,certificationRequest:xb}),ac=d({bodyPartID:g,contentInfo:ra}),bc=d({bodyPartID:g,otherMsgType:k,otherMsgValue:y}),Yb=p({tcr:b(0,f(qe)),crm:b(1,f(Ub)),orm:b(2,
f(d({bodyPartID:g,requestMessageType:k,requestMessageValue:y})))}),re=d({controlSequence:m($b),reqSequence:m(Yb),cmsSequence:m(ac),otherMsgSequence:m(bc)}),se=d({controlSequence:m($b),cmsSequence:m(ac),otherMsgSequence:m(bc)}),v=function(a,b){return{encode:function(d,e){d=a.encode(d);d=T().encode(d);"PEM"===(e||"DER").toUpperCase()&&(d=(x||(x=E.gostCoding)).PEM.encode(d,b));return d},decode:function(d){if("string"===typeof d||d instanceof String)d=(x||(x=E.gostCoding)).PEM.decode(d,b);d=T().decode(d);
return a.decode(d)}}};return{CanocicalName:hc,GostPrivateKeyInfo:v(yc,"PRIVATE KEY"),GostSubjectPublicKeyInfo:v(La,"PUBLIC KEY"),PrivateKeyInfo:v(na,"PRIVATE KEY"),EncryptedPrivateKeyInfo:v(qb,"ENCRYPTED PRIVATE KEY"),SubjectPublicKeyInfo:v(aa,"PUBLIC KEY"),TBSCertificate:v(vb),Certificate:v(xa,"CERTIFICATE"),CertificationRequestInfo:v(wb),CertificationRequest:v(xb,"CERTIFICATE REQUEST"),TBSCertList:v(zb),CertificateList:v(Pa,"CRL"),AttributeCertificateInfo:v(Db),AttributeCertificate:v(Eb,"ATTRIBUTE CERTIFICATE"),
SignedAttributes:v(Ba),ContentInfo:v(ra,"CMS"),SafeContents:v(Ob),AuthenticatedSafe:v(Od),PFX:v(Qd,"PFX"),PKIData:v(re,"PKI REQUEST"),PKIResponse:v(se,"PKI RESPONSE")}});
