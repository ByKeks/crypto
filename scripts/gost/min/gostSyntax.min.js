/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(B,w){"function"===typeof define&&define.amd?define(["gostObject","gostCoding"],w):"object"===typeof exports?module.exports=w(require("gostObject"),require("gostCoding")):B.gostSyntax=w(B.gostObject,B.gostCoding)})(this,function(B,w){function E(a){return(B||(B=D.gostObject)).algorithms[a]}function Ea(a){return(B||(B=D.gostObject)).names[a]}function sa(a){return(B||(B=D.gostObject)).identifiers[a]}function ba(a){return(B||(B=D.gostObject)).attributes[a]}function ca(a){return(B||(B=D.gostObject)).parameters[a]}
function T(){return(w||(w=D.gostCoding)).BER}function U(){return(w||(w=D.gostCoding)).Hex}function x(){for(var a={},c=0,m=arguments.length;c<m;c++){var b=arguments[c];if("object"===typeof b)for(var d in b)a[d]=b[d]}return a}function V(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),m=0,b=a.length;m<b;m++)c[b-m-1]=a[m];return c.buffer}function O(a,c,m,b){var d;if("undefined"===typeof a)throw new J("Invalid value");null===a?d=new String(""):"string"===typeof a||
a instanceof String?d=new String(a.toString()):"number"===typeof a||a instanceof Number?d=new Number(a.toString()):"boolean"===typeof a||a instanceof Boolean?d=new Boolean(a?!0:!1):a instanceof Array?d=a.slice(0):a instanceof Date?d=new Date(a.getTime()):a instanceof ArrayBuffer?d=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(d=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);d.tagNumber="undefined"!==typeof c?c:5;d.tagClass="undefined"!==
typeof m?m:0;d.tagConstructed="undefined"!==typeof b?b:!1;return d}function P(a,c,m,b){if("undefined"===typeof a)throw new J("Invalid value");m="undefined"!==typeof m?m:0;b="undefined"!==typeof b?b:!1;if(void 0!==a.tagClass&&(c!==a.tagNumber&&!(c instanceof Array&&0<=c.indexOf(a.tagNumber))||m!==a.tagClass||b!==a.tagConstructed))throw new J("Invalid format");b=a;0===m&&5===c?b=null:a instanceof String?b=a.toString():a instanceof Number?b=parseFloat(a):a instanceof Boolean?b=a?!0:!1:a instanceof Array?
(b=a.slice(0),b.buffer=a.buffer?a.buffer:(new Uint8Array(new Uint8Array(a.header.buffer,a.header.byteOffset,a.header.byteLength+a.content.byteLength))).buffer):a instanceof Date?b=new Date(a.getTime()):a instanceof ArrayBuffer?b=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(b=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);return b}var D=this,J=D.DataError||Error,bb=D.NotSupportedError||Error,Q=function(a){return{encode:function(c){return O(c,
a)},decode:function(c){return P(c,a)}}},W=Q(1),Fa=Q(22),cb=Q(19),dc=Q(20),K=Q(12),db=Q(23),F=Q(24),ec=Q(28),eb=Q(30),ma={encode:function(){return O(null,5)},decode:function(a){return P(a,5)}},fb=function(a){var c=Q(a);a=function(a){return{encode:function(b){b=a[b];if("undefined"===typeof b)throw new J("Invalid value");return c.encode(b)},decode:function(b){b=c.decode(b);for(var d in a)if(b===a[d])return d}}};a.encode=c.encode;a.decode=c.decode;return a},g=fb(2),gb=fb(10),hb=function(a,c){var b=function(b){c&&
c.call&&(b=c(b));return{encode:function(c){b&&(c=b.encode(c));return O(c,a)},decode:function(c){c=P(c,a);b&&(c=b.decode(c));return c}}};b.encode=function(c){return O(c,a)};b.decode=function(c){return P(c,a)};return b},h=hb(4),q=hb(3,function(a){if(!a||a.encode&&a.decode)return a;var c=[],b;for(b in a)c[a[b]]=b;return{encode:function(a){if(a instanceof Array){for(var b="",m=0;m<c.length;m++)b=c[m]&&0<=a.indexOf(c[m])?b+"1":b+"0";for(;1<b.length&&"0"===b.charAt(b.length-1);)b=b.substring(0,b.length-
1)}else b="0";return b},decode:function(a){for(var b=[],m=0;m<a.length;m++)"1"===a.charAt(m)&&c[m]&&b.push(c[m]);return b}}}),d=function(a){return{encode:function(c){var b=[],d;for(d in a){var e=a[d].encode(c[d]);void 0!==e&&b.push(e)}return O(b,16,0,!0)},decode:function(c){c=P(c,16,0,!0);var b={},d=0,e;for(e in a){var f=a[e].decode(c[d]);void 0!==f&&(b[e]=f,d++)}b.buffer=c.buffer;return b}}},k={encode:function(a){if(!/^(\d+\.)+\d+$/.test(a)&&(a=sa(a),!a))throw new J("Invalid object identifier value");
return O(a,6)},decode:function(a){a=P(a,6);return Ea(a)||a}},b=function(a,c){return{encode:function(b){b=c.encode(b);return O(b,a,2,b instanceof Array)},decode:function(b){return c.decode(P(b,a,2,b instanceof Array))}}},ib=function(a){return function(c,b,d){c=c||y;var e=function(e,f){var g=c.call?c(e):c;return{encode:function(c){var d=[];if(b)for(var e in c)"buffer"!==e&&d.push(g.encode(b(e,c[e],f)));else{e=0;for(var h=c.length;e<h;e++)d.push(g.encode(c[e]))}return O(d,a,0,!0)},decode:function(c){var b=
d?{}:[];c=P(c,a,0,!0);if(d)for(var m=0;m<c.length;m++)d(b,g.decode(c[m]));else for(var m=0,e=c.length;m<e;m++)b.push(g.decode(c[m]));b.buffer=c.buffer;return b}}};e.encode=function(b){for(var m=[],d=0,e=b.length;d<e;d++)m.push(c.encode(b[d]));return O(m,a,0,!0)};e.decode=function(b){b=P(b,a,0,!0);for(var m=[],d=0,e=b.length;d<e;d++)m.push(c.decode(b[d]));m.buffer=b.buffer;return m};return e}},l=ib(16),C=ib(17),G=function(a){return{encode:function(c){return O([a.encode(c)],17,0,!0)},decode:function(c){c=
P(c,17,0,!0);return a.decode(c[0])}}},p=function(a,c){return a instanceof Array?{encode:function(b){if(c)return c(b).encode(b);for(var d=0;d<a.length;d++)try{var e=a[d].encode(b);if(void 0!==e)return e}catch(f){}throw new J("Invalid format");},decode:function(c){for(var b=0;b<a.length;b++)try{var d=a[b].decode(c);if(void 0!==d)return d}catch(e){}throw new J("Invalid format");}}:{encode:function(c){for(var b in a){var d=c[b];if(void 0!==d)return a[b].encode(d)}throw new J("Invalid format");},decode:function(c){var b=
{},d;for(d in a)try{var e=a[d].decode(c);if(void 0!==e)return b[d]=e,b}catch(f){}throw new J("Invalid format");}}},L=function(){var a=function(a){return{encode:function(b){b=a.encode(b);return T().encode(b)},decode:function(b){b=T().decode(b);return a.decode(b)}}};a.encode=function(a){return T().encode(a)};a.decode=function(a){return T().decode(a)};return a}(),f=function(a){return{encode:function(c){return a.encode(c)},decode:function(c){return a.decode(c)}}},t=function(a){return{encode:function(c){return[a.encode(c)]},
decode:function(c){return a.decode(c[0])}}},y={encode:function(a){return a},decode:function(a){return a}},M=function(a,c){return{encode:function(b){return b===c||void 0===b?void 0:a.encode(b)},decode:function(b){if(void 0===b)return c;try{return a.decode(b)}catch(d){}}}},e=function(a){return{encode:function(c){return void 0===c?void 0:a.encode(c)},decode:function(c){if(void 0!==c)try{return a.decode(c)}catch(b){}}}},jb=function(a,c,b){b=b||y;var d=function(d,e){d=d||{};e=e||b;var f=function(a){var c;
d&&(c=d.call?d(a):d[a]);return c||e};return{encode:function(b){var d=f(c.encode(b));return a(d).encode(b)},decode:function(b){var d=f(c.decode(b));return a(d).decode(b)}}};d.encode=function(c){return a(b).encode(c)};d.decode=function(c){return a(b).decode(c)};return d},X=function(a,c,b,e){c=c||"type";b=b||k;return jb(function(c){return d(a(c))},{encode:function(a){return a[c]},decode:function(a){return b.decode(a[0])}},e)},da=p([K,cb,dc,ec,eb],function(a){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?
cb:K}),Y=p([F,db],function(a){return 2050<=a.getYear()?F:db}),Ga=y,Ha=X(function(a){return{type:k,value:a}},"type",k,Ga),kb=G(Ha({emailAddress:Fa,domainComponent:Fa},da)),fc=l(kb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value})(),R=p([fc]),gc=d({notBefore:Y,notAfter:Y}),lb=X(function(a){return{type:k,value:a}}),H=C(lb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),Ia=l(lb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),hc=d({a:g,
b:g,seed:e(q)}),ic=h({encode:function(a){return U().decode("04"+a.x.replace("0x","")+a.y.replace("0x",""))},decode:function(a){a=U().encode(a).replace(/[^A-fa-f0-9]/g,"").substring(2);return{x:"0x"+a.substring(0,a.length/2),y:"0x"+a.substring(a.length/2)}}}),jc=d({fieldType:k,parameters:g}),kc=d({version:g,fieldID:jc,curve:hc,base:ic,order:g,cofactor:e(g)}),lc=d({publicKeyParamSet:k,digestParamSet:k,encryptionParamSet:M(k,"id-Gost28147-89-CryptoPro-A-ParamSet")}),mc=function(a,c){return{encode:function(b){return b===
c||void 0===b?ma.encode(null):a.encode(b)},decode:function(b){return void 0===b?void 0:null===b?c:a.decode(b)}}}(k,"id-GostR3411-94-CryptoProParamSet"),nc=p({namedParameters:k,ecParameters:kc,implicitly:e(ma)}),n=function(){var a=function(a){return d({algorithm:k,parameters:e(a)})},c=function(c){return{encode:function(b){var d=c[b.id];if(d)return a(d.paramType).encode(d.encode(b));throw new bb("Algorithm not supported");},decode:function(b){var d=c[Ea(b[0])];if(d)return d.decode(a(d.paramType).decode(b));
throw new bb("Algorithm not supported");}}};c.encode=function(c){return a(y).encode(c)};c.decode=function(c){return a(y).decode(c)};return c}(),Z={paramType:nc,encode:function(a){var c;c="string"===typeof a.namedCurve?{namedParameters:ba("namedCurve")[a.namedCurve]}:{ecParameters:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.p},curve:{a:a.a,b:a.b},base:{x:a.x,y:a.y},order:a.q,cofactor:1}};return{algorithm:a.id,parameters:c}},decode:function(a){var c=a.parameters;a=E(a.algorithm);if(c.namedParameters)a=
x(a,ca(c.namedParameters));else if(c.ecParameters)a=x(a,{p:c.ecParameters.fieldID.parameters,a:c.ecParameters.curve.a,b:c.ecParameters.curve.b,x:c.ecParameters.base.x,y:c.ecParameters.base.y,q:c.ecParameters.order});else throw new J("Invalid key paramters");return a}},I={paramType:lc,encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":
"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:ba(c)[a[c]],digestParamSet:ba("sBox")[b]}}},decode:function(a){var c=a.parameters;return x(E(a.algorithm),ca(c.publicKeyParamSet),ca(c.digestParamSet))}},r={encode:function(a){return{algorithm:a.id}},decode:function(a){return E(a.algorithm)}},u={paramType:ma,encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return E(a.algorithm)}},mb={paramType:mc,encode:function(a){return{algorithm:a.id,parameters:ba("sBox")[a.sBox||
"D-A"]}},decode:function(a){return x(E(a.algorithm),ca(a.parameters))}},ta=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":I,"id-GostR3410-94":I,"id-tc26-gost3410-12-256":I,"id-tc26-gost3410-12-512":I}),N=n({noSignature:u,rsaEncryption:u,sha1withRSAEncryption:u,sha256withRSAEncryption:u,sha384withRSAEncryption:u,sha512withRSAEncryption:u,ecdsa:r,"ecdsa-with-SHA1":r,"ecdsa-with-SHA256":r,"ecdsa-with-SHA384":r,"ecdsa-with-SHA512":r,"id-GostR3410-94":u,"id-GostR3410-2001":u,"id-GostR3411-94-with-GostR3410-2001":r,
"id-GostR3411-94-with-GostR3410-94":r,"id-tc26-gost3410-12-256":u,"id-tc26-gost3410-12-512":u,"id-tc26-signwithdigest-gost3410-12-94":r,"id-tc26-signwithdigest-gost3410-12-256":r,"id-tc26-signwithdigest-gost3410-12-512":r,"id-sc-gostR3410-94":u,"id-sc-gostR3410-2001":u,"id-sc-gostR3411-94-with-gostR3410-94":u,"id-sc-gostR3411-94-with-gostR3410-2001":u}),ea=n({sha1:u,sha256:u,sha384:u,sha512:u,"id-GostR3411-94":mb,"id-tc26-gost3411-94":mb,"id-tc26-gost3411-12-256":u,"id-tc26-gost3411-12-512":u,"id-sc-gostR3411-94":r}),
nb=d({iv:h,encryptionParamSet:k}),oc=d({encryptionParamSet:k,ukm:e(h)}),ob={paramType:nb,encode:function(a){return{algorithm:a.id,parameters:{iv:a.iv,encryptionParamSet:ba("sBox")[a.sBox||"E-A"]}}},decode:function(a){var c=x(E(a.algorithm),ca(a.parameters.encryptionParamSet));c.iv=a.parameters.iv;return c}},fa={paramType:oc,encode:function(a){return{algorithm:a.id,parameters:{encryptionParamSet:ba("sBox")[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=x(E(a.algorithm),ca(a.parameters.encryptionParamSet));
a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}},pb=n({"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa}),$={paramType:pb,encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=x(E(a.algorithm));c.wrapping=a.parameters;return c}},ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":I,"id-GostR3410-94":I,"id-tc26-gost3410-12-256":I,"id-tc26-gost3410-12-512":I,"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,
"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r}),pc=n({"id-sc-gost28147-gfb":r,"id-Gost28147-89":ob}),Ja=n({"id-Gost28147-89-MAC":nb,"id-HMACGostR3411-94":r,"id-tc26-hmac-gost-3411-12-256":r,"id-tc26-hmac-gost-3411-12-512":r,hmacWithSHA1:r,hmacWithSHA224:r,hmacWithSHA256:r,hmacWithSHA384:r,hmacWithSHA512:r,"id-sc-gost28147-mac":r,
"id-sc-hmacWithGostR3411":r}),qc={paramType:d({salt:p({specified:h,otherSource:n}),iterationCount:g,keyLength:e(g),prf:Ja}),encode:function(a){return{algorithm:a.id,parameters:{salt:{specified:a.salt},iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.salt=a.parameters.salt.specified;c.iterations=a.parameters.iterationCount;c.hmac=a.parameters.prf;return c}},Ka=n({PBKDF2:qc}),s={paramType:d({salt:h,iterationCount:g}),encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,
iterationCount:a.derivation.iterations}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=x(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}},La={paramType:d({keyDerivationFunc:Ka,encryptionScheme:pc}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,encryptionScheme:a.encryption}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}};
n({"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:La});var rc={paramType:d({keyDerivationFunc:Ka,messageAuthScheme:Ja}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,messageAuthScheme:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=
a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;return c}};n({PBMAC1:rc});var sc=n({"id-sc-gost28147-gfb":r,"id-Gost28147-89":ob,"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:La}),ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":I,"id-GostR3410-94":I,
"id-tc26-gost3410-12-256":I,"id-tc26-gost3410-12-512":I,"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r,"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,
"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:La}),tc=h({encode:function(a){var c=new Uint8Array(a.byteLength+1),b=V(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){var c=new Uint8Array(a.byteLength-1),b=c.byteLength/2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,1,b),b);return V(c)}}),aa=d({algorithm:ta,subjectPublicKey:q}),Ma=function(a){return{encode:function(c){return aa.encode({algorithm:c.algorithm,
subjectPublicKey:L.encode(a[c.algorithm.id].encode(c.buffer))})},decode:function(c){c=aa.decode(c);return{algorithm:c.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a[c.algorithm.id].decode(L.decode(c.subjectPublicKey))}}}}({"id-sc-gostR3410-2001":tc,"id-sc-gostR3410-94":{encode:function(a){return g.encode((w||(w=D.gostCoding)).Int16.encode(V(a)))},decode:function(a){return V((w||(w=D.gostCoding)).Int16.decode(g.decode(a)))}},"id-GostR3410-2001":h,"id-GostR3410-94":h,
"id-tc26-gost3410-12-256":h,"id-tc26-gost3410-12-512":h}),qb={encode:function(a){return L(g).encode("0x"+U().encode(a,!0))},decode:function(a){return U().decode(L(g).decode(a).replace("0x",""),!0)}},ua=y,na=d({version:g,privateKeyAlgorithm:ta,privateKey:h,attributes:e(b(0,f(H)))}),uc=d({version:g,privateKeyAlgorithm:ta,privateKey:h,attributes:e(b(0,f(H))),publicKey:e(b(1,f(q)))}),vc=l(uc),wc=function(a){return{encode:function(c){return na.encode({version:0,privateKeyAlgorithm:c.algorithm,privateKey:a[c.algorithm.id].encode(c.buffer)})},
decode:function(c){c=na.decode(c);return{algorithm:c.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:a[c.privateKeyAlgorithm.id].decode(c.privateKey)}}}}({"id-sc-gostR3410-2001":qb,"id-sc-gostR3410-94":qb,"id-GostR3410-2001":ua,"id-GostR3410-94":ua,"id-tc26-gost3410-12-256":ua,"id-tc26-gost3410-12-512":ua}),rb=d({encryptionAlgorithm:ga,encryptedData:h}),xc=d({cA:M(W,!1),pathLenConstraint:e(g)}),yc=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,
dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),zc=l(k),Ac=l({type:k,value:b(0,t(y))}),Bc=d({nameAssigner:e(b(0,f(da))),partyName:e(b(1,f(da)))}),Cc=d({}),z=p({otherName:b(0,f(Ac)),rfc822Name:b(1,f(da)),dNSName:b(2,f(da)),x400Address:b(3,f(Cc)),directoryName:b(4,t(R)),ediPartyName:b(5,f(Bc)),uniformResourceIdentifier:b(6,f(da)),iPAddress:b(7,f(h)),registeredID:b(8,f(k))}),A=l(z),Na=d({keyIdentifier:e(b(0,f(h))),authorityCertIssuer:e(b(1,f(A))),authorityCertSerialNumber:e(b(2,
f(g)))}),Dc=d({notBefore:e(b(0,f(F))),notAfter:e(b(1,f(F)))}),Ec=d({policyQualifierId:k,qualifier:y}),Fc=d({policyIdentifier:k,policyQualifiers:e(l(Ec))}),Gc=d({issuerDomainPolicy:k,subjectDomainPolicy:k}),Hc=d({base:z,minimum:M(b(0,f(g)),0),maximum:e(b(1,f(g)))}),sb=l(Hc),Ic=d({permittedSubtrees:e(b(0,f(sb))),excludedSubtrees:e(b(1,f(sb)))}),Jc=d({requireExplicitPolicy:e(b(0,f(g))),inhibitPolicyMapping:e(b(1,f(g)))}),Oa=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,
cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),tb=p({fullName:b(0,f(A)),nameRelativeToCRLIssuer:b(1,f(kb))}),Kc=d({distributionPoint:e(b(0,t(tb))),reasons:e(b(1,f(Oa))),cRLIssuer:e(b(2,f(A)))}),va=l(Kc),Pa=d({accessMethod:k,accessLocation:z}),ub=X(function(a){return{extnID:k,critical:M(W,!1),extnValue:h(L(a))}},"extnID"),oa=l(ub,function(a,c,b){return{extnID:a,critical:b&&b(a,c),extnValue:c}},function(a,c){return a[c.extnID]=c.extnValue}),wa=oa({authorityKeyIdentifier:Na,
subjectKeyIdentifier:h,keyUsage:yc,privateKeyUsagePeriod:Dc,certificatePolicies:l(Fc),policyMappings:l(Gc),subjectAltName:A,issuerAltName:A,subjectDirectoryAttributes:Ia,basicConstraints:xc,nameConstraints:Ic,policyConstraints:Jc,extKeyUsage:zc,cRLDistributionPoints:va,inhibitAnyPolicy:g,freshestCRL:va,authorityInfoAccess:l(Pa),subjectInfoAccess:l(Pa)},function(a,c){return"keyUsage"===a||"basicConstraints"===a&&void 0===c.pathLenConstraint}),xa=function(){var a=d({r:g,s:g});return{encode:function(c){c=
V(c);var b=c.byteLength/2,d="0x"+U().encode(new Uint8Array(c,0,b));c="0x"+U().encode(new Uint8Array(c,b,b));return T().encode(a.encode({r:c,s:d}))},decode:function(c){var b=a.decode(T().decode(c));c=new Uint8Array(U().decode(b.r.replace("0x","")));var b=new Uint8Array(U().decode(b.s.replace("0x",""))),d=new Uint8Array(b.length+c.length);d.set(b,0);d.set(c,b.length);return V(d.buffer)}}}(),S={encode:function(a){return V(a)},decode:function(a){return V(a)}},vb=function(a){return function(c){var b=a[c.id];
return{encode:function(a){b&&(a=b.encode(a));return a},decode:function(a){if(a instanceof ArrayBuffer)return b&&(a=b.decode(a)),a;throw new J("Invalid signature value");}}}}({noSignature:h,"id-GostR3410-94":S,"id-GostR3410-2001":S,"id-GostR3411-94-with-GostR3410-2001":S,"id-GostR3411-94-with-GostR3410-94":S,"id-tc26-gost3410-12-256":S,"id-tc26-gost3410-12-512":S,"id-tc26-signwithdigest-gost3410-12-94":S,"id-tc26-signwithdigest-gost3410-12-256":S,"id-tc26-signwithdigest-gost3410-12-512":S,"id-sc-gostR3410-94":xa,
"id-sc-gostR3410-2001":xa,"id-sc-gostR3411-94-with-gostR3410-94":xa,"id-sc-gostR3411-94-with-gostR3410-2001":xa}),ha=function(a){return{encode:function(c){c=x(c);c.signatureValue=vb(c.signatureAlgorithm).encode(c.signatureValue);return a.encode(c)},decode:function(c){c=a.decode(c);c.signatureValue=vb(c.signatureAlgorithm).decode(c.signatureValue);return c}}},wb=d({version:b(0,t(g)),serialNumber:g,signature:N,issuer:R,validity:gc,subject:R,subjectPublicKeyInfo:aa,issuerUniqueID:e(b(1,f(q))),subjectUniqueID:e(b(2,
f(q))),extensions:e(b(3,t(wa)))}),ya=ha(d({tbsCertificate:wb,signatureAlgorithm:N,signatureValue:q})),Lc=H({challengePassword:G(da),extensionRequest:G(wa),msCertExtensions:G(wa),extendedCertificateAttributes:G(H)}),xb=d({version:g,subject:R,subjectPublicKeyInfo:aa,attributes:b(0,f(Lc))}),yb=ha(d({requestInfo:xb,signatureAlgorithm:N,signatureValue:q})),zb=gb({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,
aACompromise:10}),Mc=d({distributionPoint:e(b(0,t(tb))),onlyContainsUserCerts:M(b(1,f(W)),!1),onlyContainsCACerts:M(b(2,f(W)),!1),onlySomeReasons:e(b(3,f(Oa))),indirectCRL:M(b(4,f(W)),!1),onlyContainsAttributeCerts:M(b(5,f(W)),!1)}),Nc=oa({authorityKeyIdentifier:Na,issuerAltName:A,cRLNumber:g,deltaCRLIndicator:g,issuingDistributionPoint:Mc,freshestCRL:va},function(a){return"cRLNumber"===a}),Oc=oa({cRLReason:zb,instructionCode:k,invalidityDate:F,certificateIssuer:A}),Ab=d({version:e(g),signature:N,
issuer:R,thisUpdate:Y,nextUpdate:e(Y),revokedCertificates:e(l(d({userCertificate:g,revocationDate:Y,crlEntryExtensions:e(Oc)}))),crlExtensions:e(b(0,t(Nc)))}),Qa=ha(d({tbsCertList:Ab,signatureAlgorithm:N,signatureValue:q})),Ra=d({digestedObjectType:gb({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:e(k),digestAlgorithm:ea,objectDigest:q}),za=d({issuer:A,serial:g,issuerUID:e(q)}),Pc=d({issuerName:e(A),baseCertificateID:e(b(0,f(za))),objectDigestInfo:e(b(1,f(Ra)))}),Qc=d({targetCertificate:za,
targetName:e(z),certDigestInfo:e(Ra)}),Rc=p({targetName:b(0,t(z)),targetGroup:b(1,t(z)),targetCert:b(2,f(Qc))}),Sc=l(Rc),Tc=oa({auditIdentity:h,targetInformation:Sc,authorityKeyIdentifier:Na,authorityInfoAccess:l(Pa),cRLDistributionPoints:va,noRevAvail:ma},function(a){return"auditIdentity"===a||"targetInformation"===a}),Uc=d({baseCertificateID:e(b(0,f(za))),entityName:e(b(1,f(A))),objectDigestInfo:e(b(2,f(Ra)))}),Vc=p({v1Form:A,v2Form:b(0,f(Pc))}),Bb=d({notBeforeTime:F,notAfterTime:F}),Cb=d({service:z,
ident:z,authInfo:e(h)}),Wc=d({roleAuthority:e(b(0,f(A))),roleName:b(1,t(z))}),Xc=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),Yc=d({type:b(0,f(k)),value:b(1,f(y))}),Zc=d({policyId:b(0,f(k)),classList:M(b(1,f(Xc)),["unclassified"]),securityCategories:e(b(2,f(C(Yc))))}),Db=d({policyAuthority:e(b(0,f(A))),values:l(p({octets:h,oid:k,string:K}))}),Eb=d({version:g,holder:Uc,issuer:Vc,signature:N,serialNumber:g,attrCertValidityPeriod:Bb,attributes:Ia({authenticationInfo:C(Cb),
accessIdentity:C(Cb),chargingIdentity:G(Db),group:G(Db),role:C(Wc),clearance:C(Zc)}),issuerUniqueID:e(q),extensions:e(Tc)}),Fb=ha(d({acinfo:Eb,signatureAlgorithm:N,signatureValue:q})),ia=h,pa=h;d({ephemeralPublicKey:Gb,addedukm:e(b(0,t(h)))});d({keyInfo:pb,entityUInfo:e(b(0,t(h))),suppPubInfo:b(2,t(h))});var ja=d({encryptedKey:h,maskKey:e(b(0,f(h))),macKey:h}),$c=d({encryptionParamSet:k,ephemeralPublicKey:e(b(0,f(Ma))),ukm:h}),Hb=d({sessionEncryptedKey:ja,transportParameters:e(b(0,f($c)))}),Ib=d({sessionEncryptedKey:ja,
ukm:d({ephemeralPublicKey:Ma,addedukm:e(b(0,t(h)))})}),Sa=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,8,32))).buffer;a=(new Uint8Array(new Uint8Array(a,40,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(c){var b=a.ukm,d=c.encryptedKey;c=c.macKey;var e=new Uint8Array(b.byteLength+d.byteLength+c.byteLength);e.set(new Uint8Array(b),0);e.set(new Uint8Array(d),8);e.set(new Uint8Array(c),40);return e}}},ka=function(a){var c=Sa(a);return{encode:function(a){return ja.encode(c.encode(a))},
decode:function(a){return c.decode(ja.decode(a))}}},Aa=function(a){return{encode:function(c){return Hb.encode({sessionEncryptedKey:Sa(a).encode(c),transportParameters:{encryptionParamSet:ba("sBox")[a.wrapping.sBox||"E-A"],ephemeralPublicKey:a["public"],ukm:a.ukm}})},decode:function(c){c=Hb.decode(c);a.wrapping=ca(c.transportParameters.encryptionParamSet);a.ukm=c.transportParameters.ukm;a["public"]=c.transportParameters.ephemeralPublicKey;return Sa(a).decode(c.sessionEncryptedKey)}}},Ta=function(a){return{encode:function(a){var b=
(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey;a=a.macKey;var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),32);return d}}},Jb=function(a){return{encode:function(b){return Ib.encode({sessionEncryptedKey:Ta(a).encode(b),ukm:{ephemeralPublicKey:a["public"],addedukm:a.ukm}})},decode:function(b){b=Ib.decode(b);a.ukm=b.ukm.addedukm;
a["public"]=b.ukm.ephemeralPublicKey;return Ta(a).decode(b.sessionEncryptedKey)}}},Ua=function(a){var b=Ta(a);return{encode:function(a){return ja.encode(b.encode(a))},decode:function(a){return b.decode(ja.decode(a))}}},Ba=function(a){return function(b){var d=a[b.id],d=d&&d.call&&d(b)||d;return{encode:function(a){d&&(a=d.encode(a));return a},decode:function(a){d&&(a=d.decode(a));return a}}}}({"id-sc-gostR3410-2001":Jb,"id-sc-gostR3410-94":Jb,"id-GostR3410-2001":Aa,"id-GostR3410-94":Aa,"id-tc26-gost3410-12-256":Aa,
"id-tc26-gost3410-12-512":Aa,"id-GostR3410-94-CryptoPro-ESDH":ka,"id-GostR3410-2001-CryptoPro-ESDH":ka,"id-tc26-agreement-gost-3410-12-256":ka,"id-tc26-agreement-gost-3410-12-512":ka,"id-sc-r3410-ESDH-r3411kdf":Ua,"id-Gost28147-89-None-KeyWrap":ka,"id-Gost28147-89-CryptoPro-KeyWrap":ka,"id-sc-cmsGostWrap":Ua,"id-sc-cmsGost28147Wrap":Ua}),Va=function(a){return{encode:function(b){b=x(b);b.encryptedKey=L(Ba(b.keyEncryptionAlgorithm)).encode(b.encryptedKey);return a.encode(b)},decode:function(b){b=a.decode(b);
b.encryptedKey=L(Ba(b.keyEncryptionAlgorithm)).decode(b.encryptedKey);return b}}},la=k,pa=h,Wa=l(g),ad=d({bodyPartPath:Wa,identifier:k,content:y}),Ca=H({contentType:G(la),messageDigest:G(h),signingTime:G(Y)}),cd=H({countersignature:C(bd),unsignedData:C(ad)}),qa=d({issuer:R,serialNumber:g}),dd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),Kb=ha(d({version:g,sid:dd,digestAlgorithm:ea,signedAttrs:e(b(0,f(Ca))),signatureAlgorithm:N,signatureValue:h,unsignedAttrs:e(b(1,f(cd)))})),bd=Kb,
ed=C(Kb),fd=C(ea),gd=d({version:g,certificate:ya,attributes:H}),hd=d({extendedCertificateInfo:gd,signatureAlgorithm:N,signatureValue:q}),id=d({otherCertFormat:k,otherCert:y}),jd=d({version:g,subject:p({baseCertificateID:b(0,f(za)),subjectName:b(1,f(A))}),issuer:A,signature:N,serialNumber:g,attCertValidityPeriod:Bb,attributes:Ia,issuerUniqueID:e(q),extensions:e(wa)}),kd=ha(d({acInfo:jd,signatureAlgorithm:N,signatureValue:q})),Xa=d({eContentType:la,eContent:e(b(0,t(h)))}),ld=p({certificate:ya,extendedCertificate:b(0,
f(hd)),v1AttrCert:b(1,f(kd)),v2AttrCert:b(2,f(Fb)),other:b(3,f(id))}),md=d({otherRevInfoFormat:k,otherRevInfo:y}),nd=p({crl:Qa,other:b(1,f(md))}),Lb=C(ld),Mb=C(nd),od=d({version:g,digestAlgorithms:fd,encapContentInfo:Xa,certificates:e(b(0,f(Lb))),crls:e(b(1,f(Mb))),signerInfos:ed}),pd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),qd=Va(d({version:g,rid:pd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Nb=d({keyAttrId:k,keyAttr:e(y)}),rd=d({subjectKeyIdentifier:pa,date:e(F),other:e(Nb)}),
sd=p({issuerAndSerialNumber:qa,rKeyId:b(0,f(rd))}),td=d({rid:sd,encryptedKey:ia}),ud=l(td),Gb=d({algorithm:ta,publicKey:q}),vd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa)),originatorKey:b(1,f(Gb))}),wd=function(a){return{encode:function(b){b=x(b);var d=b.keyEncryptionAlgorithm,e=L(Ba(d));b.recipientEncryptedKeys=b.recipientEncryptedKeys.map(function(a){a=x(a);a.encryptedKey=e.encode(a.encryptedKey);return a});b.ukm=b.ukm||d.ukm;return a.encode(b)},decode:function(b){b=a.decode(b);var d=
b.keyEncryptionAlgorithm;d.ukm=d.ukm||b.ukm;var e=L(Ba(d));b.recipientEncryptedKeys.forEach(function(a){a.encryptedKey=e.decode(a.encryptedKey)});return b}}}(d({version:g,originator:b(0,t(vd)),ukm:e(b(1,t(h))),keyEncryptionAlgorithm:ga,recipientEncryptedKeys:ud})),xd=d({keyIdentifier:h,date:e(F),other:e(Nb)}),yd=Va(d({version:g,kekid:xd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),zd=Va(d({version:g,keyDerivationAlgorithm:e(b(0,f(Ka))),keyEncryptionAlgorithm:ga,encryptedKey:ia})),Ad=d({oriType:k,
oriValue:y}),Bd=p({ktri:qd,kari:b(1,f(wd)),kekri:b(2,f(yd)),pwri:b(3,f(zd)),ori:b(4,f(Ad))}),Ya=d({certs:e(b(0,f(Lb))),crls:e(b(1,f(Mb)))}),Za=C(Bd),$a=d({contentType:la,contentEncryptionAlgorithm:sc,encryptedContent:e(b(0,f(h)))}),Da=d({version:g,originatorInfo:e(b(0,f(Ya))),recipientInfos:Za,encryptedContentInfo:$a,unprotectedAttrs:e(b(1,f(H)))}),Cd=d({version:g,digestAlgorithm:ea,encapContentInfo:Xa,digest:h}),Ob=d({version:g,encryptedContentInfo:$a,unprotectedAttrs:e(b(1,f(H)))}),Dd=d({version:g,
originatorInfo:e(b(0,f(Ya))),recipientInfos:Za,macAlgorithm:Ja,digestAlgorithm:e(b(1,ea)),encapContentInfo:Xa,authAttrs:e(b(2,f(Ca))),mac:h,unauthAttrs:e(b(3,f(H)))}),Ed=d({version:g,originatorInfo:e(b(0,f(Ya))),recipientInfos:Za,authEncryptedContentInfo:$a,authAttrs:e(b(1,f(Ca))),mac:h,unauthAttrs:e(b(2,f(H)))}),Fd=p({encrypted:Ob,enveloped:b(0,f(Da)),authEnveloped:b(1,f(Ed))}),la=k,ra=X(function(a){return{contentType:la,content:b(0,t(a))}},"contentType",la)({data:h,signedData:od,envelopedData:Da,
digestedData:Cd,encryptedData:Ob,authData:Dd,encryptedKeyPkg:Fd,aKeyPackage:vc}),Gd=d({digestAlgorithm:ea,digest:h}),Hd=H({friendlyName:G(eb),localKeyId:G(h)}),Id=X(function(a){return{certId:k,certValue:b(0,t(a))}},"certId",k)({x509Certificate:h(L(ya)),sdsiCertificate:Fa},h),Jd=X(function(a){return{crlId:k,crlValue:b(0,t(a))}},"crlId",k)({x509CRL:h(L(Qa))},h),Kd=X(function(a){return{secretTypeId:k,secretValue:b(0,t(a))}},"secretTypeId",k)({secret:h},h),Ld=X(function(a){return{bagId:k,bagValue:b(0,
t(a)),bagAttributes:e(Hd)}},"bagId",k)(function(a){return{keyBag:na,pkcs8ShroudedKeyBag:rb,certBag:Id,crlBag:Jd,secretBag:Kd,safeContentsBag:Pb}[a]}),Pb=l(Ld),Md=l(ra),Nd=d({mac:Gd,macSalt:h,iterations:M(g,1)}),Od=d({version:g,authSafe:ra,macData:e(Nd)}),Pd=d({issuer:z,serialNumber:g}),Qd=d({intendedAlg:e(b(0,f(n))),symmAlg:e(b(1,f(n))),encSymmKey:e(b(2,f(q))),keyAlg:e(b(3,f(n))),valueHint:e(b(4,f(h))),encValue:q}),ia=p({encryptedValue:Qd,envelopedData:b(0,f(Da))}),Rd=p({encryptedPrivKey:b(0,ia),
keyGenParameters:b(1,f(h)),archiveRemGenPrivKey:b(2,f(W))}),Sd=d({pubMethod:g({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:e(z)}),Qb=d({action:g({dontPublish:0,pleasePublish:1}),pubInfos:e(l(Sd))}),Td=g({encrCert:0,challengeResp:1}),Sb=p({thisMessage:b(0,f(q)),subsequentMessage:b(1,f(Td)),dhMAC:b(2,f(q)),agreeMAC:b(3,f(Rb)),encryptedKey:b(4,f(Da))});d({salt:h,owf:n,iterationCount:g,mac:n});var Rb=d({algId:n,value:q}),Ud=d({authInfo:p({sender:b(0,t(z)),publicKeyMAC:Rb}),publicKey:aa}),Vd=d({poposkInput:e(b(0,
Ud)),algorithmIdentifier:n,signature:q}),Wd=p({raVerified:b(0,f(ma)),signature:b(1,f(Vd)),keyEncipherment:b(2,f(Sb)),keyAgreement:b(3,f(Sb))}),Xd=l(Ha({regToken:K,authenticator:K,pkiPublicationInfo:Qb,pkiArchiveOptions:Rd,oldCertID:Pd,protocolEncrKey:aa})),Yd=d({notBefore:e(b(0,f(Y))),notAfter:e(b(1,f(Y)))}),Tb=d({version:e(b(0,f(g))),serialNumber:e(b(1,f(g))),signingAlg:e(b(2,f(n))),issuer:e(b(3,f(R))),validity:e(b(4,f(Yd))),subject:e(b(5,f(R))),publicKey:e(b(6,f(aa))),issuerUID:e(b(7,f(q))),subjectUID:e(b(8,
f(q))),extensions:e(b(9,f(oa)))}),Ub=d({certReqId:g,certTemplate:Tb,controls:e(Xd)}),Zd=d({privateKey:na,identifier:e(p([K,z]))}),Vb=d({certReq:Ub,popo:e(Wd),regInfo:e(l(Ha({utf8Pairs:K,certReq:Ub,encKeyWithID:Zd})))});l(Vb);var Wb=d({pendToken:h,pendTime:F}),Xb=g({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,partial:7}),Yb=g({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,
internalCAError:11,tryLater:12,authDataFail:13}),$d=d({cMCStatus:Xb,bodyList:l(g),statusString:e(K),otherInfo:e(p({failInfo:Yb,pendInfo:Wb}))}),ae=d({pkiDataReference:g,certReferences:l(g),extensions:l(ub)}),be=d({request:Zb,cms:ra,thePOPAlgID:n,witnessAlgID:n,witness:h}),ce=d({pkiDataBodyid:g,bodyIds:l(g)}),de=d({issuerName:z,serialNumber:g}),ee=d({issuerName:R,cRLName:e(z),time:e(F),reasons:e(Oa)}),fe=d({issuerName:R,serialNumber:g,reason:zb,invalidityDate:e(F),passphrase:e(h),comment:e(K)}),ge=
d({bodyPartID:g,thePOPAlgID:n,thePOP:h}),$b=p({bodyPartID:g,bodyPartPath:Wa}),he=d({cMCStatus:Xb,bodyList:l($b),statusString:e(K),otherInfo:e(p({failInfo:Yb,pendInfo:Wb,extendedFailInfo:d({failInfoOID:k,failInfoValue:Ga})}))}),ie=d({seqNumber:g,hashAlgorithm:n,anchorHashes:l(h)}),ab=l(g),je=d({hashAlg:n,certHashes:l(h),pubInfo:Qb}),ke=d({pkiDataReference:Wa,certReferences:ab,replace:M(W,!0),certTemplate:Tb}),le=d({bodyList:l($b)}),me=d({proofAlgID:n,macAlgId:n,witness:h}),ne=d({keyGenAlgorithm:n,
macAlgorithm:n,witness:h}),ac=jb(function(a){return d({bodyPartID:g,attrType:k,attrValues:C(a)},{encode:function(a){return a.attrType},decode:function(a){return k.decode(a[1])}},Ga)({statusInfo:$d,identification:K,identityProof:h,dataReturn:h,transactionId:g,senderNonce:h,recipientNonce:h,addExtensions:ae,encryptedPOP:be,decryptedPOP:ge,lraPOPWitness:ce,getCert:de,getCRL:ee,revokeRequest:fe,regInfo:h,responseInfo:h,queryPending:h,popLinkRandom:h,popLinkWitness:h,confirmCertAcceptance:qa,statusInfoV2:he,
trustedAnchors:ie,authData:g,batchRequests:ab,batchResponses:ab,publishCert:je,modCertTemplate:ke,controlProcessed:le,popLinkWitnessV2:ne,identityProofV2:me})}),oe=d({bodyPartID:g,certificationRequest:yb}),bc=d({bodyPartID:g,contentInfo:ra}),cc=d({bodyPartID:g,otherMsgType:k,otherMsgValue:y}),Zb=p({tcr:b(0,f(oe)),crm:b(1,f(Vb)),orm:b(2,f(d({bodyPartID:g,requestMessageType:k,requestMessageValue:y})))}),pe=d({controlSequence:l(ac),reqSequence:l(Zb),cmsSequence:l(bc),otherMsgSequence:l(cc)}),qe=d({controlSequence:l(ac),
cmsSequence:l(bc),otherMsgSequence:l(cc)}),v=function(a,b){return{encode:function(d,e){d=a.encode(d);d=T().encode(d);"PEM"===(e||"DER").toUpperCase()&&(d=(w||(w=D.gostCoding)).PEM.encode(d,b));return d},decode:function(d){if("string"===typeof d||d instanceof String)d=(w||(w=D.gostCoding)).PEM.decode(d,b);d=T().decode(d);return a.decode(d)}}};return{CanocicalName:function(){var a={commonName:"CN",serialName:"SN",countryName:"C",localityName:"L",stateOrProvinceName:"ST",streetAddress:"STREET",organizationName:"O",
organizationalUnitName:"OU",title:"TITLE",name:"NAME",givenName:"GNAME",initials:"INITIALS",distinguishedName:"DN"},b=[],d;for(d in a)b[a[d]]=d;return{encode:function(b){var c=[],d=[],e;for(e in b)c.push(e);c.sort(function(a,b){var c=sa(a),d=sa(b);return c<d?-1:c>d?1:0});for(var f=0,c=c.length;f<c;f++)d.push((a[e]||sa(e))+"="+b[e]);return d.join(",")},decode:function(a){a=a.split(",");for(var d=0,e=a.length;d<e;d++){var f=a[d].split("="),g=f[0].trim();f[1].trim();b[g]||Ea(g)}}}},GostPrivateKeyInfo:v(wc,
"PRIVATE KEY"),GostSubjectPublicKeyInfo:v(Ma,"PUBLIC KEY"),PrivateKeyInfo:v(na,"PRIVATE KEY"),EncryptedPrivateKeyInfo:v(rb,"ENCRYPTED PRIVATE KEY"),SubjectPublicKeyInfo:v(aa,"PUBLIC KEY"),TBSCertificate:v(wb),Certificate:v(ya,"CERTIFICATE"),CertificationRequestInfo:v(xb),CertificationRequest:v(yb,"CERTIFICATE REQUEST"),TBSCertList:v(Ab),CertificateList:v(Qa,"CRL"),AttributeCertificateInfo:v(Eb),AttributeCertificate:v(Fb,"ATTRIBUTE CERTIFICATE"),SignedAttributes:v(Ca),ContentInfo:v(ra,"CMS"),SafeContents:v(Pb),
AuthenticatedSafe:v(Md),PFX:v(Od,"PFX"),PKIData:v(pe,"PKI REQUEST"),PKIResponse:v(qe,"PKI RESPONSE")}});
