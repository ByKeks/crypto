/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(B,w){"function"===typeof define&&define.amd?define(["gostObject","gostCoding"],w):"object"===typeof exports?module.exports=w(require("gostObject"),require("gostCoding")):B.gostSyntax=w(B.gostObject,B.gostCoding)})(this,function(B,w){function E(a){return(B||(B=D.gostObject)).algorithms[a]}function Da(a){return(B||(B=D.gostObject)).names[a]}function ab(a){return(B||(B=D.gostObject)).identifiers[a]}function ba(a){return(B||(B=D.gostObject)).attributes[a]}function ca(a){return(B||(B=D.gostObject)).parameters[a]}
function T(){return(w||(w=D.gostCoding)).BER}function U(){return(w||(w=D.gostCoding)).Hex}function x(){for(var a={},c=0,l=arguments.length;c<l;c++){var b=arguments[c];if("object"===typeof b)for(var d in b)a[d]=b[d]}return a}function V(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),l=0,b=a.length;l<b;l++)c[b-l-1]=a[l];return c.buffer}function O(a,c,l,b){var d;if("undefined"===typeof a)throw new J("Invalid value");null===a?d=new String(""):"string"===typeof a||
a instanceof String?d=new String(a.toString()):"number"===typeof a||a instanceof Number?d=new Number(a.toString()):"boolean"===typeof a||a instanceof Boolean?d=new Boolean(a?!0:!1):a instanceof Array?d=a.slice(0):a instanceof Date?d=new Date(a.getTime()):a instanceof ArrayBuffer?d=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(d=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);d.tagNumber="undefined"!==typeof c?c:5;d.tagClass="undefined"!==
typeof l?l:0;d.tagConstructed="undefined"!==typeof b?b:!1;return d}function P(a,c,l,b){if("undefined"===typeof a)throw new J("Invalid value");l="undefined"!==typeof l?l:0;b="undefined"!==typeof b?b:!1;if(void 0!==a.tagClass&&(c!==a.tagNumber&&!(c instanceof Array&&0<=c.indexOf(a.tagNumber))||l!==a.tagClass||b!==a.tagConstructed))throw new J("Invalid format");b=a;0===l&&5===c?b=null:a instanceof String?b=a.toString():a instanceof Number?b=parseFloat(a):a instanceof Boolean?b=a?!0:!1:a instanceof Array?
(b=a.slice(0),b.buffer=a.buffer?a.buffer:(new Uint8Array(new Uint8Array(a.header.buffer,a.header.byteOffset,a.header.byteLength+a.content.byteLength))).buffer):a instanceof Date?b=new Date(a.getTime()):a instanceof ArrayBuffer?b=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(b=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);return b}var D=this,J=D.DataError||Error,bb=D.NotSupportedError||Error,Q=function(a){return{encode:function(c){return O(c,
a)},decode:function(c){return P(c,a)}}},W=Q(1),Ea=Q(22),cb=Q(19),dc=Q(20),K=Q(12),db=Q(23),F=Q(24),ec=Q(28),eb=Q(30),ma={encode:function(){return O(null,5)},decode:function(a){return P(a,5)}},fb=function(a){var c=Q(a);a=function(a){return{encode:function(b){b=a[b];if("undefined"===typeof b)throw new J("Invalid value");return c.encode(b)},decode:function(b){b=c.decode(b);for(var d in a)if(b===a[d])return d}}};a.encode=c.encode;a.decode=c.decode;return a},g=fb(2),gb=fb(10),hb=function(a,c){var b=function(b){c&&
c.call&&(b=c(b));return{encode:function(c){b&&(c=b.encode(c));return O(c,a)},decode:function(c){c=P(c,a);b&&(c=b.decode(c));return c}}};b.encode=function(c){return O(c,a)};b.decode=function(c){return P(c,a)};return b},h=hb(4),q=hb(3,function(a){if(!a||a.encode&&a.decode)return a;var c=[],b;for(b in a)c[a[b]]=b;return{encode:function(a){if(a instanceof Array){for(var b="",l=0;l<c.length;l++)b=c[l]&&0<=a.indexOf(c[l])?b+"1":b+"0";for(;1<b.length&&"0"===b.charAt(b.length-1);)b=b.substring(0,b.length-
1)}else b="0";return b},decode:function(a){for(var b=[],l=0;l<a.length;l++)"1"===a.charAt(l)&&c[l]&&b.push(c[l]);return b}}}),d=function(a){return{encode:function(c){var b=[],d;for(d in a){var e=a[d].encode(c[d]);void 0!==e&&b.push(e)}return O(b,16,0,!0)},decode:function(c){c=P(c,16,0,!0);var b={},d=0,e;for(e in a){var f=a[e].decode(c[d]);void 0!==f&&(b[e]=f,d++)}b.buffer=c.buffer;return b}}},k={encode:function(a){if(!/^(\d+\.)+\d+$/.test(a)&&(a=ab(a),!a))throw new J("Invalid object identifier value");
return O(a,6)},decode:function(a){a=P(a,6);return Da(a)||a}},b=function(a,c){return{encode:function(b){b=c.encode(b);return O(b,a,2,b instanceof Array)},decode:function(b){return c.decode(P(b,a,2,b instanceof Array))}}},ib=function(a){return function(c,b,d){c=c||y;var e=function(e,f){var g=c.call?c(e):c;return{encode:function(c){var d=[];if(b)for(var e in c)"buffer"!==e&&d.push(g.encode(b(e,c[e],f)));else{e=0;for(var h=c.length;e<h;e++)d.push(g.encode(c[e]))}return O(d,a,0,!0)},decode:function(c){var b=
d?{}:[];c=P(c,a,0,!0);if(d)for(var l=0;l<c.length;l++)d(b,g.decode(c[l]));else for(var l=0,e=c.length;l<e;l++)b.push(g.decode(c[l]));b.buffer=c.buffer;return b}}};e.encode=function(b){for(var l=[],d=0,e=b.length;d<e;d++)l.push(c.encode(b[d]));return O(l,a,0,!0)};e.decode=function(b){b=P(b,a,0,!0);for(var l=[],d=0,e=b.length;d<e;d++)l.push(c.decode(b[d]));l.buffer=b.buffer;return l};return e}},m=ib(16),C=ib(17),G=function(a){return{encode:function(c){return O([a.encode(c)],17,0,!0)},decode:function(c){c=
P(c,17,0,!0);return a.decode(c[0])}}},p=function(a,c){return a instanceof Array?{encode:function(b){if(c)return c(b).encode(b);for(var d=0;d<a.length;d++)try{var e=a[d].encode(b);if(void 0!==e)return e}catch(f){}throw new J("Invalid format");},decode:function(c){for(var b=0;b<a.length;b++)try{var d=a[b].decode(c);if(void 0!==d)return d}catch(e){}throw new J("Invalid format");}}:{encode:function(c){for(var b in a){var d=c[b];if(void 0!==d)return a[b].encode(d)}throw new J("Invalid format");},decode:function(c){var b=
{},d;for(d in a)try{var e=a[d].decode(c);if(void 0!==e)return b[d]=e,b}catch(f){}throw new J("Invalid format");}}},L=function(){var a=function(a){return{encode:function(b){b=a.encode(b);return T().encode(b)},decode:function(b){b=T().decode(b);return a.decode(b)}}};a.encode=function(a){return T().encode(a)};a.decode=function(a){return T().decode(a)};return a}(),f=function(a){return{encode:function(c){return a.encode(c)},decode:function(c){return a.decode(c)}}},t=function(a){return{encode:function(c){return[a.encode(c)]},
decode:function(c){return a.decode(c[0])}}},y={encode:function(a){return a},decode:function(a){return a}},M=function(a,c){return{encode:function(b){return b===c||void 0===b?void 0:a.encode(b)},decode:function(b){if(void 0===b)return c;try{return a.decode(b)}catch(d){}}}},e=function(a){return{encode:function(c){return void 0===c?void 0:a.encode(c)},decode:function(c){if(void 0!==c)try{return a.decode(c)}catch(b){}}}},jb=function(a,c,b){b=b||y;var d=function(d,e){d=d||{};e=e||b;var f=function(a){var c;
d&&(c=d.call?d(a):d[a]);return c||e};return{encode:function(b){var d=f(c.encode(b));return a(d).encode(b)},decode:function(b){var d=f(c.decode(b));return a(d).decode(b)}}};d.encode=function(c){return a(b).encode(c)};d.decode=function(c){return a(b).decode(c)};return d},X=function(a,c,b,e){c=c||"type";b=b||k;return jb(function(c){return d(a(c))},{encode:function(a){return a[c]},decode:function(a){return b.decode(a[0])}},e)},da=p([K,cb,dc,ec,eb],function(a){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?
cb:K}),Y=p([F,db],function(a){return 2050<=a.getYear()?F:db}),Fa=y,Ga=X(function(a){return{type:k,value:a}},"type",k,Fa),kb=G(Ga({emailAddress:Ea,domainComponent:Ea},da)),fc=m(kb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value})(),R=p([fc]),gc=function(){var a={commonName:"CN",serialName:"SN",countryName:"C",localityName:"L",stateOrProvinceName:"ST",streetAddress:"STREET",organizationName:"O",organizationalUnitName:"OU",title:"TITLE",name:"NAME",givenName:"GNAME",initials:"INITIALS",
distinguishedName:"DN",emailAddress:"EMAIL"},c=[],b;for(b in a)c[a[b]]=b;return{encode:function(c){var b=[],d;for(d in c)"buffer"!==d&&b.push((a[d]||ab(d))+"="+c[d]);return b.join(",")},decode:function(a){a=a.split(",");for(var b=0,d=a.length;b<d;b++){var e=a[b].split("="),l=e[0].trim();e[1].trim();c[l]||Da(l)}}}}(),hc=d({notBefore:Y,notAfter:Y}),lb=X(function(a){return{type:k,value:a}}),H=C(lb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),Ha=m(lb,function(a,c){return{type:a,
value:c}},function(a,c){a[c.type]=c.value}),ic=d({a:g,b:g,seed:e(q)}),jc=h({encode:function(a){return U().decode("04"+a.x.replace("0x","")+a.y.replace("0x",""))},decode:function(a){a=U().encode(a).replace(/[^A-fa-f0-9]/g,"").substring(2);return{x:"0x"+a.substring(0,a.length/2),y:"0x"+a.substring(a.length/2)}}}),kc=d({fieldType:k,parameters:g}),lc=d({version:g,fieldID:kc,curve:ic,base:jc,order:g,cofactor:e(g)}),mc=d({publicKeyParamSet:k,digestParamSet:k,encryptionParamSet:M(k,"id-Gost28147-89-CryptoPro-A-ParamSet")}),
nc=function(a,c){return{encode:function(b){return b===c||void 0===b?ma.encode(null):a.encode(b)},decode:function(b){return void 0===b?void 0:null===b?c:a.decode(b)}}}(k,"id-GostR3411-94-CryptoProParamSet"),oc=p({namedParameters:k,ecParameters:lc,implicitly:e(ma)}),n=function(){var a=function(a){return d({algorithm:k,parameters:e(a)})},c=function(c){return{encode:function(b){var d=c[b.id];if(d)return a(d.paramType).encode(d.encode(b));throw new bb("Algorithm not supported");},decode:function(b){var d=
c[Da(b[0])];if(d)return d.decode(a(d.paramType).decode(b));throw new bb("Algorithm not supported");}}};c.encode=function(c){return a(y).encode(c)};c.decode=function(c){return a(y).decode(c)};return c}(),Z={paramType:oc,encode:function(a){var c;c="string"===typeof a.namedCurve?{namedParameters:ba("namedCurve")[a.namedCurve]}:{ecParameters:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.p},curve:{a:a.a,b:a.b},base:{x:a.x,y:a.y},order:a.q,cofactor:1}};return{algorithm:a.id,parameters:c}},
decode:function(a){var c=a.parameters;a=E(a.algorithm);if(c.namedParameters)a=x(a,ca(c.namedParameters));else if(c.ecParameters)a=x(a,{p:c.ecParameters.fieldID.parameters,a:c.ecParameters.curve.a,b:c.ecParameters.curve.b,x:c.ecParameters.base.x,y:c.ecParameters.base.y,q:c.ecParameters.order});else throw new J("Invalid key paramters");return a}},I={paramType:mc,encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||
2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:ba(c)[a[c]],digestParamSet:ba("sBox")[b]}}},decode:function(a){var c=a.parameters;return x(E(a.algorithm),ca(c.publicKeyParamSet),ca(c.digestParamSet))}},r={encode:function(a){return{algorithm:a.id}},decode:function(a){return E(a.algorithm)}},u={paramType:ma,encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return E(a.algorithm)}},
mb={paramType:nc,encode:function(a){return{algorithm:a.id,parameters:ba("sBox")[a.sBox||"D-A"]}},decode:function(a){return x(E(a.algorithm),ca(a.parameters))}},sa=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":I,"id-GostR3410-94":I,"id-tc26-gost3410-12-256":I,"id-tc26-gost3410-12-512":I}),N=n({noSignature:u,rsaEncryption:u,sha1withRSAEncryption:u,sha256withRSAEncryption:u,sha384withRSAEncryption:u,sha512withRSAEncryption:u,ecdsa:r,"ecdsa-with-SHA1":r,"ecdsa-with-SHA256":r,
"ecdsa-with-SHA384":r,"ecdsa-with-SHA512":r,"id-GostR3410-94":u,"id-GostR3410-2001":u,"id-GostR3411-94-with-GostR3410-2001":r,"id-GostR3411-94-with-GostR3410-94":r,"id-tc26-gost3410-12-256":u,"id-tc26-gost3410-12-512":u,"id-tc26-signwithdigest-gost3410-12-94":r,"id-tc26-signwithdigest-gost3410-12-256":r,"id-tc26-signwithdigest-gost3410-12-512":r,"id-sc-gostR3410-94":u,"id-sc-gostR3410-2001":u,"id-sc-gostR3411-94-with-gostR3410-94":u,"id-sc-gostR3411-94-with-gostR3410-2001":u}),ea=n({sha1:u,sha256:u,
sha384:u,sha512:u,"id-GostR3411-94":mb,"id-tc26-gost3411-94":mb,"id-tc26-gost3411-12-256":u,"id-tc26-gost3411-12-512":u,"id-sc-gostR3411-94":r}),nb=d({iv:h,encryptionParamSet:k}),pc=d({encryptionParamSet:k,ukm:e(h)}),ob={paramType:nb,encode:function(a){return{algorithm:a.id,parameters:{iv:a.iv,encryptionParamSet:ba("sBox")[a.sBox||"E-A"]}}},decode:function(a){var c=x(E(a.algorithm),ca(a.parameters.encryptionParamSet));c.iv=a.parameters.iv;return c}},fa={paramType:pc,encode:function(a){return{algorithm:a.id,
parameters:{encryptionParamSet:ba("sBox")[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=x(E(a.algorithm),ca(a.parameters.encryptionParamSet));a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}},pb=n({"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa}),$={paramType:pb,encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=x(E(a.algorithm));c.wrapping=a.parameters;return c}},ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":I,
"id-GostR3410-94":I,"id-tc26-gost3410-12-256":I,"id-tc26-gost3410-12-512":I,"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r}),qc=n({"id-sc-gost28147-gfb":r,"id-Gost28147-89":ob}),Ia=n({"id-Gost28147-89-MAC":nb,"id-HMACGostR3411-94":r,"id-tc26-hmac-gost-3411-12-256":r,
"id-tc26-hmac-gost-3411-12-512":r,hmacWithSHA1:r,hmacWithSHA224:r,hmacWithSHA256:r,hmacWithSHA384:r,hmacWithSHA512:r,"id-sc-gost28147-mac":r,"id-sc-hmacWithGostR3411":r}),rc={paramType:d({salt:p({specified:h,otherSource:n}),iterationCount:g,keyLength:e(g),prf:Ia}),encode:function(a){return{algorithm:a.id,parameters:{salt:{specified:a.salt},iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.salt=a.parameters.salt.specified;c.iterations=a.parameters.iterationCount;
c.hmac=a.parameters.prf;return c}},Ja=n({PBKDF2:rc}),s={paramType:d({salt:h,iterationCount:g}),encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=x(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}},Ka={paramType:d({keyDerivationFunc:Ja,encryptionScheme:qc}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,
encryptionScheme:a.encryption}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}};n({"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Ka});var sc={paramType:d({keyDerivationFunc:Ja,messageAuthScheme:Ia}),
encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,messageAuthScheme:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;return c}};n({PBMAC1:sc});var tc=n({"id-sc-gost28147-gfb":r,"id-Gost28147-89":ob,"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,
"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Ka}),ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":I,"id-GostR3410-94":I,"id-tc26-gost3410-12-256":I,"id-tc26-gost3410-12-512":I,"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r,
"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Ka}),uc=h({encode:function(a){var c=new Uint8Array(a.byteLength+1),b=V(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){var c=new Uint8Array(a.byteLength-1),b=c.byteLength/
2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,1,b),b);return V(c)}}),aa=d({algorithm:sa,subjectPublicKey:q}),La=function(a){return{encode:function(c){return aa.encode({algorithm:c.algorithm,subjectPublicKey:L.encode(a[c.algorithm.id].encode(c.buffer))})},decode:function(c){c=aa.decode(c);return{algorithm:c.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a[c.algorithm.id].decode(L.decode(c.subjectPublicKey))}}}}({"id-sc-gostR3410-2001":uc,"id-sc-gostR3410-94":{encode:function(a){return g.encode((w||
(w=D.gostCoding)).Int16.encode(V(a)))},decode:function(a){return V((w||(w=D.gostCoding)).Int16.decode(g.decode(a)))}},"id-GostR3410-2001":h,"id-GostR3410-94":h,"id-tc26-gost3410-12-256":h,"id-tc26-gost3410-12-512":h}),qb={encode:function(a){return L(g).encode("0x"+U().encode(a,!0))},decode:function(a){return U().decode(L(g).decode(a).replace("0x",""),!0)}},ta=y,na=d({version:g,privateKeyAlgorithm:sa,privateKey:h,attributes:e(b(0,f(H)))}),vc=d({version:g,privateKeyAlgorithm:sa,privateKey:h,attributes:e(b(0,
f(H))),publicKey:e(b(1,f(q)))}),wc=m(vc),xc=function(a){return{encode:function(c){return na.encode({version:0,privateKeyAlgorithm:c.algorithm,privateKey:a[c.algorithm.id].encode(c.buffer)})},decode:function(c){c=na.decode(c);return{algorithm:c.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:a[c.privateKeyAlgorithm.id].decode(c.privateKey)}}}}({"id-sc-gostR3410-2001":qb,"id-sc-gostR3410-94":qb,"id-GostR3410-2001":ta,"id-GostR3410-94":ta,"id-tc26-gost3410-12-256":ta,
"id-tc26-gost3410-12-512":ta}),rb=d({encryptionAlgorithm:ga,encryptedData:h}),yc=d({cA:M(W,!1),pathLenConstraint:e(g)}),zc=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Ac=m(k),Bc=m({type:k,value:b(0,t(y))}),Cc=d({nameAssigner:e(b(0,f(da))),partyName:e(b(1,f(da)))}),Dc=d({}),z=p({otherName:b(0,f(Bc)),rfc822Name:b(1,f(da)),dNSName:b(2,f(da)),x400Address:b(3,f(Dc)),directoryName:b(4,t(R)),ediPartyName:b(5,
f(Cc)),uniformResourceIdentifier:b(6,f(da)),iPAddress:b(7,f(h)),registeredID:b(8,f(k))}),A=m(z),Ma=d({keyIdentifier:e(b(0,f(h))),authorityCertIssuer:e(b(1,f(A))),authorityCertSerialNumber:e(b(2,f(g)))}),Ec=d({notBefore:e(b(0,f(F))),notAfter:e(b(1,f(F)))}),Fc=d({policyQualifierId:k,qualifier:y}),Gc=d({policyIdentifier:k,policyQualifiers:e(m(Fc))}),Hc=d({issuerDomainPolicy:k,subjectDomainPolicy:k}),Ic=d({base:z,minimum:M(b(0,f(g)),0),maximum:e(b(1,f(g)))}),sb=m(Ic),Jc=d({permittedSubtrees:e(b(0,f(sb))),
excludedSubtrees:e(b(1,f(sb)))}),Kc=d({requireExplicitPolicy:e(b(0,f(g))),inhibitPolicyMapping:e(b(1,f(g)))}),Na=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),tb=p({fullName:b(0,f(A)),nameRelativeToCRLIssuer:b(1,f(kb))}),Lc=d({distributionPoint:e(b(0,t(tb))),reasons:e(b(1,f(Na))),cRLIssuer:e(b(2,f(A)))}),ua=m(Lc),Oa=d({accessMethod:k,accessLocation:z}),ub=X(function(a){return{extnID:k,critical:M(W,
!1),extnValue:h(L(a))}},"extnID"),oa=m(ub,function(a,c,b){return{extnID:a,critical:b&&b(a,c),extnValue:c}},function(a,c){return a[c.extnID]=c.extnValue}),va=oa({authorityKeyIdentifier:Ma,subjectKeyIdentifier:h,keyUsage:zc,privateKeyUsagePeriod:Ec,certificatePolicies:m(Gc),policyMappings:m(Hc),subjectAltName:A,issuerAltName:A,subjectDirectoryAttributes:Ha,basicConstraints:yc,nameConstraints:Jc,policyConstraints:Kc,extKeyUsage:Ac,cRLDistributionPoints:ua,inhibitAnyPolicy:g,freshestCRL:ua,authorityInfoAccess:m(Oa),
subjectInfoAccess:m(Oa)},function(a,c){return"keyUsage"===a||"basicConstraints"===a&&void 0===c.pathLenConstraint}),wa=function(){var a=d({r:g,s:g});return{encode:function(c){c=V(c);var b=c.byteLength/2,d="0x"+U().encode(new Uint8Array(c,0,b));c="0x"+U().encode(new Uint8Array(c,b,b));return T().encode(a.encode({r:c,s:d}))},decode:function(c){var b=a.decode(T().decode(c));c=new Uint8Array(U().decode(b.r.replace("0x","")));var b=new Uint8Array(U().decode(b.s.replace("0x",""))),d=new Uint8Array(b.length+
c.length);d.set(b,0);d.set(c,b.length);return V(d.buffer)}}}(),S={encode:function(a){return V(a)},decode:function(a){return V(a)}},vb=function(a){return function(c){var b=a[c.id];return{encode:function(a){b&&(a=b.encode(a));return a},decode:function(a){if(a instanceof ArrayBuffer)return b&&(a=b.decode(a)),a;throw new J("Invalid signature value");}}}}({noSignature:h,"id-GostR3410-94":S,"id-GostR3410-2001":S,"id-GostR3411-94-with-GostR3410-2001":S,"id-GostR3411-94-with-GostR3410-94":S,"id-tc26-gost3410-12-256":S,
"id-tc26-gost3410-12-512":S,"id-tc26-signwithdigest-gost3410-12-94":S,"id-tc26-signwithdigest-gost3410-12-256":S,"id-tc26-signwithdigest-gost3410-12-512":S,"id-sc-gostR3410-94":wa,"id-sc-gostR3410-2001":wa,"id-sc-gostR3411-94-with-gostR3410-94":wa,"id-sc-gostR3411-94-with-gostR3410-2001":wa}),ha=function(a){return{encode:function(c){c=x(c);c.signatureValue=vb(c.signatureAlgorithm).encode(c.signatureValue);return a.encode(c)},decode:function(c){c=a.decode(c);c.signatureValue=vb(c.signatureAlgorithm).decode(c.signatureValue);
return c}}},wb=d({version:b(0,t(g)),serialNumber:g,signature:N,issuer:R,validity:hc,subject:R,subjectPublicKeyInfo:aa,issuerUniqueID:e(b(1,f(q))),subjectUniqueID:e(b(2,f(q))),extensions:e(b(3,t(va)))}),xa=ha(d({tbsCertificate:wb,signatureAlgorithm:N,signatureValue:q})),Mc=H({challengePassword:G(da),extensionRequest:G(va),msCertExtensions:G(va),extendedCertificateAttributes:G(H)}),xb=d({version:g,subject:R,subjectPublicKeyInfo:aa,attributes:b(0,f(Mc))}),yb=ha(d({requestInfo:xb,signatureAlgorithm:N,
signatureValue:q})),zb=gb({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),Nc=d({distributionPoint:e(b(0,t(tb))),onlyContainsUserCerts:M(b(1,f(W)),!1),onlyContainsCACerts:M(b(2,f(W)),!1),onlySomeReasons:e(b(3,f(Na))),indirectCRL:M(b(4,f(W)),!1),onlyContainsAttributeCerts:M(b(5,f(W)),!1)}),Oc=oa({authorityKeyIdentifier:Ma,issuerAltName:A,cRLNumber:g,deltaCRLIndicator:g,issuingDistributionPoint:Nc,
freshestCRL:ua},function(a){return"cRLNumber"===a}),Pc=oa({cRLReason:zb,instructionCode:k,invalidityDate:F,certificateIssuer:A}),Ab=d({version:e(g),signature:N,issuer:R,thisUpdate:Y,nextUpdate:e(Y),revokedCertificates:e(m(d({userCertificate:g,revocationDate:Y,crlEntryExtensions:e(Pc)}))),crlExtensions:e(b(0,t(Oc)))}),Pa=ha(d({tbsCertList:Ab,signatureAlgorithm:N,signatureValue:q})),Qa=d({digestedObjectType:gb({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:e(k),digestAlgorithm:ea,
objectDigest:q}),ya=d({issuer:A,serial:g,issuerUID:e(q)}),Qc=d({issuerName:e(A),baseCertificateID:e(b(0,f(ya))),objectDigestInfo:e(b(1,f(Qa)))}),Rc=d({targetCertificate:ya,targetName:e(z),certDigestInfo:e(Qa)}),Sc=p({targetName:b(0,t(z)),targetGroup:b(1,t(z)),targetCert:b(2,f(Rc))}),Tc=m(Sc),Uc=oa({auditIdentity:h,targetInformation:Tc,authorityKeyIdentifier:Ma,authorityInfoAccess:m(Oa),cRLDistributionPoints:ua,noRevAvail:ma},function(a){return"auditIdentity"===a||"targetInformation"===a}),Vc=d({baseCertificateID:e(b(0,
f(ya))),entityName:e(b(1,f(A))),objectDigestInfo:e(b(2,f(Qa)))}),Wc=p({v1Form:A,v2Form:b(0,f(Qc))}),Bb=d({notBeforeTime:F,notAfterTime:F}),Cb=d({service:z,ident:z,authInfo:e(h)}),Xc=d({roleAuthority:e(b(0,f(A))),roleName:b(1,t(z))}),Yc=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),Zc=d({type:b(0,f(k)),value:b(1,f(y))}),$c=d({policyId:b(0,f(k)),classList:M(b(1,f(Yc)),["unclassified"]),securityCategories:e(b(2,f(C(Zc))))}),Db=d({policyAuthority:e(b(0,f(A))),values:m(p({octets:h,
oid:k,string:K}))}),Eb=d({version:g,holder:Vc,issuer:Wc,signature:N,serialNumber:g,attrCertValidityPeriod:Bb,attributes:Ha({authenticationInfo:C(Cb),accessIdentity:C(Cb),chargingIdentity:G(Db),group:G(Db),role:C(Xc),clearance:C($c)}),issuerUniqueID:e(q),extensions:e(Uc)}),Fb=ha(d({acinfo:Eb,signatureAlgorithm:N,signatureValue:q})),ia=h,pa=h;d({ephemeralPublicKey:Gb,addedukm:e(b(0,t(h)))});d({keyInfo:pb,entityUInfo:e(b(0,t(h))),suppPubInfo:b(2,t(h))});var ja=d({encryptedKey:h,maskKey:e(b(0,f(h))),
macKey:h}),ad=d({encryptionParamSet:k,ephemeralPublicKey:e(b(0,f(La))),ukm:h}),Hb=d({sessionEncryptedKey:ja,transportParameters:e(b(0,f(ad)))}),Ib=d({sessionEncryptedKey:ja,ukm:d({ephemeralPublicKey:La,addedukm:e(b(0,t(h)))})}),Ra=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,8,32))).buffer;a=(new Uint8Array(new Uint8Array(a,40,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(c){var b=a.ukm,d=c.encryptedKey;c=c.macKey;var e=new Uint8Array(b.byteLength+d.byteLength+
c.byteLength);e.set(new Uint8Array(b),0);e.set(new Uint8Array(d),8);e.set(new Uint8Array(c),40);return e}}},ka=function(a){var c=Ra(a);return{encode:function(a){return ja.encode(c.encode(a))},decode:function(a){return c.decode(ja.decode(a))}}},za=function(a){return{encode:function(c){return Hb.encode({sessionEncryptedKey:Ra(a).encode(c),transportParameters:{encryptionParamSet:ba("sBox")[a.wrapping.sBox||"E-A"],ephemeralPublicKey:a["public"],ukm:a.ukm}})},decode:function(c){c=Hb.decode(c);a.wrapping=
ca(c.transportParameters.encryptionParamSet);a.ukm=c.transportParameters.ukm;a["public"]=c.transportParameters.ephemeralPublicKey;return Ra(a).decode(c.sessionEncryptedKey)}}},Sa=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey;a=a.macKey;var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),
32);return d}}},Jb=function(a){return{encode:function(b){return Ib.encode({sessionEncryptedKey:Sa(a).encode(b),ukm:{ephemeralPublicKey:a["public"],addedukm:a.ukm}})},decode:function(b){b=Ib.decode(b);a.ukm=b.ukm.addedukm;a["public"]=b.ukm.ephemeralPublicKey;return Sa(a).decode(b.sessionEncryptedKey)}}},Ta=function(a){var b=Sa(a);return{encode:function(a){return ja.encode(b.encode(a))},decode:function(a){return b.decode(ja.decode(a))}}},Aa=function(a){return function(b){var d=a[b.id],d=d&&d.call&&
d(b)||d;return{encode:function(a){d&&(a=d.encode(a));return a},decode:function(a){d&&(a=d.decode(a));return a}}}}({"id-sc-gostR3410-2001":Jb,"id-sc-gostR3410-94":Jb,"id-GostR3410-2001":za,"id-GostR3410-94":za,"id-tc26-gost3410-12-256":za,"id-tc26-gost3410-12-512":za,"id-GostR3410-94-CryptoPro-ESDH":ka,"id-GostR3410-2001-CryptoPro-ESDH":ka,"id-tc26-agreement-gost-3410-12-256":ka,"id-tc26-agreement-gost-3410-12-512":ka,"id-sc-r3410-ESDH-r3411kdf":Ta,"id-Gost28147-89-None-KeyWrap":ka,"id-Gost28147-89-CryptoPro-KeyWrap":ka,
"id-sc-cmsGostWrap":Ta,"id-sc-cmsGost28147Wrap":Ta}),Ua=function(a){return{encode:function(b){b=x(b);b.encryptedKey=L(Aa(b.keyEncryptionAlgorithm)).encode(b.encryptedKey);return a.encode(b)},decode:function(b){b=a.decode(b);b.encryptedKey=L(Aa(b.keyEncryptionAlgorithm)).decode(b.encryptedKey);return b}}},la=k,pa=h,Va=m(g),bd=d({bodyPartPath:Va,identifier:k,content:y}),Ba=H({contentType:G(la),messageDigest:G(h),signingTime:G(Y)}),dd=H({countersignature:C(cd),unsignedData:C(bd)}),qa=d({issuer:R,serialNumber:g}),
ed=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),Kb=ha(d({version:g,sid:ed,digestAlgorithm:ea,signedAttrs:e(b(0,f(Ba))),signatureAlgorithm:N,signatureValue:h,unsignedAttrs:e(b(1,f(dd)))})),cd=Kb,fd=C(Kb),gd=C(ea),hd=d({version:g,certificate:xa,attributes:H}),id=d({extendedCertificateInfo:hd,signatureAlgorithm:N,signatureValue:q}),jd=d({otherCertFormat:k,otherCert:y}),kd=d({version:g,subject:p({baseCertificateID:b(0,f(ya)),subjectName:b(1,f(A))}),issuer:A,signature:N,serialNumber:g,
attCertValidityPeriod:Bb,attributes:Ha,issuerUniqueID:e(q),extensions:e(va)}),ld=ha(d({acInfo:kd,signatureAlgorithm:N,signatureValue:q})),Wa=d({eContentType:la,eContent:e(b(0,t(h)))}),md=p({certificate:xa,extendedCertificate:b(0,f(id)),v1AttrCert:b(1,f(ld)),v2AttrCert:b(2,f(Fb)),other:b(3,f(jd))}),nd=d({otherRevInfoFormat:k,otherRevInfo:y}),od=p({crl:Pa,other:b(1,f(nd))}),Lb=C(md),Mb=C(od),pd=d({version:g,digestAlgorithms:gd,encapContentInfo:Wa,certificates:e(b(0,f(Lb))),crls:e(b(1,f(Mb))),signerInfos:fd}),
qd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),rd=Ua(d({version:g,rid:qd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Nb=d({keyAttrId:k,keyAttr:e(y)}),sd=d({subjectKeyIdentifier:pa,date:e(F),other:e(Nb)}),td=p({issuerAndSerialNumber:qa,rKeyId:b(0,f(sd))}),ud=d({rid:td,encryptedKey:ia}),vd=m(ud),Gb=d({algorithm:sa,publicKey:q}),wd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa)),originatorKey:b(1,f(Gb))}),xd=function(a){return{encode:function(b){b=x(b);var d=b.keyEncryptionAlgorithm,
e=L(Aa(d));b.recipientEncryptedKeys=b.recipientEncryptedKeys.map(function(a){a=x(a);a.encryptedKey=e.encode(a.encryptedKey);return a});b.ukm=b.ukm||d.ukm;return a.encode(b)},decode:function(b){b=a.decode(b);var d=b.keyEncryptionAlgorithm;d.ukm=d.ukm||b.ukm;var e=L(Aa(d));b.recipientEncryptedKeys.forEach(function(a){a.encryptedKey=e.decode(a.encryptedKey)});return b}}}(d({version:g,originator:b(0,t(wd)),ukm:e(b(1,t(h))),keyEncryptionAlgorithm:ga,recipientEncryptedKeys:vd})),yd=d({keyIdentifier:h,date:e(F),
other:e(Nb)}),zd=Ua(d({version:g,kekid:yd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Ad=Ua(d({version:g,keyDerivationAlgorithm:e(b(0,f(Ja))),keyEncryptionAlgorithm:ga,encryptedKey:ia})),Bd=d({oriType:k,oriValue:y}),Cd=p({ktri:rd,kari:b(1,f(xd)),kekri:b(2,f(zd)),pwri:b(3,f(Ad)),ori:b(4,f(Bd))}),Xa=d({certs:e(b(0,f(Lb))),crls:e(b(1,f(Mb)))}),Ya=C(Cd),Za=d({contentType:la,contentEncryptionAlgorithm:tc,encryptedContent:e(b(0,f(h)))}),Ca=d({version:g,originatorInfo:e(b(0,f(Xa))),recipientInfos:Ya,encryptedContentInfo:Za,
unprotectedAttrs:e(b(1,f(H)))}),Dd=d({version:g,digestAlgorithm:ea,encapContentInfo:Wa,digest:h}),Ob=d({version:g,encryptedContentInfo:Za,unprotectedAttrs:e(b(1,f(H)))}),Ed=d({version:g,originatorInfo:e(b(0,f(Xa))),recipientInfos:Ya,macAlgorithm:Ia,digestAlgorithm:e(b(1,ea)),encapContentInfo:Wa,authAttrs:e(b(2,f(Ba))),mac:h,unauthAttrs:e(b(3,f(H)))}),Fd=d({version:g,originatorInfo:e(b(0,f(Xa))),recipientInfos:Ya,authEncryptedContentInfo:Za,authAttrs:e(b(1,f(Ba))),mac:h,unauthAttrs:e(b(2,f(H)))}),
Gd=p({encrypted:Ob,enveloped:b(0,f(Ca)),authEnveloped:b(1,f(Fd))}),la=k,ra=X(function(a){return{contentType:la,content:b(0,t(a))}},"contentType",la)({data:h,signedData:pd,envelopedData:Ca,digestedData:Dd,encryptedData:Ob,authData:Ed,encryptedKeyPkg:Gd,aKeyPackage:wc}),Hd=d({digestAlgorithm:ea,digest:h}),Id=H({friendlyName:G(eb),localKeyId:G(h)}),Jd=X(function(a){return{certId:k,certValue:b(0,t(a))}},"certId",k)({x509Certificate:h(L(xa)),sdsiCertificate:Ea},h),Kd=X(function(a){return{crlId:k,crlValue:b(0,
t(a))}},"crlId",k)({x509CRL:h(L(Pa))},h),Ld=X(function(a){return{secretTypeId:k,secretValue:b(0,t(a))}},"secretTypeId",k)({secret:h},h),Md=X(function(a){return{bagId:k,bagValue:b(0,t(a)),bagAttributes:e(Id)}},"bagId",k)(function(a){return{keyBag:na,pkcs8ShroudedKeyBag:rb,certBag:Jd,crlBag:Kd,secretBag:Ld,safeContentsBag:Pb}[a]}),Pb=m(Md),Nd=m(ra),Od=d({mac:Hd,macSalt:h,iterations:M(g,1)}),Pd=d({version:g,authSafe:ra,macData:e(Od)}),Qd=d({issuer:z,serialNumber:g}),Rd=d({intendedAlg:e(b(0,f(n))),symmAlg:e(b(1,
f(n))),encSymmKey:e(b(2,f(q))),keyAlg:e(b(3,f(n))),valueHint:e(b(4,f(h))),encValue:q}),ia=p({encryptedValue:Rd,envelopedData:b(0,f(Ca))}),Sd=p({encryptedPrivKey:b(0,ia),keyGenParameters:b(1,f(h)),archiveRemGenPrivKey:b(2,f(W))}),Td=d({pubMethod:g({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:e(z)}),Qb=d({action:g({dontPublish:0,pleasePublish:1}),pubInfos:e(m(Td))}),Ud=g({encrCert:0,challengeResp:1}),Sb=p({thisMessage:b(0,f(q)),subsequentMessage:b(1,f(Ud)),dhMAC:b(2,f(q)),agreeMAC:b(3,f(Rb)),encryptedKey:b(4,
f(Ca))});d({salt:h,owf:n,iterationCount:g,mac:n});var Rb=d({algId:n,value:q}),Vd=d({authInfo:p({sender:b(0,t(z)),publicKeyMAC:Rb}),publicKey:aa}),Wd=d({poposkInput:e(b(0,Vd)),algorithmIdentifier:n,signature:q}),Xd=p({raVerified:b(0,f(ma)),signature:b(1,f(Wd)),keyEncipherment:b(2,f(Sb)),keyAgreement:b(3,f(Sb))}),Yd=m(Ga({regToken:K,authenticator:K,pkiPublicationInfo:Qb,pkiArchiveOptions:Sd,oldCertID:Qd,protocolEncrKey:aa})),Zd=d({notBefore:e(b(0,f(Y))),notAfter:e(b(1,f(Y)))}),Tb=d({version:e(b(0,f(g))),
serialNumber:e(b(1,f(g))),signingAlg:e(b(2,f(n))),issuer:e(b(3,f(R))),validity:e(b(4,f(Zd))),subject:e(b(5,f(R))),publicKey:e(b(6,f(aa))),issuerUID:e(b(7,f(q))),subjectUID:e(b(8,f(q))),extensions:e(b(9,f(oa)))}),Ub=d({certReqId:g,certTemplate:Tb,controls:e(Yd)}),$d=d({privateKey:na,identifier:e(p([K,z]))}),Vb=d({certReq:Ub,popo:e(Xd),regInfo:e(m(Ga({utf8Pairs:K,certReq:Ub,encKeyWithID:$d})))});m(Vb);var Wb=d({pendToken:h,pendTime:F}),Xb=g({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,
popRequired:6,partial:7}),Yb=g({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),ae=d({cMCStatus:Xb,bodyList:m(g),statusString:e(K),otherInfo:e(p({failInfo:Yb,pendInfo:Wb}))}),be=d({pkiDataReference:g,certReferences:m(g),extensions:m(ub)}),ce=d({request:Zb,cms:ra,thePOPAlgID:n,witnessAlgID:n,witness:h}),de=d({pkiDataBodyid:g,bodyIds:m(g)}),ee=d({issuerName:z,
serialNumber:g}),fe=d({issuerName:R,cRLName:e(z),time:e(F),reasons:e(Na)}),ge=d({issuerName:R,serialNumber:g,reason:zb,invalidityDate:e(F),passphrase:e(h),comment:e(K)}),he=d({bodyPartID:g,thePOPAlgID:n,thePOP:h}),$b=p({bodyPartID:g,bodyPartPath:Va}),ie=d({cMCStatus:Xb,bodyList:m($b),statusString:e(K),otherInfo:e(p({failInfo:Yb,pendInfo:Wb,extendedFailInfo:d({failInfoOID:k,failInfoValue:Fa})}))}),je=d({seqNumber:g,hashAlgorithm:n,anchorHashes:m(h)}),$a=m(g),ke=d({hashAlg:n,certHashes:m(h),pubInfo:Qb}),
le=d({pkiDataReference:Va,certReferences:$a,replace:M(W,!0),certTemplate:Tb}),me=d({bodyList:m($b)}),ne=d({proofAlgID:n,macAlgId:n,witness:h}),oe=d({keyGenAlgorithm:n,macAlgorithm:n,witness:h}),ac=jb(function(a){return d({bodyPartID:g,attrType:k,attrValues:C(a)},{encode:function(a){return a.attrType},decode:function(a){return k.decode(a[1])}},Fa)({statusInfo:ae,identification:K,identityProof:h,dataReturn:h,transactionId:g,senderNonce:h,recipientNonce:h,addExtensions:be,encryptedPOP:ce,decryptedPOP:he,
lraPOPWitness:de,getCert:ee,getCRL:fe,revokeRequest:ge,regInfo:h,responseInfo:h,queryPending:h,popLinkRandom:h,popLinkWitness:h,confirmCertAcceptance:qa,statusInfoV2:ie,trustedAnchors:je,authData:g,batchRequests:$a,batchResponses:$a,publishCert:ke,modCertTemplate:le,controlProcessed:me,popLinkWitnessV2:oe,identityProofV2:ne})}),pe=d({bodyPartID:g,certificationRequest:yb}),bc=d({bodyPartID:g,contentInfo:ra}),cc=d({bodyPartID:g,otherMsgType:k,otherMsgValue:y}),Zb=p({tcr:b(0,f(pe)),crm:b(1,f(Vb)),orm:b(2,
f(d({bodyPartID:g,requestMessageType:k,requestMessageValue:y})))}),qe=d({controlSequence:m(ac),reqSequence:m(Zb),cmsSequence:m(bc),otherMsgSequence:m(cc)}),re=d({controlSequence:m(ac),cmsSequence:m(bc),otherMsgSequence:m(cc)}),v=function(a,b){return{encode:function(d,e){d=a.encode(d);d=T().encode(d);"PEM"===(e||"DER").toUpperCase()&&(d=(w||(w=D.gostCoding)).PEM.encode(d,b));return d},decode:function(d){if("string"===typeof d||d instanceof String)d=(w||(w=D.gostCoding)).PEM.decode(d,b);d=T().decode(d);
return a.decode(d)}}};return{CanocicalName:gc,GostPrivateKeyInfo:v(xc,"PRIVATE KEY"),GostSubjectPublicKeyInfo:v(La,"PUBLIC KEY"),PrivateKeyInfo:v(na,"PRIVATE KEY"),EncryptedPrivateKeyInfo:v(rb,"ENCRYPTED PRIVATE KEY"),SubjectPublicKeyInfo:v(aa,"PUBLIC KEY"),TBSCertificate:v(wb),Certificate:v(xa,"CERTIFICATE"),CertificationRequestInfo:v(xb),CertificationRequest:v(yb,"CERTIFICATE REQUEST"),TBSCertList:v(Ab),CertificateList:v(Pa,"CRL"),AttributeCertificateInfo:v(Eb),AttributeCertificate:v(Fb,"ATTRIBUTE CERTIFICATE"),
SignedAttributes:v(Ba),ContentInfo:v(ra,"CMS"),SafeContents:v(Pb),AuthenticatedSafe:v(Nd),PFX:v(Pd,"PFX"),PKIData:v(qe,"PKI REQUEST"),PKIResponse:v(re,"PKI RESPONSE")}});
