/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(c,g){"function"===typeof define&&define.amd?define(["gostRandom","gost28147","gostR3411","gostR3410"],g):"object"===typeof exports?module.exports=g(require("gostRandom"),require("gost28147"),require("gostR3411"),require("gostR3410")):("undefined"!==typeof importScripts&&(c.gostRandom&&c.Gost28147&&c.GostR3411&&c.GostR3410||importScripts("gostRandom.js","gost28147.js","gostR3411.js","gostR3410.js")),c.gostEngine=g(c.gostRandom,c.Gost28147,c.GostR3411,c.GostR3410))})(this,function(c,g,k,l){var f=
this,m={execute:function(b,a,c){var d;if(!b)throw new (f.SyntaxError||Error)("Algorithm not defined");if(!b.name)throw new (f.SyntaxError||Error)("Algorithm name not defined");d=b.name;var e=b.mode;if("GOST 28147"!==d||"generateKey"!==a&&("MAC"!==e||"sign"!==a&&"verify"!==a)&&("KW"!==e||"wrapKey"!==a&&"unwrapKey"!==a)&&(e&&"ES"!==e||"encrypt"!==a&&"decrypt"!==a))if("GOST R 34.11"!==d||"digest"!==a&&("HMAC"!==e||"sign"!==a&&"verify"!==a&&"generateKey"!==a)&&("PBKDF2"!==e||"deriveKey"!==a&&"deriveBits"!==
a&&"generateKey"!==a)){if("GOST R 34.10"!==d||"generateKey"!==a&&(e&&"SIGN"!==e||"sign"!==a&&"verify"!==a)&&"DH"!==e&&"deriveKey"!==a&&"deriveBits"!==a)throw new (f.NotSupportedError||Error)("Algorithm "+d+"-"+e+" is not valid for "+a);d="GostR3410"}else d="GostR3411";else d="Gost28147";b=this["get"+d](b);return b[a].apply(b,c)},getGost28147:function(b){return new (g||(g=f.Gost28147))(b)},getGostR3411:function(b){return new (k||(k=f.GostR3411))(b)},getGostR3410:function(b){return new (l||(l=f.GostR3410))(b)}};
if(f.importScripts)f.onmessage=function(b){try{postMessage({id:b.data.id,result:m.execute(b.data.algorithm,b.data.method,b.data.args)})}catch(a){postMessage({id:b.data.id,error:a.message})}};else{var n="",p="";"undefined"!==typeof document&&function(){for(var b=/^(.*)gostCrypto(.*)\.js$/i,a=document.querySelectorAll("script"),c=0,d=a.length;c<d;c++){var e=a[c].getAttribute("src");if(e=b.exec(e))n=e[1],p=e[2]}}();var h=function(){for(var b=0,a=arguments.length;b<a;b++){var c=arguments[b].split("."),
c=n+c[0]+p+"."+c[1],d=document.querySelector('script[src="'+c+'"]');d||(d=document.createElement("script"),d.setAttribute("src",c),document.head.appendChild(d))}};c||h("gostRandom.js");g||h("gost28147.js");k||h("gostR3411.js");l||h("gostR3410.js")}return m});
