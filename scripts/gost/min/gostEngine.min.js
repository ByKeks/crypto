/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(c,g){"function"===typeof define&&define.amd?define(["gostRandom","gostCipher","gostDigest","gostSign"],g):"object"===typeof exports?module.exports=g(require("gostRandom"),require("gostCipher"),require("gostDigest"),require("gostSign")):("undefined"!==typeof importScripts&&(c.GostRandom&&c.GostCipher&&c.GostDigest&&c.GostSign||importScripts("gostRandom.js","gostCipher.js","gostDigest.js","gostSign.js")),c.gostEngine=g(c.GostRandom,c.GostCipher,c.GostDigest,c.GostSign))})(this,function(c,
g,k,l){var f=this,m={execute:function(b,a,c){var d;if(!b)throw new (f.SyntaxError||Error)("Algorithm not defined");if(!b.name)throw new (f.SyntaxError||Error)("Algorithm name not defined");d=b.name;var e=b.mode;if("GOST 28147"!==d&&"GOST R 34.12"!==d&&"RC2"!==d||"generateKey"!==a&&("MAC"!==e||"sign"!==a&&"verify"!==a)&&("KW"!==e||"wrapKey"!==a&&"unwrapKey"!==a)&&(e&&"ES"!==e||"encrypt"!==a&&"decrypt"!==a))if("GOST R 34.11"!==d&&"SHA"!==d||"digest"!==a&&("HMAC"!==e||"sign"!==a&&"verify"!==a&&"generateKey"!==
a)&&("KDF"!==e&&"PBKDF2"!==e&&"PFXKDF"!==e&&"CPKDF"!==e||"deriveKey"!==a&&"deriveBits"!==a&&"generateKey"!==a)){if("GOST R 34.10"!==d||"generateKey"!==a&&(e&&"SIGN"!==e||"sign"!==a&&"verify"!==a)&&("KW"!==e||"wrapKey"!==a&&"unwrapKey"!==a)&&("DH"!==e||"deriveKey"!==a&&"deriveBits"!==a))throw new (f.NotSupportedError||Error)("Algorithm "+d+"-"+e+" is not valid for "+a);d="GostSign"}else d="GostDigest";else d="GostCipher";b=this["get"+d](b);return b[a].apply(b,c)},getGostCipher:function(b){return new (g||
(g=f.GostCipher))(b)},getGostDigest:function(b){return new (k||(k=f.GostDigest))(b)},getGostSign:function(b){return new (l||(l=f.GostSign))(b)}};if(f.importScripts)f.onmessage=function(b){try{postMessage({id:b.data.id,result:m.execute(b.data.algorithm,b.data.method,b.data.args)})}catch(a){postMessage({id:b.data.id,error:a.message})}};else{var n="",p="";"undefined"!==typeof document&&function(){for(var b=/^(.*)gostCrypto(.*)\.js$/i,a=document.querySelectorAll("script"),c=0,d=a.length;c<d;c++){var e=
a[c].getAttribute("src");if(e=b.exec(e))n=e[1],p=e[2]}}();var h=function(){for(var b=0,a=arguments.length;b<a;b++){var c=arguments[b].split("."),c=n+c[0]+p+"."+c[1],d=document.querySelector('script[src="'+c+'"]');d||(d=document.createElement("script"),d.setAttribute("src",c),document.head.appendChild(d))}};c||h("gostRandom.js");g||h("gostCipher.js");k||h("gostDigest.js");l||h("gostSign.js")}return m});
