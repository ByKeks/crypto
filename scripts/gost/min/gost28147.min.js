/*
 201-15, Rudolf Nickolaev. All rights reserved.
*/
(function(x,B){"function"===typeof define&&define.amd?define(["gostRandom"],B):"object"===typeof exports?module.exports=B(require("gostRandom")):("undefined"!==typeof importScripts&&(x.gostRandom||importScripts("gostRandom.js")),x.Gost28147=B(x.gostRandom))})(this,function(x){function B(b){return 2147483648<=b?b-4294967296:b}function R(b){return 0>b?b+4294967296:b}function I(b){x=x||C.gostRandom;!x&&N&&N.getRandomValues&&(x=N);if(x)x.getRandomValues(b);else throw new J("Random generator not found");
}function v(b){if(b instanceof ArrayBuffer)return b;if(b&&b.buffer&&b.buffer instanceof ArrayBuffer)return 0===b.byteOffset&&b.byteLength===b.buffer.byteLength?b.buffer:(new Uint8Array(new Uint8Array(b,b.byteOffset,b.byteLength))).buffer;throw new w("ArrayBuffer or ArrayBufferView required");}function z(b){return new Uint8Array(v(b))}function A(b){return new Uint8Array(z(b))}function y(b){return(b&255)<<24|(b&65280)<<8|b>>8&65280|b>>24&255}function O(b,c,a,e){a=e?y(c[1])+y(a)&4294967295:c[0]+a&4294967295;
var d=b[0+(a>>0&15)]<<0,d=d|b[16+(a>>4&15)]<<4,d=d|b[32+(a>>8&15)]<<8,d=d|b[48+(a>>12&15)]<<12,d=d|b[64+(a>>16&15)]<<16,d=d|b[80+(a>>20&15)]<<20,d=d|b[96+(a>>24&15)]<<24,d=d|b[112+(a>>28&15)]<<28;a=d<<11|d>>>21;e?(a=y(a)^c[0],c[0]=c[1],c[1]=a):(a^=c[1],c[1]=c[0],c[0]=a)}function Z(b,c){for(var a=this.sBox,e=0;32>e;e++)O(a,c,b[e]);a=c[0];c[0]=c[1];c[1]=a}function $(b,c){var a=this.sBox,e=y(c[0]);c[0]=y(c[1]);c[1]=e;for(e=0;32>e;e++)O(a,c,b[e]);c[0]=y(c[0]);c[1]=y(c[1])}function aa(b,c){for(var a=new Int32Array(32),
e=new Int32Array(v(c)),d=0;8>d;d++)a[d]=e[d];if(b){for(d=0;8>d;d++)a[d+8]=a[d];for(d=0;8>d;d++)a[d+16]=a[d]}else{for(d=0;8>d;d++)a[d+8]=a[7-d];for(d=0;8>d;d++)a[d+16]=a[7-d]}for(d=0;8>d;d++)a[d+24]=a[7-d];return a}function ba(b,c){for(var a=new Int32Array(32),e=new Int32Array(v(c)),d=0;8>d;d++)a[d]=y(e[d]);if(b){for(d=0;8>d;d++)a[d+8]=a[d];for(d=0;8>d;d++)a[d+16]=a[d]}else{for(d=0;8>d;d++)a[d+8]=a[7-d];for(d=0;8>d;d++)a[d+16]=a[7-d]}for(d=0;8>d;d++)a[d+24]=a[7-d];return a}function D(b,c){for(var a=
this.pad(z(c)),e=this.blockLength>>3,d=e>>2,g=a.byteLength/e,n=this.keySchedule(!0,b),q=0;q<g;q++){var h=new Int32Array(a.buffer,e*q,d);this.process(n,h)}return a.buffer}function K(b,c){for(var a=A(c),e=this.blockLength>>3,d=e>>2,g=a.byteLength/e,n=this.keySchedule(!1,b),q=0;q<g;q++){var h=new Int32Array(a.buffer,e*q,d);this.process(n,h)}return this.unpad(a).buffer}function S(b,c,a){a=new Uint8Array(a||this.iv);c=A(c);for(var e=this.blockLength>>3,d=e>>2,g=a.length,n=g>>2,q=new Uint8Array(g),h=this.shiftBits>>
3,m=c.length,s=m%h,m=(m-s)/h,l=this.keySchedule(!0,b),p=new Int32Array(a.buffer),t=0;t<m;t++){if(h===e){this.process(l,p);for(var u=new Int32Array(c.buffer,t*h,d),r=0;r<d;r++)u[r]^=p[r];if(n!==d)for(r=0;r<n-d;r++)p[r]=p[d+r];for(r=0;r<d;r++)p[r+n-d]=u[r]}else{for(r=0;r<g;r++)q[r]=a[r];this.process(l,p);for(r=0;r<h;r++)c[t*h+r]^=a[r];for(r=0;r<g-h;r++)a[r]=q[h+r];for(r=0;r<h;r++)a[g-h+r]=c[t*h+r]}b=this.keyMeshing(b,a,t,!0,l)}if(0<s)for(this.process(l,p),t=0;t<s;t++)c[m*h+t]^=a[t];return c.buffer}
function ca(b,c,a){a=new Uint8Array(a||this.iv);c=A(c);for(var e=this.blockLength>>3,d=e>>2,g=a.length,n=g>>2,q=new Uint8Array(g),h=this.shiftBits>>3,m=c.length,s=m%h,m=(m-s)/h,l=this.keySchedule(!0,b),p=new Int32Array(a.buffer),t=0;t<m;t++){if(h===e){this.process(l,p);for(var u=new Int32Array(c.buffer,t*h,d),r=new Int32Array(q.buffer),f=0;f<d;f++)r[f]=u[f];for(f=0;f<d;f++)u[f]^=p[f];if(n!==d)for(f=0;f<n-d;f++)p[f]=p[d+f];for(f=0;f<d;f++)p[f+n-d]=r[f]}else{for(f=0;f<g;f++)q[f]=a[f];this.process(l,
p);for(f=0;f<h;f++)q[f]=c[t*h+f],c[t*h+f]^=a[f];for(f=0;f<g-h;f++)a[f]=q[h+f];for(f=0;f<h;f++)a[g-h+f]=q[f]}b=this.keyMeshing(b,a,t,!0,l)}if(0<s)for(this.process(l,p),t=0;t<s;t++)c[m*h+t]^=a[t];return c.buffer}function da(b,c,a){a=new Uint8Array(a||this.iv);c=A(c);for(var e=this.blockLength>>3,d=e>>2,g=a.length,n=g>>2,q=new Uint8Array(g),h=this.shiftBits>>3,m=new Uint8Array(h),s=c.length,l=s%h,s=(s-l)/h,p=this.keySchedule(!0,b),t=new Int32Array(a.buffer),u=0;u<s;u++){if(h===e){this.process(p,t);for(var r=
new Int32Array(q.buffer),f=0;f<d;f++)r[f]=t[f];for(var v=new Int32Array(c.buffer,u*h,d),f=0;f<d;f++)v[f]^=t[f];if(n!==d)for(f=0;f<n-d;f++)t[f]=t[d+f];for(f=0;f<d;f++)t[f+n-d]=r[f]}else{for(f=0;f<g;f++)q[f]=a[f];this.process(p,t);for(f=0;f<h;f++)m[f]=a[f];for(f=0;f<h;f++)c[u*h+f]^=a[f];for(f=0;f<g-h;f++)a[f]=q[h+f];for(f=0;f<h;f++)a[g-h+f]=m[f]}b=this.keyMeshing(b,a,u,!0,p)}if(0<l)for(this.process(p,t),u=0;u<l;u++)c[s*h+u]^=a[u];return c.buffer}function ea(b,c,a){a=new Uint8Array(a||this.iv);c=A(c);
var e=new Int32Array(2),d=this.blockLength>>3,g=d>>2,n=c.length,q=n%d,n=(n-q)/d,h=this.keySchedule(!0,b),m=new Int32Array(a.buffer);this.process(h,m);for(var s=0;s<n;s++){var l=new Int32Array(c.buffer,s*d,g);m[0]=m[0]+16843009&4294967295;m[1]=B(R(m[1]+16843012&4294967295)%4294967295);for(var p=0;p<g;p++)e[p]=m[p];this.process(h,m);for(p=0;p<g;p++)l[p]^=m[p];for(p=0;p<g;p++)m[p]=e[p];b=this.keyMeshing(b,a,s,!0,h)}if(0<q)for(m[0]=m[0]+16843009&4294967295,m[1]=B(R(m[1]+16843012&4294967295)%4294967295),
this.process(h,m),s=0;s<q;s++)c[n*d+s]^=a[s];return c.buffer}function P(b,c,a){c=A(c);var e=this.blockLength>>3,d=e>>2,g=this.shiftBits>>3,n=c.length,q=n%g,n=(n-q)/g,h=new Uint8Array(e),m=new Int32Array(d);b=this.keySchedule(!0,b);var s=new Int32Array(h.buffer);h.set(a||this.iv);for(a=0;a<n;a++){for(var l=0;l<d;l++)m[l]=s[l];this.process(b,s);for(l=0;l<g;l++)c[g*a+l]^=h[l];for(l=0;l<d;l++)s[l]=m[l];for(l=e-1;0<=a;--a)if(254<h[l])h[l]-=254;else{h[l]++;break}}if(0<q)for(this.process(b,s),l=0;l<q;l++)c[g*
n+l]^=h[l];return c.buffer}function T(b,c,a){a=new Uint8Array(a||this.iv);var e=this.blockLength>>3,d=a.length>>2,g=e>>2;c=this.pad(z(c));for(var n=this.keySchedule(!0,b),q=new Int32Array(a.buffer),h=0,m=c.length/e;h<m;h++){for(var s=new Int32Array(c.buffer,h*e,g),l=0;l<g;l++)q[l]^=s[l];this.process(n,q);for(l=0;l<g;l++)s[l]=q[l];if(d!==g){for(l=0;l<d-g;l++)q[l]=q[g+l];for(l=0;l<g;l++)q[l+d-g]=s[l]}b=this.keyMeshing(b,a,h,!0,n)}return c.buffer}function fa(b,c,a){a=new Uint8Array(a||this.iv);var e=
this.blockLength>>3,d=a.length>>2,g=e>>2;c=A(c);for(var n=new Int32Array(2),q=this.keySchedule(!1,b),h=new Int32Array(a.buffer),m=0,s=c.length/e;m<s;m++){for(var l=new Int32Array(c.buffer,m*e,g),p=0;p<g;p++)n[p]=l[p];this.process(q,l);for(p=0;p<g;p++)l[p]^=h[p];if(d!==g)for(p=0;p<d-g;p++)h[p]=h[g+p];for(p=0;p<g;p++)h[p+d-g]=n[p];b=this.keyMeshing(b,a,m,!1,q)}return this.unpad(c.buffer)}function M(){var b=new Uint8Array(this.bitLength/8);I(b);return b.buffer}function ga(b,c,a){a=U.call(this,z(a));
for(var e=this.blockLength>>3,d=e>>2,g=a.length/e,n=this.sBox,q=0;q<g;q++){for(var h=new Int32Array(a.buffer,q*e,d),m=0;m<d;m++)c[m]^=h[m];for(m=0;16>m;m++)O(n,c,b[m])}}function V(b){var c=0;b=new Uint8Array(b.buffer);for(var a=b.length,e=a-1;0<=e;--e){var d=b[e]>>>7;b[e]=b[e]<<1&255|c;c=d}0!==c&&(16===a?b[15]^=135:b[7]^=27)}function ha(b,c,a){var e=this.blockLength>>3,d=e>>2,g=z(a),n=new Int32Array(d);this.process(b,n);V(n);0!==a.byteLength%e&&(g=W.call(this,z(a)),V(n));a=0;for(var q=g.length/e;a<
q;a++){for(var h=new Int32Array(g.buffer,a*e,d),m=0;m<d;m++)c[m]^=h[m];if(a===q-1)for(m=0;m<d;m++)c[m]^=n[m];this.process(b,c)}}function E(b,c,a){b=this.keySchedule(!0,b);a=new Uint8Array(a||this.iv);var e=this.blockLength>>3,d=new Int32Array(a.buffer);this.processMAC(b,d,c);c=Math.ceil(this.macLength/e)||e>>1;b=new Uint8Array(c);b.set(new Uint8Array(a.buffer,0,c));return b.buffer}function F(b,c,a,e){b=new Uint8Array(E.call(this,b,a,e));c=z(c);if(b.length!==c.length)return!1;a=0;for(e=b.length;a<
e;a++)if(b[a]!==c[a])return!1;return!0}function ia(b,c,a){a||(this.ukm?a=new Uint8Array(this.ukm):I(a=new Uint8Array(8)));var e=E.call(this,b,c,a);b=D.call(this,b,c);c=new Uint8Array(44);c.set(new Uint8Array(a));c.set(new Uint8Array(b),8);c.set(new Uint8Array(e),40);return c.buffer}function ja(b,c){var a=v(c);if(44!==a.byteLength)throw new w("Wrapping key size must be 44 bytes");var e=new Uint8Array(a,0,8),d=new Uint8Array(a,8,32),a=new Uint8Array(a,40,4),d=K.call(this,b,d);if(!F.call(this,b,a,d,
e))throw new w("Error verify MAC of wrapping key");return d}function X(b,c){for(var a=new Int32Array(v(b)),e=[],d=0;8>d;d++){e[d]=[];for(var g=0;8>g;g++)e[d][g]=c[d]>>>g&1}for(d=0;8>d;d++){for(var n=new Int32Array(2),g=0;8>g;g++)e[d][g]?n[0]=n[0]+a[g]&4294967295:n[1]=n[1]+a[g]&4294967295;g=new Uint8Array(n.buffer);a=new Int32Array(S.call(this,a,a,g))}return a}function ka(b,c,a){a||(this.ukm?a=new Uint8Array(this.ukm):I(a=new Uint8Array(8)));var e=X.call(this,b,a);b=E.call(this,b,c,a);c=D.call(this,
e,c);e=new Uint8Array(44);e.set(new Uint8Array(a));e.set(new Uint8Array(c),8);e.set(new Uint8Array(b),40);return e.buffer}function la(b,c){var a=v(c);if(44!==a.byteLength)throw new w("Wrapping key size must be 44 bytes");var e=new Uint8Array(a,0,8),d=new Uint8Array(a,8,32),a=new Uint8Array(a,40,4),g=X.call(this,b,e),d=K.call(this,g,d);if(!F.call(this,b,a,d,e))throw new w("Error verify MAC of wrapping key");return d}function Y(b){var c=v(b);if(34!==(new Uint8Array(c,0,1))[0])throw new w("Invalid magic number");
var a=(new Uint8Array(c,1,1))[0];b=new Uint8Array(c,2,4);for(var e=new Uint8Array(32),d=0;d<a;d++)for(var g=new Uint8Array(c,6+32*d,32),n=0;32>n;n++)e[n]^=g[n];c=new Uint8Array(32);a=F.call(this,e,b,c);if(!a)for(g="E-A E-B E-C E-D E-SC D-A D-SC D-TEST E-Z E-DEFAULT E-TEST".split(" "),d=0,n=g.length;d<n&&!(this.sBox=G[g[d]],a=F.call(this,e,b,c));d++);if(!a)throw new w("Invalid main key MAC");return e.buffer}function ma(b,c){var a=v(b),e=v(c);32!==a.byteLength&&(a=Y.call(this,a));var d=D.call(this,
a,e),a=E.call(this,a,e),e=new Uint8Array(36);e.set(new Uint8Array(d),0);e.set(new Uint8Array(a),32);return e.buffer}function na(b,c){var a=v(b),e=v(c);32!==a.byteLength&&(a=Y.call(this,a));var d=new Uint8Array(e,0,32),e=new Uint8Array(e,32,4),d=K.call(this,a,d);if(!F.call(this,a,e,d))throw new w("Invalid key MAC");return d}function oa(){var b=M.call(this),c=void 0,a=8,b=new Uint8Array(v(b));if(32!==b.byteLength)throw new w("Wrong cleartext size "+k.byteLength+" bytes");if(c)if(c=new Uint8Array(v(c)),
0<c.byteLength&&0===c.byteLength%32)a=c.byteLength/32+1;else throw new w("Wrong rand size "+c.byteLength+" bytes");else I(c=new Uint8Array(32*(a-1)));var e=new Uint8Array(32*a+6),d=g.buffer,g=new Uint8Array(32),g=E.call(this,b,g);e[0]=34;e[1]=a;e.set(g,2);e.set(c,38);for(c=1;c<a;c++)for(var g=new Uint8Array(d,6+32*c),n=0;32>n;n++)b[n]^=g[n];e.set(b,6);return e.buffer}function pa(b,c,a,e,d){0===(a+1)%256&&(b=K.call(this,b,qa),c.set(new Uint8Array(D.call(this,b,c))),d.set(this.keySchedule(e,b)));return b}
function Q(b){return b}function L(b){return new Uint8Array(b)}function ra(b){var c=b.byteLength,a=this.blockLength>>3,e=a-c%a,a=Math.ceil((c+1)/a)*a,d=new Uint8Array(a);d.set(b);for(b=c;b<a;b++)d[b]=e;return d}function sa(b){var c=b.byteLength,a=b[c-1],c=c-a;if(a>this.blockLength>>3)throw w("Invalid padding");a=new Uint8Array(c);0<c&&a.set(new Uint8Array(b.buffer,0,c));return a}function U(b){var c=b.byteLength,a=this.blockLength>>3,a=Math.ceil(c/a)*a,e=new Uint8Array(a);e.set(b);for(b=c;b<a;b++)e[b]=
0;return e}function W(b){var c=b.byteLength,a=this.blockLength>>3,a=Math.ceil((c+1)/a)*a,e=new Uint8Array(a);e.set(b);e[c]=1;for(b=c+1;b<a;b++)e[b]=0;return e}function ta(b){for(var c=b.byteLength;1<c&&0===b[c-1];)c--;if(1!==b[c-1])throw w("Invalid padding");c--;var a=new Uint8Array(c);0<c&&a.set(new Uint8Array(b.buffer,0,c));return a}function ua(b){var c=b.byteLength,a=this.blockLength>>3,e=a-c%a,a=Math.ceil(c/a)*a,a=new Uint8Array(a),c=new Uint8Array(a.buffer,c,e);a.set(b);I(c);return a}var C=this,
N=C.crypto||C.msCrypto,H=C.SyntaxError||Error,w=C.DataError||Error,J=C.NotSupportedError||Error,va=function(){var b=new ArrayBuffer(2);(new DataView(b)).setInt16(0,256,!0);return 256===(new Int16Array(b))[0]}(),wa=new Uint8Array([0,0,0,0,0,0,0,0]),G={"E-DEFAULT":[12,4,6,2,10,5,11,9,14,8,13,7,0,3,15,1,6,8,2,3,9,10,5,12,1,14,4,7,11,13,0,15,11,3,5,8,2,15,10,13,14,1,7,4,12,9,6,0,12,8,2,1,13,4,15,6,7,0,10,5,3,14,9,11,7,15,5,10,8,1,6,13,0,9,3,14,11,4,2,12,5,13,15,6,9,2,12,10,11,7,8,1,4,3,14,0,8,14,2,5,
6,9,1,12,15,4,11,0,13,10,3,7,1,7,14,13,0,5,8,3,4,15,10,6,9,12,11,2],"E-TEST":[4,2,15,5,9,1,0,8,14,3,11,12,13,7,10,6,12,9,15,14,8,1,3,10,2,7,4,13,6,0,11,5,13,8,14,12,7,3,9,10,1,5,2,4,6,15,0,11,14,9,11,2,5,15,7,1,0,13,12,6,10,4,3,8,3,14,5,9,6,8,0,13,10,11,7,12,2,1,15,4,8,15,6,11,1,9,12,5,13,3,7,10,0,14,2,4,9,11,12,0,3,6,7,5,4,8,14,15,1,10,2,13,12,6,5,2,11,0,9,13,3,14,7,10,15,4,1,8],"E-A":[9,6,3,2,8,11,1,7,10,4,14,15,12,0,13,5,3,7,14,9,8,10,15,0,5,2,6,12,11,4,13,1,14,4,6,2,11,3,13,8,12,15,5,10,0,7,1,
9,14,7,10,12,13,1,3,9,0,2,11,4,15,8,5,6,11,5,1,9,8,13,15,0,14,4,2,3,12,7,10,6,3,10,13,12,1,2,0,11,7,5,9,4,8,15,14,6,1,13,2,9,7,10,6,0,8,12,4,5,15,3,11,14,11,10,15,5,0,12,14,8,6,2,3,9,1,7,13,4],"E-B":[8,4,11,1,3,5,0,9,2,14,10,12,13,6,7,15,0,1,2,10,4,13,5,12,9,7,3,15,11,8,6,14,14,12,0,10,9,2,13,11,7,5,8,15,3,6,1,4,7,5,0,13,11,6,1,2,3,10,12,15,4,14,9,8,2,7,12,15,9,5,10,11,1,4,0,13,6,8,14,3,8,3,2,6,4,13,14,11,12,1,7,15,10,0,9,5,5,2,10,11,9,1,12,3,7,4,13,0,6,15,8,14,0,4,11,14,8,3,7,1,10,2,9,6,15,13,5,
12],"E-C":[1,11,12,2,9,13,0,15,4,5,8,14,10,7,6,3,0,1,7,13,11,4,5,2,8,14,15,12,9,10,6,3,8,2,5,0,4,9,15,10,3,7,12,13,6,14,1,11,3,6,0,1,5,13,10,8,11,2,9,7,14,15,12,4,8,13,11,0,4,5,1,2,9,3,12,14,6,15,10,7,12,9,11,1,8,14,2,4,7,3,6,5,10,0,15,13,10,9,6,8,13,14,2,0,15,3,5,11,4,1,12,7,7,4,0,5,10,2,15,14,12,6,1,11,13,9,3,8],"E-D":[15,12,2,10,6,4,5,0,7,9,14,13,1,11,8,3,11,6,3,4,12,15,14,2,7,13,8,0,5,10,9,1,1,12,11,0,15,14,6,5,10,13,4,8,9,3,7,2,1,5,14,12,10,7,0,13,6,2,11,4,9,3,15,8,0,12,8,9,13,2,10,11,7,3,6,
5,4,14,15,1,8,0,15,3,2,5,14,11,1,10,4,7,12,9,13,6,3,0,6,15,1,14,9,2,13,8,12,4,11,10,5,7,1,10,6,8,15,11,0,4,12,3,5,9,7,13,2,14],"E-SC":[3,6,1,0,5,7,13,9,4,11,8,12,14,15,2,10,7,1,5,2,8,11,9,12,13,0,3,10,15,14,4,6,15,1,4,6,12,8,9,2,14,3,7,10,11,13,5,0,3,4,15,12,5,9,14,0,6,8,7,10,1,11,13,2,6,9,0,7,11,8,4,12,2,14,10,15,1,13,5,3,6,1,2,15,0,11,9,12,7,13,10,5,8,4,14,3,0,2,14,12,9,1,4,7,3,15,6,8,10,13,11,5,5,2,11,8,4,12,7,1,10,6,14,0,9,3,13,15],"E-Z":[1,8,5,7,12,11,6,12,7,14,13,15,8,3,8,4,14,2,15,5,2,5,2,
6,13,5,6,10,1,8,3,2,0,6,9,8,13,2,9,10,5,9,2,1,4,15,10,5,8,1,12,6,15,10,5,11,3,12,10,13,6,13,12,9,4,15,11,0,7,14,1,14,15,4,7,9,0,1,14,8,10,11,8,3,10,7,4,13,6,0,1,14,5,4,7,7,9,13,4,11,3,12,11,0,12,10,3,4,14,9,13,3,11,3,14,2,9,6,0,15,2,7,0,12,11,0,15,1],"D-TEST":[4,10,9,2,13,8,0,14,6,11,1,12,7,15,5,3,14,11,4,12,6,13,15,10,2,3,8,1,0,7,5,9,5,8,1,13,10,3,4,2,14,15,12,7,6,0,9,11,7,13,10,1,0,8,9,15,14,4,6,12,11,2,5,3,6,12,7,1,5,15,13,8,4,10,9,14,0,3,11,2,4,11,10,0,7,2,1,13,3,6,8,5,9,12,15,14,13,11,4,1,3,
15,5,9,0,10,14,7,6,8,2,12,1,15,13,0,5,7,10,4,9,2,3,14,6,11,8,12],"D-A":[10,4,5,6,8,1,3,7,13,12,14,0,9,2,11,15,5,15,4,0,2,13,11,9,1,7,6,3,12,14,10,8,7,15,12,14,9,4,1,0,3,11,5,2,6,10,8,13,4,10,7,12,0,15,2,8,14,1,6,5,13,11,9,3,7,6,4,11,9,12,2,10,1,8,0,14,15,13,3,5,7,6,2,4,13,9,15,0,10,1,5,11,8,14,12,3,13,14,4,1,7,0,5,10,3,12,8,15,6,2,9,11,1,3,10,9,5,11,4,15,8,6,7,14,13,0,2,12],"D-SC":[11,13,7,0,5,4,1,15,9,14,6,10,3,12,8,2,1,2,7,9,13,11,15,8,14,12,4,0,5,6,10,3,5,1,13,3,15,6,12,7,9,8,11,2,4,14,0,10,13,
1,11,4,9,12,14,0,7,5,8,15,6,2,10,3,2,13,10,15,9,11,3,7,8,12,5,14,6,0,1,4,0,4,6,12,5,3,8,13,10,11,15,2,1,9,7,14,1,3,12,8,10,6,11,0,2,14,7,9,15,4,5,13,10,11,6,0,1,3,4,7,14,13,5,15,8,2,9,12]},qa=new Uint8Array([105,0,114,34,100,201,4,35,141,58,219,150,70,233,42,196,24,254,172,148,0,237,7,18,192,134,220,194,239,76,169,43]);return function(b){if(!va)throw new J("Big endian platform not supported");b=b||{};this.bitLength=b.length||256;this.blockLength=this.bitLength/4;this.name=(b.name||"GOST 28147")+"-"+
(b.version||1989)%100+"-"+("MAC"===b.mode?"MAC-"+(b.macLength||this.bitLength/8):"KW"===b.mode||b.keyWrapping?("NO"!==(b.keyWrapping||"NO")?b.keyWrapping:"")+"KW":(b.block||"ECB")+("CFB"===b.block||"OFB"===b.block||"CTR"===b.block&&2015===b.version?"-"+(b.shiftBits||this.blockLength):"")+(b.padding?"-"+(b.padding||("CTR"===b.block||"CFB"===b.block||"OFB"===b.block?"NO":"ZERO"))+"PADDING":"")+("NO"!==(b.keyMeshing||"NO")?"-CPKEYMESHING":""))+("string"===typeof b.sBox?"/"+b.sBox:"");switch(b.version||
1989){case 2015:this.version=2015;this.process=$;this.processMAC=ha;this.keySchedule=ba;break;case 1989:this.version=1989;this.process=Z;this.processMAC=ga;this.keySchedule=aa;break;default:throw new J("Algorithm version "+b.version+" not supported");}switch(b.mode||b.keyWrapping&&"KW"||"ES"){case "ES":switch(b.block||"ECB"){case "ECB":this.encrypt=D;this.decrypt=K;break;case "CTR":1989===this.version?this.decrypt=this.encrypt=ea:(this.decrypt=this.encrypt=P,this.shiftBits=b.shiftBits||this.blockLength);
break;case "CBC":this.encrypt=T;this.decrypt=fa;break;case "CFB":this.encrypt=S;this.decrypt=ca;this.shiftBits=b.shiftBits||this.blockLength;break;case "OFB":this.decrypt=this.encrypt=da;this.shiftBits=b.shiftBits||this.blockLength;break;default:throw new J("Block mode "+b.block+" not supported");}switch(b.keyMeshing){case "CP":this.keyMeshing=pa;break;default:this.keyMeshing=Q}if(this.encrypt===D||this.encrypt===T)switch(b.padding){case "PKCS5P":this.pad=ra;this.unpad=sa;break;case "RANDOM":this.pad=
ua;this.unpad=L;break;case "BIT":this.pad=W;this.unpad=ta;break;default:this.pad=U,this.unpad=L}else this.unpad=this.pad=L;this.generateKey=M;break;case "MAC":this.sign=E;this.verify=F;this.generateKey=M;this.macLength=b.macLength||this.bitLength/8;this.unpad=this.pad=L;this.keyMeshing=Q;break;case "KW":this.unpad=this.pad=L;this.keyMeshing=Q;switch(b.keyWrapping){case "CP":this.wrapKey=ka;this.unwrapKey=la;this.generateKey=M;this.shiftBits=b.shiftBits||this.blockLength;break;case "SC":this.wrapKey=
ma;this.unwrapKey=na;this.generateKey=oa;break;default:this.wrapKey=ia,this.unwrapKey=ja}break;default:throw new J("Mode "+b.mode+" not supported");}var c=b.sBox;if(!c)c=2015===this.version?G["E-DEFAULT"]:G["E-A"];else if("string"===typeof c){if(c=c.toUpperCase(),c=G[c],!c)throw new H("Unknown sBox name: "+b.sBox);}else if(!c.length||c.length!==G["E-DEFAULT"].length)throw new H("Length of sBox must be "+G["E-DEFAULT"].length);this.sBox=c;if(b.iv){this.iv=new Uint8Array(b.iv);if(8*this.iv.byteLength!==
this.blockLength&&1989===this.version)throw new H("Length of iv must be "+this.blockLength+" bits");if(16*this.iv.byteLength!==this.blockLength&&this.encrypt===P)throw new H("Length of iv must be "+this.blockLength/2+" bits");if(0!==8*this.iv.byteLength%this.blockLength&&this.encrypt!==P)throw new H("Length of iv must be a multiple of "+this.blockLength+" bits");}else this.iv=wa;if(b.ukm&&(this.ukm=new Uint8Array(b.ukm),8*this.ukm.byteLength!==this.blockLength))throw new H("Length of ukm must be "+
this.blockLength+" bits");}});
