/*
 2014, Rudolf Nickolaev. All rights reserved.
*/
(function(w,D){"function"===typeof define&&define.amd?define(["gostRandom","gostR3411"],D):"object"===typeof exports?module.exports=D(require("gostRandom"),require("gostR3411")):("undefined"!==typeof importScripts&&(w.gostRandom&&w.GostR3411||importScripts("gostRandom.js","gostR3411.js")),w.GostR3410=D(w.gostRandom,w.GostR3411))})(this,function(w,D){function z(a,b,c,d,e,f,g){var h=c&16383;for(c>>=14;0<=--g;){var k=a[b]&16383,l=a[b++]>>14,n=c*k+l*h,k=h*k+((n&16383)<<14)+d[e]+f;f=(k>>28)+(n>>14)+c*
l;d[e++]=k&268435455}return f}function n(a){a=Array(Math.ceil(a));a.s=0;a.t=0;return a}function E(a,b){for(var c=a.t-1;0<=c;--c)b[c]=a[c];b.t=a.t;b.s=a.s;return b}function qa(a,b){a.t=1;a.s=0>b?-1:0;0<b?a[0]=b:-1>b?a[0]=b+268435456:a.t=0;return a}function A(a){var b=n(1);qa(b,a);return b}function t(a){for(var b=a.s&268435455;0<a.t&&a[a.t-1]===b;)--a.t;return a}function p(a,b,c){for(var d=0,e=0,f=Math.min(b.t,a.t);d<f;)e+=a[d]-b[d],c[d++]=e&268435455,e>>=28;if(b.t<a.t){for(e-=b.s;d<a.t;)e+=a[d],c[d++]=
e&268435455,e>>=28;e+=a.s}else{for(e+=a.s;d<b.t;)e-=b[d],c[d++]=e&268435455,e>>=28;e-=b.s}c.s=0>e?-1:0;-1>e?c[d++]=268435456+e:0<e&&(c[d++]=e);c.t=d;return t(c)}function ea(a,b){return p(a,b,n(a.t))}function J(a,b,c){for(var d=0,e=0,f=Math.min(b.t,a.t);d<f;)e+=a[d]+b[d],c[d++]=e&268435455,e>>=28;if(b.t<a.t){for(e+=b.s;d<a.t;)e+=a[d],c[d++]=e&268435455,e>>=28;e+=a.s}else{for(e+=a.s;d<b.t;)e+=b[d],c[d++]=e&268435455,e>>=28;e+=b.s}c.s=0>e?-1:0;0<e?c[d++]=e:-1>e&&(c[d++]=268435456+e);c.t=d;return t(c)}
function K(a){if(0>a.s){var b=n(a.t);a=p(u,a,b)}return a}function s(a,b){var c=a.s-b.s;if(0!==c)return c;var d=a.t,c=d-b.t;if(0!==c)return 0>a.s?-c:c;for(;0<=--d;)if(0!==(c=a[d]-b[d]))return c;return 0}function fa(a){var b=1,c;0!==(c=a>>>16)&&(a=c,b+=16);0!==(c=a>>8)&&(a=c,b+=8);0!==(c=a>>4)&&(a=c,b+=4);0!==(c=a>>2)&&(a=c,b+=2);0!==a>>1&&(b+=1);return b}function R(a,b,c){var d;for(d=a.t-1;0<=d;--d)c[d+b]=a[d];for(d=b-1;0<=d;--d)c[d]=0;c.t=a.t+b;c.s=a.s;return c}function X(a,b,c){for(var d=b;d<a.t;++d)c[d-
b]=a[d];c.t=Math.max(a.t-b,0);c.s=a.s;return c}function ga(a,b,c){var d=b%28,e=28-d,f=(1<<e)-1;b=Math.floor(b/28);var g=a.s<<d&268435455,h;for(h=a.t-1;0<=h;--h)c[h+b+1]=a[h]>>e|g,g=(a[h]&f)<<d;for(h=b-1;0<=h;--h)c[h]=0;c[b]=g;c.t=a.t+b+1;c.s=a.s;return t(c)}function F(a,b,c){c.s=a.s;var d=Math.floor(b/28);if(d>=a.t)c.t=0;else{b%=28;var e=28-b,f=(1<<b)-1;c[0]=a[d]>>b;for(var g=d+1;g<a.t;++g)c[g-d-1]|=(a[g]&f)<<e,c[g-d]=a[g]>>b;0<b&&(c[a.t-d-1]|=(a.s&f)<<e);c.t=a.t-d;return t(c)}}function G(a){return 0>=
a.t?0:28*(a.t-1)+fa(a[a.t-1]^a.s&268435455)}function Y(a,b,c){var d=K(a),e=K(b),f=d.t;for(c.t=f+e.t;0<=--f;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=z(d,0,e[f],c,f,0,d.t);c.s=0;a.s!==b.s&&p(u,c,c);return t(c)}function H(a,b){return Y(a,b,n(a.t+b.t))}function Z(a,b){for(var c=K(a),d=b.t=2*c.t;0<=--d;)b[d]=0;for(d=0;d<c.t-1;++d){var e=z(c,d,c[d],b,2*d,0,1);(b[d+c.t]+=z(c,d+1,2*c[d],b,2*d+1,e,c.t-d-1))>=c.DV&&(b[d+c.t]-=c.DV,b[d+c.t+1]=1)}0<b.t&&(b[b.t-1]+=z(c,d,c[d],b,2*d,0,1));b.s=0;return t(b)}function ha(a,
b,c,d){var e=K(b);if(0>=e.t)throw new Ca("Division by zero");var f=K(a);if(f.t<e.t)return c&&qa(c,0),d&&E(a,d),c;d||(d=n(b.t));var g=n(b.t),h=a.s,k=b.s,l=28-fa(e[e.t-1]);0<l?(ga(e,l,g),ga(f,l,d)):(E(e,g),E(f,d));e=g.t;f=g[e-1];if(0===f)return c;var m=16777216*f+(1<e?g[e-2]>>4:0),q=Da/m,m=16777216/m,L=d.t,r=L-e;a=c?c:n(Math.max(a.t-b.t,1));R(g,r,a);0<=s(d,a)&&(d[d.t++]=1,p(d,a,d));R(O,e,a);for(p(a,g,g);g.t<e;)g[g.t++]=0;for(;0<=--r;)if(b=d[--L]===f?268435455:Math.floor(d[L]*q+(d[L-1]+16)*m),(d[L]+=
z(g,0,b,d,r,0,e))<b)for(R(g,r,a),p(d,a,d);d[L]<--b;)p(d,a,d);c&&(X(d,e,c),h!==k&&p(u,c,c));d.t=e;t(d);0<l&&F(d,l,d);0>h&&p(u,d,d);return c}function ra(a,b,c){ha(K(a),b,null,c);0>a.s&&0<s(c,u)&&p(b,c,c);return c}function q(a,b){return ra(a,b,n(b.t))}function x(a){return 0===(0<a.t?a[0]&1:a.s)}function y(a){return 0===s(a,u)}function P(a){return 0>a.s?-1:0>=a.t||1===a.t&&0>=a[0]?0:1}function sa(a,b){var c=x(b);if(x(a)&&c||0===P(b))return u;for(var d=E(b,n(b.t)),e=E(a,n(a.t)),f=A(1),g=A(0),h=A(0),k=
A(1);0!==P(d);){for(;x(d);)F(d,1,d),c?(x(f)&&x(g)||(J(f,a,f),p(g,b,g)),F(f,1,f)):x(g)||p(g,b,g),F(g,1,g);for(;x(e);)F(e,1,e),c?(x(h)&&x(k)||(J(h,a,h),p(k,b,k)),F(h,1,h)):x(k)||p(k,b,k),F(k,1,k);0<=s(d,e)?(p(d,e,d),c&&p(f,h,f),p(g,k,g)):(p(e,d,e),c&&p(h,f,h),p(k,g,k))}if(0!==s(e,O))return u;if(0<=s(k,b))return subtract(k,b);if(0>P(k))J(k,b,k);else return k;return 0>P(k)?J(k,b,n(k.t)):k}function S(a,b){var c=Math.floor(b/28);return c>=a.t?0!==a.s:0!==(a[c]&1<<b%28)}function ia(a,b){for(var c in b)a.prototype[c]=
b[c]}function ja(a){this.r2=n(2*a.t);this.q3=n(2*a.t);R(O,2*a.t,this.r2);var b=this.r2;this.mu=ha(b,a,n(Math.max(b.t-a.t,1)),null);this.m=a}function $(a,b,c){var d=G(b),e,f=A(1),g;if(0>=d)return f;e=18>d?1:48>d?3:144>d?4:768>d?5:6;g=8>d?new ta(c):x(c)?new ja(c):new ua(c);var h=[],k=3,l=e-1,m=(1<<e)-1;h[1]=g.convert(a);if(1<e)for(d=n(2*c.t),g.sqrTo(h[1],d);k<=m;)h[k]=n(2*c.t),g.mulTo(d,h[k-2],h[k]),k+=2;a=b.t-1;for(var p=!0,q=n(2*c.t),d=fa(b[a])-1;0<=a;){d>=l?c=b[a]>>d-l&m:(c=(b[a]&(1<<d+1)-1)<<l-
d,0<a&&(c|=b[a-1]>>28+d-l));for(k=e;0==(c&1);)c>>=1,--k;0>(d-=k)&&(d+=28,--a);if(p)E(h[c],f),p=!1;else{for(;1<k;)g.sqrTo(f,q),g.sqrTo(q,f),k-=2;0<k?g.sqrTo(f,q):(k=f,f=q,q=k);g.mulTo(q,h[c],f)}for(;0<=a&&0==(b[a]&1<<d);)g.sqrTo(f,q),k=f,f=q,q=k,0>--d&&(d=27,--a)}return g.revert(f)}function r(a,b){a.r.reduce(b);b.q=a.q;b.r=a.r;return b}function aa(a,b){b.q=a.q;b.r=a.r;return b}function va(a,b){var c=J(a,b,n(a.t));0<s(c,a.q)&&p(c,a.q,c);return aa(a,c)}function B(a,b){var c=ea(a,b);0>c.s&&J(a.q,c,c);
return aa(a,c)}function l(a,b){return r(a,H(a,b))}function M(a){return r(a,Z(a,n(2*a.t)))}function Q(a,b){var c=n(a.t);0>b?F(a,-b,c):ga(a,b,c);return r(a,c)}function wa(a){return aa(a,sa(a,a.q))}function I(a,b,c,d){return{curve:a,x:b,y:c,z:d||r(a,O)}}function ba(a){a.zinv||(a.zinv=wa(a.z));return l(a.x,a.zinv)}function xa(a){a.zinv||(a.zinv=wa(a.z));return l(a.y,a.zinv)}function T(a){return a.x||a.y?y(a.z)&&!y(a.y):!0}function U(a,b){if(T(a))return b;if(T(b))return a;var c=B(l(b.y,a.z),l(a.y,b.z)),
d=B(l(b.x,a.z),l(a.x,b.z));if(y(d))return y(c)?ka(a):a.curve.infinity;var e=a.x,f=a.y,g=M(d),h=l(g,d),e=l(e,g),g=l(M(c),a.z),d=l(B(l(B(g,Q(e,1)),b.z),h),d),c=va(l(B(B(l(l(e,ca),c),l(f,h)),l(g,c)),b.z),l(c,h)),h=l(l(h,a.z),b.z);return I(a.curve,d,c,h)}function ka(a){if(T(a))return a;if(0===P(a.y))return a.curve.infinity;var b=a.x,c=a.y,d=l(c,a.z),e=l(d,c),c=a.curve.a,f=l(M(b),ca);y(c)||(f=va(f,l(M(a.z),c)));c=l(Q(B(M(f),l(Q(b,3),e)),1),d);b=B(l(Q(B(l(l(f,ca),b),Q(e,1)),2),e),l(M(f),f));d=Q(l(M(d),
d),3);return I(a.curve,c,b,d)}function la(a,b){if(T(a))return a;if(0===P(b))return a.curve.infinity;var c=H(b,ca),d;d=a.curve;var e=a.x,f;f=a.y;f=aa(f,ea(f.q,f));d=I(d,e,f,a.z);e=a;for(f=G(c)-2;0<f;--f){var e=ka(e),g=S(c,f),h=S(b,f);g!==h&&(e=U(e,g?a:d))}return e}function ya(a,b,c){var d={};d.q=a;d.r=new ja(a);d.a=r(d,b);d.b=r(d,c);d.infinity=I(d);return d}function m(a){a=new Uint8Array(a);var b=n(8*a.length/28);b.t=0;for(var c=b.s=0,d=0,e=a.length;d<e;d++){var f=a[d];0===c?b[b.t++]=f:28<c+8?(b[b.t-
1]|=(f&(1<<28-c)-1)<<c,b[b.t++]=f>>28-c):b[b.t-1]|=f<<c;c+=8;28<=c&&(c-=28)}return t(b)}function da(a,b){var c,d=!1,e=[],f=a.t,g=28-28*f%8;if(0<f--)for(28>g&&0<(c=a[f]>>g)&&(d=!0,e.push(c));0<=f;)8>g?(c=(a[f]&(1<<g)-1)<<8-g,c|=a[--f]>>(g+=20)):(c=a[f]>>(g-=8)&255,0>=g&&(g+=28,--f)),0<c&&(d=!0),d&&e.push(c);c=new Uint8Array(b?b/8:e.length);d&&c.set(e.reverse());return c.buffer}function C(a){if("number"===typeof a||a instanceof Number)return A(a);(a=a.replace(/[^\-A-Fa-f0-9]/g,""))||(a="0");for(var b=
n(a.length/7),c=a.length,d=!1,e=0;0<=--c;)if("-"===a.charAt(c))d=!0;else{var f=parseInt(a.charAt(c),16),d=!1;0===e?b[b.t++]=f:28<e+4?(b[b.t-1]|=(f&(1<<28-e)-1)<<e,b[b.t++]=f>>28-e):b[b.t-1]|=f<<e;e+=4;28<=e&&(e-=28)}d&&p(u,b,b);return t(b)}function V(a){if(a instanceof ArrayBuffer)return a;if(a&&a.buffer&&a.buffer instanceof ArrayBuffer)return 0===a.byteOffset&&a.byteLength===a.buffer.byteLength?a.buffer:(new Uint8Array(new Uint8Array(a,a.byteOffset,a.byteLength))).buffer;throw new ma("ArrayBuffer or ArrayBufferView required");
}function na(a){a=V(a);if(0<a.byteLength%2)throw new ma("Buffer length must be even");var b=a.byteLength/2;return[m(new Uint8Array(a,0,b)),m(new Uint8Array(a,b,b))]}function oa(a,b,c){a=da(a,c);b=da(b,c);c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a));c.set(new Uint8Array(b),a.byteLength);return c.buffer}function za(a){w||(w=N.gostRandom,!w&&pa&&pa.getRandomValues&&(w=pa));if(w)return a=new Uint8Array(Math.ceil(a/8)),w.getRandomValues(a),a;throw new W("Random generator not found");
}function Ea(a,b){var c,d=V(b);c=this.hash?m(this.hash.digest(d)):m(d);var d=this.q,e=q(m(V(a)),d);c=q(c,d);y(c)&&(c=O);for(var f=u;y(f);){for(var g=u;y(g);){var h=q(m(this.ukm||za(this.bitLength)),d);this.curve?(g=la(this.P,h),g=q(ba(g),d)):g=q($(this.a,h,this.p),d)}var f=H(g,e),k=H(h,c),f=J(f,k,n(f.t)),f=q(f,d)}return oa(g,f,this.bitLength)}function Fa(a,b,c){var d=this.q;b=na(b);var e=b[1];b=b[0];if(0<=s(b,d)||0<=s(e,d))return!1;c=V(c);c=this.hash?m(this.hash.digest(c)):m(c);c=q(c,d);0===y(c)&&
(c=O);c=sa(c,d);e=q(H(e,c),d);c=ea(d,q(H(b,c),d));if(this.curve){var f=na(a),g=this.curve;a=this.P;for(var h=r(g,f[0]),f=r(g,f[1]),f=new I(g,h,f),g=G(e)>G(c)?G(e)-1:G(c)-1,h=a.curve.infinity,k=U(a,f);0<=g;)h=ka(h),S(e,g)?h=S(c,g)?U(h,k):U(h,a):S(c,g)&&(h=U(h,f)),--g;d=q(ba(h),d)}else g=this.p,h=this.a,f=m(a),d=q(q(H($(h,e,g),$(f,c,g)),g),d);return 0===s(d,b)}function Aa(){if(this.curve){for(var a=this.curve.infinity;T(a);){var b=u;if(this.ukm)b=m(this.ukm);else for(;y(b);)b=q(m(za(this.bitLength)),
this.q);var a=la(this.P,b),c=ba(a),d=xa(a)}return{privateKey:da(b,this.bitLength),publicKey:oa(c,d,this.bitLength)}}throw new W("Key generation for GOST R 34.10-94 not supported");}function Ba(a){var b;b=m(this.ukm);var c=this.q;a=q(m(V(a)),c);this.curve?(b=la(this.peer_Q,q(H(b,a),c)),b=oa(ba(b),xa(b),this.bitLength)):b=da($(this.peer_y,a,this.p));return this.hash?this.hash.digest(b):b}function Ga(a,b){if(8>b||b>this.bitLength||0<b%8)throw new ma("Length must be no more than "+this.bitLength+" bits and multiple of 8");
var c=b/8,d=Ba.call(this,a),e=new Uint8Array(c);e.set(new Uint8Array(d,0,c));return e.buffer}function Ha(a){a=Ba.call(this,a);var b=new Uint8Array(32);b.set(new Uint8Array(a,0,32));return b.buffer}var N=this,pa=N.crypto||N.msCrypto,Ca=N.OperationError||Error,ma=N.DataError||Error,W=N.NotSupportedError||Error,v={"S-256-TEST":{a:7,b:"0x5FBFF498AA938CE739B8E022FBAFEF40563F6E6A3472FC2A514C0CE9DAE23B7E",p:"0x8000000000000000000000000000000000000000000000000000000000000431",q:"0x8000000000000000000000000000000150FE8A1892976154C59CFC193ACCF5B3",
x:2,y:"0x8E2A8A0E65147D4BD6316030E16D19C85C97F0A9CA267122B96ABBCEA7E8FC8"},"S-256-A":{a:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD94",b:166,p:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD97",q:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6C611070995AD10045841B09B761B893",x:1,y:"0x8D91E471E0989CDA27DF505A453F2B7635294F2DDF23E3B122ACC99C9E9F1E14"},"S-256-B":{a:"0x8000000000000000000000000000000000000000000000000000000000000C96",b:"0x3E1AF419A269A5F866A7D3C25C3DF80AE979259373FF2B182F49D4CE7E1BBC8B",
p:"0x8000000000000000000000000000000000000000000000000000000000000C99",q:"0x800000000000000000000000000000015F700CFFF1A624E5E497161BCC8A198F",x:1,y:"0x3FA8124359F96680B83D1C3EB2C070E5C545C9858D03ECFB744BF8D717717EFC"},"S-256-C":{a:"0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D7598",b:32858,p:"0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D759B",q:"0x9B9F605F5A858107AB1EC85E6B41C8AA582CA3511EDDFB74F02F3A6598980BB9",x:0,y:"0x41ECE55743711A8C3CBF3783CD08C0EE4D4DC440D4641A8F366E550DFDB3BB67"},
"P-256":{p:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF",a:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC",b:"0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B",x:"0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296",y:"0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",q:"0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"},"T-512-TEST":{a:7,b:"0x1CFF0806A31116DA29D8CFA54E57EB748BC5F377E49400FDD788B649ECA1AC4361834013B2AD7322480A89CA58E0CF74BC9E540C2ADD6897FAD0A3084F302ADC",
p:"0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DF1D852741AF4704A0458047E80E4546D35B8336FAC224DD81664BBF528BE6373",q:"0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DA82F2D7ECB1DBAC719905C5EECC423F1D86E25EDBE23C595D644AAF187E6E6DF",x:"0x24D19CC64572EE30F396BF6EBBFD7A6C5213B3B3D7057CC825F91093A68CD762FD60611262CD838DC6B60AA7EEE804E28BC849977FAC33B4B530F1B120248A9A",y:"0x2BB312A43BD2CE6E0D020613C857ACDDCFBF061E91E5F2C3F32447C259F39B2C83AB156D77F1496BF7EB3351E1EE4E43DC1A18B91B24640B6DBB92CB1ADD371E"},
"T-512-A":{p:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC7",a:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC4",b:"0xE8C2505DEDFC86DDC1BD0B2B6667F1DA34B82574761CB0E879BD081CFD0B6265EE3CB090F30D27614CB4574010DA90DD862EF9D4EBEE4761503190785A71C760",q:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF27E69532F48D89116FF22B8D4E0560609B4B38ABFAD2B85DCACDB1411F10B275",
x:3,y:"0x7503CFE87A836AE3A61B8816E25450E6CE5E1C93ACF1ABC1778064FDCBEFA921DF1626BE4FD036E93D75E6A50E3A41E98028FE5FC235F5B889A589CB5215F2A4"},"T-512-B":{p:"0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006F",a:"0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006C",b:"0x687D1B459DC841457E3E06CF6F5E2517B97C7D614AF138BCBF85DC806C4B289F3E965D2DB1416D217F8B276FAD1AB69C50F78BEE1FA3106EFB8CCBC7C5140116",
q:"0x800000000000000000000000000000000000000000000000000000000000000149A1EC142565A545ACFDB77BD9D40CFA8B996712101BEA0EC6346C54374F25BD",x:2,y:"0x1A8F7EDA389B094C2C071E3647A8940F3C123B697578C213BE6DD9E6C8EC7335DCB228FD1EDF4A39152CBCAAF8C0398828041055F94CEEEC7E21340780FE41BD"}};v["X-256-A"]=v["S-256-A"];v["X-256-B"]=v["S-256-C"];v["T-256-TEST"]=v["S-256-TEST"];v["T-256-A"]=v["S-256-A"];v["T-256-B"]=v["S-256-B"];v["T-256-C"]=v["S-256-C"];var Ia={"S-TEST":{modulusLength:512,p:"0xEE8172AE8996608FB69359B89EB82A69854510E2977A4D63BC97322CE5DC3386EA0A12B343E9190F23177539845839786BB0C345D165976EF2195EC9B1C379E3",
q:"0x98915E7EC8265EDFCDA31E88F24809DDB064BDC7285DD50D7289F0AC6F49DD2D",a:"0x9e96031500c8774a869582d4afde2127afad2538b4b6270a6f7c8837b50d50f206755984a49e509304d648be2ab5aab18ebe2cd46ac3d8495b142aa6ce23e21c"},"S-A":{modulusLength:1024,p:"0xB4E25EFB018E3C8B87505E2A67553C5EDC56C2914B7E4F89D23F03F03377E70A2903489DD60E78418D3D851EDB5317C4871E40B04228C3B7902963C4B7D85D52B9AA88F2AFDBEB28DA8869D6DF846A1D98924E925561BD69300B9DDD05D247B5922D967CBB02671881C57D10E5EF72D3E6DAD4223DC82AA1F7D0294651A480DF",q:"0x972432A437178B30BD96195B773789AB2FFF15594B176DD175B63256EE5AF2CF",
a:"0x8FD36731237654BBE41F5F1F8453E71CA414FFC22C25D915309E5D2E62A2A26C7111F3FC79568DAFA028042FE1A52A0489805C0DE9A1A469C844C7CABBEE625C3078888C1D85EEA883F1AD5BC4E6776E8E1A0750912DF64F79956499F1E182475B0B60E2632ADCD8CF94E9C54FD1F3B109D81F00BF2AB8CB862ADF7D40B9369A"},"S-B":{modulusLength:1024,p:"0xC6971FC57524B30C9018C5E621DE15499736854F56A6F8AEE65A7A404632B1BCF0349FFCAFCB0A103177971FC1612ADCDB8C8CC938C70225C8FD12AFF01B1D064E0AD6FDE6AB9159166CB9F2FC171D92F0CC7B6A6B2CD7FA342ACBE2C9315A42D576B1ECCE77A963157F3D0BD96A8EB0B0F3502AD238101B05116334F1E5B7AB",
q:"0xB09D634C10899CD7D4C3A7657403E05810B07C61A688BAB2C37F475E308B0607",a:"0x3D26B467D94A3FFC9D71BF8DB8934084137264F3C2E9EB16DCA214B8BC7C872485336744934FD2EF5943F9ED0B745B90AA3EC8D70CDC91682478B664A2E1F8FB56CEF2972FEE7EDB084AF746419B854FAD02CC3E3646FF2E1A18DD4BEB3C44F7F2745588029649674546CC9187C207FB8F2CECE8E2293F68395C4704AF04BAB5"},"S-C":{modulusLength:1024,p:"0x9D88E6D7FE3313BD2E745C7CDD2AB9EE4AF3C8899E847DE74A33783EA68BC30588BA1F738C6AAF8AB350531F1854C3837CC3C860FFD7E2E106C3F63B3D8A4C034CE73942A6C3D585B599CF695ED7A3C4A93B2B947B7157BB1A1C043AB41EC8566C6145E938A611906DE0D32E562494569D7E999A0DDA5C879BDD91FE124DF1E9",
q:"0xFADD197ABD19A1B4653EECF7ECA4D6A22B1F7F893B641F901641FBB555354FAF",a:"0x7447ED7156310599070B12609947A5C8C8A8625CF1CF252B407B331F93D639DDD1BA392656DECA992DD035354329A1E95A6E32D6F47882D960B8F10ACAFF796D13CD9611F853DAB6D2623483E46788708493937A1A29442598AEC2E0742022563440FE9C18740ECE6765AC05FAF024A64B026E7E408840819E962E7E5F401AE3"},"S-D":{modulusLength:1024,p:"0x80F102D32B0FD167D069C27A307ADAD2C466091904DBAA55D5B8CC7026F2F7A1919B890CB652C40E054E1E9306735B43D7B279EDDF9102001CD9E1A831FE8A163EED89AB07CF2ABE8242AC9DEDDDBF98D62CDDD1EA4F5F15D3A42A6677BDD293B24260C0F27C0F1D15948614D567B66FA902BAA11A69AE3BCEADBB83E399C9B5",
q:"0xF0F544C418AAC234F683F033511B65C21651A6078BDA2D69BB9F732867502149",a:"0x6BCC0B4FADB3889C1E06ADD23CC09B8AB6ECDEDF73F04632595EE4250005D6AF5F5ADE44CB1E26E6263C672347CFA26F9E9393681E6B759733784CDE5DBD9A14A39369DFD99FA85CC0D10241C4010343F34A91393A706CF12677CBFA1F578D6B6CFBE8A1242CFCC94B3B653A476E145E3862C18CC3FED8257CFEF74CDB205BF1"},"X-A":{modulusLength:1024,p:"0xCA3B3F2EEE9FD46317D49595A9E7518E6C63D8F4EB4D22D10D28AF0B8839F079F8289E603B03530784B9BB5A1E76859E4850C670C7B71C0DF84CA3E0D6C177FE9F78A9D8433230A883CD82A2B2B5C7A3306980278570CDB79BF01074A69C9623348824B0C53791D53C6A78CAB69E1CFB28368611A397F50F541E16DB348DBE5F",
q:"0xCAE4D85F80C147704B0CA48E85FB00A9057AA4ACC44668E17F1996D7152690D9",a:"0xBE27D652F2F1E339DA734211B85B06AE4DE236AA8FBEEB3F1ADCC52CD43853777E834A6A518138678A8ADBD3A55C70A7EAB1BA7A0719548677AAF4E609FFB47F6B9D7E45B0D06D83D7ADC53310ABD85783E7317F7EC73268B6A9C08D260B85D8485696CA39C17B17F044D1E050489036ABD381C5E6BF82BA352A1AFF136601AF"},"X-B":{modulusLength:1024,p:"0x9286DBDA91ECCFC3060AA5598318E2A639F5BA90A4CA656157B2673FB191CD0589EE05F4CEF1BD13508408271458C30851CE7A4EF534742BFB11F4743C8F787B11193BA304C0E6BCA25701BF88AF1CB9B8FD4711D89F88E32B37D95316541BF1E5DBB4989B3DF13659B88C0F97A3C1087B9F2D5317D557DCD4AFC6D0A754E279",
q:"0xC966E9B3B8B7CDD82FF0F83AF87036C38F42238EC50A876CD390E43D67B6013F",a:"0x7E9C3096676F51E3B2F9884CF0AC2156779496F410E049CED7E53D8B7B5B366B1A6008E5196605A55E89C3190DABF80B9F1163C979FCD18328DAE5E9048811B370107BB7715F82091BB9DE0E33EE2FED6255474F8769FCE5EAFAEEF1CB5A32E0D5C6C2F0FC0B3447072947F5B4C387666993A333FC06568E534AD56D2338D729"},"X-C":{modulusLength:1024,p:"0xB194036ACE14139D36D64295AE6C50FC4B7D65D8B340711366CA93F383653908EE637BE428051D86612670AD7B402C09B820FA77D9DA29C8111A8496DA6C261A53ED252E4D8A69A20376E6ADDB3BDCD331749A491A184B8FDA6D84C31CF05F9119B5ED35246EA4562D85928BA1136A8D0E5A7E5C764BA8902029A1336C631A1D",
q:"0x96120477DF0F3896628E6F4A88D83C93204C210FF262BCCB7DAE450355125259",a:"0x3F1817052BAA7598FE3E4F4FC5C5F616E122CFF9EBD89EF81DC7CE8BF56CC64B43586C80F1C4F56DD5718FDD76300BE336784259CA25AADE5A483F64C02A20CF4A10F9C189C433DEFE31D263E6C9764660A731ECCAECB74C8279303731E8CF69205BC73E5A70BDF93E5BB681DAB4EEB9C733CAAB2F673C475E0ECA921D29782E"}},Da=Math.pow(2,52),u=A(0),O=A(1),ca=A(3),ta=function(a){this.m=a};ia(ta,{convert:function(a){return 0>a.s||0<=s(a,this.m)?q(a,this.m):a},revert:function(a){return a},
reduce:function(a){ra(a,this.m,a)},sqrTo:function(a,b){Z(a,b);this.reduce(b)},mulTo:function(a,b,c){Y(a,b,c);this.reduce(c)}});var ua=function(a){this.m=a;var b;if(1>a.t)b=0;else if(b=a[0],0===(b&1))b=0;else{var c=b&3,c=c*(2-(b&15)*c)&15,c=c*(2-(b&255)*c)&255,c=c*(2-((b&65535)*c&65535))&65535,c=c*(2-b*c%268435456)%268435456;b=0<c?268435456-c:-c}this.mp=b;this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=8191;this.mt2=2*a.t};ia(ua,{convert:function(a){var b=n(a.t);R(K(a),this.m.t,b);ha(b,this.m,
null,b);0>a.s&&0<s(b,u)&&p(this.m,b,b);return b},revert:function(a){var b=n(a.t);E(a,b);this.reduce(b);return b},reduce:function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=a[b]&32767,d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&268435455,c=b+this.m.t;for(a[c]+=z(this.m,0,d,a,b,0,this.m.t);268435456<=a[c];)a[c]-=268435456,a[++c]++}t(a);X(a,this.m.t,a);0<=s(a,this.m)&&p(a,this.m,a)},sqrTo:function(a,b){Z(a,b);this.reduce(b)},mulTo:function(a,b,c){Y(a,b,c);this.reduce(c)}});
ia(ja,{convert:function(a){if(0>a.s||a.t>2*this.m.t)return q(a,this.m);if(0>s(a,this.m))return a;var b=n(a.t);E(a,b);this.reduce(b);return b},revert:function(a){return a},reduce:function(a){X(a,this.m.t-1,this.r2);a.t>this.m.t+1&&(a.t=this.m.t+1,t(a));var b=this.mu,c=this.r2,d=this.m.t+1,e=this.q3;--d;var f=e.t=b.t+c.t-d;for(e.s=0;0<=--f;)e[f]=0;for(f=Math.max(d-b.t,0);f<c.t;++f)e[b.t+f-d]=z(b,d-f,c[f],e,0,0,b.t+f-d);t(e);X(e,1,e);b=this.m;c=this.q3;d=this.m.t+1;e=this.r2;f=Math.min(b.t+c.t,d);e.s=
0;for(e.t=f;0<f;)e[--f]=0;var g;for(g=e.t-b.t;f<g;++f)e[f+b.t]=z(b,0,c[f],e,f,0,b.t);for(g=Math.min(c.t,d);f<g;++f)z(b,0,c[f],e,f,0,d-f);for(t(e);0>s(a,this.r2);){b=a;for(c=this.m.t+1;b.t<=c;)b[b.t++]=0;for(b[c]+=1;268435456<=b[c];)b[c]-=268435456,++c>=b.t&&(b[b.t++]=0),++b[c]}for(p(a,this.r2,a);0<=s(a,this.m);)p(a,this.m,a)},sqrTo:function(a,b){Z(a,b);this.reduce(b)},mulTo:function(a,b,c){Y(a,b,c);this.reduce(c)}});return function(a){a=a||{};this.name=(a.name||"GOST R 34.10")+"-"+(a.version||2012)%
100+"-"+(a.length||256)+("SIGN"!==(a.mode||"SIGN")?"-"+a.mode:"")+("string"===typeof a.namedParam?"/"+a.namedParam:"")+("string"===typeof a.namedCurve?"/"+a.namedCurve:"")+("string"===typeof a.sBox?"/"+a.sBox:"");var b=a.version||2012;switch(a.mode||"SIGN"){case "SIGN":this.sign=Ea;this.verify=Fa;this.generateKey=Aa;break;case "DH":this.deriveBits=Ga,this.deriveKey=Ha,this.generateKey=Aa}if(1994===b)a.p&&a.q&&a.a?(this.modulusLength=a.modulusLength||1024,this.p=m(a.p),this.q=m(a.q),this.a=m(a.a)):
(b=Ia[this.namedParam=(a.namedParam||"S-A").toUpperCase()],this.modulusLength=b.modulusLength,this.p=C(b.p),this.q=C(b.q),this.a=C(b.a)),a["public"]&&(this.peer_y=m(a["public"]));else{if(a.p&&a.q&&a.a&&a.b&&a.x&&a.y){var c=this.curve=ya(m(a.p),m(a.a),m(a.b));this.P=I(c,r(c,m(a.x)),r(c,m(a.y)));this.q=m(a.q)}else b=v[this.namedCurve=(a.namedCurve||"S-256-A").toUpperCase()],c=this.curve=ya(C(b.p),C(b.a),C(b.b)),this.P=I(c,r(c,C(b.x)),r(c,C(b.y))),this.q=C(b.q);a["public"]&&(b=na(a["public"]),this.peer_Q=
new I(this.curve,r(this.curve,b[0]),r(this.curve,b[1])))}if(this.curve){c=a.length||G(this.q);if(508<c&&512>=c)c=512;else if(254<c&&256>=c)c=256;else throw new W("Support keys only 256 or 512 bits length");b=c}else{c=a.modulusLength||G(this.p);if(1016<c&&1024>=c)c=1024;else if(508<c&&512>=c)c=512;else throw new W("Support keys only 512 or 1024 bits length");b=256}this.bitLength=b;this.keyLength=c;if(c=a.hash){c.name&&(c=c.name);c={name:c};1994===a.version||2001===a.version?(c.version=1994,c.length=
256,c.sBox=a.sBox):(c.version=2012,c.length=b);D||(D=N.GostR3411);if(!D)throw new W("Object GostR3411 not found");this.hash=new D(c)}a.ukm&&(this.ukm=a.ukm)}});
