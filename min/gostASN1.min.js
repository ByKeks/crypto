/*
 2014-2016, Rudolf Nickolaev. All rights reserved.
*/
(function(x,w){"function"===typeof define&&define.amd?define(["gostCrypto","gostCoding","gostSecurity"],w):"object"===typeof exports?module.exports=w(require("gostCrypto"),require("gostCoding"),require("gostSecurity")):x.GostASN1=w(x.gostCrypto,x.GostCoding,x.GostSecurity)})(this,function(x){function w(){for(var a={},c=0,b=arguments.length;c<b;c++){var d=arguments[c];if("object"===typeof d)for(var e in d)a[e]=d[e]}return a}function wa(a){a instanceof P&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),
b=0,d=a.length;b<d;b++)c[d-b-1]=a[b];return c.buffer}function X(a){return a instanceof P||a.buffer instanceof P}function kc(a,c){return a.length>=c?a:Array(c-a.length+1).join("0")+a}function Ia(a){return 2>=a?a:4>=a?4:8>=a?8:16>=a?16:32>=a?32:64>=a?64:128>=a?128:256>=a?256:512>a?512:1024>a?1024:void 0}function Q(a){if(a)throw Error("Invalid format");}function ha(a,c,b,d){"object"!==typeof b&&(b={value:b});void 0!==d&&(b.enumerable=d);Object.defineProperty(a,c,b)}function Ja(a,c,b){for(var d in c)ha(a,
d,c[d],b)}function T(a,c,b,d,e,f){Q(void 0===c);c={tagNumber:b,tagClass:d||0,tagConstructed:e||!1,object:c};a=a||"DER";if("DER"===a||"CER"===a)c=ia.encode(c,a);"PEM"===a&&(c=Ka.encode(c,f));return c}function Y(a,c,b,d,e){Q(void 0===a);"string"===typeof a&&(a=Ka.decode(a,e,!1));a instanceof P&&(a=ia.decode(a));b=b||0;d=d||!1;void 0===a.tagNumber&&(a=T(!0,a.object,c,b,a.object instanceof Array),a=ia.decode(a));Q(a.tagClass!==b||a.tagNumber!==c||a.tagConstructed!==d);return 0===b&&5===c?null:a.object}
function t(a,c,b,d){"function"!==typeof c&&(d=b,b=c,c=function(){a.apply(this,arguments)});c.prototype=Object.create(a.prototype,{constructor:{value:c},superclass:{value:a.prototype}});b&&Ja(c.prototype,b);if(a!==Object)for(var e in a)c[e]=a[e];c.super=a;d&&Ja(c,d,!0);return c}function La(){}var P=this.ArrayBuffer,I=x.security.algorithms,hb=x.security.names,ib=x.security.identifiers,ba=x.security.attributes,ca=x.security.parameters,ia=x.coding.BER,Ka=x.coding.PEM,jb=x.coding.Hex,kb=x.coding.Int16,
U={encode:function(a,c){return"0x"+jb.encode(a,c)},decode:function(a,c,b){"number"===typeof a&&(a=a.toString(16));a=a.replace("0x","");b=b||Ia(a.length);return jb.decode(kc(a,b),c)}},k=t(Object,function(a){this.object=a},{_set:function(a,c,b){a.property(c).set.call(this,b)},_get:function(a,c){return a.property(c).get.call(this)},_call:function(a,c,b){return a.method(c).apply(this,b)},hasProperty:function(a){return this.hasOwnProperty(a)||!!this.constructor.property(a)},encode:function(){return this.object}},
{decode:function(a){return new this(a)},property:function(a){for(var c=this.prototype;c;){var b=Object.getOwnPropertyDescriptor(c,a);if(b)return b;c=c.superclass}},method:function(a){for(var c=this.prototype;c;){if(c[a])return c[a];c=c.superclass}}}),y=function(a){return t(k,{encode:function(c){return T(c,this.object,a)}},{decode:function(c){return new this(Y(c,a))}})},da=y(1),ea=y(22),xa=y(18),ya=y(19),lc=y(20),z=y(12),mc=y(23),A=y(24),nc=y(28),Ma=y(30),pa=t(y(5),{object:{get:function(){return null},
set:function(a){Q(null!==a)}}}),lb=function(a){function c(c){return t(y(a),function(a){b.super.call(this,a)},{encode:function(b){return T(b,c[this.object],a)}},{decode:function(b){b=Y(b,a);for(var d in c)if(b===c[d])return new this(d);Q(!0)}})}var b=t(y(a),function(a){if(this instanceof b)b.super.apply(this,arguments);else return c(a)});return b},h=lb(2),mb=lb(10),g=function(){function a(a){return a?t(a,{encode:function(c){return T(c,a.method("encode").call(this,!0),4)}},{decode:function(c){return a.decode.call(this,
Y(c,4))}}):c}var c=t(y(4),function(b){if(this instanceof c)c.super.apply(this,arguments);else return a(b)});return c}(),q=function(){function a(a){return a?t(a,{encode:function(c){return T(c,a.method("encode").call(this,!0),3)}},{decode:function(c){return a.decode.call(this,Y(c,3))}}):b}function c(a){return t(k,function(a,c){k.call(this,a);this.numbits=c||0},{encode:function(c){var b=this.object,d=[];if(b instanceof Array){for(var e=0,f=b.length;e<f;e++){var O=a[b[e]];void 0!==O&&(d[O]="1")}e=0;for(f=
Math.max(d.length,this.numbits);e<f;e++)d[e]||(d[e]="0");d=d.join("")}else d="0";return T(c,d,3)}},{decode:function(c){c=Y(c,3);var b=[],d;for(d in a)"1"===c.charAt(a[d])&&b.push(d);return new this(b,c.length)}})}var b=t(y(3),function(d){if(this instanceof b)b.super.apply(this,arguments);else return"object"===typeof d?c(d):a(d)});return b}(),F=function(a){a.combine=function(c,b){for(var d in a.prototype)a.prototype.hasOwnProperty(d)&&!c.hasProperty(d)&&ha(c,d,function(a){return{get:function(){return this[b]&&
this[b][a]},set:function(c){this[b]||(this[b]={});this[b][a]=c},configurable:!1,enumerable:!0}}(d))};return a},e=function(a,c){var b=t(k,function(a,c){ha(this,"items",{writable:!0,value:{}});"string"===typeof a||a instanceof P?this.decode(a):void 0!==a&&(this.object=a,c&&this.check())},{object:{get:function(){return this},set:function(c){if(c instanceof b){this.items=c.items;for(var d in a){var e=this.getItemClass(d,this.items);e.combine&&e.combine(this,d)}}else{var f={};for(d in a){var g=c[d],e=
this.getItemClass(d,f);void 0!==g?f[d]=new e(g):e.combine&&(f[d]=new e(c));e.combine&&e.combine(this,d)}this.items=f}}},getItemClass:function(c,b){return a[c]},encode:function(b){var d=[],e=this.items,f;for(f in a)if(e[f]){var O=e[f].encode(!0);void 0!==O&&d.push(O)}return T(b,d,16,0,!0,c)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(b){b=Y(b,16,0,!0,c);var d=
0,e=new this,f=e.items={},O;for(O in a){console.log(O,"decoding...");var g=e.getItemClass(O,f),h=g.decode(b[d]);void 0!==h&&(f[O]=h,g.combine&&g.combine(e,O),d++)}return e}}),d;for(d in a)ha(b.prototype,d,function(c){return{get:function(){return this.items[c]&&this.items[c].object},set:function(a){if(void 0!==a){var b=this.getItemClass(c,this.items);this.items[c]=new b(a)}else delete this.items[c]},configurable:!1,enumerable:!a[c].combine}}(d)),a[d].combine&&a[d].combine(b.prototype,d);return b},
J=function(a,c,b,d,f){var g=e(a,f),h=function(e,f){c=c||"type";b=b||"value";f=f||d||k;var Z=t(g,function(a){if(this instanceof Z)g.apply(this,arguments);else return h.apply(this,arguments)},{getItemClass:function(d,g){var h=a[d];if(b===d){var Z,aa=g&&g[c];aa&&(aa=aa.object,e&&(Z="function"===typeof e?e(aa):e[aa]));Z=Z||f||k;h=h===k?Z:h(Z)}return h}});ha(Z.prototype,c,{get:function(){return this.items[c]&&this.items[c].object},set:function(){Q(!0)},configurable:!1,enumerable:!0});return Z};return h()},
l=t(k,{encode:function(a){var c=this.object,c=/^(\d+\.)+\d+$/.test(c)?c:ib[c];Q(!c);return T(a,c,6)}},{decode:function(a){a=Y(a,6);return new this(hb[a]||a)}}),f=function(a){a=a||k;return t(a,{encode:function(c){c=a.method("encode").call(this,c);return"string"===typeof c||c instanceof P?c:4===c.tagNumber||0!==c.tagClass||c.object instanceof Array?{object:c.object}:{object:ia.encode(c,"DER",!0)}}},{decode:function(c){"string"===typeof c||c instanceof P||(c={object:c.object,header:c.header,content:c.content});
return a.decode.call(this,c)}})},p=function(a){a=a||k;return t(a,{encode:function(c){c=a.method("encode").call(this,c);return"string"===typeof c||c instanceof P?c:{object:[c]}}},{decode:function(c){return"string"===typeof c||c instanceof P?a.decode.call(this,c):a.decode.call(this,c.object[0])}})},b=function(a,c){return t(c,function(){c.apply(this,arguments)},{encode:function(b){b=c.method("encode").call(this,b);if("string"===typeof b||b instanceof P)return b;b.tagNumber=a;b.tagClass=2;b.tagConstructed=
b.object instanceof Array;return b}},{decode:function(b){Q(void 0!==b.tagNumber&&(2!==b.tagClass||b.tagNumber!==a));return c.decode.call(this,b)}})},nb=function(a){return function(c,b){c=c||k;var d=function(e,f){var g="function"===typeof c&&void 0!==e?c(e,f):c;if(b){var h=t(k,function(a){if(this instanceof h)ha(this,"items",{writable:!0,value:{}}),k.call(this,a||{});else return d.apply(this,arguments)},{object:{get:function(){this.read();return this},set:function(a){if(a instanceof h)a.read(),this.items=
a.items;else{var c={},b;for(b in a)c[b]=this.createItem(a[b],b);this.items=c}this.reset()}},createItem:function(a,c){if(b){var d={};d[b.typeName]=c;d[b.valueName]=a}else d=a;return new g(d)},getItemValue:function(a){a=this.items[a];return b?a.object[b.valueName]:a.object},setItemValue:function(a,c){var d=this.items[a];b?d.object[b.valueName]=c:d.object=c},isItemType:function(a){return b?ib[a]:!isNaN(parseInt(a))},reset:function(){var a=this.items,c;for(c in this)this.hasOwnProperty(c)&&!this.items[c]&&
this.isItemType(c)&&delete this[c];for(c in a)this[c]=this.getItemValue(c)},read:function(){var a=this.items,c;for(c in this)this.isItemType(c)&&(this.items[c]?this.getItemValue(c)!==this[c]&&this.setItemValue(c,this[c]):(a[c]=this.createItem(this[c],c),this[c]=this.getItemValue(c)))},encode:function(c){this.read();var b=this.items,d=[],e;for(e in b){console.log(e,b[e],"encoding...");var f=b[e].encode(!0);void 0!==f&&d.push(f)}return T(c,d,a,0,!0)},decode:function(a){this.object=this.constructor.decode(a)},
check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(c){c=Y(c,a,0,!0);for(var d=new this,e=d.items={},f=0,h=c.length;f<h;f++){var aa=g.decode(c[f]);e[b?aa.object[b.typeName]:f]=aa}d.reset();return d}});return h}var l=t(k,function(a){if(this instanceof l)Ja(this,{items:{writable:!0,value:[]},values:{writable:!0,value:[]}}),k.call(this,a||[]);else return d.apply(this,arguments)},{object:{get:function(){this.read();return this.values},
set:function(a){if(a instanceof l)a.read(),this.items=a.items;else{for(var c=[],b=0,d=a.length;b<d;b++)c[b]=new g(a[b]);this.items=c}this.reset()}},encode:function(c){this.read();for(var b=this.items,d=[],e=0,f=b.length;e<f;e++){var g=b[e].encode(!0);void 0!==g&&d.push(g)}return T(c,d,a,0,!0)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))},reset:function(){for(var a=0,c=this.items.length;a<c;a++)this.values.push(this.items[a].object)},
read:function(){for(var a=this.items,c=this.values,b=0,d=c.length;b<d;b++)this.items[b]?a[b].object!==c[b]&&(a[b].object=c[b]):(a[b]=new g(c[b]),c[b]=a[b].object)}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(c){c=Y(c,a,0,!0);var b=new this;b.items=[];for(var d=0,e=c.length;d<e;d++)b.items.push(g.decode(c[d]));b.reset();return b}});return l};return d()}},m=nb(16),B=nb(17),R=function(a,c){if(c){var b=t(k,{object:{get:function(){if(this.item)return c.decode(this.item.object)},
set:function(b){void 0!==b?this.item=new a(c.encode(b)):delete this.item}},encode:function(a){return this.item.encode(a)}},{decode:function(c){var b=new this;b.item=a.decode(c);return b}}),d;for(d in a)b[d]||(b[d]=a[d]);return b}return a},C=function(a){return R(B(a),{encode:function(a){return[a]},decode:function(a){return a[0]}})},r=function(a,c){return t(k,{object:{get:function(){return this.item&&this.item.object},set:function(b){if(b instanceof k)for(var d in a)if(b instanceof a[d]){this.item=
b;return}d="function"===typeof c?c(b):c;Q(!d||!a[d]);this.item=b=new a[d](b)}},encode:function(a){return this.item.encode(a)}},{decode:function(c){for(var b in a)try{var d=a[b].decode(c);if(void 0!==d)return new this(d)}catch(e){}Q(!0)}})},K=function(a){a=a||k;return t(a,{encode:function(){return ia.encode(a.method("encode").call(this,!0))}},{encode:function(a,b){return(new this(a)).encode(b)},decode:function(c){return a.decode.call(this,ia.decode(c))}})},V=function(a,c){a=a||k;return t(a,{encode:function(b){return this.object===
c?void 0:a.method("encode").call(this,b)}},{decode:function(b){if(void 0===b)return new this(c);try{return a.decode.call(this,b)}catch(d){}}})},d=function(a){a=a||k;return t(a,{},{decode:function(c){if(void 0!==c)try{return a.decode.call(this,c)}catch(b){}}})},ja=r({teletexString:lc,printableString:ya,universalString:nc,utf8String:z,bmpString:Ma,numericString:xa},function(a){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?"printableString":"utf8String"}),fa=r({utcTime:mc,
generalTime:A},function(a){return 2050<=a.getYear()?"generalTime":"utcTime"}),Na=J({type:l,value:k}),Oa={typeName:"type",valueName:"value"},ob=C(Na({serialName:ya,countryName:ya,dnQualifier:ya,emailAddress:ea,domainComponent:ea,SNILS:xa,OGRN:xa,INN:xa},ja)),oc=m(ob,Oa)(),W=r({rdnSequence:oc},"rdnSequence"),pb=F(e({notBefore:fa,notAfter:fa})),qb=J({type:l,value:k}),G=B(qb,Oa),Pa=m(qb,Oa),pc=e({a:h,b:h,seed:d(q)}),qc=g(t(k,{encode:function(){var a=this.object,c=Math.max(Ia(a.x.length-2),Ia(a.y.length-
2))/2,b=new Uint8Array(2*c+1);b[0]=4;b.set(new Uint8Array(U.decode(a.x,!1,c)),1);b.set(new Uint8Array(U.decode(a.y,!1,c)),c+1);return b.buffer}},{decode:function(a){var c=(a.byteLength-1)/2;return new this({x:U.encode(new Uint8Array(a,1,c)),y:U.encode(new Uint8Array(a,c+1,c))})}})),rc=e({fieldType:l,parameters:h}),sc=e({version:h,fieldID:rc,curve:pc,base:qc,order:h,cofactor:d(h)}),tc=e({publicKeyParamSet:l,digestParamSet:l,encryptionParamSet:d(l)}),uc=function(a,c){a=a||k;return t(a,{encode:function(b){return this.object===
c?(new pa(null)).encode(b):a.method("encode").call(this,b)}},{decode:function(b){if(void 0!==b){if(null===b||5===b.tagNumber&&0===b.tagClass)return new this(c);try{return a.decode.call(this,b)}catch(d){}}}})}(l,"id-GostR3411-94-CryptoProParamSet"),vc=r({namedParameters:l,ecParameters:sc,implicitly:d(pa)},function(a){return"string"===typeof a||a instanceof String?"namedParameters":"ecParameters"}),H=function(a,c){return R(e({algorithm:l,parameters:d(a)}),c)},s=function(){var a=H(k),c=t(k,function(a){if(this instanceof
c)c.super.apply(this,arguments);else return b(a)},{encode:function(c){return(new a(this.object)).encode(c)}},{decode:function(c){return new this(a.decode(c).object)}}),b=function(a){return t(k,{object:{get:function(){if(this.item)return this.item.object},set:function(c){if(c){var b=a[c.id];if(!b)throw Error("Algorithm not supported");this.item=new b(c)}else delete this.item}},encode:function(a){return this.item.encode(a)}},{decode:function(c){"string"===typeof c&&(c=Ka.decode(c,void 0,!1));c instanceof
P&&(c=ia.decode(c));var b=a[hb[c.object[0].object]];if(b){var d=new this;d.item=b.decode(c);return d}throw Error("Algorithm not supported");}})};return c}(),za=H(vc,{encode:function(a){return{algorithm:a.id,parameters:"string"===typeof a.namedCurve?ba.namedCurve[a.namedCurve]:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.curve.p},curve:{a:a.curve.a,b:a.curve.b},base:{x:a.curve.x,y:a.curve.y},order:a.curve.q,cofactor:1}}},decode:function(a){var c=a.parameters;a=I[a.algorithm];if("string"===
typeof c||c instanceof String)a=w(a,ca[c]);else if("object"===typeof c)a=w(a,{curve:{p:c.fieldID.parameters,a:c.curve.a,b:c.curve.b,x:c.base.x,y:c.base.y,q:c.order}});else throw new DataError("Invalid key paramters");return a}}),L=H(tc,{encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:ba[c][a[c]],
digestParamSet:ba.sBox[b],encryptionParamSet:a.encParams&&a.encParams.sBox?ba.sBox[a.encParams.sBox]:void 0}}},decode:function(a){var c=a.parameters;a=w(I[a.algorithm],ca[c.publicKeyParamSet],ca[c.digestParamSet]);c.encryptionParamSet&&(a.encParams=ca[c.encryptionParamSet]);return a}}),u=H(k,{encode:function(a){return{algorithm:a.id}},decode:function(a){return I[a.algorithm]}}),v=H(pa,{encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return I[a.algorithm]}}),qa=H(uc,{encode:function(a){return{algorithm:a.id,
parameters:ba.sBox[a.sBox||a.hash&&a.hash.sBox||"D-A"]}},decode:function(a){var c=w(I[a.algorithm]);a=ca[a.parameters];c.hash?c.hash=w(c.hash,a):c=w(c,a);return c}}),$=s({ecdsa:za,noSignature:v,rsaEncryption:v,"id-sc-gostR3410-2001":za,"id-GostR3410-2001":L,"id-GostR3410-94":L,"id-GostR3410-2001DH":L,"id-GostR3410-94DH":L,"id-tc26-gost3410-12-256":L,"id-tc26-gost3410-12-512":L,"id-tc26-agreement-gost-3410-12-256":L,"id-tc26-agreement-gost-3410-12-512":L,"id-sc-gost28147-gfb":u,"id-Gost28147-89":u}),
S=s({noSignature:v,rsaEncryption:v,sha1withRSAEncryption:v,sha256withRSAEncryption:v,sha384withRSAEncryption:v,sha512withRSAEncryption:v,ecdsa:u,"ecdsa-with-SHA1":u,"ecdsa-with-SHA256":u,"ecdsa-with-SHA384":u,"ecdsa-with-SHA512":u,"id-GostR3410-94":v,"id-GostR3410-2001":v,"id-GostR3411-94-with-GostR3410-2001":u,"id-GostR3411-94-with-GostR3410-94":u,"id-tc26-gost3410-12-256":v,"id-tc26-gost3410-12-512":v,"id-tc26-signwithdigest-gost3410-12-94":u,"id-tc26-signwithdigest-gost3410-12-256":u,"id-tc26-signwithdigest-gost3410-12-512":u,
"id-sc-gostR3410-94":v,"id-sc-gostR3410-2001":v,"id-sc-gostR3411-94-with-gostR3410-94":v,"id-sc-gostR3411-94-with-gostR3410-2001":v}),la=s({sha1:u,sha256:v,sha384:v,sha512:v,"id-GostR3411-94":qa,"id-tc26-gost3411-94":qa,"id-tc26-gost3411-12-256":v,"id-tc26-gost3411-12-512":v,"id-sc-gostR3411-94":u}),rb=e({iv:g,encryptionParamSet:l}),wc=e({encryptionParamSet:l,ukm:d(g)}),Qa=H(rb,{encode:function(a){return{algorithm:a.id,parameters:{iv:a.iv,encryptionParamSet:ba.sBox[a.sBox||"E-A"]}}},decode:function(a){var c=
w(I[a.algorithm],ca[a.parameters.encryptionParamSet]);c.iv=a.parameters.iv;return c}}),Ra=H(g,{encode:function(a){return{algorithm:a.id,parameters:a.iv}},decode:function(a){var c=w(I[a.algorithm]);c.iv=a.parameters||new Uint8Array([0,0,0,0,0,0,0,0]);return c}}),Aa=H(wc,{encode:function(a){return{algorithm:a.id,parameters:{encryptionParamSet:ba.sBox[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=w(I[a.algorithm],ca[a.parameters.encryptionParamSet]);a.parameters.ukm&&(c.ukm=a.parameters.ukm);
return c}}),sb=s({"id-Gost28147-89-None-KeyWrap":Aa,"id-Gost28147-89-CryptoPro-KeyWrap":Aa}),Ba=H(sb,{encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=w(I[a.algorithm]);c.wrapping=a.parameters;return c}}),xc=s({"id-sc-gost28147-gfb":Ra,"id-Gost28147-89":Qa}),Sa=s({"id-Gost28147-89-MAC":rb,"id-HMACGostR3411-94":qa,"id-tc26-hmac-gost-3411-12-256":qa,"id-tc26-hmac-gost-3411-12-512":qa,hmacWithSHA1:u,hmacWithSHA224:u,hmacWithSHA256:u,hmacWithSHA384:u,hmacWithSHA512:u,
"id-sc-gost28147-mac":u,"id-sc-hmacWithGostR3411":u}),yc=e({salt:r({specified:g,otherSource:s},function(a){return X(a)?"specified":"otherSource"}),iterationCount:h,keyLength:d(h),prf:Sa}),zc=H(yc,{encode:function(a){return{algorithm:a.id,parameters:{salt:a.salt,iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=w(I[a.algorithm]);c.salt=a.parameters.salt;c.iterations=a.parameters.iterationCount;c.hmac=a.parameters.prf;c.hash=c.hmac.hash;return c}}),Ta=s({PBKDF2:zc}),tb=e({salt:g,iterationCount:h}),
n=H(tb,{paramType:tb,encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=w(I[a.algorithm]);c.derivation=w(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}}),Ac=e({keyDerivationFunc:Ta,encryptionScheme:xc}),Ua=H(Ac,{encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,encryptionScheme:a.encryption}}},decode:function(a){var c=w(I[a.algorithm]);
c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}});s({"pbeWithSHAAndAES128-CBC":n,"pbeWithSHAAndAES192-CBC":n,"pbeWithSHAAndAES256-CBC":n,"pbeWithSHA256AndAES128-CBC":n,"pbeWithSHA256AndAES192-CBC":n,"pbeWithSHA256AndAES256-CBC":n,"id-sc-pbeWithGost3411AndGost28147":n,"id-sc-pbeWithGost3411AndGost28147CFB":n,"pbeWithSHAAnd3-KeyTripleDES-CBC":n,"pbeWithSHAAnd2-KeyTripleDES-CBC":n,"pbeWithSHAAnd128BitRC2-CBC":n,"pbeWithSHAAnd40BitRC2-CBC":n,pbeUnknownGost:n,
PBES2:Ua});var ra=s({ecdsa:za,rsaEncryption:v,"id-sc-gost28147-gfb":Ra,"id-Gost28147-89":Qa,"id-sc-gostR3410-2001":za,"id-GostR3410-2001":L,"id-GostR3410-94":L,"id-tc26-gost3410-12-256":L,"id-tc26-gost3410-12-512":L,"id-GostR3410-94-CryptoPro-ESDH":Ba,"id-GostR3410-2001-CryptoPro-ESDH":Ba,"id-tc26-agreement-gost-3410-12-256":Ba,"id-tc26-agreement-gost-3410-12-512":Ba,"id-sc-r3410-ESDH-r3411kdf":v,"id-Gost28147-89-None-KeyWrap":Aa,"id-Gost28147-89-CryptoPro-KeyWrap":Aa,"id-sc-cmsGostWrap":u,"id-sc-cmsGost28147Wrap":u,
"pbeWithSHAAndAES128-CBC":n,"pbeWithSHAAndAES192-CBC":n,"pbeWithSHAAndAES256-CBC":n,"pbeWithSHA256AndAES128-CBC":n,"pbeWithSHA256AndAES192-CBC":n,"pbeWithSHA256AndAES256-CBC":n,"id-sc-pbeWithGost3411AndGost28147":n,"id-sc-pbeWithGost3411AndGost28147CFB":n,"pbeWithSHAAnd3-KeyTripleDES-CBC":n,"pbeWithSHAAnd2-KeyTripleDES-CBC":n,"pbeWithSHAAnd128BitRC2-CBC":n,"pbeWithSHAAnd40BitRC2-CBC":n,pbeUnknownGost:n,PBES2:Ua}),Bc=e({keyDerivationFunc:Ta,messageAuthScheme:Sa}),Cc=H(Bc,{encode:function(a){return{algorithm:a.id,
parameters:{keyDerivationFunc:a.derivation,messageAuthScheme:a.hmac}}},decode:function(a){var c=w(I[a.algorithm]);c.derivation=a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;return c}});s({PBMAC1:Cc});var Dc=s({"id-sc-gost28147-gfb":Ra,"id-Gost28147-89":Qa,"pbeWithSHAAndAES128-CBC":n,"pbeWithSHAAndAES192-CBC":n,"pbeWithSHAAndAES256-CBC":n,"pbeWithSHA256AndAES128-CBC":n,"pbeWithSHA256AndAES192-CBC":n,"pbeWithSHA256AndAES256-CBC":n,"id-sc-pbeWithGost3411AndGost28147":n,"id-sc-pbeWithGost3411AndGost28147CFB":n,
"pbeWithSHAAnd3-KeyTripleDES-CBC":n,"pbeWithSHAAnd2-KeyTripleDES-CBC":n,"pbeWithSHAAnd128BitRC2-CBC":n,"pbeWithSHAAnd40BitRC2-CBC":n,pbeUnknownGost:n,PBES2:Ua}),ub=R(q(K(h)),{encode:function(a){return kb.encode(wa(a))},decode:function(a){return wa(kb.decode(a))}}),vb=R(q(K(g)),{encode:function(a){var c=new Uint8Array(a.byteLength+1),b=wa(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){Q(0===(a.byteLength&1));var c=new Uint8Array(a.byteLength-
1),b=c.byteLength/2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,1,b),b);return wa(c)}}),M=q(K(g)),ma=e({algorithm:$,subjectPublicKey:q},"PUBLIC KEY"),Va=function(a){return R(J({algorithm:$,subjectPublicKey:k},"algorithm","subjectPublicKey")(function(c){return a[c.id]}),{encode:function(a){return{algorithm:a.algorithm,subjectPublicKey:a.buffer}},decode:function(a){return{algorithm:a.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a.subjectPublicKey}}})}({"id-sc-gostR3410-2001":vb,
"id-sc-gostR3410-94":ub,"id-GostR3410-2001":M,"id-GostR3410-94":M,"id-tc26-gost3410-12-256":M,"id-tc26-gost3410-12-512":M}),wb=R(g(K(h)),{encode:function(a){return U.encode(a,!0)},decode:function(a){return U.decode(a,!0)}}),Ec=e({keyValueMask:g,keyValyePublicKey:g}),ga=r({privateKey:g(K(r({keyValueMask:g,keyValueInfo:Ec},function(a){return X(a)?"keyValueMask":"keyValueInfo"}))),keyValueMask:g},function(a){return a.enclosed?"keyValueMask":"privateKey"}),Fc=function(a){return J({version:h,privateKeyAlgorithm:$,
privateKeyWrapped:R(g(K(e({keyData:h,keyMac:h}))),{encode:function(a){var b=a.byteLength-4;return{keyData:U.encode(new Uint8Array(a,0,b)),keyMac:U.encode(new Uint8Array(a,b,4))}},decode:function(a){var b=U.decode(a.keyData);a=U.decode(a.keyMac);var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b));d.set(new Uint8Array(a),b.byteLength);return d}}),attributes:k},"privateKeyAlgorithm","attributes")(function(c){return d(b(0,f(G({"id-sc-gostR3410-2001-publicKey":C(a[c.id])}))))})}({"id-sc-gostR3410-2001":vb,
"id-sc-gostR3410-94":ub,"id-GostR3410-2001":M,"id-GostR3410-94":M,"id-GostR3410-2001DH":M,"id-GostR3410-94DH":M,"id-tc26-gost3410-12-256":M,"id-tc26-gost3410-12-512":M,"id-tc26-agreement-gost-3410-12-256":M,"id-tc26-agreement-gost-3410-12-512":M}),Wa=e({version:h,privateKeyAlgorithm:$,privateKey:g,attributes:d(b(0,f(G)))},"PRIVATE KEY"),Gc=e({version:h,privateKeyAlgorithm:$,privateKey:g,attributes:d(b(0,f(G))),publicKey:d(b(1,f(q)))}),Hc=m(Gc),Ic=function(a){return R(J({version:h,privateKeyAlgorithm:$,
privateKey:k,attributes:d(b(0,f(G)))},"privateKeyAlgorithm","privateKey")(function(c){return a[c.id]}),{encode:function(a){return{version:0,privateKeyAlgorithm:a.algorithm,privateKey:a.buffer}},decode:function(a){return{algorithm:a.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:X(a.privateKey)?a.privateKey:a.privateKey.keyValueMask}}})}({"id-sc-gostR3410-2001":wb,"id-sc-gostR3410-94":wb,"id-GostR3410-2001":ga,"id-GostR3410-94":ga,"id-GostR3410-2001DH":ga,
"id-GostR3410-94DH":ga,"id-tc26-gost3410-12-256":ga,"id-tc26-gost3410-12-512":ga,"id-tc26-agreement-gost-3410-12-256":ga,"id-tc26-agreement-gost-3410-12-512":ga}),xb=e({encryptionAlgorithm:ra,encryptedData:g},"ENCRYPTED PRIVATE KEY"),Jc=e({cA:V(da,!1),pathLenConstraint:d(h)}),Kc=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Lc=m(l),Mc=e({type:l,value:b(0,p(k))}),Nc=e({nameAssigner:d(b(0,f(ja))),partyName:d(b(1,
f(ja)))}),Oc=e({}),D=r({otherName:b(0,f(Mc)),rfc822Name:b(1,f(ja)),dNSName:b(2,f(ja)),x400Address:b(3,f(Oc)),directoryName:b(4,p(W)),ediPartyName:b(5,f(Nc)),uniformResourceIdentifier:b(6,f(ja)),iPAddress:b(7,f(g)),registeredID:b(8,f(l))},function(a){return"string"===typeof a||a instanceof String?0<=a.indexOf("@")?"rfc822Name":"dNSName":X(a)?"iPAddress":"directoryName"}),E=m(D),Xa=e({keyIdentifier:d(b(0,f(g))),authorityCertIssuer:d(b(1,f(E))),authorityCertSerialNumber:d(b(2,f(h)))}),Pc=e({notBefore:d(b(0,
f(A))),notAfter:d(b(1,f(A)))}),Qc=e({policyQualifierId:l,qualifier:k}),Rc=e({policyIdentifier:l,policyQualifiers:d(m(Qc))}),Sc=e({issuerDomainPolicy:l,subjectDomainPolicy:l}),Tc=e({base:D,minimum:V(b(0,f(h)),0),maximum:d(b(1,f(h)))}),yb=m(Tc),Uc=e({permittedSubtrees:d(b(0,f(yb))),excludedSubtrees:d(b(1,f(yb)))}),Vc=e({requireExplicitPolicy:d(b(0,f(h))),inhibitPolicyMapping:d(b(1,f(h)))}),Ya=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,
privilegeWithdrawn:7,aACompromise:8}),zb=r({fullName:b(0,f(E)),nameRelativeToCRLIssuer:b(1,f(ob))},function(a){return a instanceof Array?"fullName":"nameRelativeToCRLIssuer"}),Wc=e({distributionPoint:d(b(0,p(zb))),reasons:d(b(1,f(Ya))),cRLIssuer:d(b(2,f(E)))}),Ca=m(Wc),Za=e({accessMethod:l,accessLocation:D}),Ab=function(a,b){var d=J({extnID:l,critical:V(da,!1),extnValue:function(a){return g(K(a))}},"extnID","extnValue"),e=t(d(a),{object:{get:function(){var a=this._get(e.super,"object");a&&"object"===
typeof a.extnValue&&this.defineValue(a.extnValue);return a},set:function(a){this._set(e.super,"object",a);a&&a.extnValue&&(void 0!==a.extnValue.critical?this.critical=a.extnValue.critical:void 0===this.critical&&b&&(this.critical=b(this.extnID,a.extnValue)))}},extnValue:{get:function(){var a=this._get(e.super,"extnValue");"object"===typeof a&&this.defineValue(a);return a},set:function(a){this._set(e.super,"extnValue",a);a&&(void 0!==a.critical?this.critical=a.critical:void 0===this.critical&&b&&(this.critical=
b(this.extnID,a)))}},defineValue:function(a){if("object"===typeof a&&!Object.getOwnPropertyDescriptor(a,"critical")){var b=this;ha(a,"critical",{get:function(){return b.critical},set:function(a){b.critical=a},enumerable:!0,configurable:!1})}}});return e},Xc=e({signTool:z,cATool:z,signToolCert:z,cAToolCert:z}),na=m(Ab,{typeName:"extnID",valueName:"extnValue"}),Da=na({authorityKeyIdentifier:Xa,subjectKeyIdentifier:g,keyUsage:Kc,privateKeyUsagePeriod:Pc,certificatePolicies:m(Rc),policyMappings:m(Sc),
subjectAltName:E,issuerAltName:E,subjectDirectoryAttributes:Pa,basicConstraints:Jc,nameConstraints:Uc,policyConstraints:Vc,extKeyUsage:Lc,cRLDistributionPoints:Ca,inhibitAnyPolicy:h,freshestCRL:Ca,authorityInfoAccess:m(Za),subjectInfoAccess:m(Za),subjectSignTool:z,issuerSignTool:Xc},function(a,b){return"keyUsage"===a||"basicConstraints"===a&&void 0===b.pathLenConstraint}),Yc=e({r:h,s:h}),Bb=F(e({version:b(0,p(h)),serialNumber:h,signature:S,issuer:W,validity:pb,subject:W,subjectPublicKeyInfo:ma,issuerUniqueID:d(b(1,
f(q))),subjectUniqueID:d(b(2,f(q))),extensions:d(b(3,p(Da)))})),ka=e({tbsCertificate:Bb,signatureAlgorithm:S,signatureValue:q},"CERTIFICATE"),Zc=G({challengePassword:C(ja),extensionRequest:C(Da),msCertExtensions:C(Da),extendedCertificateAttributes:C(G)}),Cb=F(e({version:h,subject:W,subjectPublicKeyInfo:ma,attributes:b(0,f(Zc))})),Db=e({requestInfo:Cb,signatureAlgorithm:S,signatureValue:q},"CERTIFICATE REQUEST"),Eb=mb({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,
cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),$c=e({distributionPoint:d(b(0,p(zb))),onlyContainsUserCerts:V(b(1,f(da)),!1),onlyContainsCACerts:V(b(2,f(da)),!1),onlySomeReasons:d(b(3,f(Ya))),indirectCRL:V(b(4,f(da)),!1),onlyContainsAttributeCerts:V(b(5,f(da)),!1)}),ad=na({authorityKeyIdentifier:Xa,issuerAltName:E,cRLNumber:h,deltaCRLIndicator:h,issuingDistributionPoint:$c,freshestCRL:Ca},function(a){return"cRLNumber"===a}),bd=na({cRLReason:Eb,instructionCode:l,
invalidityDate:A,certificateIssuer:E}),Fb=F(e({version:d(h),signature:S,issuer:W,thisUpdate:fa,nextUpdate:d(fa),revokedCertificates:d(m(e({userCertificate:h,revocationDate:fa,crlEntryExtensions:d(bd)}))),crlExtensions:d(b(0,p(ad)))})),$a=e({tbsCertList:Fb,signatureAlgorithm:S,signatureValue:q},"CRL"),ab=e({digestedObjectType:mb({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:d(l),digestAlgorithm:la,objectDigest:q}),Ea=e({issuer:E,serial:h,issuerUID:d(q)}),cd=e({issuerName:d(E),
baseCertificateID:d(b(0,f(Ea))),objectDigestInfo:d(b(1,f(ab)))}),dd=e({targetCertificate:Ea,targetName:d(D),certDigestInfo:d(ab)}),ed=r({targetName:b(0,p(D)),targetGroup:b(1,p(D)),targetCert:b(2,f(dd))}),fd=m(ed),gd=na({auditIdentity:g,targetInformation:fd,authorityKeyIdentifier:Xa,authorityInfoAccess:m(Za),cRLDistributionPoints:Ca,noRevAvail:pa},function(a){return"auditIdentity"===a||"targetInformation"===a}),hd=e({baseCertificateID:d(b(0,f(Ea))),entityName:d(b(1,f(E))),objectDigestInfo:d(b(2,f(ab)))}),
id=r({v1Form:E,v2Form:b(0,f(cd))},"v2Form"),Gb=e({notBeforeTime:A,notAfterTime:A}),Hb=e({service:D,ident:D,authInfo:d(g)}),jd=e({roleAuthority:d(b(0,f(E))),roleName:b(1,p(D))}),kd=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),ld=e({type:b(0,f(l)),value:b(1,f(k))}),md=e({policyId:b(0,f(l)),classList:V(b(1,f(kd)),["unclassified"]),securityCategories:d(b(2,f(B(ld))))}),Ib=e({policyAuthority:d(b(0,f(E))),values:m(r({octets:g,oid:l,string:z},function(a){return X?"octets":
getIdentifier(a)?"oid":"string"}))}),Jb=F(e({version:h,holder:hd,issuer:id,signature:S,serialNumber:h,attrCertValidityPeriod:Gb,attributes:Pa({authenticationInfo:B(Hb),accessIdentity:B(Hb),chargingIdentity:C(Ib),group:C(Ib),role:B(jd),clearance:B(md)}),issuerUniqueID:d(q),extensions:d(gd)})),Kb=e({acinfo:Jb,signatureAlgorithm:S,signatureValue:q},"ATTRIBUTE CERTIFICATE"),oa=g,sa=g;e({keyInfo:sb,entityUInfo:d(b(0,p(g))),suppPubInfo:b(2,p(g))});var N=R(e({encryptedKey:g,maskKey:d(b(0,f(g))),macKey:g}),
{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey,d=a.maskKey;a=a.macKey;if(d)for(var d=new Int32Array(d),e=new Int32Array(b),f=0,g=d.length/e.length;f<g;f++)for(var h=0,k=e.length;h<k;h++)e[h]=e[h]+d[k*f+h]&4294967295;d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),32);return d.buffer}}),nd=e({encryptionParamSet:l,
ephemeralPublicKey:d(b(0,f(Va))),ukm:g}),Fa=R(e({sessionEncryptedKey:N,transportParameters:d(b(0,f(nd)))}),{encode:function(a){var b=a.algorithm;return{sessionEncryptedKey:a.sessionEncryptedKey,transportParameters:{encryptionParamSet:ba.sBox[b.wrapping.sBox||"E-A"],ephemeralPublicKey:b["public"],ukm:b.ukm}}},decode:function(a){return{algorithm:{wrapping:ca[a.transportParameters.encryptionParamSet],ukm:a.transportParameters.ukm,"public":a.transportParameters.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),
Lb=R(e({sessionEncryptedKey:N,ukm:e({ephemeralPublicKey:Va,addedukm:d(b(0,p(g)))})}),{encode:function(a){var b=a.algorithm;return{sessionEncryptedKey:a.sessionEncryptedKey,ukm:{ephemeralPublicKey:b["public"],addedukm:b.ukm}}},decode:function(a){return{algorithm:{ukm:a.ukm.addedukm,"public":a.ukm.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),od=function(a){return function(b){return(b=a[b.id])?K(b):k}}({"id-sc-gostR3410-2001":Lb,"id-sc-gostR3410-94":Lb,"id-GostR3410-2001":Fa,"id-GostR3410-94":Fa,
"id-tc26-gost3410-12-256":Fa,"id-tc26-gost3410-12-512":Fa,"id-GostR3410-94-CryptoPro-ESDH":N,"id-GostR3410-2001-CryptoPro-ESDH":N,"id-tc26-agreement-gost-3410-12-256":N,"id-tc26-agreement-gost-3410-12-512":N,"id-sc-r3410-ESDH-r3411kdf":N,"id-Gost28147-89-None-KeyWrap":N,"id-Gost28147-89-CryptoPro-KeyWrap":N,"id-sc-cmsGostWrap":N,"id-sc-cmsGost28147Wrap":N}),pd=q({kccaSoftPassword:0,kccaReservePrimary:1,kccaPrimaryKeyAbsent:2,kccaFKCShared:3}),qd=q({pkaExportable:0,pkaUserProtect:1,pkaExchange:2,pkaEphemeral:3,
pkaNonCachable:4,pkaDhAllowed:5}),Mb=e({attributes:d(qd),privateKeyAlgorithm:d(b(0,f($)))}),Nb=e({path:ea,hmac:g}),rd=e({containerAlgoritmIdentifier:d(b(0,f(s))),containerName:d(ea),attributes:pd,primaryPrivateKeyParameters:Mb,hmacPassword:d(b(2,f(g))),secondaryEncryptedPrivateKey:d(b(3,f(N))),secondaryPrivateKeyParameters:d(b(4,f(Mb))),primaryCertificate:d(b(5,f(g(K(ka))))),secondaryCertificate:d(b(6,f(g(K(ka))))),encryptionContainerName:d(b(7,f(ea))),primaryCertificateLink:d(b(8,f(Nb))),secondaryCertificateLink:d(b(9,
f(Nb))),primaryFP:d(b(10,f(g))),secondaryFP:d(b(11,f(g))),passwordPolicy:d(s),containerSecurityLevel:d(h),extensions:d(b(12,f(na({keyValidity:e({notBefore:d(b(0,f(A))),notAfter:d(b(1,f(A)))})})))),secondaryEncryptionContainerName:d(b(13,f(ea)))}),sd=e({keyContainerContent:rd,hmacKeyContainerContent:g}),td=e({containerName:ea,extElem1:d(k)}),ud=e({primaryKey:g,secondaryKey:d(g),hmacKey:d(g)}),vd=e({mask:g,randomStatus:g,hmacRandom:g}),Ob=e({keyClass:h,keyType:h,algorithm:d(b(0,p($))),serialNumber:d(b(1,
p(g))),addSerialNumber:d(b(2,p(g))),certSerialNumber:d(b(3,p(g))),subjectUID:d(b(4,p(g))),recipientUID:d(b(5,p(g))),validity:d(b(6,p(r({validity:pb,keyValidity:e({notBefore:d(b(0,f(A))),notAfter:d(b(1,f(A)))})},function(){return"keyValidity"})))),keyUID:d(b(7,p(q))),flags:d(b(10,p(h)))}),wd=e({version:h,keyInfo:Ob,defenceKeyInfo:Ob,certificate:d(b(0,p(ka))),publicKey:d(b(1,p(g)))}),ta=l,sa=g,bb=m(h),xd=e({bodyPartPath:bb,identifier:l,content:k}),Ga=G({contentType:C(ta),signingTime:C(fa),messageDigest:C(g)}),
Pb=G(function(a){return{countersignature:B(yd),unsignedData:B(xd)}[a]}),ua=e({issuer:W,serialNumber:h}),zd=r({issuerAndSerialNumber:ua,subjectKeyIdentifier:b(0,f(sa))},function(a){return X(a)?"subjectKeyIdentifier":"issuerAndSerialNumber"}),Qb=e({version:h,sid:zd,digestAlgorithm:la,signedAttrs:d(b(0,f(Ga))),signatureAlgorithm:S,signatureValue:g,unsignedAttrs:d(b(1,f(Pb)))}),yd=Qb,Ad=B(Qb),Bd=B(la),Cd=F(e({version:h,certificate:ka,attributes:G})),Dd=e({extendedCertificateInfo:Cd,signatureAlgorithm:S,
signatureValue:q}),Ed=e({otherCertFormat:l,otherCert:k}),Fd=F(e({version:h,subject:r({baseCertificateID:b(0,f(Ea)),subjectName:b(1,f(E))},function(a){return a.issuer?"baseCertificateID":"subjectName"}),issuer:E,signature:S,serialNumber:h,attCertValidityPeriod:Gb,attributes:Pa,issuerUniqueID:d(q),extensions:d(Da)})),Gd=e({acInfo:Fd,signatureAlgorithm:S,signatureValue:q}),cb=e({eContentType:ta,eContent:d(b(0,p(g)))}),Hd=r({certificate:ka,extendedCertificate:b(0,f(Dd)),v1AttrCert:b(1,f(Gd)),v2AttrCert:b(2,
f(Kb)),other:b(3,f(Ed))},function(a){return a.holder?"AttributeCertificateV2":a.certificate?"ExtendedCertificate":a.otherCertFormat?"other":"certificate"}),Id=e({otherRevInfoFormat:l,otherRevInfo:k}),Jd=r({crl:$a,other:b(1,f(Id))},function(a){return a.otherRevInfoFormat?"other":"crl"}),Rb=B(Hd),Sb=B(Jd),Kd=e({version:h,digestAlgorithms:Bd,encapContentInfo:cb,certificates:d(b(0,f(Rb))),crls:d(b(1,f(Sb))),signerInfos:Ad}),Ld=r({issuerAndSerialNumber:ua,subjectKeyIdentifier:b(0,f(sa))},function(a){return X(a)?
"subjectKeyIdentifier":"issuerAndSerialNumber"}),Md=e({version:h,rid:Ld,keyEncryptionAlgorithm:ra,encryptedKey:oa}),Tb=e({keyAttrId:l,keyAttr:d(k)}),Nd=e({subjectKeyIdentifier:sa,date:d(A),other:d(Tb)}),Od=r({issuerAndSerialNumber:ua,rKeyId:b(0,f(Nd))},function(a){return X(a)?"rKeyId":"issuerAndSerialNumber"}),Pd=e({rid:Od,encryptedKey:oa}),Qd=m(Pd),Ub=e({algorithm:$,publicKey:q});e({ephemeralPublicKey:Ub,addedukm:d(b(0,p(g)))});var Rd=r({issuerAndSerialNumber:ua,subjectKeyIdentifier:b(0,f(sa)),originatorKey:b(1,
f(Ub))},function(a){return X(a)?"subjectKeyIdentifier":a.algorithm?"originatorKey":"issuerAndSerialNumber"}),Sd=e({version:h,originator:b(0,p(Rd)),ukm:d(b(1,p(g))),keyEncryptionAlgorithm:ra,recipientEncryptedKeys:Qd}),Td=e({keyIdentifier:g,date:d(A),other:d(Tb)}),Ud=e({version:h,kekid:Td,keyEncryptionAlgorithm:ra,encryptedKey:oa}),Vd=e({version:h,friendlyName:d(b(0,f(Ta))),keyEncryptionAlgorithm:ra,encryptedKey:oa}),Wd=e({oriType:l,oriValue:k}),Xd=r({ktri:Md,kari:b(1,f(Sd)),kekri:b(2,f(Ud)),pwri:b(3,
f(Vd)),ori:b(4,f(Wd))},function(a){return a.rid?"ktri":a.originator?"kari":a.kekid?"kekri":a.oriType?"ori":"pwri"}),db=e({certs:d(b(0,f(Rb))),crls:d(b(1,f(Sb)))}),eb=B(Xd),fb=e({contentType:ta,contentEncryptionAlgorithm:Dc,encryptedContent:d(b(0,f(g)))}),Ha=e({version:h,originatorInfo:d(b(0,f(db))),recipientInfos:eb,encryptedContentInfo:fb,unprotectedAttrs:d(b(1,f(G)))}),Yd=e({version:h,digestAlgorithm:la,encapContentInfo:cb,digest:g}),Vb=e({version:h,encryptedContentInfo:fb,unprotectedAttrs:d(b(1,
f(G)))}),Zd=e({version:h,originatorInfo:d(b(0,f(db))),recipientInfos:eb,macAlgorithm:Sa,digestAlgorithm:d(b(1,la)),encapContentInfo:cb,authAttrs:d(b(2,f(Ga))),mac:g,unauthAttrs:d(b(3,f(G)))}),$d=e({version:h,originatorInfo:d(b(0,f(db))),recipientInfos:eb,authEncryptedContentInfo:fb,authAttrs:d(b(1,f(Ga))),mac:g,unauthAttrs:d(b(2,f(G)))}),ae=r({encrypted:Vb,enveloped:b(0,f(Ha)),authEnveloped:b(1,f($d))},function(a){return a.encryptedContentInfo?a.recipientInfos?"enveloped":"encrypted":"authEnveloped"}),
ta=l,va=J({contentType:ta,content:function(a){return b(0,p(a))}},"contentType","content",void 0,"CMS")({data:g,signedData:F(Kd),envelopedData:F(Ha),digestedData:F(Yd),encryptedData:F(Vb),authData:F(Zd),encryptedKeyPkg:F(ae),aKeyPackage:F(Hc)}),be=e({digestAlgorithm:la,digest:g}),ce=G({friendlyName:C(Ma),keyProviderNameAttr:C(Ma),localKeyId:C(g),certKeyIdentifierPropId:C(g)}),de=J({certId:l,certValue:function(a){return b(0,p(a))}},"certId","certValue")({x509Certificate:g(K(ka)),sdsiCertificate:ea},
g),ee=J({crlId:l,crlValue:function(a){return b(0,p(a))}},"crlId","crlValue")({x509CRL:g(K($a))},g),fe=J({secretTypeId:l,secretValue:function(a){return b(0,p(a))}},"secretTypeId","secretValue")({secret:g},g),ge=J({bagId:l,bagValue:function(a){return b(0,p(a))},bagAttributes:d(ce)},"bagId","bagValue")(function(a){return{keyBag:Wa,pkcs8ShroudedKeyBag:xb,certBag:de,crlBag:ee,secretBag:fe,safeContentsBag:Wb}[a]}),Wb=m(ge),he=m(va),ie=e({mac:be,macSalt:g,iterations:V(h,1)}),je=e({version:h,authSafe:va,
macData:d(ie)},"PFX"),ke=e({issuer:D,serialNumber:h}),le=e({intendedAlg:d(b(0,f(s))),symmAlg:d(b(1,f(s))),encSymmKey:d(b(2,f(q))),keyAlg:d(b(3,f(s))),valueHint:d(b(4,f(g))),encValue:q}),oa=r({encryptedValue:le,envelopedData:b(0,f(Ha))},function(a){return a.encryptedContentInfo?"envelopedData":"encryptedValue"}),me=r({encryptedPrivKey:b(0,oa),keyGenParameters:b(1,f(g)),archiveRemGenPrivKey:b(2,f(da))}),ne=e({pubMethod:h({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:d(D)}),Xb=e({action:h({dontPublish:0,
pleasePublish:1}),pubInfos:d(m(ne))}),oe=h({encrCert:0,challengeResp:1}),Zb=r({thisMessage:b(0,f(q)),subsequentMessage:b(1,f(oe)),dhMAC:b(2,f(q)),agreeMAC:b(3,f(Yb)),encryptedKey:b(4,f(Ha))});e({salt:g,owf:s,iterationCount:h,mac:s});var Yb=e({algId:s,value:q}),pe=e({authInfo:r({sender:b(0,p(D)),publicKeyMAC:Yb}),publicKey:ma}),qe=e({poposkInput:d(b(0,pe)),algorithmIdentifier:s,signature:q}),re=r({raVerified:b(0,f(pa)),signature:b(1,f(qe)),keyEncipherment:b(2,f(Zb)),keyAgreement:b(3,f(Zb))}),se=m(Na({regToken:z,
authenticator:z,pkiPublicationInfo:Xb,pkiArchiveOptions:me,oldCertID:ke,protocolEncrKey:ma})),te=e({notBefore:d(b(0,f(fa))),notAfter:d(b(1,f(fa)))}),$b=e({version:d(b(0,f(h))),serialNumber:d(b(1,f(h))),signingAlg:d(b(2,f(s))),issuer:d(b(3,f(W))),validity:d(b(4,f(te))),subject:d(b(5,f(W))),publicKey:d(b(6,f(ma))),issuerUID:d(b(7,f(q))),subjectUID:d(b(8,f(q))),extensions:d(b(9,f(na)))}),ac=e({certReqId:h,certTemplate:$b,controls:d(se)}),ue=e({privateKey:Wa,identifier:d(r({string:z,generalName:D},function(a){return"string"===
typeof a||a instanceof String?"string":"generalName"}))}),bc=e({certReq:ac,popo:d(re),regInfo:d(m(Na({utf8Pairs:z,certReq:ac,encKeyWithID:ue})))});m(bc);var cc=e({pendToken:g,pendTime:A}),dc=h({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,partial:7}),ec=h({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),ve=e({cMCStatus:dc,
bodyList:m(h),statusString:d(z),otherInfo:d(r({failInfo:ec,pendInfo:cc}))}),we=e({pkiDataReference:h,certReferences:m(h),extensions:m(Ab)}),xe=e({pkiDataBodyid:h,bodyIds:m(h)}),ye=e({issuerName:D,serialNumber:h}),ze=e({issuerName:W,cRLName:d(D),time:d(A),reasons:d(Ya)}),Ae=e({issuerName:W,serialNumber:h,reason:Eb,invalidityDate:d(A),passphrase:d(g),comment:d(z)}),Be=e({bodyPartID:h,thePOPAlgID:s,thePOP:g}),fc=r({bodyPartID:h,bodyPartPath:bb}),Ce=e({cMCStatus:dc,bodyList:m(fc),statusString:d(z),otherInfo:d(r({failInfo:ec,
pendInfo:cc,extendedFailInfo:e({failInfoOID:l,failInfoValue:k})}))}),De=e({seqNumber:h,hashAlgorithm:s,anchorHashes:m(g)}),gb=m(h),Ee=e({hashAlg:s,certHashes:m(g),pubInfo:Xb}),Fe=e({pkiDataReference:bb,certReferences:gb,replace:V(da,!0),certTemplate:$b}),Ge=e({bodyList:m(fc)}),He=e({proofAlgID:s,macAlgId:s,witness:g}),Ie=e({keyGenAlgorithm:s,macAlgorithm:s,witness:g}),Je=e({bodyPartID:h,certificationRequest:Db}),gc=e({bodyPartID:h,contentInfo:va}),hc=e({bodyPartID:h,otherMsgType:l,otherMsgValue:k}),
ic=r({tcr:b(0,f(Je)),crm:b(1,f(bc)),orm:b(2,f(e({bodyPartID:h,requestMessageType:l,requestMessageValue:k})))}),Ke=e({request:ic,cms:va,thePOPAlgID:s,witnessAlgID:s,witness:g}),jc=J({bodyPartID:h,attrType:l,attrValues:function(a){return B(a)}},"attrType","attrValues",k)({statusInfo:ve,identification:z,identityProof:g,dataReturn:g,transactionId:h,senderNonce:g,recipientNonce:g,addExtensions:we,encryptedPOP:Ke,decryptedPOP:Be,lraPOPWitness:xe,getCert:ye,getCRL:ze,revokeRequest:Ae,regInfo:g,responseInfo:g,
queryPending:g,popLinkRandom:g,popLinkWitness:g,confirmCertAcceptance:ua,statusInfoV2:Ce,trustedAnchors:De,authPublish:h,batchRequests:gb,batchResponses:gb,publishCert:Ee,modCertTemplate:Fe,controlProcessed:Ge,popLinkWitnessV2:Ie,identityProofV2:He}),Le=e({controlSequence:m(jc),reqSequence:m(ic),cmsSequence:m(gc),otherMsgSequence:m(hc)},"PKI REQUEST"),Me=e({controlSequence:m(jc),cmsSequence:m(gc),otherMsgSequence:m(hc)},"PKI RESPONSE");La.prototype={GostPrivateKeyInfo:Ic,GostSubjectPublicKeyInfo:Va,
GostKeyContainer:sd,GostKeyContainerName:td,GostPrivateKeys:ud,GostPrivateMasks:vd,ViPNetInfo:wd,GostSignature:Yc,GostEncryptedKey:od,GostWrappedPrivateKey:Fc,PrivateKeyInfo:Wa,EncryptedPrivateKeyInfo:xb,SubjectPublicKeyInfo:ma,TBSCertificate:Bb,Certificate:ka,CertificationRequestInfo:Cb,CertificationRequest:Db,TBSCertList:Fb,CertificateList:$a,AttributeCertificateInfo:Jb,AttributeCertificate:Kb,SignedAttributes:Ga,UnsignedAttributes:Pb,ContentInfo:va,SafeContents:Wb,AuthenticatedSafe:he,PFX:je,PKIData:Le,
PKIResponse:Me};x.asn1=new La;return La});
