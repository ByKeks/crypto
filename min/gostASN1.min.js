/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(x,w){"function"===typeof define&&define.amd?define(["gostCrypto","gostCoding","gostSecurity"],w):"object"===typeof exports?module.exports=w(require("gostCrypto"),require("gostCoding"),require("gostSecurity")):x.GostASN1=w(x.gostCrypto,x.GostCoding,x.GostSecurity)})(this,function(x){function w(){for(var a={},c=0,b=arguments.length;c<b;c++){var d=arguments[c];if("object"===typeof d)for(var e in d)a[e]=d[e]}return a}function wa(a){a instanceof N&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),
b=0,d=a.length;b<d;b++)c[d-b-1]=a[b];return c.buffer}function X(a){return a instanceof N||a.buffer instanceof N}function jc(a,c){return a.length>=c?a:Array(c-a.length+1).join("0")+a}function Ha(a){return 2>=a?a:4>=a?4:8>=a?8:16>=a?16:32>=a?32:64>=a?64:128>=a?128:256>=a?256:512>a?512:1024>a?1024:void 0}function O(a){if(a)throw Error("Invalid format");}function ha(a,c,b,d){"object"!==typeof b&&(b={value:b});void 0!==d&&(b.enumerable=d);Object.defineProperty(a,c,b)}function Ia(a,c,b){for(var d in c)ha(a,
d,c[d],b)}function S(a,c,b,d,e,f){O(void 0===c);c={tagNumber:b,tagClass:d||0,tagConstructed:e||!1,object:c};a=a||"DER";if("DER"===a||"CER"===a)c=ia.encode(c,a);"PEM"===a&&(c=Ja.encode(c,f));return c}function Y(a,c,b,d,e){O(void 0===a);"string"===typeof a&&(a=Ja.decode(a,e,!1));a instanceof N&&(a=ia.decode(a));b=b||0;d=d||!1;void 0===a.tagNumber&&(a=S(!0,a.object,c,b,a.object instanceof Array),a=ia.decode(a));O(a.tagClass!==b||a.tagNumber!==c||a.tagConstructed!==d);return 0===b&&5===c?null:a.object}
function t(a,c,b,d){"function"!==typeof c&&(d=b,b=c,c=function(){a.apply(this,arguments)});c.prototype=Object.create(a.prototype,{constructor:{value:c},superclass:{value:a.prototype}});b&&Ia(c.prototype,b);if(a!==Object)for(var e in a)c[e]=a[e];c.super=a;d&&Ia(c,d,!0);return c}function Ka(){}var N=this.ArrayBuffer,H=x.security.algorithms,gb=x.security.names,hb=x.security.identifiers,ba=x.security.attributes,ca=x.security.parameters,ia=x.coding.BER,Ja=x.coding.PEM,ib=x.coding.Hex,jb=x.coding.Int16,
T={encode:function(a,c){return"0x"+ib.encode(a,c)},decode:function(a,c,b){"number"===typeof a&&(a=a.toString(16));a=a.replace("0x","");b=b||Ha(a.length);return ib.decode(jc(a,b),c)}},k=t(Object,function(a){this.object=a},{_set:function(a,c,b){a.property(c).set.call(this,b)},_get:function(a,c){return a.property(c).get.call(this)},_call:function(a,c,b){return a.method(c).apply(this,b)},hasProperty:function(a){return this.hasOwnProperty(a)||!!this.constructor.property(a)},encode:function(){return this.object}},
{decode:function(a){return new this(a)},property:function(a){for(var c=this.prototype;c;){var b=Object.getOwnPropertyDescriptor(c,a);if(b)return b;c=c.superclass}},method:function(a){for(var c=this.prototype;c;){if(c[a])return c[a];c=c.superclass}}}),D=function(a){return t(k,{encode:function(c){return S(c,this.object,a)}},{decode:function(c){return new this(Y(c,a))}})},da=D(1),ea=D(22),xa=D(19),kc=D(20),U=D(12),lc=D(23),y=D(24),mc=D(28),La=D(30),pa=t(D(5),{object:{get:function(){return null},set:function(a){O(null!==
a)}}}),kb=function(a){function c(c){return t(D(a),function(a){b.super.call(this,a)},{encode:function(b){return S(b,c[this.object],a)}},{decode:function(b){b=Y(b,a);for(var d in c)if(b===c[d])return new this(d);O(!0)}})}var b=t(D(a),function(a){if(this instanceof b)b.super.apply(this,arguments);else return c(a)});return b},h=kb(2),lb=kb(10),g=function(){function a(a){return a?t(a,{encode:function(c){return S(c,a.method("encode").call(this,!0),4)}},{decode:function(c){return a.decode.call(this,Y(c,
4))}}):c}var c=t(D(4),function(b){if(this instanceof c)c.super.apply(this,arguments);else return a(b)});return c}(),q=function(){function a(a){return a?t(a,{encode:function(c){return S(c,a.method("encode").call(this,!0),3)}},{decode:function(c){return a.decode.call(this,Y(c,3))}}):b}function c(a){return t(k,function(a,c){k.call(this,a);this.numbits=c||0},{encode:function(c){var b=this.object,d=[];if(b instanceof Array){for(var e=0,f=b.length;e<f;e++){var R=a[b[e]];void 0!==R&&(d[R]="1")}e=0;for(f=
Math.max(d.length,this.numbits);e<f;e++)d[e]||(d[e]="0");d=d.join("")}else d="0";return S(c,d,3)}},{decode:function(c){c=Y(c,3);var b=[],d;for(d in a)"1"===c.charAt(a[d])&&b.push(d);return new this(b,c.length)}})}var b=t(D(3),function(d){if(this instanceof b)b.super.apply(this,arguments);else return"object"===typeof d?c(d):a(d)});return b}(),E=function(a){a.combine=function(c,b){for(var d in a.prototype)a.prototype.hasOwnProperty(d)&&!c.hasProperty(d)&&ha(c,d,function(a){return{get:function(){return this[b]&&
this[b][a]},set:function(c){this[b]||(this[b]={});this[b][a]=c},configurable:!1,enumerable:!0}}(d))};return a},e=function(a,c){var b=t(k,function(a,c){ha(this,"items",{writable:!0,value:{}});"string"===typeof a||a instanceof N?this.decode(a):void 0!==a&&(this.object=a,c&&this.check())},{object:{get:function(){return this},set:function(c){if(c instanceof b){this.items=c.items;for(var d in a){var e=this.getItemClass(d,this.items);e.combine&&e.combine(this,d)}}else{var f={};for(d in a){var g=c[d],e=
this.getItemClass(d,f);void 0!==g?f[d]=new e(g):e.combine&&(f[d]=new e(c));e.combine&&e.combine(this,d)}this.items=f}}},getItemClass:function(c,b){return a[c]},encode:function(b){var d=[],e=this.items,f;for(f in a)if(e[f]){var R=e[f].encode(!0);void 0!==R&&d.push(R)}return S(b,d,16,0,!0,c)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(b){b=Y(b,16,0,!0,c);var d=
0,e=new this,f=e.items={},R;for(R in a){var g=e.getItemClass(R,f),h=g.decode(b[d]);void 0!==h&&(f[R]=h,g.combine&&g.combine(e,R),d++)}return e}}),d;for(d in a)ha(b.prototype,d,function(c){return{get:function(){return this.items[c]&&this.items[c].object},set:function(a){if(void 0!==a){var b=this.getItemClass(c,this.items);this.items[c]=new b(a)}else delete this.items[c]},configurable:!1,enumerable:!a[c].combine}}(d)),a[d].combine&&a[d].combine(b.prototype,d);return b},I=function(a,c,b,d,f){var g=e(a,
f),h=function(e,f){c=c||"type";b=b||"value";f=f||d||k;var Z=t(g,function(a){if(this instanceof Z)g.apply(this,arguments);else return h.apply(this,arguments)},{getItemClass:function(d,g){var h=a[d];if(b===d){var Z,aa=g&&g[c];aa&&(aa=aa.object,e&&(Z="function"===typeof e?e(aa):e[aa]));Z=Z||f||k;h=h===k?Z:h(Z)}return h}});ha(Z.prototype,c,{get:function(){return this.items[c]&&this.items[c].object},set:function(){O(!0)},configurable:!1,enumerable:!0});return Z};return h()},l=t(k,{encode:function(a){var c=
this.object,c=/^(\d+\.)+\d+$/.test(c)?c:hb[c];O(!c);return S(a,c,6)}},{decode:function(a){a=Y(a,6);return new this(gb[a]||a)}}),f=function(a){a=a||k;return t(a,{encode:function(c){c=a.method("encode").call(this,c);return"string"===typeof c||c instanceof N?c:4===c.tagNumber||0!==c.tagClass||c.object instanceof Array?{object:c.object}:{object:ia.encode(c,"DER",!0)}}},{decode:function(c){"string"===typeof c||c instanceof N||(c={object:c.object,header:c.header,content:c.content});return a.decode.call(this,
c)}})},p=function(a){a=a||k;return t(a,{encode:function(c){c=a.method("encode").call(this,c);return"string"===typeof c||c instanceof N?c:{object:[c]}}},{decode:function(c){return"string"===typeof c||c instanceof N?a.decode.call(this,c):a.decode.call(this,c.object[0])}})},b=function(a,c){return t(c,function(){c.apply(this,arguments)},{encode:function(b){b=c.method("encode").call(this,b);if("string"===typeof b||b instanceof N)return b;b.tagNumber=a;b.tagClass=2;b.tagConstructed=b.object instanceof Array;
return b}},{decode:function(b){O(void 0!==b.tagNumber&&(2!==b.tagClass||b.tagNumber!==a));return c.decode.call(this,b)}})},mb=function(a){return function(c,b){c=c||k;var d=function(e,f){var g="function"===typeof c&&void 0!==e?c(e,f):c;if(b){var h=t(k,function(a){if(this instanceof h)ha(this,"items",{writable:!0,value:{}}),k.call(this,a||{});else return d.apply(this,arguments)},{object:{get:function(){this.read();return this},set:function(a){if(a instanceof h)a.read(),this.items=a.items;else{var c=
{},b;for(b in a)c[b]=this.createItem(a[b],b);this.items=c}this.reset()}},createItem:function(a,c){if(b){var d={};d[b.typeName]=c;d[b.valueName]=a}else d=a;return new g(d)},getItemValue:function(a){a=this.items[a];return b?a.object[b.valueName]:a.object},setItemValue:function(a,c){var d=this.items[a];b?d.object[b.valueName]=c:d.object=c},isItemType:function(a){return b?hb[a]:!isNaN(parseInt(a))},reset:function(){var a=this.items,c;for(c in this)this.hasOwnProperty(c)&&!this.items[c]&&this.isItemType(c)&&
delete this[c];for(c in a)this[c]=this.getItemValue(c)},read:function(){var a=this.items,c;for(c in this)this.isItemType(c)&&(this.items[c]?this.getItemValue(c)!==this[c]&&this.setItemValue(c,this[c]):(a[c]=this.createItem(this[c],c),this[c]=this.getItemValue(c)))},encode:function(c){this.read();var b=this.items,d=[],e;for(e in b){var f=b[e].encode(!0);void 0!==f&&d.push(f)}return S(c,d,a,0,!0)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))}},
{encode:function(a,c){return(new this(a)).encode(c)},decode:function(c){c=Y(c,a,0,!0);for(var d=new this,e=d.items={},f=0,h=c.length;f<h;f++){var aa=g.decode(c[f]);e[b?aa.object[b.typeName]:f]=aa}d.reset();return d}});return h}var l=t(k,function(a){if(this instanceof l)Ia(this,{items:{writable:!0,value:[]},values:{writable:!0,value:[]}}),k.call(this,a||[]);else return d.apply(this,arguments)},{object:{get:function(){this.read();return this.values},set:function(a){if(a instanceof l)a.read(),this.items=
a.items;else{for(var c=[],b=0,d=a.length;b<d;b++)c[b]=new g(a[b]);this.items=c}this.reset()}},encode:function(c){this.read();for(var b=this.items,d=[],e=0,f=b.length;e<f;e++){var g=b[e].encode(!0);void 0!==g&&d.push(g)}return S(c,d,a,0,!0)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))},reset:function(){for(var a=0,c=this.items.length;a<c;a++)this.values.push(this.items[a].object)},read:function(){for(var a=this.items,c=this.values,
b=0,d=c.length;b<d;b++)this.items[b]?a[b].object!==c[b]&&(a[b].object=c[b]):(a[b]=new g(c[b]),c[b]=a[b].object)}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(c){c=Y(c,a,0,!0);var b=new this;b.items=[];for(var d=0,e=c.length;d<e;d++)b.items.push(g.decode(c[d]));b.reset();return b}});return l};return d()}},m=mb(16),z=mb(17),P=function(a,c){if(c){var b=t(k,{object:{get:function(){if(this.item)return c.decode(this.item.object)},set:function(b){void 0!==b?this.item=new a(c.encode(b)):
delete this.item}},encode:function(a){return this.item.encode(a)}},{decode:function(c){var b=new this;b.item=a.decode(c);return b}}),d;for(d in a)b[d]||(b[d]=a[d]);return b}return a},A=function(a){return P(z(a),{encode:function(a){return[a]},decode:function(a){return a[0]}})},r=function(a,c){return t(k,{object:{get:function(){return this.item&&this.item.object},set:function(b){if(b instanceof k)for(var d in a)if(b instanceof a[d]){this.item=b;return}d="function"===typeof c?c(b):c;O(!d||!a[d]);this.item=
b=new a[d](b)}},encode:function(a){return this.item.encode(a)}},{decode:function(c){for(var b in a)try{var d=a[b].decode(c);if(void 0!==d)return new this(d)}catch(e){}O(!0)}})},J=function(a){a=a||k;return t(a,{encode:function(){return ia.encode(a.method("encode").call(this,!0))}},{encode:function(a,b){return(new this(a)).encode(b)},decode:function(c){return a.decode.call(this,ia.decode(c))}})},V=function(a,c){a=a||k;return t(a,{encode:function(b){return this.object===c?void 0:a.method("encode").call(this,
b)}},{decode:function(b){if(void 0===b)return new this(c);try{return a.decode.call(this,b)}catch(d){}}})},d=function(a){a=a||k;return t(a,{},{decode:function(c){if(void 0!==c)try{return a.decode.call(this,c)}catch(b){}}})},ja=r({teletexString:kc,printableString:xa,universalString:mc,utf8String:U,bmpString:La},function(a){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?"printableString":"utf8String"}),fa=r({utcTime:lc,generalTime:y},function(a){return 2050<=a.getYear()?
"generalTime":"utcTime"}),Ma=I({type:l,value:k}),Na={typeName:"type",valueName:"value"},nb=A(Ma({serialName:xa,countryName:xa,dnQualifier:xa,emailAddress:ea,domainComponent:ea},ja)),nc=m(nb,Na)(),W=r({rdnSequence:nc},"rdnSequence"),ob=E(e({notBefore:fa,notAfter:fa})),pb=I({type:l,value:k}),F=z(pb,Na),Oa=m(pb,Na),oc=e({a:h,b:h,seed:d(q)}),pc=g(t(k,{encode:function(){var a=this.object,c=Math.max(Ha(a.x.length-2),Ha(a.y.length-2))/2,b=new Uint8Array(2*c+1);b[0]=4;b.set(new Uint8Array(T.decode(a.x,!1,
c)),1);b.set(new Uint8Array(T.decode(a.y,!1,c)),c+1);return b.buffer}},{decode:function(a){var c=(a.byteLength-1)/2;return new this({x:T.encode(new Uint8Array(a,1,c)),y:T.encode(new Uint8Array(a,c+1,c))})}})),qc=e({fieldType:l,parameters:h}),rc=e({version:h,fieldID:qc,curve:oc,base:pc,order:h,cofactor:d(h)}),sc=e({publicKeyParamSet:l,digestParamSet:l,encryptionParamSet:d(l)}),tc=function(a,c){a=a||k;return t(a,{encode:function(b){return this.object===c?(new pa(null)).encode(b):a.method("encode").call(this,
b)}},{decode:function(b){if(void 0!==b){if(null===b||5===b.tagNumber&&0===b.tagClass)return new this(c);try{return a.decode.call(this,b)}catch(d){}}}})}(l,"id-GostR3411-94-CryptoProParamSet"),uc=r({namedParameters:l,ecParameters:rc,implicitly:d(pa)},function(a){return"string"===typeof a||a instanceof String?"namedParameters":"ecParameters"}),G=function(a,c){return P(e({algorithm:l,parameters:d(a)}),c)},s=function(){var a=G(k),c=t(k,function(a){if(this instanceof c)c.super.apply(this,arguments);else return b(a)},
{encode:function(c){return(new a(this.object)).encode(c)}},{decode:function(c){return new this(a.decode(c).object)}}),b=function(a){return t(k,{object:{get:function(){if(this.item)return this.item.object},set:function(c){if(c){var b=a[c.id];if(!b)throw Error("Algorithm not supported");this.item=new b(c)}else delete this.item}},encode:function(a){return this.item.encode(a)}},{decode:function(c){"string"===typeof c&&(c=Ja.decode(c,void 0,!1));c instanceof N&&(c=ia.decode(c));var b=a[gb[c.object[0].object]];
if(b){var d=new this;d.item=b.decode(c);return d}throw Error("Algorithm not supported");}})};return c}(),ya=G(uc,{encode:function(a){return{algorithm:a.id,parameters:"string"===typeof a.namedCurve?ba.namedCurve[a.namedCurve]:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.curve.p},curve:{a:a.curve.a,b:a.curve.b},base:{x:a.curve.x,y:a.curve.y},order:a.curve.q,cofactor:1}}},decode:function(a){var c=a.parameters;a=H[a.algorithm];if("string"===typeof c||c instanceof String)a=w(a,ca[c]);else if("object"===
typeof c)a=w(a,{curve:{p:c.fieldID.parameters,a:c.curve.a,b:c.curve.b,x:c.base.x,y:c.base.y,q:c.order}});else throw new DataError("Invalid key paramters");return a}}),K=G(sc,{encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:ba[c][a[c]],digestParamSet:ba.sBox[b],encryptionParamSet:a.encParams&&
a.encParams.sBox?ba.sBox[a.encParams.sBox]:void 0}}},decode:function(a){var c=a.parameters;a=w(H[a.algorithm],ca[c.publicKeyParamSet],ca[c.digestParamSet]);c.encryptionParamSet&&(a.encParams=ca[c.encryptionParamSet]);return a}}),u=G(k,{encode:function(a){return{algorithm:a.id}},decode:function(a){return H[a.algorithm]}}),v=G(pa,{encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return H[a.algorithm]}}),qa=G(tc,{encode:function(a){return{algorithm:a.id,parameters:ba.sBox[a.sBox||
a.hash&&a.hash.sBox||"D-A"]}},decode:function(a){var c=w(H[a.algorithm]);a=ca[a.parameters];c.hash?c.hash=w(c.hash,a):c=w(c,a);return c}}),$=s({ecdsa:ya,noSignature:v,rsaEncryption:v,"id-sc-gostR3410-2001":ya,"id-GostR3410-2001":K,"id-GostR3410-94":K,"id-GostR3410-2001DH":K,"id-GostR3410-94DH":K,"id-tc26-gost3410-12-256":K,"id-tc26-gost3410-12-512":K,"id-tc26-agreement-gost-3410-12-256":K,"id-tc26-agreement-gost-3410-12-512":K,"id-sc-gost28147-gfb":u,"id-Gost28147-89":u}),Q=s({noSignature:v,rsaEncryption:v,
sha1withRSAEncryption:v,sha256withRSAEncryption:v,sha384withRSAEncryption:v,sha512withRSAEncryption:v,ecdsa:u,"ecdsa-with-SHA1":u,"ecdsa-with-SHA256":u,"ecdsa-with-SHA384":u,"ecdsa-with-SHA512":u,"id-GostR3410-94":v,"id-GostR3410-2001":v,"id-GostR3411-94-with-GostR3410-2001":u,"id-GostR3411-94-with-GostR3410-94":u,"id-tc26-gost3410-12-256":v,"id-tc26-gost3410-12-512":v,"id-tc26-signwithdigest-gost3410-12-94":u,"id-tc26-signwithdigest-gost3410-12-256":u,"id-tc26-signwithdigest-gost3410-12-512":u,"id-sc-gostR3410-94":v,
"id-sc-gostR3410-2001":v,"id-sc-gostR3411-94-with-gostR3410-94":v,"id-sc-gostR3411-94-with-gostR3410-2001":v}),la=s({sha1:u,sha256:v,sha384:v,sha512:v,"id-GostR3411-94":qa,"id-tc26-gost3411-94":qa,"id-tc26-gost3411-12-256":v,"id-tc26-gost3411-12-512":v,"id-sc-gostR3411-94":u}),qb=e({iv:g,encryptionParamSet:l}),vc=e({encryptionParamSet:l,ukm:d(g)}),Pa=G(qb,{encode:function(a){return{algorithm:a.id,parameters:{iv:a.iv,encryptionParamSet:ba.sBox[a.sBox||"E-A"]}}},decode:function(a){var c=w(H[a.algorithm],
ca[a.parameters.encryptionParamSet]);c.iv=a.parameters.iv;return c}}),Qa=G(g,{encode:function(a){return{algorithm:a.id,parameters:a.iv}},decode:function(a){var c=w(H[a.algorithm]);c.iv=a.parameters||new Uint8Array([0,0,0,0,0,0,0,0]);return c}}),za=G(vc,{encode:function(a){return{algorithm:a.id,parameters:{encryptionParamSet:ba.sBox[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=w(H[a.algorithm],ca[a.parameters.encryptionParamSet]);a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}}),rb=s({"id-Gost28147-89-None-KeyWrap":za,
"id-Gost28147-89-CryptoPro-KeyWrap":za}),Aa=G(rb,{encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=w(H[a.algorithm]);c.wrapping=a.parameters;return c}}),wc=s({"id-sc-gost28147-gfb":Qa,"id-Gost28147-89":Pa}),Ra=s({"id-Gost28147-89-MAC":qb,"id-HMACGostR3411-94":qa,"id-tc26-hmac-gost-3411-12-256":qa,"id-tc26-hmac-gost-3411-12-512":qa,hmacWithSHA1:u,hmacWithSHA224:u,hmacWithSHA256:u,hmacWithSHA384:u,hmacWithSHA512:u,"id-sc-gost28147-mac":u,"id-sc-hmacWithGostR3411":u}),
xc=e({salt:r({specified:g,otherSource:s},function(a){return X(a)?"specified":"otherSource"}),iterationCount:h,keyLength:d(h),prf:Ra}),yc=G(xc,{encode:function(a){return{algorithm:a.id,parameters:{salt:a.salt,iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=w(H[a.algorithm]);c.salt=a.parameters.salt;c.iterations=a.parameters.iterationCount;c.hmac=a.parameters.prf;c.hash=c.hmac.hash;return c}}),Sa=s({PBKDF2:yc}),sb=e({salt:g,iterationCount:h}),n=G(sb,{paramType:sb,encode:function(a){return{algorithm:a.id,
parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=w(H[a.algorithm]);c.derivation=w(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}}),zc=e({keyDerivationFunc:Sa,encryptionScheme:wc}),Ta=G(zc,{encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,encryptionScheme:a.encryption}}},decode:function(a){var c=w(H[a.algorithm]);c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;
return c}});s({"pbeWithSHAAndAES128-CBC":n,"pbeWithSHAAndAES192-CBC":n,"pbeWithSHAAndAES256-CBC":n,"pbeWithSHA256AndAES128-CBC":n,"pbeWithSHA256AndAES192-CBC":n,"pbeWithSHA256AndAES256-CBC":n,"id-sc-pbeWithGost3411AndGost28147":n,"id-sc-pbeWithGost3411AndGost28147CFB":n,"pbeWithSHAAnd3-KeyTripleDES-CBC":n,"pbeWithSHAAnd2-KeyTripleDES-CBC":n,"pbeWithSHAAnd128BitRC2-CBC":n,"pbeWithSHAAnd40BitRC2-CBC":n,pbeUnknownGost:n,PBES2:Ta});var ra=s({ecdsa:ya,rsaEncryption:v,"id-sc-gost28147-gfb":Qa,"id-Gost28147-89":Pa,
"id-sc-gostR3410-2001":ya,"id-GostR3410-2001":K,"id-GostR3410-94":K,"id-tc26-gost3410-12-256":K,"id-tc26-gost3410-12-512":K,"id-GostR3410-94-CryptoPro-ESDH":Aa,"id-GostR3410-2001-CryptoPro-ESDH":Aa,"id-tc26-agreement-gost-3410-12-256":Aa,"id-tc26-agreement-gost-3410-12-512":Aa,"id-sc-r3410-ESDH-r3411kdf":v,"id-Gost28147-89-None-KeyWrap":za,"id-Gost28147-89-CryptoPro-KeyWrap":za,"id-sc-cmsGostWrap":u,"id-sc-cmsGost28147Wrap":u,"pbeWithSHAAndAES128-CBC":n,"pbeWithSHAAndAES192-CBC":n,"pbeWithSHAAndAES256-CBC":n,
"pbeWithSHA256AndAES128-CBC":n,"pbeWithSHA256AndAES192-CBC":n,"pbeWithSHA256AndAES256-CBC":n,"id-sc-pbeWithGost3411AndGost28147":n,"id-sc-pbeWithGost3411AndGost28147CFB":n,"pbeWithSHAAnd3-KeyTripleDES-CBC":n,"pbeWithSHAAnd2-KeyTripleDES-CBC":n,"pbeWithSHAAnd128BitRC2-CBC":n,"pbeWithSHAAnd40BitRC2-CBC":n,pbeUnknownGost:n,PBES2:Ta}),Ac=e({keyDerivationFunc:Sa,messageAuthScheme:Ra}),Bc=G(Ac,{encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,messageAuthScheme:a.hmac}}},
decode:function(a){var c=w(H[a.algorithm]);c.derivation=a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;return c}});s({PBMAC1:Bc});var Cc=s({"id-sc-gost28147-gfb":Qa,"id-Gost28147-89":Pa,"pbeWithSHAAndAES128-CBC":n,"pbeWithSHAAndAES192-CBC":n,"pbeWithSHAAndAES256-CBC":n,"pbeWithSHA256AndAES128-CBC":n,"pbeWithSHA256AndAES192-CBC":n,"pbeWithSHA256AndAES256-CBC":n,"id-sc-pbeWithGost3411AndGost28147":n,"id-sc-pbeWithGost3411AndGost28147CFB":n,"pbeWithSHAAnd3-KeyTripleDES-CBC":n,"pbeWithSHAAnd2-KeyTripleDES-CBC":n,
"pbeWithSHAAnd128BitRC2-CBC":n,"pbeWithSHAAnd40BitRC2-CBC":n,pbeUnknownGost:n,PBES2:Ta}),tb=P(q(J(h)),{encode:function(a){return jb.encode(wa(a))},decode:function(a){return wa(jb.decode(a))}}),ub=P(q(J(g)),{encode:function(a){var c=new Uint8Array(a.byteLength+1),b=wa(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){O(0===(a.byteLength&1));var c=new Uint8Array(a.byteLength-1),b=c.byteLength/2;c.set(new Uint8Array(a,b+1,b),
0);c.set(new Uint8Array(a,1,b),b);return wa(c)}}),L=q(J(g)),ma=e({algorithm:$,subjectPublicKey:q},"PUBLIC KEY"),Ua=function(a){return P(I({algorithm:$,subjectPublicKey:k},"algorithm","subjectPublicKey")(function(c){return a[c.id]}),{encode:function(a){return{algorithm:a.algorithm,subjectPublicKey:a.buffer}},decode:function(a){return{algorithm:a.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a.subjectPublicKey}}})}({"id-sc-gostR3410-2001":ub,"id-sc-gostR3410-94":tb,
"id-GostR3410-2001":L,"id-GostR3410-94":L,"id-tc26-gost3410-12-256":L,"id-tc26-gost3410-12-512":L}),vb=P(g(J(h)),{encode:function(a){return T.encode(a,!0)},decode:function(a){return T.decode(a,!0)}}),Dc=e({keyValueMask:g,keyValyePublicKey:g}),ga=r({privateKey:g(J(r({keyValueMask:g,keyValueInfo:Dc},function(a){return X(a)?"keyValueMask":"keyValueInfo"}))),keyValueMask:g},function(a){return a.enclosed?"keyValueMask":"privateKey"}),Ec=function(a){return I({version:h,privateKeyAlgorithm:$,privateKeyWrapped:P(g(J(e({keyData:h,
keyMac:h}))),{encode:function(a){var b=a.byteLength-4;return{keyData:T.encode(new Uint8Array(a,0,b)),keyMac:T.encode(new Uint8Array(a,b,4))}},decode:function(a){var b=T.decode(a.keyData);a=T.decode(a.keyMac);var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b));d.set(new Uint8Array(a),b.byteLength);return d}}),attributes:k},"privateKeyAlgorithm","attributes")(function(c){return d(b(0,f(F({"id-sc-gostR3410-2001-publicKey":A(a[c.id])}))))})}({"id-sc-gostR3410-2001":ub,"id-sc-gostR3410-94":tb,
"id-GostR3410-2001":L,"id-GostR3410-94":L,"id-GostR3410-2001DH":L,"id-GostR3410-94DH":L,"id-tc26-gost3410-12-256":L,"id-tc26-gost3410-12-512":L,"id-tc26-agreement-gost-3410-12-256":L,"id-tc26-agreement-gost-3410-12-512":L}),Va=e({version:h,privateKeyAlgorithm:$,privateKey:g,attributes:d(b(0,f(F)))},"PRIVATE KEY"),Fc=e({version:h,privateKeyAlgorithm:$,privateKey:g,attributes:d(b(0,f(F))),publicKey:d(b(1,f(q)))}),Gc=m(Fc),Hc=function(a){return P(I({version:h,privateKeyAlgorithm:$,privateKey:k,attributes:d(b(0,
f(F)))},"privateKeyAlgorithm","privateKey")(function(c){return a[c.id]}),{encode:function(a){return{version:0,privateKeyAlgorithm:a.algorithm,privateKey:a.buffer}},decode:function(a){return{algorithm:a.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:X(a.privateKey)?a.privateKey:a.privateKey.keyValueMask}}})}({"id-sc-gostR3410-2001":vb,"id-sc-gostR3410-94":vb,"id-GostR3410-2001":ga,"id-GostR3410-94":ga,"id-GostR3410-2001DH":ga,"id-GostR3410-94DH":ga,
"id-tc26-gost3410-12-256":ga,"id-tc26-gost3410-12-512":ga,"id-tc26-agreement-gost-3410-12-256":ga,"id-tc26-agreement-gost-3410-12-512":ga}),wb=e({encryptionAlgorithm:ra,encryptedData:g},"ENCRYPTED PRIVATE KEY"),Ic=e({cA:V(da,!1),pathLenConstraint:d(h)}),Jc=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Kc=m(l),Lc=e({type:l,value:b(0,p(k))}),Mc=e({nameAssigner:d(b(0,f(ja))),partyName:d(b(1,f(ja)))}),
Nc=e({}),B=r({otherName:b(0,f(Lc)),rfc822Name:b(1,f(ja)),dNSName:b(2,f(ja)),x400Address:b(3,f(Nc)),directoryName:b(4,p(W)),ediPartyName:b(5,f(Mc)),uniformResourceIdentifier:b(6,f(ja)),iPAddress:b(7,f(g)),registeredID:b(8,f(l))},function(a){return"string"===typeof a||a instanceof String?0<=a.indexOf("@")?"rfc822Name":"dNSName":X(a)?"iPAddress":"directoryName"}),C=m(B),Wa=e({keyIdentifier:d(b(0,f(g))),authorityCertIssuer:d(b(1,f(C))),authorityCertSerialNumber:d(b(2,f(h)))}),Oc=e({notBefore:d(b(0,f(y))),
notAfter:d(b(1,f(y)))}),Pc=e({policyQualifierId:l,qualifier:k}),Qc=e({policyIdentifier:l,policyQualifiers:d(m(Pc))}),Rc=e({issuerDomainPolicy:l,subjectDomainPolicy:l}),Sc=e({base:B,minimum:V(b(0,f(h)),0),maximum:d(b(1,f(h)))}),xb=m(Sc),Tc=e({permittedSubtrees:d(b(0,f(xb))),excludedSubtrees:d(b(1,f(xb)))}),Uc=e({requireExplicitPolicy:d(b(0,f(h))),inhibitPolicyMapping:d(b(1,f(h)))}),Xa=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,
privilegeWithdrawn:7,aACompromise:8}),yb=r({fullName:b(0,f(C)),nameRelativeToCRLIssuer:b(1,f(nb))},function(a){return a instanceof Array?"fullName":"nameRelativeToCRLIssuer"}),Vc=e({distributionPoint:d(b(0,p(yb))),reasons:d(b(1,f(Xa))),cRLIssuer:d(b(2,f(C)))}),Ba=m(Vc),Ya=e({accessMethod:l,accessLocation:B}),zb=function(a,b){var d=I({extnID:l,critical:V(da,!1),extnValue:function(a){return g(J(a))}},"extnID","extnValue"),e=t(d(a),{object:{get:function(){var a=this._get(e.super,"object");a&&"object"===
typeof a.extnValue&&this.defineValue(a.extnValue);return a},set:function(a){this._set(e.super,"object",a);a&&a.extnValue&&(void 0!==a.extnValue.critical?this.critical=a.extnValue.critical:void 0===this.critical&&b&&(this.critical=b(this.extnID,a.extnValue)))}},extnValue:{get:function(){var a=this._get(e.super,"extnValue");"object"===typeof a&&this.defineValue(a);return a},set:function(a){this._set(e.super,"extnValue",a);a&&(void 0!==a.critical?this.critical=a.critical:void 0===this.critical&&b&&(this.critical=
b(this.extnID,a)))}},defineValue:function(a){if("object"===typeof a&&!Object.getOwnPropertyDescriptor(a,"critical")){var b=this;ha(a,"critical",{get:function(){return b.critical},set:function(a){b.critical=a},enumerable:!0,configurable:!1})}}});return e},na=m(zb,{typeName:"extnID",valueName:"extnValue"}),Ca=na({authorityKeyIdentifier:Wa,subjectKeyIdentifier:g,keyUsage:Jc,privateKeyUsagePeriod:Oc,certificatePolicies:m(Qc),policyMappings:m(Rc),subjectAltName:C,issuerAltName:C,subjectDirectoryAttributes:Oa,
basicConstraints:Ic,nameConstraints:Tc,policyConstraints:Uc,extKeyUsage:Kc,cRLDistributionPoints:Ba,inhibitAnyPolicy:h,freshestCRL:Ba,authorityInfoAccess:m(Ya),subjectInfoAccess:m(Ya)},function(a,b){return"keyUsage"===a||"basicConstraints"===a&&void 0===b.pathLenConstraint}),Wc=e({r:h,s:h}),Ab=E(e({version:b(0,p(h)),serialNumber:h,signature:Q,issuer:W,validity:ob,subject:W,subjectPublicKeyInfo:ma,issuerUniqueID:d(b(1,f(q))),subjectUniqueID:d(b(2,f(q))),extensions:d(b(3,p(Ca)))})),ka=e({tbsCertificate:Ab,
signatureAlgorithm:Q,signatureValue:q},"CERTIFICATE"),Xc=F({challengePassword:A(ja),extensionRequest:A(Ca),msCertExtensions:A(Ca),extendedCertificateAttributes:A(F)}),Bb=E(e({version:h,subject:W,subjectPublicKeyInfo:ma,attributes:b(0,f(Xc))})),Cb=e({requestInfo:Bb,signatureAlgorithm:Q,signatureValue:q},"CERTIFICATE REQUEST"),Db=lb({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),
Yc=e({distributionPoint:d(b(0,p(yb))),onlyContainsUserCerts:V(b(1,f(da)),!1),onlyContainsCACerts:V(b(2,f(da)),!1),onlySomeReasons:d(b(3,f(Xa))),indirectCRL:V(b(4,f(da)),!1),onlyContainsAttributeCerts:V(b(5,f(da)),!1)}),Zc=na({authorityKeyIdentifier:Wa,issuerAltName:C,cRLNumber:h,deltaCRLIndicator:h,issuingDistributionPoint:Yc,freshestCRL:Ba},function(a){return"cRLNumber"===a}),$c=na({cRLReason:Db,instructionCode:l,invalidityDate:y,certificateIssuer:C}),Eb=E(e({version:d(h),signature:Q,issuer:W,thisUpdate:fa,
nextUpdate:d(fa),revokedCertificates:d(m(e({userCertificate:h,revocationDate:fa,crlEntryExtensions:d($c)}))),crlExtensions:d(b(0,p(Zc)))})),Za=e({tbsCertList:Eb,signatureAlgorithm:Q,signatureValue:q},"CRL"),$a=e({digestedObjectType:lb({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:d(l),digestAlgorithm:la,objectDigest:q}),Da=e({issuer:C,serial:h,issuerUID:d(q)}),ad=e({issuerName:d(C),baseCertificateID:d(b(0,f(Da))),objectDigestInfo:d(b(1,f($a)))}),bd=e({targetCertificate:Da,targetName:d(B),
certDigestInfo:d($a)}),cd=r({targetName:b(0,p(B)),targetGroup:b(1,p(B)),targetCert:b(2,f(bd))}),dd=m(cd),ed=na({auditIdentity:g,targetInformation:dd,authorityKeyIdentifier:Wa,authorityInfoAccess:m(Ya),cRLDistributionPoints:Ba,noRevAvail:pa},function(a){return"auditIdentity"===a||"targetInformation"===a}),fd=e({baseCertificateID:d(b(0,f(Da))),entityName:d(b(1,f(C))),objectDigestInfo:d(b(2,f($a)))}),gd=r({v1Form:C,v2Form:b(0,f(ad))},"v2Form"),Fb=e({notBeforeTime:y,notAfterTime:y}),Gb=e({service:B,ident:B,
authInfo:d(g)}),hd=e({roleAuthority:d(b(0,f(C))),roleName:b(1,p(B))}),id=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),jd=e({type:b(0,f(l)),value:b(1,f(k))}),kd=e({policyId:b(0,f(l)),classList:V(b(1,f(id)),["unclassified"]),securityCategories:d(b(2,f(z(jd))))}),Hb=e({policyAuthority:d(b(0,f(C))),values:m(r({octets:g,oid:l,string:U},function(a){return X?"octets":getIdentifier(a)?"oid":"string"}))}),Ib=E(e({version:h,holder:fd,issuer:gd,signature:Q,serialNumber:h,attrCertValidityPeriod:Fb,
attributes:Oa({authenticationInfo:z(Gb),accessIdentity:z(Gb),chargingIdentity:A(Hb),group:A(Hb),role:z(hd),clearance:z(kd)}),issuerUniqueID:d(q),extensions:d(ed)})),Jb=e({acinfo:Ib,signatureAlgorithm:Q,signatureValue:q},"ATTRIBUTE CERTIFICATE"),oa=g,sa=g;e({keyInfo:rb,entityUInfo:d(b(0,p(g))),suppPubInfo:b(2,p(g))});var M=P(e({encryptedKey:g,maskKey:d(b(0,f(g))),macKey:g}),{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,
macKey:a}},decode:function(a){var b=a.encryptedKey,d=a.maskKey;a=a.macKey;if(d)for(var d=new Int32Array(d),e=new Int32Array(b),f=0,g=d.length/e.length;f<g;f++)for(var h=0,k=e.length;h<k;h++)e[h]=e[h]+d[k*f+h]&4294967295;d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),32);return d.buffer}}),ld=e({encryptionParamSet:l,ephemeralPublicKey:d(b(0,f(Ua))),ukm:g}),Ea=P(e({sessionEncryptedKey:M,transportParameters:d(b(0,f(ld)))}),{encode:function(a){var b=a.algorithm;
return{sessionEncryptedKey:a.sessionEncryptedKey,transportParameters:{encryptionParamSet:ba.sBox[b.wrapping.sBox||"E-A"],ephemeralPublicKey:b["public"],ukm:b.ukm}}},decode:function(a){return{algorithm:{wrapping:ca[a.transportParameters.encryptionParamSet],ukm:a.transportParameters.ukm,"public":a.transportParameters.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),Kb=P(e({sessionEncryptedKey:M,ukm:e({ephemeralPublicKey:Ua,addedukm:d(b(0,p(g)))})}),{encode:function(a){var b=a.algorithm;
return{sessionEncryptedKey:a.sessionEncryptedKey,ukm:{ephemeralPublicKey:b["public"],addedukm:b.ukm}}},decode:function(a){return{algorithm:{ukm:a.ukm.addedukm,"public":a.ukm.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),md=function(a){return function(b){return(b=a[b.id])?J(b):k}}({"id-sc-gostR3410-2001":Kb,"id-sc-gostR3410-94":Kb,"id-GostR3410-2001":Ea,"id-GostR3410-94":Ea,"id-tc26-gost3410-12-256":Ea,"id-tc26-gost3410-12-512":Ea,"id-GostR3410-94-CryptoPro-ESDH":M,"id-GostR3410-2001-CryptoPro-ESDH":M,
"id-tc26-agreement-gost-3410-12-256":M,"id-tc26-agreement-gost-3410-12-512":M,"id-sc-r3410-ESDH-r3411kdf":M,"id-Gost28147-89-None-KeyWrap":M,"id-Gost28147-89-CryptoPro-KeyWrap":M,"id-sc-cmsGostWrap":M,"id-sc-cmsGost28147Wrap":M}),nd=q({kccaSoftPassword:0,kccaReservePrimary:1,kccaPrimaryKeyAbsent:2,kccaFKCShared:3}),od=q({pkaExportable:0,pkaUserProtect:1,pkaExchange:2,pkaEphemeral:3,pkaNonCachable:4,pkaDhAllowed:5}),Lb=e({attributes:d(od),privateKeyAlgorithm:d(b(0,f($)))}),Mb=e({path:ea,hmac:g}),pd=
e({containerAlgoritmIdentifier:d(b(0,f(s))),containerName:d(ea),attributes:nd,primaryPrivateKeyParameters:Lb,hmacPassword:d(b(2,f(g))),secondaryEncryptedPrivateKey:d(b(3,f(M))),secondaryPrivateKeyParameters:d(b(4,f(Lb))),primaryCertificate:d(b(5,f(g(J(ka))))),secondaryCertificate:d(b(6,f(g(J(ka))))),encryptionContainerName:d(b(7,f(ea))),primaryCertificateLink:d(b(8,f(Mb))),secondaryCertificateLink:d(b(9,f(Mb))),primaryFP:d(b(10,f(g))),secondaryFP:d(b(11,f(g))),passwordPolicy:d(s),containerSecurityLevel:d(h),
extensions:d(b(12,f(na({keyValidity:e({notBefore:d(b(0,f(y))),notAfter:d(b(1,f(y)))})})))),secondaryEncryptionContainerName:d(b(13,f(ea)))}),qd=e({keyContainerContent:pd,hmacKeyContainerContent:g}),rd=e({containerName:ea,extElem1:d(k)}),sd=e({primaryKey:g,secondaryKey:d(g),hmacKey:d(g)}),td=e({mask:g,randomStatus:g,hmacRandom:g}),Nb=e({keyClass:h,keyType:h,algorithm:d(b(0,p($))),serialNumber:d(b(1,p(g))),addSerialNumber:d(b(2,p(g))),certSerialNumber:d(b(3,p(g))),subjectUID:d(b(4,p(g))),recipientUID:d(b(5,
p(g))),validity:d(b(6,p(r({validity:ob,keyValidity:e({notBefore:d(b(0,f(y))),notAfter:d(b(1,f(y)))})},function(){return"keyValidity"})))),keyUID:d(b(7,p(q))),flags:d(b(10,p(h)))}),ud=e({version:h,keyInfo:Nb,defenceKeyInfo:Nb,certificate:d(b(0,p(ka))),publicKey:d(b(1,p(g)))}),ta=l,sa=g,ab=m(h),vd=e({bodyPartPath:ab,identifier:l,content:k}),Fa=F({contentType:A(ta),signingTime:A(fa),messageDigest:A(g)}),Ob=F(function(a){return{countersignature:z(wd),unsignedData:z(vd)}[a]}),ua=e({issuer:W,serialNumber:h}),
xd=r({issuerAndSerialNumber:ua,subjectKeyIdentifier:b(0,f(sa))},function(a){return X(a)?"subjectKeyIdentifier":"issuerAndSerialNumber"}),Pb=e({version:h,sid:xd,digestAlgorithm:la,signedAttrs:d(b(0,f(Fa))),signatureAlgorithm:Q,signatureValue:g,unsignedAttrs:d(b(1,f(Ob)))}),wd=Pb,yd=z(Pb),zd=z(la),Ad=E(e({version:h,certificate:ka,attributes:F})),Bd=e({extendedCertificateInfo:Ad,signatureAlgorithm:Q,signatureValue:q}),Cd=e({otherCertFormat:l,otherCert:k}),Dd=E(e({version:h,subject:r({baseCertificateID:b(0,
f(Da)),subjectName:b(1,f(C))},function(a){return a.issuer?"baseCertificateID":"subjectName"}),issuer:C,signature:Q,serialNumber:h,attCertValidityPeriod:Fb,attributes:Oa,issuerUniqueID:d(q),extensions:d(Ca)})),Ed=e({acInfo:Dd,signatureAlgorithm:Q,signatureValue:q}),bb=e({eContentType:ta,eContent:d(b(0,p(g)))}),Fd=r({certificate:ka,extendedCertificate:b(0,f(Bd)),v1AttrCert:b(1,f(Ed)),v2AttrCert:b(2,f(Jb)),other:b(3,f(Cd))},function(a){return a.holder?"AttributeCertificateV2":a.certificate?"ExtendedCertificate":
a.otherCertFormat?"other":"certificate"}),Gd=e({otherRevInfoFormat:l,otherRevInfo:k}),Hd=r({crl:Za,other:b(1,f(Gd))},function(a){return a.otherRevInfoFormat?"other":"crl"}),Qb=z(Fd),Rb=z(Hd),Id=e({version:h,digestAlgorithms:zd,encapContentInfo:bb,certificates:d(b(0,f(Qb))),crls:d(b(1,f(Rb))),signerInfos:yd}),Jd=r({issuerAndSerialNumber:ua,subjectKeyIdentifier:b(0,f(sa))},function(a){return X(a)?"subjectKeyIdentifier":"issuerAndSerialNumber"}),Kd=e({version:h,rid:Jd,keyEncryptionAlgorithm:ra,encryptedKey:oa}),
Sb=e({keyAttrId:l,keyAttr:d(k)}),Ld=e({subjectKeyIdentifier:sa,date:d(y),other:d(Sb)}),Md=r({issuerAndSerialNumber:ua,rKeyId:b(0,f(Ld))},function(a){return X(a)?"rKeyId":"issuerAndSerialNumber"}),Nd=e({rid:Md,encryptedKey:oa}),Od=m(Nd),Tb=e({algorithm:$,publicKey:q});e({ephemeralPublicKey:Tb,addedukm:d(b(0,p(g)))});var Pd=r({issuerAndSerialNumber:ua,subjectKeyIdentifier:b(0,f(sa)),originatorKey:b(1,f(Tb))},function(a){return X(a)?"subjectKeyIdentifier":a.algorithm?"originatorKey":"issuerAndSerialNumber"}),
Qd=e({version:h,originator:b(0,p(Pd)),ukm:d(b(1,p(g))),keyEncryptionAlgorithm:ra,recipientEncryptedKeys:Od}),Rd=e({keyIdentifier:g,date:d(y),other:d(Sb)}),Sd=e({version:h,kekid:Rd,keyEncryptionAlgorithm:ra,encryptedKey:oa}),Td=e({version:h,friendlyName:d(b(0,f(Sa))),keyEncryptionAlgorithm:ra,encryptedKey:oa}),Ud=e({oriType:l,oriValue:k}),Vd=r({ktri:Kd,kari:b(1,f(Qd)),kekri:b(2,f(Sd)),pwri:b(3,f(Td)),ori:b(4,f(Ud))},function(a){return a.rid?"ktri":a.originator?"kari":a.kekid?"kekri":a.oriType?"ori":
"pwri"}),cb=e({certs:d(b(0,f(Qb))),crls:d(b(1,f(Rb)))}),db=z(Vd),eb=e({contentType:ta,contentEncryptionAlgorithm:Cc,encryptedContent:d(b(0,f(g)))}),Ga=e({version:h,originatorInfo:d(b(0,f(cb))),recipientInfos:db,encryptedContentInfo:eb,unprotectedAttrs:d(b(1,f(F)))}),Wd=e({version:h,digestAlgorithm:la,encapContentInfo:bb,digest:g}),Ub=e({version:h,encryptedContentInfo:eb,unprotectedAttrs:d(b(1,f(F)))}),Xd=e({version:h,originatorInfo:d(b(0,f(cb))),recipientInfos:db,macAlgorithm:Ra,digestAlgorithm:d(b(1,
la)),encapContentInfo:bb,authAttrs:d(b(2,f(Fa))),mac:g,unauthAttrs:d(b(3,f(F)))}),Yd=e({version:h,originatorInfo:d(b(0,f(cb))),recipientInfos:db,authEncryptedContentInfo:eb,authAttrs:d(b(1,f(Fa))),mac:g,unauthAttrs:d(b(2,f(F)))}),Zd=r({encrypted:Ub,enveloped:b(0,f(Ga)),authEnveloped:b(1,f(Yd))},function(a){return a.encryptedContentInfo?a.recipientInfos?"enveloped":"encrypted":"authEnveloped"}),ta=l,va=I({contentType:ta,content:function(a){return b(0,p(a))}},"contentType","content",void 0,"CMS")({data:g,
signedData:E(Id),envelopedData:E(Ga),digestedData:E(Wd),encryptedData:E(Ub),authData:E(Xd),encryptedKeyPkg:E(Zd),aKeyPackage:E(Gc)}),$d=e({digestAlgorithm:la,digest:g}),ae=F({friendlyName:A(La),keyProviderNameAttr:A(La),localKeyId:A(g),certKeyIdentifierPropId:A(g)}),be=I({certId:l,certValue:function(a){return b(0,p(a))}},"certId","certValue")({x509Certificate:g(J(ka)),sdsiCertificate:ea},g),ce=I({crlId:l,crlValue:function(a){return b(0,p(a))}},"crlId","crlValue")({x509CRL:g(J(Za))},g),de=I({secretTypeId:l,
secretValue:function(a){return b(0,p(a))}},"secretTypeId","secretValue")({secret:g},g),ee=I({bagId:l,bagValue:function(a){return b(0,p(a))},bagAttributes:d(ae)},"bagId","bagValue")(function(a){return{keyBag:Va,pkcs8ShroudedKeyBag:wb,certBag:be,crlBag:ce,secretBag:de,safeContentsBag:Vb}[a]}),Vb=m(ee),fe=m(va),ge=e({mac:$d,macSalt:g,iterations:V(h,1)}),he=e({version:h,authSafe:va,macData:d(ge)},"PFX"),ie=e({issuer:B,serialNumber:h}),je=e({intendedAlg:d(b(0,f(s))),symmAlg:d(b(1,f(s))),encSymmKey:d(b(2,
f(q))),keyAlg:d(b(3,f(s))),valueHint:d(b(4,f(g))),encValue:q}),oa=r({encryptedValue:je,envelopedData:b(0,f(Ga))},function(a){return a.encryptedContentInfo?"envelopedData":"encryptedValue"}),ke=r({encryptedPrivKey:b(0,oa),keyGenParameters:b(1,f(g)),archiveRemGenPrivKey:b(2,f(da))}),le=e({pubMethod:h({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:d(B)}),Wb=e({action:h({dontPublish:0,pleasePublish:1}),pubInfos:d(m(le))}),me=h({encrCert:0,challengeResp:1}),Yb=r({thisMessage:b(0,f(q)),subsequentMessage:b(1,
f(me)),dhMAC:b(2,f(q)),agreeMAC:b(3,f(Xb)),encryptedKey:b(4,f(Ga))});e({salt:g,owf:s,iterationCount:h,mac:s});var Xb=e({algId:s,value:q}),ne=e({authInfo:r({sender:b(0,p(B)),publicKeyMAC:Xb}),publicKey:ma}),oe=e({poposkInput:d(b(0,ne)),algorithmIdentifier:s,signature:q}),pe=r({raVerified:b(0,f(pa)),signature:b(1,f(oe)),keyEncipherment:b(2,f(Yb)),keyAgreement:b(3,f(Yb))}),qe=m(Ma({regToken:U,authenticator:U,pkiPublicationInfo:Wb,pkiArchiveOptions:ke,oldCertID:ie,protocolEncrKey:ma})),re=e({notBefore:d(b(0,
f(fa))),notAfter:d(b(1,f(fa)))}),Zb=e({version:d(b(0,f(h))),serialNumber:d(b(1,f(h))),signingAlg:d(b(2,f(s))),issuer:d(b(3,f(W))),validity:d(b(4,f(re))),subject:d(b(5,f(W))),publicKey:d(b(6,f(ma))),issuerUID:d(b(7,f(q))),subjectUID:d(b(8,f(q))),extensions:d(b(9,f(na)))}),$b=e({certReqId:h,certTemplate:Zb,controls:d(qe)}),se=e({privateKey:Va,identifier:d(r({string:U,generalName:B},function(a){return"string"===typeof a||a instanceof String?"string":"generalName"}))}),ac=e({certReq:$b,popo:d(pe),regInfo:d(m(Ma({utf8Pairs:U,
certReq:$b,encKeyWithID:se})))});m(ac);var bc=e({pendToken:g,pendTime:y}),cc=h({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,partial:7}),dc=h({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),te=e({cMCStatus:cc,bodyList:m(h),statusString:d(U),otherInfo:d(r({failInfo:dc,pendInfo:bc}))}),ue=e({pkiDataReference:h,certReferences:m(h),
extensions:m(zb)}),ve=e({pkiDataBodyid:h,bodyIds:m(h)}),we=e({issuerName:B,serialNumber:h}),xe=e({issuerName:W,cRLName:d(B),time:d(y),reasons:d(Xa)}),ye=e({issuerName:W,serialNumber:h,reason:Db,invalidityDate:d(y),passphrase:d(g),comment:d(U)}),ze=e({bodyPartID:h,thePOPAlgID:s,thePOP:g}),ec=r({bodyPartID:h,bodyPartPath:ab}),Ae=e({cMCStatus:cc,bodyList:m(ec),statusString:d(U),otherInfo:d(r({failInfo:dc,pendInfo:bc,extendedFailInfo:e({failInfoOID:l,failInfoValue:k})}))}),Be=e({seqNumber:h,hashAlgorithm:s,
anchorHashes:m(g)}),fb=m(h),Ce=e({hashAlg:s,certHashes:m(g),pubInfo:Wb}),De=e({pkiDataReference:ab,certReferences:fb,replace:V(da,!0),certTemplate:Zb}),Ee=e({bodyList:m(ec)}),Fe=e({proofAlgID:s,macAlgId:s,witness:g}),Ge=e({keyGenAlgorithm:s,macAlgorithm:s,witness:g}),He=e({bodyPartID:h,certificationRequest:Cb}),fc=e({bodyPartID:h,contentInfo:va}),gc=e({bodyPartID:h,otherMsgType:l,otherMsgValue:k}),hc=r({tcr:b(0,f(He)),crm:b(1,f(ac)),orm:b(2,f(e({bodyPartID:h,requestMessageType:l,requestMessageValue:k})))}),
Ie=e({request:hc,cms:va,thePOPAlgID:s,witnessAlgID:s,witness:g}),ic=I({bodyPartID:h,attrType:l,attrValues:function(a){return z(a)}},"attrType","attrValues",k)({statusInfo:te,identification:U,identityProof:g,dataReturn:g,transactionId:h,senderNonce:g,recipientNonce:g,addExtensions:ue,encryptedPOP:Ie,decryptedPOP:ze,lraPOPWitness:ve,getCert:we,getCRL:xe,revokeRequest:ye,regInfo:g,responseInfo:g,queryPending:g,popLinkRandom:g,popLinkWitness:g,confirmCertAcceptance:ua,statusInfoV2:Ae,trustedAnchors:Be,
authPublish:h,batchRequests:fb,batchResponses:fb,publishCert:Ce,modCertTemplate:De,controlProcessed:Ee,popLinkWitnessV2:Ge,identityProofV2:Fe}),Je=e({controlSequence:m(ic),reqSequence:m(hc),cmsSequence:m(fc),otherMsgSequence:m(gc)},"PKI REQUEST"),Ke=e({controlSequence:m(ic),cmsSequence:m(fc),otherMsgSequence:m(gc)},"PKI RESPONSE");Ka.prototype={GostPrivateKeyInfo:Hc,GostSubjectPublicKeyInfo:Ua,GostKeyContainer:qd,GostKeyContainerName:rd,GostPrivateKeys:sd,GostPrivateMasks:td,ViPNetInfo:ud,GostSignature:Wc,
GostEncryptedKey:md,GostWrappedPrivateKey:Ec,PrivateKeyInfo:Va,EncryptedPrivateKeyInfo:wb,SubjectPublicKeyInfo:ma,TBSCertificate:Ab,Certificate:ka,CertificationRequestInfo:Bb,CertificationRequest:Cb,TBSCertList:Eb,CertificateList:Za,AttributeCertificateInfo:Ib,AttributeCertificate:Jb,SignedAttributes:Fa,UnsignedAttributes:Ob,ContentInfo:va,SafeContents:Vb,AuthenticatedSafe:fe,PFX:he,PKIData:Je,PKIResponse:Ke};x.asn1=new Ka;return Ka});
