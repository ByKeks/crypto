/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(x,w){"function"===typeof define&&define.amd?define(["gostCrypto","gostCoding","gostSecurity"],w):"object"===typeof exports?module.exports=w(require("gostCrypto"),require("gostCoding"),require("gostSecurity")):x.GostASN1=w(x.gostCrypto,x.GostCoding,x.GostSecurity)})(this,function(x){function w(){for(var a={},c=0,H=arguments.length;c<H;c++){var b=arguments[c];if("object"===typeof b)for(var d in b)a[d]=b[d]}return a}function ta(a){a instanceof Q&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),
b=0,d=a.length;b<d;b++)c[d-b-1]=a[b];return c.buffer}function da(a){return a instanceof Q||a.buffer instanceof Q}function fc(a,c){return a.length>=c?a:Array(c-a.length+1).join("0")+a}function Fa(a){return 2>=a?a:4>=a?4:8>=a?8:16>=a?16:32>=a?32:64>=a?64:128>=a?128:256>=a?256:512>a?512:1024>a?1024:void 0}function M(a){if(a)throw Error("Invalid format");}function ea(a,c,b,d){"object"!==typeof b&&(b={value:b});void 0!==d&&(b.enumerable=d);Object.defineProperty(a,c,b)}function Ga(a,c,b){for(var d in c)ea(a,
d,c[d],b)}function R(a,c,b,d,e,f){M(void 0===c);c={tagNumber:b,tagClass:d||0,tagConstructed:e||!1,object:c};a=a||"DER";if("DER"===a||"CER"===a)c=S.encode(c,a);"PEM"===a&&(c=ua.encode(c,f));return c}function X(a,c,b,d,e){M(void 0===a);"string"===typeof a&&(a=ua.decode(a,e,!1));a instanceof Q&&(a=S.decode(a));b=b||0;d=d||!1;void 0===a.tagNumber&&(a=R(!0,a.object,c,b,a.object instanceof Array),16===c||17===c||4===c&&!a.tagConstructed||(a=S.decode(S.encode(a))));M(a.tagClass!==b||a.tagNumber!==c||a.tagConstructed!==
d);return 0===b&&5===c?null:a.object}function q(a,c,b,d){"function"!==typeof c&&(d=b,b=c,c=function(){a.apply(this,arguments)});c.prototype=Object.create(a.prototype,{constructor:{value:c},superclass:{value:a.prototype}});b&&Ga(c.prototype,b);if(a!==Object)for(var e in a)c[e]=a[e];c.super=a;d&&Ga(c,d,!0);return c}function Ha(){}var Q=this.ArrayBuffer,F=x.security.algorithms,db=x.security.names,eb=x.security.identifiers,Y=x.security.attributes,Z=x.security.parameters,S=x.coding.BER,ua=x.coding.PEM,
fb=x.coding.Hex,gb=x.coding.Int16,T={encode:function(a,c){return"0x"+fb.encode(a,c)},decode:function(a,c,b){"number"===typeof a&&(a=a.toString(16));a=a.replace("0x","");b=b||Fa(a.length);return fb.decode(fc(a,b),c)}},b=q(Object,function(a){this.object=a},{_set:function(a,c,b){a.property(c).set.call(this,b)},_get:function(a,c){return a.property(c).get.call(this)},_call:function(a,c,b){return a.method(c).apply(this,b)},hasProperty:function(a){return this.hasOwnProperty(a)||!!this.constructor.property(a)},
encode:function(){return this.object}},{decode:function(a){return new this(a)},property:function(a){for(var c=this.prototype;c;){var b=Object.getOwnPropertyDescriptor(c,a);if(b)return b;c=c.superclass}},method:function(a){for(var c=this.prototype;c;){if(c[a])return c[a];c=c.superclass}}}),C=function(a){return q(b,{encode:function(c){return R(c,this.object,a)}},{decode:function(c){return new this(X(c,a))}})},$=C(1),aa=C(22),va=C(19),gc=C(20),U=C(12),hc=C(23),G=C(24),ic=C(28),Ia=C(30),na=q(C(5),{object:{get:function(){return null},
set:function(a){M(null!==a)}}}),hb=function(a){function c(c){return q(C(a),function(a){b.super.call(this,a)},{encode:function(b){return R(b,c[this.object],a)}},{decode:function(b){b=X(b,a);for(var d in c)if(b===c[d])return new this(d);M(!0)}})}var b=q(C(a),function(a){if(this instanceof b)b.super.apply(this,arguments);else return c(a)});return b},h=hb(2),ib=hb(10),g=function(){function a(a){return a?q(a,{encode:function(c){return R(c,a.method("encode").call(this,!0),4)}},{decode:function(c){return a.decode.call(this,
X(c,4))}}):c}var c=q(C(4),function(b){if(this instanceof c)c.super.apply(this,arguments);else return a(b)});return c}(),n=function(){function a(a){return a?q(a,{encode:function(c){return R(c,a.method("encode").call(this,!0),3)}},{decode:function(c){return a.decode.call(this,X(c,3))}}):d}function c(a){return q(b,function(a,c){b.call(this,a);this.numbits=c||0},{encode:function(c){var b=this.object,d=[];if(b instanceof Array){for(var e=0,f=b.length;e<f;e++){var H=a[b[e]];void 0!==H&&(d[H]="1")}e=0;for(f=
Math.max(d.length,this.numbits);e<f;e++)d[e]||(d[e]="0");d=d.join("")}else d="0";return R(c,d,3)}},{decode:function(c){c=X(c,3);var b=[],d;for(d in a)"1"===c.charAt(a[d])&&b.push(d);return new this(b,c.length)}})}var d=q(C(3),function(b){if(this instanceof d)d.super.apply(this,arguments);else return"object"===typeof b?c(b):a(b)});return d}(),v=function(a){a.combine=function(c,b){for(var d in a.prototype)a.prototype.hasOwnProperty(d)&&!c.hasProperty(d)&&ea(c,d,function(a){return{get:function(){return this[b]&&
this[b][a]},set:function(c){this[b]||(this[b]={});this[b][a]=c},configurable:!1,enumerable:!0}}(d))};return a},f=function(a,c){var d=q(b,function(a,c){ea(this,"items",{writable:!0,value:{}});"string"===typeof a||a instanceof Q?this.decode(a):void 0!==a&&(this.object=a,c&&this.check())},{object:{get:function(){return this},set:function(c){if(c instanceof d){this.items=c.items;for(var b in a){var e=this.getItemClass(b,this.items);e.combine&&e.combine(this,b)}}else{var f={};for(b in a){var g=c[b],e=
this.getItemClass(b,f);void 0!==g?f[b]=new e(g):e.combine&&(f[b]=new e(c));e.combine&&e.combine(this,b)}this.items=f}}},getItemClass:function(c,b){return a[c]},encode:function(b){var d=[],e=this.items,f;for(f in a)if(e[f]){var H=e[f].encode(!0);void 0!==H&&d.push(H)}return R(b,d,16,0,!0,c)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(b){b=X(b,16,0,!0,c);var d=
0,e=new this,f=e.items={},H;for(H in a){var g=e.getItemClass(H,f),h=g.decode(b[d]);void 0!==h&&(f[H]=h,g.combine&&g.combine(e,H),d++)}return e}}),e;for(e in a)ea(d.prototype,e,function(c){return{get:function(){return this.items[c]&&this.items[c].object},set:function(a){if(void 0!==a){var b=this.getItemClass(c,this.items);this.items[c]=new b(a)}else delete this.items[c]},configurable:!1,enumerable:!a[c].combine}}(e)),a[e].combine&&a[e].combine(d.prototype,e);return d},I=function(a,c,d,e,g){return function(h,
l){c=c||"type";d=d||"value";l=l||e||b;var k=f(a,g),k=q(k,{getItemClass:function(e,f){var g=a[e];if(d===e){var ma,k=f&&f[c];k&&(k=k.object,h&&(ma="function"===typeof h?h(k):h[k]));ma=ma||l||b;g=g===b?ma:g(ma)}return g}});ea(k.prototype,c,{get:function(){return this.items[c]&&this.items[c].object},set:function(){M(!0)},configurable:!1,enumerable:!0});return k}},l=q(b,{encode:function(a){var c=this.object,c=/^(\d+\.)+\d+$/.test(c)?c:eb[c];M(!c);return R(a,c,6)}},{decode:function(a){a=X(a,6);return new this(db[a]||
a)}}),d=function(a,c){return q(c,function(){c.apply(this,arguments)},{encode:function(b){b=c.method("encode").call(this,b);if("string"===typeof b||b instanceof Q)return b;b=4===b.tagNumber||0!==b.tagClass||b.object instanceof Array?{object:b.object}:{object:S.decode(S.encode(b)).content};b.tagNumber=a;b.tagClass=2;b.tagConstructed=b.object instanceof Array;return b}},{decode:function(b){void 0!==b.tagNumber&&(M(2!==b.tagClass||b.tagNumber!==a),b={object:b.object});return c.decode.call(this,b)}})},
jb=function(a){return function(c,d){c=c||b;var e=function(f,g){var h="function"===typeof c&&void 0!==f?c(f,g):c;if(d){var k=q(b,function(a){if(this instanceof k)ea(this,"items",{writable:!0,value:{}}),b.call(this,a||{});else return e.apply(this,arguments)},{object:{get:function(){this.read();return this},set:function(a){if(a instanceof k)a.read(),this.items=a.items;else{var c={},b;for(b in a)c[b]=this.createItem(a[b],b);this.items=c}this.reset()}},createItem:function(a,c){if(d){var b={};b[d.typeName]=
c;b[d.valueName]=a}else b=a;return new h(b)},getItemValue:function(a){a=this.items[a];return d?a.object[d.valueName]:a.object},setItemValue:function(a,c){var b=this.items[a];d?b.object[d.valueName]=c:b.object=c},isItemType:function(a){return d?eb[a]:!isNaN(parseInt(a))},reset:function(){var a=this.items,c;for(c in this)this.hasOwnProperty(c)&&!this.items[c]&&this.isItemType(c)&&delete this[c];for(c in a)this[c]=this.getItemValue(c)},read:function(){var a=this.items,c;for(c in this)this.isItemType(c)&&
(this.items[c]?this.getItemValue(c)!==this[c]&&this.setItemValue(c,this[c]):(a[c]=this.createItem(this[c],c),this[c]=this.getItemValue(c)))},encode:function(c){this.read();var b=this.items,d=[],e;for(e in b){var f=b[e].encode(!0);void 0!==f&&d.push(f)}return R(c,d,a,0,!0)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(c){c=X(c,a,0,!0);for(var b=new this,e=b.items=
{},f=0,g=c.length;f<g;f++){var k=h.decode(c[f]);e[d?k.object[d.typeName]:f]=k}b.reset();return b}});return k}var l=q(b,function(a){if(this instanceof l)Ga(this,{items:{writable:!0,value:[]},values:{writable:!0,value:[]}}),b.call(this,a||[]);else return e.apply(this,arguments)},{object:{get:function(){this.read();return this.values},set:function(a){if(a instanceof l)a.read(),this.items=a.items;else{for(var c=[],b=0,d=a.length;b<d;b++)c[b]=new h(a[b]);this.items=c}this.reset()}},encode:function(c){this.read();
for(var b=this.items,d=[],e=0,f=b.length;e<f;e++){var g=b[e].encode(!0);void 0!==g&&d.push(g)}return R(c,d,a,0,!0)},reset:function(){for(var a=0,c=this.items.length;a<c;a++)this.values.push(this.items[a].object)},read:function(){for(var a=this.items,c=this.values,b=0,d=c.length;b<d;b++)this.items[b]?a[b].object!==c[b]&&(a[b].object=c[b]):(a[b]=new h(c[b]),c[b]=a[b].object)}},{decode:function(c){c=X(c,a,0,!0);var b=new this;b.items=[];for(var d=0,e=c.length;d<e;d++)b.items.push(h.decode(c[d]));b.reset();
return b}});return l};return e()}},k=jb(16),y=jb(17),N=function(a,c){if(c){var d=q(b,{encode:function(b){return(new a(c.encode(this.object))).encode(b)}},{decode:function(b){return new this(c.decode(a.decode(b).object))}}),e;for(e in a)d[e]||(d[e]=a[e]);return d}return a},z=function(a){return N(y(a),{encode:function(a){return[a]},decode:function(a){return a[0]}})},r=function(a,c){return q(b,{object:{get:function(){return this.item&&this.item.object},set:function(d){if(d instanceof b)for(var e in a)if(d instanceof
a[e]){this.item=d;return}e="function"===typeof c?c(d):c;M(!e||!a[e]);this.item=d=new a[e](d)}},encode:function(a){return this.item.encode(a)}},{decode:function(c){for(var b in a)try{var d=a[b].decode(c);if(void 0!==d)return new this(d)}catch(e){}M(!0)}})},O=function(a){a=a||b;return q(a,{encode:function(){return S.encode(a.method("encode").call(this,!0))}},{encode:function(a,b){return(new this(a)).encode(b)},decode:function(c){return a.decode.call(this,S.decode(c))}})},ga=function(a){return a||b},
u=function(a){a=a||b;return q(a,{encode:function(c){c=a.method("encode").call(this,c);return"string"===typeof c||c instanceof Q?c:{object:[c]}}},{decode:function(c){return"string"===typeof c||c instanceof Q?("string"===typeof c&&(c=ua.decode(c,void 0,!1)),c instanceof Q&&(c=S.decode(c)),a.decode.call(this,c)):a.decode.call(this,c.object[0])}})},V=function(a,c){a=a||b;return q(a,{encode:function(b){return this.object===c?void 0:a.method("encode").call(this,b)}},{decode:function(b){if(void 0===b)return new this(c);
try{return a.decode.call(this,b)}catch(d){}}})},e=function(a){a=a||b;return q(a,{},{decode:function(c){if(void 0!==c)try{return a.decode.call(this,c)}catch(b){}}})},fa=r({teletexString:gc,printableString:va,universalString:ic,utf8String:U,bmpString:Ia},function(a){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?"printableString":"utf8String"}),ba=r({utcTime:hc,generalTime:G},function(a){return 2050<=a.getYear()?"generalTime":"utcTime"}),Ja=I({type:l,value:b}),Ka=
{typeName:"type",valueName:"value"},kb=z(Ja({serialName:va,countryName:va,dnQualifier:va,emailAddress:aa,domainComponent:aa},fa)),jc=k(kb,Ka)(),W=r({rdnSequence:jc},"rdnSequence"),kc=v(f({notBefore:ba,notAfter:ba})),lb=I({type:l,value:b}),D=y(lb,Ka),La=k(lb,Ka),lc=f({a:h,b:h,seed:e(n)}),mc=g(q(b,{encode:function(){var a=this.object,c=Math.max(Fa(a.x.length-2),Fa(a.y.length-2))/2,b=new Uint8Array(2*c+1);b[0]=4;b.set(new Uint8Array(T.decode(a.x,!1,c)),1);b.set(new Uint8Array(T.decode(a.y,!1,c)),c+1);
return b.buffer}},{decode:function(a){var c=(a.byteLength-1)/2;return new this({x:T.encode(new Uint8Array(a,1,c)),y:T.encode(new Uint8Array(a,c+1,c))})}})),nc=f({fieldType:l,parameters:h}),oc=f({version:h,fieldID:nc,curve:lc,base:mc,order:h,cofactor:e(h)}),pc=f({publicKeyParamSet:l,digestParamSet:l,encryptionParamSet:e(l)}),qc=function(a,c){a=a||b;return q(a,{encode:function(b){return this.object===c?(new na(null)).encode(b):a.method("encode").call(this,b)}},{decode:function(b){if(void 0!==b){if(null===
b||5===b.tagNumber&&0===b.tagClass)return new this(c);try{return a.decode.call(this,b)}catch(d){}}}})}(l,"id-GostR3411-94-CryptoProParamSet"),rc=r({namedParameters:l,ecParameters:oc,implicitly:e(na)},function(a){return"string"===typeof a||a instanceof String?"namedParameters":"ecParameters"}),E=function(a,c){return N(f({algorithm:l,parameters:e(a)}),c)},p=function(){var a=E(b),c=q(b,function(a){if(this instanceof c)c.super.apply(this,arguments);else return d(a)},{encode:function(c){return(new a(this.object)).encode(c)}},
{decode:function(c){return new this(a.decode(c).object)}}),d=function(a){return q(b,{encode:function(c){var b=this.object,d=a[b.id];if(d)return(new d(b)).encode(c);throw Error("Algorithm not supported");}},{decode:function(c){"string"===typeof c&&(c=ua.decode(c,void 0,!1));c instanceof Q&&(c=S.decode(c));var b=a[db[c.object[0].object]];if(b)return new this(b.decode(c).object);throw Error("Algorithm not supported");}})};return c}(),wa=E(rc,{encode:function(a){return{algorithm:a.id,parameters:"string"===
typeof a.namedCurve?Y.namedCurve[a.namedCurve]:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.curve.p},curve:{a:a.curve.a,b:a.curve.b},base:{x:a.curve.x,y:a.curve.y},order:a.curve.q,cofactor:1}}},decode:function(a){var c=a.parameters;a=F[a.algorithm];if("string"===typeof c||c instanceof String)a=w(a,Z[c]);else if("object"===typeof c)a=w(a,{curve:{p:c.fieldID.parameters,a:c.curve.a,b:c.curve.b,x:c.base.x,y:c.base.y,q:c.order}});else throw new DataError("Invalid key paramters");return a}}),
J=E(pc,{encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:Y[c][a[c]],digestParamSet:Y.sBox[b],encryptionParamSet:a.encParams&&a.encParams.sBox?Y.sBox[a.encParams.sBox]:void 0}}},decode:function(a){var c=a.parameters;a=w(F[a.algorithm],Z[c.publicKeyParamSet],Z[c.digestParamSet]);
c.encryptionParamSet&&(a.encParams=Z[c.encryptionParamSet]);return a}}),s=E(b,{encode:function(a){return{algorithm:a.id}},decode:function(a){return F[a.algorithm]}}),t=E(na,{encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return F[a.algorithm]}}),mb=E(qc,{encode:function(a){return{algorithm:a.id,parameters:Y.sBox[a.sBox||"D-A"]}},decode:function(a){return w(F[a.algorithm],Z[a.parameters])}}),ca=p({ecdsa:wa,noSignature:t,rsaEncryption:t,"id-sc-gostR3410-2001":wa,"id-GostR3410-2001":J,
"id-GostR3410-94":J,"id-GostR3410-2001DH":J,"id-GostR3410-94DH":J,"id-tc26-gost3410-12-256":J,"id-tc26-gost3410-12-512":J,"id-tc26-agreement-gost-3410-12-256":J,"id-tc26-agreement-gost-3410-12-512":J,"id-sc-gost28147-gfb":s,"id-Gost28147-89":s}),P=p({noSignature:t,rsaEncryption:t,sha1withRSAEncryption:t,sha256withRSAEncryption:t,sha384withRSAEncryption:t,sha512withRSAEncryption:t,ecdsa:s,"ecdsa-with-SHA1":s,"ecdsa-with-SHA256":s,"ecdsa-with-SHA384":s,"ecdsa-with-SHA512":s,"id-GostR3410-94":t,"id-GostR3410-2001":t,
"id-GostR3411-94-with-GostR3410-2001":s,"id-GostR3411-94-with-GostR3410-94":s,"id-tc26-gost3410-12-256":t,"id-tc26-gost3410-12-512":t,"id-tc26-signwithdigest-gost3410-12-94":s,"id-tc26-signwithdigest-gost3410-12-256":s,"id-tc26-signwithdigest-gost3410-12-512":s,"id-sc-gostR3410-94":t,"id-sc-gostR3410-2001":t,"id-sc-gostR3411-94-with-gostR3410-94":t,"id-sc-gostR3411-94-with-gostR3410-2001":t}),ha=p({sha1:t,sha256:t,sha384:t,sha512:t,"id-GostR3411-94":mb,"id-tc26-gost3411-94":mb,"id-tc26-gost3411-12-256":t,
"id-tc26-gost3411-12-512":t,"id-sc-gostR3411-94":s}),nb=f({iv:g,encryptionParamSet:l}),sc=f({encryptionParamSet:l,ukm:e(g)}),Ma=E(nb,{encode:function(a){return{algorithm:a.id,parameters:{iv:a.iv,encryptionParamSet:Y.sBox[a.sBox||"E-A"]}}},decode:function(a){var c=w(F[a.algorithm],Z[a.parameters.encryptionParamSet]);c.iv=a.parameters.iv;return c}}),Na=E(g,{encode:function(a){return{algorithm:a.id,parameters:a.iv}},decode:function(a){var c=w(F[a.algorithm]);c.iv=a.parameters||new Uint8Array([0,0,0,
0,0,0,0,0]);return c}}),xa=E(sc,{encode:function(a){return{algorithm:a.id,parameters:{encryptionParamSet:Y.sBox[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=w(F[a.algorithm],Z[a.parameters.encryptionParamSet]);a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}}),ob=p({"id-Gost28147-89-None-KeyWrap":xa,"id-Gost28147-89-CryptoPro-KeyWrap":xa}),ya=E(ob,{encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=w(F[a.algorithm]);c.wrapping=a.parameters;return c}}),
oa=p({ecdsa:wa,rsaEncryption:t,"id-sc-gost28147-gfb":Na,"id-Gost28147-89":Ma,"id-sc-gostR3410-2001":wa,"id-GostR3410-2001":J,"id-GostR3410-94":J,"id-tc26-gost3410-12-256":J,"id-tc26-gost3410-12-512":J,"id-GostR3410-94-CryptoPro-ESDH":ya,"id-GostR3410-2001-CryptoPro-ESDH":ya,"id-tc26-agreement-gost-3410-12-256":ya,"id-tc26-agreement-gost-3410-12-512":ya,"id-sc-r3410-ESDH-r3411kdf":t,"id-Gost28147-89-None-KeyWrap":xa,"id-Gost28147-89-CryptoPro-KeyWrap":xa,"id-sc-cmsGostWrap":s,"id-sc-cmsGost28147Wrap":s,
"pbeWithSHAAndAES128-CBC":m,"pbeWithSHAAndAES192-CBC":m,"pbeWithSHAAndAES256-CBC":m,"pbeWithSHA256AndAES128-CBC":m,"pbeWithSHA256AndAES192-CBC":m,"pbeWithSHA256AndAES256-CBC":m,"id-sc-pbeWithGost3411AndGost28147":m,"id-sc-pbeWithGost3411AndGost28147CFB":m,"pbeWithSHAAnd3-KeyTripleDES-CBC":m,"pbeWithSHAAnd2-KeyTripleDES-CBC":m,"pbeWithSHAAnd128BitRC2-CBC":m,"pbewithSHAAnd40BitRC2-CBC":m,pbeUnknownGost:m,PBES2:Oa}),tc=p({"id-sc-gost28147-gfb":Na,"id-Gost28147-89":Ma}),Pa=p({"id-Gost28147-89-MAC":nb,
"id-HMACGostR3411-94":s,"id-tc26-hmac-gost-3411-12-256":s,"id-tc26-hmac-gost-3411-12-512":s,hmacWithSHA1:s,hmacWithSHA224:s,hmacWithSHA256:s,hmacWithSHA384:s,hmacWithSHA512:s,"id-sc-gost28147-mac":s,"id-sc-hmacWithGostR3411":s}),uc=f({salt:r({specified:g,otherSource:p},function(a){return da(a)?"specified":"otherSource"}),iterationCount:h,keyLength:e(h),prf:Pa}),vc=E(uc,{encode:function(a){return{algorithm:a.id,parameters:{salt:a.salt,iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=
w(F[a.algorithm]);c.salt=a.parameters.salt;c.iterations=a.parameters.iterationCount;c.hmac=a.parameters.prf;c.hash=c.hmac.hash;return c}}),Qa=p({PBKDF2:vc}),pb=f({salt:g,iterationCount:h}),m=E(pb,{paramType:pb,encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=w(F[a.algorithm]);c.derivation=w(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}}),wc=f({keyDerivationFunc:Qa,
encryptionScheme:tc}),Oa=E(wc,{encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,encryptionScheme:a.encryption}}},decode:function(a){var c=w(F[a.algorithm]);c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}});p({"pbeWithSHAAndAES128-CBC":m,"pbeWithSHAAndAES192-CBC":m,"pbeWithSHAAndAES256-CBC":m,"pbeWithSHA256AndAES128-CBC":m,"pbeWithSHA256AndAES192-CBC":m,"pbeWithSHA256AndAES256-CBC":m,"id-sc-pbeWithGost3411AndGost28147":m,
"id-sc-pbeWithGost3411AndGost28147CFB":m,"pbeWithSHAAnd3-KeyTripleDES-CBC":m,"pbeWithSHAAnd2-KeyTripleDES-CBC":m,"pbeWithSHAAnd128BitRC2-CBC":m,"pbewithSHAAnd40BitRC2-CBC":m,pbeUnknownGost:m,PBES2:Oa});var xc=f({keyDerivationFunc:Qa,messageAuthScheme:Pa}),yc=E(xc,{encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,messageAuthScheme:a.hmac}}},decode:function(a){var c=w(F[a.algorithm]);c.derivation=a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;
return c}});p({PBMAC1:yc});var zc=p({"id-sc-gost28147-gfb":Na,"id-Gost28147-89":Ma,"pbeWithSHAAndAES128-CBC":m,"pbeWithSHAAndAES192-CBC":m,"pbeWithSHAAndAES256-CBC":m,"pbeWithSHA256AndAES128-CBC":m,"pbeWithSHA256AndAES192-CBC":m,"pbeWithSHA256AndAES256-CBC":m,"id-sc-pbeWithGost3411AndGost28147":m,"id-sc-pbeWithGost3411AndGost28147CFB":m,"pbeWithSHAAnd3-KeyTripleDES-CBC":m,"pbeWithSHAAnd2-KeyTripleDES-CBC":m,"pbeWithSHAAnd128BitRC2-CBC":m,"pbewithSHAAnd40BitRC2-CBC":m,pbeUnknownGost:m,PBES2:Oa}),qb=
N(n(O(h)),{encode:function(a){return gb.encode(ta(a))},decode:function(a){return ta(gb.decode(a))}}),rb=N(n(O(g)),{encode:function(a){var c=new Uint8Array(a.byteLength+1),b=ta(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){M(0===(a.byteLength&1));var c=new Uint8Array(a.byteLength-1),b=c.byteLength/2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,1,b),b);return ta(c)}}),K=n(O(g)),ia=f({algorithm:ca,subjectPublicKey:n},
"PUBLIC KEY"),Ra=function(a){return q(N(I({algorithm:ca,subjectPublicKey:b},"algorithm","subjectPublicKey")(function(c){return a[c.id]}),{encode:function(a){return{algorithm:a.algorithm,subjectPublicKey:a.buffer}},decode:function(a){return{algorithm:a.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a.subjectPublicKey}}}),{object:{get:function(){return this},set:function(a){for(var b in a)this[b]=a[b]}}})}({"id-sc-gostR3410-2001":rb,"id-sc-gostR3410-94":qb,
"id-GostR3410-2001":K,"id-GostR3410-94":K,"id-tc26-gost3410-12-256":K,"id-tc26-gost3410-12-512":K}),sb=N(g(O(h)),{encode:function(a){return T.encode(a,!0)},decode:function(a){return T.decode(a,!0)}}),Ac=function(a){return I({version:h,privateKeyAlgorithm:ca,privateKeyWrapped:N(g(O(f({keyData:h,keyMac:h}))),{encode:function(a){var b=a.byteLength-4;return{keyData:T.encode(new Uint8Array(a,0,b)),keyMac:T.encode(new Uint8Array(a,b,4))}},decode:function(a){var b=T.decode(a.keyData);a=T.decode(a.keyMac);
var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b));d.set(new Uint8Array(a),b.byteLength);return d}}),attributes:b},"privateKeyAlgorithm","attributes")(function(b){return e(d(0,ga(D({"id-sc-gostR3410-2001-publicKey":z(a[b.id])}))))})}({"id-sc-gostR3410-2001":rb,"id-sc-gostR3410-94":qb,"id-GostR3410-2001":K,"id-GostR3410-94":K,"id-GostR3410-2001DH":K,"id-GostR3410-94DH":K,"id-tc26-gost3410-12-256":K,"id-tc26-gost3410-12-512":K,"id-tc26-agreement-gost-3410-12-256":K,"id-tc26-agreement-gost-3410-12-512":K}),
Sa=f({version:h,privateKeyAlgorithm:ca,privateKey:g,attributes:e(d(0,D||b))},"PRIVATE KEY"),Bc=f({version:h,privateKeyAlgorithm:ca,privateKey:g,attributes:e(d(0,D||b)),publicKey:e(d(1,n||b))}),Cc=k(Bc),Dc=function(a){return q(N(I({version:h,privateKeyAlgorithm:ca,privateKey:b,attributes:e(d(0,D||b))},"privateKeyAlgorithm","privateKey")(function(b){return a[b.id]}),{encode:function(a){return{version:0,privateKeyAlgorithm:a.algorithm,privateKey:a.buffer}},decode:function(a){return{algorithm:a.privateKeyAlgorithm,
type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:a.privateKey}}}),{object:{get:function(){return this},set:function(a){for(var b in a)this[b]=a[b]}}})}({"id-sc-gostR3410-2001":sb,"id-sc-gostR3410-94":sb,"id-GostR3410-2001":g,"id-GostR3410-94":g,"id-GostR3410-2001DH":g,"id-GostR3410-94DH":g,"id-tc26-gost3410-12-256":g,"id-tc26-gost3410-12-512":g,"id-tc26-agreement-gost-3410-12-256":g,"id-tc26-agreement-gost-3410-12-512":g}),tb=f({encryptionAlgorithm:oa,encryptedData:g},
"ENCRYPTED PRIVATE KEY"),Ec=f({cA:V($,!1),pathLenConstraint:e(h)}),Fc=n({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Gc=k(l),Hc=f({type:l,value:d(0,u(b))}),Ic=f({nameAssigner:e(d(0,fa||b)),partyName:e(d(1,fa||b))}),Jc=f({}),A=r({otherName:d(0,Hc||b),rfc822Name:d(1,fa||b),dNSName:d(2,fa||b),x400Address:d(3,Jc||b),directoryName:d(4,u(W)),ediPartyName:d(5,Ic||b),uniformResourceIdentifier:d(6,fa||b),iPAddress:d(7,
g||b),registeredID:d(8,l||b)},function(a){return"string"===typeof a||a instanceof String?0<=a.indexOf("@")?"rfc822Name":"dNSName":da(a)?"iPAddress":"directoryName"}),B=k(A),Ta=f({keyIdentifier:e(d(0,g||b)),authorityCertIssuer:e(d(1,B||b)),authorityCertSerialNumber:e(d(2,h||b))}),Kc=f({notBefore:e(d(0,G||b)),notAfter:e(d(1,G||b))}),Lc=f({policyQualifierId:l,qualifier:b}),Mc=f({policyIdentifier:l,policyQualifiers:e(k(Lc))}),Nc=f({issuerDomainPolicy:l,subjectDomainPolicy:l}),Oc=f({base:A,minimum:V(d(0,
h||b),0),maximum:e(d(1,h||b))}),ub=k(Oc),Pc=f({permittedSubtrees:e(d(0,ub||b)),excludedSubtrees:e(d(1,ub||b))}),Qc=f({requireExplicitPolicy:e(d(0,h||b)),inhibitPolicyMapping:e(d(1,h||b))}),Ua=n({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),vb=r({fullName:d(0,B||b),nameRelativeToCRLIssuer:d(1,kb||b)},function(a){return a instanceof Array?"fullName":"nameRelativeToCRLIssuer"}),Rc=f({distributionPoint:e(d(0,
u(vb))),reasons:e(d(1,Ua||b)),cRLIssuer:e(d(2,B||b))}),za=k(Rc),Va=f({accessMethod:l,accessLocation:A}),wb=function(a,b){var d=I({extnID:l,critical:V($,!1),extnValue:function(a){return g(O(a))}},"extnID","extnValue"),e=q(d(a),{object:{get:function(){var a=this._get(e.super,"object");a&&"object"===typeof a.extnValue&&this.defineValue(a.extnValue);return a},set:function(a){this._set(e.super,"object",a);a&&a.extnValue&&(void 0!==a.extnValue.critical?this.critical=a.extnValue.critical:void 0===this.critical&&
b&&(this.critical=b(this.extnID,a.extnValue)))}},extnValue:{get:function(){var a=this._get(e.super,"extnValue");"object"===typeof a&&this.defineValue(a);return a},set:function(a){this._set(e.super,"extnValue",a);a&&(void 0!==a.critical?this.critical=a.critical:void 0===this.critical&&b&&(this.critical=b(this.extnID,a)))}},defineValue:function(a){if("object"===typeof a&&!Object.getOwnPropertyDescriptor(a,"critical")){var b=this;ea(a,"critical",{get:function(){return b.critical},set:function(a){b.critical=
a},enumerable:!0,configurable:!1})}}});return e},ja=k(wb,{typeName:"extnID",valueName:"extnValue"}),Aa=ja({authorityKeyIdentifier:Ta,subjectKeyIdentifier:g,keyUsage:Fc,privateKeyUsagePeriod:Kc,certificatePolicies:k(Mc),policyMappings:k(Nc),subjectAltName:B,issuerAltName:B,subjectDirectoryAttributes:La,basicConstraints:Ec,nameConstraints:Pc,policyConstraints:Qc,extKeyUsage:Gc,cRLDistributionPoints:za,inhibitAnyPolicy:h,freshestCRL:za,authorityInfoAccess:k(Va),subjectInfoAccess:k(Va)},function(a,b){return"keyUsage"===
a||"basicConstraints"===a&&void 0===b.pathLenConstraint}),Sc=f({r:h,s:h}),xb=v(f({version:d(0,u(h)),serialNumber:h,signature:P,issuer:W,validity:kc,subject:W,subjectPublicKeyInfo:ia,issuerUniqueID:e(d(1,n||b)),subjectUniqueID:e(d(2,n||b)),extensions:e(d(3,u(Aa)))})),ka=f({tbsCertificate:xb,signatureAlgorithm:P,signatureValue:n},"CERTIFICATE"),Tc=D({challengePassword:z(fa),extensionRequest:z(Aa),msCertExtensions:z(Aa),extendedCertificateAttributes:z(D)}),yb=v(f({version:h,subject:W,subjectPublicKeyInfo:ia,
attributes:d(0,Tc||b)})),zb=f({requestInfo:yb,signatureAlgorithm:P,signatureValue:n},"CERTIFICATE REQUEST"),Ab=ib({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),Uc=f({distributionPoint:e(d(0,u(vb))),onlyContainsUserCerts:V(d(1,$||b),!1),onlyContainsCACerts:V(d(2,$||b),!1),onlySomeReasons:e(d(3,Ua||b)),indirectCRL:V(d(4,$||b),!1),onlyContainsAttributeCerts:V(d(5,$||b),!1)}),
Vc=ja({authorityKeyIdentifier:Ta,issuerAltName:B,cRLNumber:h,deltaCRLIndicator:h,issuingDistributionPoint:Uc,freshestCRL:za},function(a){return"cRLNumber"===a}),Wc=ja({cRLReason:Ab,instructionCode:l,invalidityDate:G,certificateIssuer:B}),Bb=v(f({version:e(h),signature:P,issuer:W,thisUpdate:ba,nextUpdate:e(ba),revokedCertificates:e(k(f({userCertificate:h,revocationDate:ba,crlEntryExtensions:e(Wc)}))),crlExtensions:e(d(0,u(Vc)))})),Wa=f({tbsCertList:Bb,signatureAlgorithm:P,signatureValue:n},"CRL"),
Xa=f({digestedObjectType:ib({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:e(l),digestAlgorithm:ha,objectDigest:n}),Ba=f({issuer:B,serial:h,issuerUID:e(n)}),Xc=f({issuerName:e(B),baseCertificateID:e(d(0,Ba||b)),objectDigestInfo:e(d(1,Xa||b))}),Yc=f({targetCertificate:Ba,targetName:e(A),certDigestInfo:e(Xa)}),Zc=r({targetName:d(0,u(A)),targetGroup:d(1,u(A)),targetCert:d(2,Yc||b)}),$c=k(Zc),ad=ja({auditIdentity:g,targetInformation:$c,authorityKeyIdentifier:Ta,authorityInfoAccess:k(Va),
cRLDistributionPoints:za,noRevAvail:na},function(a){return"auditIdentity"===a||"targetInformation"===a}),bd=f({baseCertificateID:e(d(0,Ba||b)),entityName:e(d(1,B||b)),objectDigestInfo:e(d(2,Xa||b))}),cd=r({v1Form:B,v2Form:d(0,Xc||b)},"v2Form"),Cb=f({notBeforeTime:G,notAfterTime:G}),Db=f({service:A,ident:A,authInfo:e(g)}),dd=f({roleAuthority:e(d(0,B||b)),roleName:d(1,u(A))}),ed=n({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),fd=f({type:d(0,l||b),value:d(1,b||b)}),gd=
f({policyId:d(0,l||b),classList:V(d(1,ed||b),["unclassified"]),securityCategories:e(d(2,ga(y(fd))))}),Eb=f({policyAuthority:e(d(0,B||b)),values:k(r({octets:g,oid:l,string:U},function(a){return da?"octets":getIdentifier(a)?"oid":"string"}))}),Fb=v(f({version:h,holder:bd,issuer:cd,signature:P,serialNumber:h,attrCertValidityPeriod:Cb,attributes:La({authenticationInfo:y(Db),accessIdentity:y(Db),chargingIdentity:z(Eb),group:z(Eb),role:y(dd),clearance:y(gd)}),issuerUniqueID:e(n),extensions:e(ad)})),Gb=
f({acinfo:Fb,signatureAlgorithm:P,signatureValue:n},"ATTRIBUTE CERTIFICATE"),la=g,pa=g;f({keyInfo:ob,entityUInfo:e(d(0,u(g))),suppPubInfo:d(2,u(g))});var L=N(f({encryptedKey:g,maskKey:e(d(0,g||b)),macKey:g}),{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey,d=a.maskKey;a=a.macKey;if(d)for(var d=new Int32Array(d),e=new Int32Array(b),f=0,g=d.length/e.length;f<
g;f++)for(var h=0,k=e.length;h<k;h++)e[h]=e[h]+d[k*f+h]&4294967295;d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),32);return d.buffer}}),hd=f({encryptionParamSet:l,ephemeralPublicKey:e(d(0,Ra||b)),ukm:g}),Ca=N(f({sessionEncryptedKey:L,transportParameters:e(d(0,hd||b))}),{encode:function(a){var b=a.algorithm;return{sessionEncryptedKey:a.sessionEncryptedKey,transportParameters:{encryptionParamSet:Y.sBox[b.wrapping.sBox||"E-A"],ephemeralPublicKey:b["public"],
ukm:b.ukm}}},decode:function(a){return{algorithm:{wrapping:Z[a.transportParameters.encryptionParamSet],ukm:a.transportParameters.ukm,"public":a.transportParameters.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),Hb=N(f({sessionEncryptedKey:L,ukm:f({ephemeralPublicKey:Ra,addedukm:e(d(0,u(g)))})}),{encode:function(a){var b=a.algorithm;return{sessionEncryptedKey:a.sessionEncryptedKey,ukm:{ephemeralPublicKey:b["public"],addedukm:b.ukm}}},decode:function(a){return{algorithm:{ukm:a.ukm.addedukm,
"public":a.ukm.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),id=function(a){return function(c){return(c=a[c.id])?O(c):b}}({"id-sc-gostR3410-2001":Hb,"id-sc-gostR3410-94":Hb,"id-GostR3410-2001":Ca,"id-GostR3410-94":Ca,"id-tc26-gost3410-12-256":Ca,"id-tc26-gost3410-12-512":Ca,"id-GostR3410-94-CryptoPro-ESDH":L,"id-GostR3410-2001-CryptoPro-ESDH":L,"id-tc26-agreement-gost-3410-12-256":L,"id-tc26-agreement-gost-3410-12-512":L,"id-sc-r3410-ESDH-r3411kdf":L,"id-Gost28147-89-None-KeyWrap":L,
"id-Gost28147-89-CryptoPro-KeyWrap":L,"id-sc-cmsGostWrap":L,"id-sc-cmsGost28147Wrap":L}),jd=n({kccaSoftPassword:0,kccaReservePrimary:1,kccaPrimaryKeyAbsent:2,kccaFKCShared:3}),kd=n({pkaExportable:0,pkaUserProtect:1,pkaExchange:2,pkaEphemeral:3,pkaNonCachable:4,pkaDhAllowed:5}),Ib=f({attributes:e(kd),privateKeyAlgorithm:e(d(0,ca||b))}),Jb=f({path:aa,hmac:g}),ld=f({containerAlgoritmIdentifier:e(d(0,p||b)),containerName:e(aa),attributes:jd,primaryPrivateKeyParameters:Ib,hmacPassword:e(d(2,g||b)),secondaryEncryptedPrivateKey:e(d(3,
L||b)),secondaryPrivateKeyParameters:e(d(4,Ib||b)),primaryCertificate:e(d(5,ga(g(O(ka))))),secondaryCertificate:e(d(6,ga(g(O(ka))))),encryptionContainerName:e(d(7,aa||b)),primaryCertificateLink:e(d(8,Jb||b)),secondaryCertificateLink:e(d(9,Jb||b)),primaryFP:e(d(10,g||b)),secondaryFP:e(d(11,g||b)),passwordPolicy:e(p),containerSecurityLevel:e(h),extensions:e(d(12,ga(ja({keyValidity:f({notBefore:e(d(0,G||b)),notAfter:e(d(1,G||b))})})))),secondaryEncryptionContainerName:e(d(13,aa||b))}),md=f({keyContainerContent:ld,
hmacKeyContainerContent:g}),nd=f({containerName:aa,extElem1:e(b)}),od=f({primaryKey:g,secondaryKey:e(g),hmacKey:e(g)}),pd=f({mask:g,randomStatus:g,hmacRandom:g}),qa=l,pa=g,Ya=k(h),qd=f({bodyPartPath:Ya,identifier:l,content:b}),Da=D({contentType:z(qa),messageDigest:z(g),signingTime:z(ba)}),Kb=D(function(a){return{countersignature:y(rd),unsignedData:y(qd)}[a]}),ra=f({issuer:W,serialNumber:h}),sd=r({issuerAndSerialNumber:ra,subjectKeyIdentifier:d(0,pa||b)},function(a){return da(a)?"subjectKeyIdentifier":
"issuerAndSerialNumber"}),Lb=f({version:h,sid:sd,digestAlgorithm:ha,signedAttrs:e(d(0,Da||b)),signatureAlgorithm:P,signatureValue:g,unsignedAttrs:e(d(1,Kb||b))}),rd=Lb,td=y(Lb),ud=y(ha),vd=v(f({version:h,certificate:ka,attributes:D})),wd=f({extendedCertificateInfo:vd,signatureAlgorithm:P,signatureValue:n}),xd=f({otherCertFormat:l,otherCert:b}),yd=v(f({version:h,subject:r({baseCertificateID:d(0,Ba||b),subjectName:d(1,B||b)},function(a){return a.issuer?"baseCertificateID":"subjectName"}),issuer:B,signature:P,
serialNumber:h,attCertValidityPeriod:Cb,attributes:La,issuerUniqueID:e(n),extensions:e(Aa)})),zd=f({acInfo:yd,signatureAlgorithm:P,signatureValue:n}),Za=f({eContentType:qa,eContent:e(d(0,u(g)))}),Ad=r({certificate:ka,extendedCertificate:d(0,wd||b),v1AttrCert:d(1,zd||b),v2AttrCert:d(2,Gb||b),other:d(3,xd||b)},function(a){return a.holder?"AttributeCertificateV2":a.certificate?"ExtendedCertificate":a.otherCertFormat?"other":"certificate"}),Bd=f({otherRevInfoFormat:l,otherRevInfo:b}),Cd=r({crl:Wa,other:d(1,
Bd||b)},function(a){return a.otherRevInfoFormat?"other":"crl"}),Mb=y(Ad),Nb=y(Cd),Dd=f({version:h,digestAlgorithms:ud,encapContentInfo:Za,certificates:e(d(0,Mb||b)),crls:e(d(1,Nb||b)),signerInfos:td}),Ed=r({issuerAndSerialNumber:ra,subjectKeyIdentifier:d(0,pa||b)},function(a){return da(a)?"subjectKeyIdentifier":"issuerAndSerialNumber"}),Fd=f({version:h,rid:Ed,keyEncryptionAlgorithm:oa,encryptedKey:la}),Ob=f({keyAttrId:l,keyAttr:e(b)}),Gd=f({subjectKeyIdentifier:pa,date:e(G),other:e(Ob)}),Hd=r({issuerAndSerialNumber:ra,
rKeyId:d(0,Gd||b)},function(a){return da(a)?"rKeyId":"issuerAndSerialNumber"}),Id=f({rid:Hd,encryptedKey:la}),Jd=k(Id),Pb=f({algorithm:ca,publicKey:n});f({ephemeralPublicKey:Pb,addedukm:e(d(0,u(g)))});var Kd=r({issuerAndSerialNumber:ra,subjectKeyIdentifier:d(0,pa||b),originatorKey:d(1,Pb||b)},function(a){return da(a)?"subjectKeyIdentifier":a.algorithm?"originatorKey":"issuerAndSerialNumber"}),Ld=f({version:h,originator:d(0,u(Kd)),ukm:e(d(1,u(g))),keyEncryptionAlgorithm:oa,recipientEncryptedKeys:Jd}),
Md=f({keyIdentifier:g,date:e(G),other:e(Ob)}),Nd=f({version:h,kekid:Md,keyEncryptionAlgorithm:oa,encryptedKey:la}),Od=f({version:h,friendlyName:e(d(0,Qa||b)),keyEncryptionAlgorithm:oa,encryptedKey:la}),Pd=f({oriType:l,oriValue:b}),Qd=r({ktri:Fd,kari:d(1,Ld||b),kekri:d(2,Nd||b),pwri:d(3,Od||b),ori:d(4,Pd||b)},function(a){return a.rid?"ktri":a.originator?"kari":a.kekid?"kekri":a.oriType?"ori":"pwri"}),$a=f({certs:e(d(0,Mb||b)),crls:e(d(1,Nb||b))}),ab=y(Qd),bb=f({contentType:qa,contentEncryptionAlgorithm:zc,
encryptedContent:e(d(0,g||b))}),Ea=f({version:h,originatorInfo:e(d(0,$a||b)),recipientInfos:ab,encryptedContentInfo:bb,unprotectedAttrs:e(d(1,D||b))}),Rd=f({version:h,digestAlgorithm:ha,encapContentInfo:Za,digest:g}),Qb=f({version:h,encryptedContentInfo:bb,unprotectedAttrs:e(d(1,D||b))}),Sd=f({version:h,originatorInfo:e(d(0,$a||b)),recipientInfos:ab,macAlgorithm:Pa,digestAlgorithm:e(d(1,ha)),encapContentInfo:Za,authAttrs:e(d(2,Da||b)),mac:g,unauthAttrs:e(d(3,D||b))}),Td=f({version:h,originatorInfo:e(d(0,
$a||b)),recipientInfos:ab,authEncryptedContentInfo:bb,authAttrs:e(d(1,Da||b)),mac:g,unauthAttrs:e(d(2,D||b))}),Ud=r({encrypted:Qb,enveloped:d(0,Ea||b),authEnveloped:d(1,Td||b)},function(a){return a.encryptedContentInfo?a.recipientInfos?"enveloped":"encrypted":"authEnveloped"}),qa=l,sa=I({contentType:qa,content:function(a){return d(0,u(a))}},"contentType","content",void 0,"CMS")({data:g,signedData:v(Dd),envelopedData:v(Ea),digestedData:v(Rd),encryptedData:v(Qb),authData:v(Sd),encryptedKeyPkg:v(Ud),
aKeyPackage:v(Cc)}),Vd=f({digestAlgorithm:ha,digest:g}),Wd=D({friendlyName:z(Ia),keyProviderNameAttr:z(Ia),localKeyId:z(g),certKeyIdentifierPropId:z(g)}),Xd=I({certId:l,certValue:function(a){return d(0,u(a))}},"certId","certValue")({x509Certificate:g(O(ka)),sdsiCertificate:aa},g),Yd=I({crlId:l,crlValue:function(a){return d(0,u(a))}},"crlId","crlValue")({x509CRL:g(O(Wa))},g),Zd=I({secretTypeId:l,secretValue:function(a){return d(0,u(a))}},"secretTypeId","secretValue")({secret:g},g),$d=I({bagId:l,bagValue:function(a){return d(0,
u(a))},bagAttributes:e(Wd)},"bagId","bagValue")(function(a){return{keyBag:v(Sa),pkcs8ShroudedKeyBag:v(tb),certBag:v(Xd),crlBag:v(Yd),secretBag:v(Zd),safeContentsBag:Rb}[a]}),Rb=k($d),ae=k(sa),be=f({mac:Vd,macSalt:g,iterations:V(h,1)}),ce=f({version:h,authSafe:sa,macData:e(be)},"PFX"),de=f({issuer:A,serialNumber:h}),ee=f({intendedAlg:e(d(0,p||b)),symmAlg:e(d(1,p||b)),encSymmKey:e(d(2,n||b)),keyAlg:e(d(3,p||b)),valueHint:e(d(4,g||b)),encValue:n}),la=r({encryptedValue:ee,envelopedData:d(0,Ea||b)},function(a){return a.encryptedContentInfo?
"envelopedData":"encryptedValue"}),fe=r({encryptedPrivKey:d(0,la),keyGenParameters:d(1,g||b),archiveRemGenPrivKey:d(2,$||b)}),ge=f({pubMethod:h({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:e(A)}),Sb=f({action:h({dontPublish:0,pleasePublish:1}),pubInfos:e(k(ge))}),he=h({encrCert:0,challengeResp:1}),Ub=r({thisMessage:d(0,n||b),subsequentMessage:d(1,he||b),dhMAC:d(2,n||b),agreeMAC:d(3,Tb||b),encryptedKey:d(4,Ea||b)});f({salt:g,owf:p,iterationCount:h,mac:p});var Tb=f({algId:p,value:n}),ie=f({authInfo:r({sender:d(0,
u(A)),publicKeyMAC:Tb}),publicKey:ia}),je=f({poposkInput:e(d(0,ie)),algorithmIdentifier:p,signature:n}),ke=r({raVerified:d(0,na||b),signature:d(1,je||b),keyEncipherment:d(2,Ub||b),keyAgreement:d(3,Ub||b)}),le=k(Ja({regToken:U,authenticator:U,pkiPublicationInfo:Sb,pkiArchiveOptions:fe,oldCertID:de,protocolEncrKey:ia})),me=f({notBefore:e(d(0,ba||b)),notAfter:e(d(1,ba||b))}),Vb=f({version:e(d(0,h||b)),serialNumber:e(d(1,h||b)),signingAlg:e(d(2,p||b)),issuer:e(d(3,W||b)),validity:e(d(4,me||b)),subject:e(d(5,
W||b)),publicKey:e(d(6,ia||b)),issuerUID:e(d(7,n||b)),subjectUID:e(d(8,n||b)),extensions:e(d(9,ja||b))}),Wb=f({certReqId:h,certTemplate:Vb,controls:e(le)}),ne=f({privateKey:Sa,identifier:e(r({string:U,generalName:A},function(a){return"string"===typeof a||a instanceof String?"string":"generalName"}))}),Xb=f({certReq:Wb,popo:e(ke),regInfo:e(k(Ja({utf8Pairs:U,certReq:Wb,encKeyWithID:ne})))});k(Xb);var Yb=f({pendToken:g,pendTime:G}),Zb=h({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,
partial:7}),$b=h({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),oe=f({cMCStatus:Zb,bodyList:k(h),statusString:e(U),otherInfo:e(r({failInfo:$b,pendInfo:Yb}))}),pe=f({pkiDataReference:h,certReferences:k(h),extensions:k(wb)}),qe=f({pkiDataBodyid:h,bodyIds:k(h)}),re=f({issuerName:A,serialNumber:h}),se=f({issuerName:W,cRLName:e(A),time:e(G),reasons:e(Ua)}),
te=f({issuerName:W,serialNumber:h,reason:Ab,invalidityDate:e(G),passphrase:e(g),comment:e(U)}),ue=f({bodyPartID:h,thePOPAlgID:p,thePOP:g}),ac=r({bodyPartID:h,bodyPartPath:Ya}),ve=f({cMCStatus:Zb,bodyList:k(ac),statusString:e(U),otherInfo:e(r({failInfo:$b,pendInfo:Yb,extendedFailInfo:f({failInfoOID:l,failInfoValue:b})}))}),we=f({seqNumber:h,hashAlgorithm:p,anchorHashes:k(g)}),cb=k(h),xe=f({hashAlg:p,certHashes:k(g),pubInfo:Sb}),ye=f({pkiDataReference:Ya,certReferences:cb,replace:V($,!0),certTemplate:Vb}),
ze=f({bodyList:k(ac)}),Ae=f({proofAlgID:p,macAlgId:p,witness:g}),Be=f({keyGenAlgorithm:p,macAlgorithm:p,witness:g}),Ce=f({bodyPartID:h,certificationRequest:zb}),bc=f({bodyPartID:h,contentInfo:sa}),cc=f({bodyPartID:h,otherMsgType:l,otherMsgValue:b}),dc=r({tcr:d(0,Ce||b),crm:d(1,Xb||b),orm:d(2,ga(f({bodyPartID:h,requestMessageType:l,requestMessageValue:b})))}),De=f({request:dc,cms:sa,thePOPAlgID:p,witnessAlgID:p,witness:g}),ec=I({bodyPartID:h,attrType:l,attrValues:function(a){return y(a)}},"attrType",
"attrValues",b)({statusInfo:oe,identification:U,identityProof:g,dataReturn:g,transactionId:h,senderNonce:g,recipientNonce:g,addExtensions:pe,encryptedPOP:De,decryptedPOP:ue,lraPOPWitness:qe,getCert:re,getCRL:se,revokeRequest:te,regInfo:g,responseInfo:g,queryPending:g,popLinkRandom:g,popLinkWitness:g,confirmCertAcceptance:ra,statusInfoV2:ve,trustedAnchors:we,authPublish:h,batchRequests:cb,batchResponses:cb,publishCert:xe,modCertTemplate:ye,controlProcessed:ze,popLinkWitnessV2:Be,identityProofV2:Ae}),
Ee=f({controlSequence:k(ec),reqSequence:k(dc),cmsSequence:k(bc),otherMsgSequence:k(cc)},"PKI REQUEST"),Fe=f({controlSequence:k(ec),cmsSequence:k(bc),otherMsgSequence:k(cc)},"PKI RESPONSE");Ha.prototype={GostPrivateKeyInfo:Dc,GostSubjectPublicKeyInfo:Ra,GostKeyContainer:md,GostKeyContainerName:nd,GostPrivateKeys:od,GostPrivateMasks:pd,GostSignature:Sc,GostEncryptedKey:id,GostWrappedPrivateKey:Ac,PrivateKeyInfo:Sa,EncryptedPrivateKeyInfo:tb,SubjectPublicKeyInfo:ia,TBSCertificate:xb,Certificate:ka,CertificationRequestInfo:yb,
CertificationRequest:zb,TBSCertList:Bb,CertificateList:Wa,AttributeCertificateInfo:Fb,AttributeCertificate:Gb,SignedAttributes:Da,UnsignedAttributes:Kb,ContentInfo:sa,SafeContents:Rb,AuthenticatedSafe:ae,PFX:ce,PKIData:Ee,PKIResponse:Fe};x.asn1=new Ha;return Ha});
