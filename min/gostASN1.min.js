/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(x,w){"function"===typeof define&&define.amd?define(["gostCrypto","gostCoding","gostSecurity"],w):"object"===typeof exports?module.exports=w(require("gostCrypto"),require("gostCoding"),require("gostSecurity")):x.GostASN1=w(x.gostCrypto,x.GostCoding,x.GostSecurity)})(this,function(x){function w(){for(var a={},c=0,b=arguments.length;c<b;c++){var d=arguments[c];if("object"===typeof d)for(var e in d)a[e]=d[e]}return a}function ua(a){a instanceof M&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),
b=0,d=a.length;b<d;b++)c[d-b-1]=a[b];return c.buffer}function ea(a){return a instanceof M||a.buffer instanceof M}function hc(a,c){return a.length>=c?a:Array(c-a.length+1).join("0")+a}function Fa(a){return 2>=a?a:4>=a?4:8>=a?8:16>=a?16:32>=a?32:64>=a?64:128>=a?128:256>=a?256:512>a?512:1024>a?1024:void 0}function N(a){if(a)throw Error("Invalid format");}function fa(a,c,b,d){"object"!==typeof b&&(b={value:b});void 0!==d&&(b.enumerable=d);Object.defineProperty(a,c,b)}function Ga(a,c,b){for(var d in c)fa(a,
d,c[d],b)}function S(a,c,b,d,e,f){N(void 0===c);c={tagNumber:b,tagClass:d||0,tagConstructed:e||!1,object:c};a=a||"DER";if("DER"===a||"CER"===a)c=ga.encode(c,a);"PEM"===a&&(c=Ha.encode(c,f));return c}function X(a,c,b,d,e){N(void 0===a);"string"===typeof a&&(a=Ha.decode(a,e,!1));a instanceof M&&(a=ga.decode(a));b=b||0;d=d||!1;void 0===a.tagNumber&&(a=S(!0,a.object,c,b,a.object instanceof Array),a=ga.decode(a));N(a.tagClass!==b||a.tagNumber!==c||a.tagConstructed!==d);return 0===b&&5===c?null:a.object}
function t(a,c,b,d){"function"!==typeof c&&(d=b,b=c,c=function(){a.apply(this,arguments)});c.prototype=Object.create(a.prototype,{constructor:{value:c},superclass:{value:a.prototype}});b&&Ga(c.prototype,b);if(a!==Object)for(var e in a)c[e]=a[e];c.super=a;d&&Ga(c,d,!0);return c}function Ia(){}var M=this.ArrayBuffer,H=x.security.algorithms,eb=x.security.names,fb=x.security.identifiers,$=x.security.attributes,aa=x.security.parameters,ga=x.coding.BER,Ha=x.coding.PEM,gb=x.coding.Hex,hb=x.coding.Int16,
T={encode:function(a,c){return"0x"+gb.encode(a,c)},decode:function(a,c,b){"number"===typeof a&&(a=a.toString(16));a=a.replace("0x","");b=b||Fa(a.length);return gb.decode(hc(a,b),c)}},l=t(Object,function(a){this.object=a},{_set:function(a,c,b){a.property(c).set.call(this,b)},_get:function(a,c){return a.property(c).get.call(this)},_call:function(a,c,b){return a.method(c).apply(this,b)},hasProperty:function(a){return this.hasOwnProperty(a)||!!this.constructor.property(a)},encode:function(){return this.object}},
{decode:function(a){return new this(a)},property:function(a){for(var c=this.prototype;c;){var b=Object.getOwnPropertyDescriptor(c,a);if(b)return b;c=c.superclass}},method:function(a){for(var c=this.prototype;c;){if(c[a])return c[a];c=c.superclass}}}),D=function(a){return t(l,{encode:function(c){return S(c,this.object,a)}},{decode:function(c){return new this(X(c,a))}})},ba=D(1),ca=D(22),va=D(19),ic=D(20),U=D(12),jc=D(23),y=D(24),kc=D(28),Ja=D(30),na=t(D(5),{object:{get:function(){return null},set:function(a){N(null!==
a)}}}),ib=function(a){function c(c){return t(D(a),function(a){b.super.call(this,a)},{encode:function(b){return S(b,c[this.object],a)}},{decode:function(b){b=X(b,a);for(var d in c)if(b===c[d])return new this(d);N(!0)}})}var b=t(D(a),function(a){if(this instanceof b)b.super.apply(this,arguments);else return c(a)});return b},h=ib(2),jb=ib(10),g=function(){function a(a){return a?t(a,{encode:function(c){return S(c,a.method("encode").call(this,!0),4)}},{decode:function(c){return a.decode.call(this,X(c,
4))}}):c}var c=t(D(4),function(b){if(this instanceof c)c.super.apply(this,arguments);else return a(b)});return c}(),q=function(){function a(a){return a?t(a,{encode:function(c){return S(c,a.method("encode").call(this,!0),3)}},{decode:function(c){return a.decode.call(this,X(c,3))}}):b}function c(a){return t(l,function(a,c){l.call(this,a);this.numbits=c||0},{encode:function(c){var b=this.object,d=[];if(b instanceof Array){for(var e=0,f=b.length;e<f;e++){var R=a[b[e]];void 0!==R&&(d[R]="1")}e=0;for(f=
Math.max(d.length,this.numbits);e<f;e++)d[e]||(d[e]="0");d=d.join("")}else d="0";return S(c,d,3)}},{decode:function(c){c=X(c,3);var b=[],d;for(d in a)"1"===c.charAt(a[d])&&b.push(d);return new this(b,c.length)}})}var b=t(D(3),function(d){if(this instanceof b)b.super.apply(this,arguments);else return"object"===typeof d?c(d):a(d)});return b}(),E=function(a){a.combine=function(c,b){for(var d in a.prototype)a.prototype.hasOwnProperty(d)&&!c.hasProperty(d)&&fa(c,d,function(a){return{get:function(){return this[b]&&
this[b][a]},set:function(c){this[b]||(this[b]={});this[b][a]=c},configurable:!1,enumerable:!0}}(d))};return a},f=function(a,c){var b=t(l,function(a,c){fa(this,"items",{writable:!0,value:{}});"string"===typeof a||a instanceof M?this.decode(a):void 0!==a&&(this.object=a,c&&this.check())},{object:{get:function(){return this},set:function(c){if(c instanceof b){this.items=c.items;for(var d in a){var e=this.getItemClass(d,this.items);e.combine&&e.combine(this,d)}}else{var f={};for(d in a){var g=c[d],e=
this.getItemClass(d,f);void 0!==g?f[d]=new e(g):e.combine&&(f[d]=new e(c));e.combine&&e.combine(this,d)}this.items=f}}},getItemClass:function(c,b){return a[c]},encode:function(b){var d=[],e=this.items,f;for(f in a)if(e[f]){var R=e[f].encode(!0);void 0!==R&&d.push(R)}return S(b,d,16,0,!0,c)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(b){b=X(b,16,0,!0,c);var d=
0,e=new this,f=e.items={},R;for(R in a){var g=e.getItemClass(R,f),h=g.decode(b[d]);void 0!==h&&(f[R]=h,g.combine&&g.combine(e,R),d++)}return e}}),d;for(d in a)fa(b.prototype,d,function(c){return{get:function(){return this.items[c]&&this.items[c].object},set:function(a){if(void 0!==a){var b=this.getItemClass(c,this.items);this.items[c]=new b(a)}else delete this.items[c]},configurable:!1,enumerable:!a[c].combine}}(d)),a[d].combine&&a[d].combine(b.prototype,d);return b},I=function(a,c,b,d,e){return function(g,
h){c=c||"type";b=b||"value";h=h||d||l;var k=f(a,e),k=t(k,{getItemClass:function(d,e){var f=a[d];if(b===d){var Z,k=e&&e[c];k&&(k=k.object,g&&(Z="function"===typeof g?g(k):g[k]));Z=Z||h||l;f=f===l?Z:f(Z)}return f}});fa(k.prototype,c,{get:function(){return this.items[c]&&this.items[c].object},set:function(){N(!0)},configurable:!1,enumerable:!0});return k}},k=t(l,{encode:function(a){var c=this.object,c=/^(\d+\.)+\d+$/.test(c)?c:fb[c];N(!c);return S(a,c,6)}},{decode:function(a){a=X(a,6);return new this(eb[a]||
a)}}),e=function(a){a=a||l;return t(a,{encode:function(c){c=a.method("encode").call(this,c);return"string"===typeof c||c instanceof M?c:4===c.tagNumber||0!==c.tagClass||c.object instanceof Array?{object:c.object}:{object:ga.encode(c,"DER",!0)}}},{decode:function(c){"string"===typeof c||c instanceof M||(c={object:c.object,header:c.header,content:c.content});return a.decode.call(this,c)}})},p=function(a){a=a||l;return t(a,{encode:function(c){c=a.method("encode").call(this,c);return"string"===typeof c||
c instanceof M?c:{object:[c]}}},{decode:function(c){return"string"===typeof c||c instanceof M?a.decode.call(this,c):a.decode.call(this,c.object[0])}})},b=function(a,c){return t(c,function(){c.apply(this,arguments)},{encode:function(b){b=c.method("encode").call(this,b);if("string"===typeof b||b instanceof M)return b;b.tagNumber=a;b.tagClass=2;b.tagConstructed=b.object instanceof Array;return b}},{decode:function(b){N(void 0!==b.tagNumber&&(2!==b.tagClass||b.tagNumber!==a));return c.decode.call(this,
b)}})},kb=function(a){return function(c,b){c=c||l;var d=function(e,f){var g="function"===typeof c&&void 0!==e?c(e,f):c;if(b){var h=t(l,function(a){if(this instanceof h)fa(this,"items",{writable:!0,value:{}}),l.call(this,a||{});else return d.apply(this,arguments)},{object:{get:function(){this.read();return this},set:function(a){if(a instanceof h)a.read(),this.items=a.items;else{var c={},b;for(b in a)c[b]=this.createItem(a[b],b);this.items=c}this.reset()}},createItem:function(a,c){if(b){var d={};d[b.typeName]=
c;d[b.valueName]=a}else d=a;return new g(d)},getItemValue:function(a){a=this.items[a];return b?a.object[b.valueName]:a.object},setItemValue:function(a,c){var d=this.items[a];b?d.object[b.valueName]=c:d.object=c},isItemType:function(a){return b?fb[a]:!isNaN(parseInt(a))},reset:function(){var a=this.items,c;for(c in this)this.hasOwnProperty(c)&&!this.items[c]&&this.isItemType(c)&&delete this[c];for(c in a)this[c]=this.getItemValue(c)},read:function(){var a=this.items,c;for(c in this)this.isItemType(c)&&
(this.items[c]?this.getItemValue(c)!==this[c]&&this.setItemValue(c,this[c]):(a[c]=this.createItem(this[c],c),this[c]=this.getItemValue(c)))},encode:function(c){this.read();var b=this.items,d=[],e;for(e in b){var f=b[e].encode(!0);void 0!==f&&d.push(f)}return S(c,d,a,0,!0)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(a,c){return(new this(a)).encode(c)},decode:function(c){c=X(c,a,0,!0);for(var d=new this,e=d.items=
{},f=0,h=c.length;f<h;f++){var Z=g.decode(c[f]);e[b?Z.object[b.typeName]:f]=Z}d.reset();return d}});return h}var k=t(l,function(a){if(this instanceof k)Ga(this,{items:{writable:!0,value:[]},values:{writable:!0,value:[]}}),l.call(this,a||[]);else return d.apply(this,arguments)},{object:{get:function(){this.read();return this.values},set:function(a){if(a instanceof k)a.read(),this.items=a.items;else{for(var c=[],b=0,d=a.length;b<d;b++)c[b]=new g(a[b]);this.items=c}this.reset()}},encode:function(c){this.read();
for(var b=this.items,d=[],e=0,f=b.length;e<f;e++){var g=b[e].encode(!0);void 0!==g&&d.push(g)}return S(c,d,a,0,!0)},decode:function(a){this.object=this.constructor.decode(a)},check:function(){this.constructor.decode(this.encode(!0))},reset:function(){for(var a=0,c=this.items.length;a<c;a++)this.values.push(this.items[a].object)},read:function(){for(var a=this.items,c=this.values,b=0,d=c.length;b<d;b++)this.items[b]?a[b].object!==c[b]&&(a[b].object=c[b]):(a[b]=new g(c[b]),c[b]=a[b].object)}},{encode:function(a,
c){return(new this(a)).encode(c)},decode:function(c){c=X(c,a,0,!0);var b=new this;b.items=[];for(var d=0,e=c.length;d<e;d++)b.items.push(g.decode(c[d]));b.reset();return b}});return k};return d()}},m=kb(16),z=kb(17),O=function(a,c){if(c){var b=t(l,{object:{get:function(){if(this.item)return c.decode(this.item.object)},set:function(b){void 0!==b?this.item=new a(c.encode(b)):delete this.item}},encode:function(a){return this.item.encode(a)}},{decode:function(c){var b=new this;b.item=a.decode(c);return b}}),
d;for(d in a)b[d]||(b[d]=a[d]);return b}return a},A=function(a){return O(z(a),{encode:function(a){return[a]},decode:function(a){return a[0]}})},s=function(a,c){return t(l,{object:{get:function(){return this.item&&this.item.object},set:function(b){if(b instanceof l)for(var d in a)if(b instanceof a[d]){this.item=b;return}d="function"===typeof c?c(b):c;N(!d||!a[d]);this.item=b=new a[d](b)}},encode:function(a){return this.item.encode(a)}},{decode:function(c){for(var b in a)try{var d=a[b].decode(c);if(void 0!==
d)return new this(d)}catch(e){}N(!0)}})},P=function(a){a=a||l;return t(a,{encode:function(){return ga.encode(a.method("encode").call(this,!0))}},{encode:function(a,b){return(new this(a)).encode(b)},decode:function(c){return a.decode.call(this,ga.decode(c))}})},V=function(a,c){a=a||l;return t(a,{encode:function(b){return this.object===c?void 0:a.method("encode").call(this,b)}},{decode:function(b){if(void 0===b)return new this(c);try{return a.decode.call(this,b)}catch(d){}}})},d=function(a){a=a||l;
return t(a,{},{decode:function(c){if(void 0!==c)try{return a.decode.call(this,c)}catch(b){}}})},ha=s({teletexString:ic,printableString:va,universalString:kc,utf8String:U,bmpString:Ja},function(a){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?"printableString":"utf8String"}),da=s({utcTime:jc,generalTime:y},function(a){return 2050<=a.getYear()?"generalTime":"utcTime"}),Ka=I({type:k,value:l}),La={typeName:"type",valueName:"value"},lb=A(Ka({serialName:va,countryName:va,
dnQualifier:va,emailAddress:ca,domainComponent:ca},ha)),lc=m(lb,La)(),W=s({rdnSequence:lc},"rdnSequence"),mb=E(f({notBefore:da,notAfter:da})),nb=I({type:k,value:l}),F=z(nb,La),Ma=m(nb,La),mc=f({a:h,b:h,seed:d(q)}),nc=g(t(l,{encode:function(){var a=this.object,c=Math.max(Fa(a.x.length-2),Fa(a.y.length-2))/2,b=new Uint8Array(2*c+1);b[0]=4;b.set(new Uint8Array(T.decode(a.x,!1,c)),1);b.set(new Uint8Array(T.decode(a.y,!1,c)),c+1);return b.buffer}},{decode:function(a){var c=(a.byteLength-1)/2;return new this({x:T.encode(new Uint8Array(a,
1,c)),y:T.encode(new Uint8Array(a,c+1,c))})}})),oc=f({fieldType:k,parameters:h}),pc=f({version:h,fieldID:oc,curve:mc,base:nc,order:h,cofactor:d(h)}),qc=f({publicKeyParamSet:k,digestParamSet:k,encryptionParamSet:d(k)}),rc=function(a,c){a=a||l;return t(a,{encode:function(b){return this.object===c?(new na(null)).encode(b):a.method("encode").call(this,b)}},{decode:function(b){if(void 0!==b){if(null===b||5===b.tagNumber&&0===b.tagClass)return new this(c);try{return a.decode.call(this,b)}catch(d){}}}})}(k,
"id-GostR3411-94-CryptoProParamSet"),sc=s({namedParameters:k,ecParameters:pc,implicitly:d(na)},function(a){return"string"===typeof a||a instanceof String?"namedParameters":"ecParameters"}),G=function(a,c){return O(f({algorithm:k,parameters:d(a)}),c)},r=function(){var a=G(l),c=t(l,function(a){if(this instanceof c)c.super.apply(this,arguments);else return b(a)},{encode:function(c){return(new a(this.object)).encode(c)}},{decode:function(c){return new this(a.decode(c).object)}}),b=function(a){return t(l,
{object:{get:function(){if(this.item)return this.item.object},set:function(c){if(c){var b=a[c.id];if(!b)throw Error("Algorithm not supported");this.item=new b(c)}else delete this.item}},encode:function(a){return this.item.encode(a)}},{decode:function(c){"string"===typeof c&&(c=Ha.decode(c,void 0,!1));c instanceof M&&(c=ga.decode(c));var b=a[eb[c.object[0].object]];if(b){var d=new this;d.item=b.decode(c);return d}throw Error("Algorithm not supported");}})};return c}(),wa=G(sc,{encode:function(a){return{algorithm:a.id,
parameters:"string"===typeof a.namedCurve?$.namedCurve[a.namedCurve]:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.curve.p},curve:{a:a.curve.a,b:a.curve.b},base:{x:a.curve.x,y:a.curve.y},order:a.curve.q,cofactor:1}}},decode:function(a){var c=a.parameters;a=H[a.algorithm];if("string"===typeof c||c instanceof String)a=w(a,aa[c]);else if("object"===typeof c)a=w(a,{curve:{p:c.fieldID.parameters,a:c.curve.a,b:c.curve.b,x:c.base.x,y:c.base.y,q:c.order}});else throw new DataError("Invalid key paramters");
return a}}),J=G(qc,{encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:$[c][a[c]],digestParamSet:$.sBox[b],encryptionParamSet:a.encParams&&a.encParams.sBox?$.sBox[a.encParams.sBox]:void 0}}},decode:function(a){var c=a.parameters;a=w(H[a.algorithm],aa[c.publicKeyParamSet],aa[c.digestParamSet]);
c.encryptionParamSet&&(a.encParams=aa[c.encryptionParamSet]);return a}}),v=G(l,{encode:function(a){return{algorithm:a.id}},decode:function(a){return H[a.algorithm]}}),u=G(na,{encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return H[a.algorithm]}}),oa=G(rc,{encode:function(a){return{algorithm:a.id,parameters:$.sBox[a.sBox||a.hash&&a.hash.sBox||"D-A"]}},decode:function(a){var c=w(H[a.algorithm]);a=aa[a.parameters];c.hash?c.hash=w(c.hash,a):c=w(c,a);return c}}),Y=r({ecdsa:wa,
noSignature:u,rsaEncryption:u,"id-sc-gostR3410-2001":wa,"id-GostR3410-2001":J,"id-GostR3410-94":J,"id-GostR3410-2001DH":J,"id-GostR3410-94DH":J,"id-tc26-gost3410-12-256":J,"id-tc26-gost3410-12-512":J,"id-tc26-agreement-gost-3410-12-256":J,"id-tc26-agreement-gost-3410-12-512":J,"id-sc-gost28147-gfb":v,"id-Gost28147-89":v}),Q=r({noSignature:u,rsaEncryption:u,sha1withRSAEncryption:u,sha256withRSAEncryption:u,sha384withRSAEncryption:u,sha512withRSAEncryption:u,ecdsa:v,"ecdsa-with-SHA1":v,"ecdsa-with-SHA256":v,
"ecdsa-with-SHA384":v,"ecdsa-with-SHA512":v,"id-GostR3410-94":u,"id-GostR3410-2001":u,"id-GostR3411-94-with-GostR3410-2001":v,"id-GostR3411-94-with-GostR3410-94":v,"id-tc26-gost3410-12-256":u,"id-tc26-gost3410-12-512":u,"id-tc26-signwithdigest-gost3410-12-94":v,"id-tc26-signwithdigest-gost3410-12-256":v,"id-tc26-signwithdigest-gost3410-12-512":v,"id-sc-gostR3410-94":u,"id-sc-gostR3410-2001":u,"id-sc-gostR3411-94-with-gostR3410-94":u,"id-sc-gostR3411-94-with-gostR3410-2001":u}),ja=r({sha1:u,sha256:u,
sha384:u,sha512:u,"id-GostR3411-94":oa,"id-tc26-gost3411-94":oa,"id-tc26-gost3411-12-256":u,"id-tc26-gost3411-12-512":u,"id-sc-gostR3411-94":v}),ob=f({iv:g,encryptionParamSet:k}),tc=f({encryptionParamSet:k,ukm:d(g)}),Na=G(ob,{encode:function(a){return{algorithm:a.id,parameters:{iv:a.iv,encryptionParamSet:$.sBox[a.sBox||"E-A"]}}},decode:function(a){var c=w(H[a.algorithm],aa[a.parameters.encryptionParamSet]);c.iv=a.parameters.iv;return c}}),Oa=G(g,{encode:function(a){return{algorithm:a.id,parameters:a.iv}},
decode:function(a){var c=w(H[a.algorithm]);c.iv=a.parameters||new Uint8Array([0,0,0,0,0,0,0,0]);return c}}),xa=G(tc,{encode:function(a){return{algorithm:a.id,parameters:{encryptionParamSet:$.sBox[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=w(H[a.algorithm],aa[a.parameters.encryptionParamSet]);a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}}),pb=r({"id-Gost28147-89-None-KeyWrap":xa,"id-Gost28147-89-CryptoPro-KeyWrap":xa}),ya=G(pb,{encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},
decode:function(a){var c=w(H[a.algorithm]);c.wrapping=a.parameters;return c}}),uc=r({"id-sc-gost28147-gfb":Oa,"id-Gost28147-89":Na}),Pa=r({"id-Gost28147-89-MAC":ob,"id-HMACGostR3411-94":oa,"id-tc26-hmac-gost-3411-12-256":oa,"id-tc26-hmac-gost-3411-12-512":oa,hmacWithSHA1:v,hmacWithSHA224:v,hmacWithSHA256:v,hmacWithSHA384:v,hmacWithSHA512:v,"id-sc-gost28147-mac":v,"id-sc-hmacWithGostR3411":v}),vc=f({salt:s({specified:g,otherSource:r},function(a){return ea(a)?"specified":"otherSource"}),iterationCount:h,
keyLength:d(h),prf:Pa}),wc=G(vc,{encode:function(a){return{algorithm:a.id,parameters:{salt:a.salt,iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=w(H[a.algorithm]);c.salt=a.parameters.salt;c.iterations=a.parameters.iterationCount;c.hmac=a.parameters.prf;c.hash=c.hmac.hash;return c}}),Qa=r({PBKDF2:wc}),qb=f({salt:g,iterationCount:h}),n=G(qb,{paramType:qb,encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=
w(H[a.algorithm]);c.derivation=w(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}}),xc=f({keyDerivationFunc:Qa,encryptionScheme:uc}),Ra=G(xc,{encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,encryptionScheme:a.encryption}}},decode:function(a){var c=w(H[a.algorithm]);c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}});r({"pbeWithSHAAndAES128-CBC":n,"pbeWithSHAAndAES192-CBC":n,"pbeWithSHAAndAES256-CBC":n,
"pbeWithSHA256AndAES128-CBC":n,"pbeWithSHA256AndAES192-CBC":n,"pbeWithSHA256AndAES256-CBC":n,"id-sc-pbeWithGost3411AndGost28147":n,"id-sc-pbeWithGost3411AndGost28147CFB":n,"pbeWithSHAAnd3-KeyTripleDES-CBC":n,"pbeWithSHAAnd2-KeyTripleDES-CBC":n,"pbeWithSHAAnd128BitRC2-CBC":n,"pbewithSHAAnd40BitRC2-CBC":n,pbeUnknownGost:n,PBES2:Ra});var pa=r({ecdsa:wa,rsaEncryption:u,"id-sc-gost28147-gfb":Oa,"id-Gost28147-89":Na,"id-sc-gostR3410-2001":wa,"id-GostR3410-2001":J,"id-GostR3410-94":J,"id-tc26-gost3410-12-256":J,
"id-tc26-gost3410-12-512":J,"id-GostR3410-94-CryptoPro-ESDH":ya,"id-GostR3410-2001-CryptoPro-ESDH":ya,"id-tc26-agreement-gost-3410-12-256":ya,"id-tc26-agreement-gost-3410-12-512":ya,"id-sc-r3410-ESDH-r3411kdf":u,"id-Gost28147-89-None-KeyWrap":xa,"id-Gost28147-89-CryptoPro-KeyWrap":xa,"id-sc-cmsGostWrap":v,"id-sc-cmsGost28147Wrap":v,"pbeWithSHAAndAES128-CBC":n,"pbeWithSHAAndAES192-CBC":n,"pbeWithSHAAndAES256-CBC":n,"pbeWithSHA256AndAES128-CBC":n,"pbeWithSHA256AndAES192-CBC":n,"pbeWithSHA256AndAES256-CBC":n,
"id-sc-pbeWithGost3411AndGost28147":n,"id-sc-pbeWithGost3411AndGost28147CFB":n,"pbeWithSHAAnd3-KeyTripleDES-CBC":n,"pbeWithSHAAnd2-KeyTripleDES-CBC":n,"pbeWithSHAAnd128BitRC2-CBC":n,"pbewithSHAAnd40BitRC2-CBC":n,pbeUnknownGost:n,PBES2:Ra}),yc=f({keyDerivationFunc:Qa,messageAuthScheme:Pa}),zc=G(yc,{encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,messageAuthScheme:a.hmac}}},decode:function(a){var c=w(H[a.algorithm]);c.derivation=a.parameters.keyDerivationFunc;c.hmac=
a.parameters.messageAuthScheme;return c}});r({PBMAC1:zc});var Ac=r({"id-sc-gost28147-gfb":Oa,"id-Gost28147-89":Na,"pbeWithSHAAndAES128-CBC":n,"pbeWithSHAAndAES192-CBC":n,"pbeWithSHAAndAES256-CBC":n,"pbeWithSHA256AndAES128-CBC":n,"pbeWithSHA256AndAES192-CBC":n,"pbeWithSHA256AndAES256-CBC":n,"id-sc-pbeWithGost3411AndGost28147":n,"id-sc-pbeWithGost3411AndGost28147CFB":n,"pbeWithSHAAnd3-KeyTripleDES-CBC":n,"pbeWithSHAAnd2-KeyTripleDES-CBC":n,"pbeWithSHAAnd128BitRC2-CBC":n,"pbewithSHAAnd40BitRC2-CBC":n,
pbeUnknownGost:n,PBES2:Ra}),rb=O(q(P(h)),{encode:function(a){return hb.encode(ua(a))},decode:function(a){return ua(hb.decode(a))}}),sb=O(q(P(g)),{encode:function(a){var c=new Uint8Array(a.byteLength+1),b=ua(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){N(0===(a.byteLength&1));var c=new Uint8Array(a.byteLength-1),b=c.byteLength/2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,1,b),b);return ua(c)}}),K=q(P(g)),
ka=f({algorithm:Y,subjectPublicKey:q},"PUBLIC KEY"),Sa=function(a){return O(I({algorithm:Y,subjectPublicKey:l},"algorithm","subjectPublicKey")(function(c){return a[c.id]}),{encode:function(a){return{algorithm:a.algorithm,subjectPublicKey:a.buffer}},decode:function(a){return{algorithm:a.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a.subjectPublicKey}}})}({"id-sc-gostR3410-2001":sb,"id-sc-gostR3410-94":rb,"id-GostR3410-2001":K,"id-GostR3410-94":K,"id-tc26-gost3410-12-256":K,
"id-tc26-gost3410-12-512":K}),tb=O(g(P(h)),{encode:function(a){return T.encode(a,!0)},decode:function(a){return T.decode(a,!0)}}),Bc=function(a){return I({version:h,privateKeyAlgorithm:Y,privateKeyWrapped:O(g(P(f({keyData:h,keyMac:h}))),{encode:function(a){var b=a.byteLength-4;return{keyData:T.encode(new Uint8Array(a,0,b)),keyMac:T.encode(new Uint8Array(a,b,4))}},decode:function(a){var b=T.decode(a.keyData);a=T.decode(a.keyMac);var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b));
d.set(new Uint8Array(a),b.byteLength);return d}}),attributes:l},"privateKeyAlgorithm","attributes")(function(c){return d(b(0,e(F({"id-sc-gostR3410-2001-publicKey":A(a[c.id])}))))})}({"id-sc-gostR3410-2001":sb,"id-sc-gostR3410-94":rb,"id-GostR3410-2001":K,"id-GostR3410-94":K,"id-GostR3410-2001DH":K,"id-GostR3410-94DH":K,"id-tc26-gost3410-12-256":K,"id-tc26-gost3410-12-512":K,"id-tc26-agreement-gost-3410-12-256":K,"id-tc26-agreement-gost-3410-12-512":K}),Ta=f({version:h,privateKeyAlgorithm:Y,privateKey:g,
attributes:d(b(0,e(F)))},"PRIVATE KEY"),Cc=f({version:h,privateKeyAlgorithm:Y,privateKey:g,attributes:d(b(0,e(F))),publicKey:d(b(1,e(q)))}),Dc=m(Cc),Ec=function(a){return O(I({version:h,privateKeyAlgorithm:Y,privateKey:l,attributes:d(b(0,e(F)))},"privateKeyAlgorithm","privateKey")(function(b){return a[b.id]}),{encode:function(a){return{version:0,privateKeyAlgorithm:a.algorithm,privateKey:a.buffer}},decode:function(a){return{algorithm:a.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign",
"deriveKey","deriveBits"],buffer:a.privateKey}}})}({"id-sc-gostR3410-2001":tb,"id-sc-gostR3410-94":tb,"id-GostR3410-2001":g,"id-GostR3410-94":g,"id-GostR3410-2001DH":g,"id-GostR3410-94DH":g,"id-tc26-gost3410-12-256":g,"id-tc26-gost3410-12-512":g,"id-tc26-agreement-gost-3410-12-256":g,"id-tc26-agreement-gost-3410-12-512":g}),ub=f({encryptionAlgorithm:pa,encryptedData:g},"ENCRYPTED PRIVATE KEY"),Fc=f({cA:V(ba,!1),pathLenConstraint:d(h)}),Gc=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,
keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Hc=m(k),Ic=f({type:k,value:b(0,p(l))}),Jc=f({nameAssigner:d(b(0,e(ha))),partyName:d(b(1,e(ha)))}),Kc=f({}),B=s({otherName:b(0,e(Ic)),rfc822Name:b(1,e(ha)),dNSName:b(2,e(ha)),x400Address:b(3,e(Kc)),directoryName:b(4,p(W)),ediPartyName:b(5,e(Jc)),uniformResourceIdentifier:b(6,e(ha)),iPAddress:b(7,e(g)),registeredID:b(8,e(k))},function(a){return"string"===typeof a||a instanceof String?0<=a.indexOf("@")?"rfc822Name":"dNSName":ea(a)?
"iPAddress":"directoryName"}),C=m(B),Ua=f({keyIdentifier:d(b(0,e(g))),authorityCertIssuer:d(b(1,e(C))),authorityCertSerialNumber:d(b(2,e(h)))}),Lc=f({notBefore:d(b(0,e(y))),notAfter:d(b(1,e(y)))}),Mc=f({policyQualifierId:k,qualifier:l}),Nc=f({policyIdentifier:k,policyQualifiers:d(m(Mc))}),Oc=f({issuerDomainPolicy:k,subjectDomainPolicy:k}),Pc=f({base:B,minimum:V(b(0,e(h)),0),maximum:d(b(1,e(h)))}),vb=m(Pc),Qc=f({permittedSubtrees:d(b(0,e(vb))),excludedSubtrees:d(b(1,e(vb)))}),Rc=f({requireExplicitPolicy:d(b(0,
e(h))),inhibitPolicyMapping:d(b(1,e(h)))}),Va=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),wb=s({fullName:b(0,e(C)),nameRelativeToCRLIssuer:b(1,e(lb))},function(a){return a instanceof Array?"fullName":"nameRelativeToCRLIssuer"}),Sc=f({distributionPoint:d(b(0,p(wb))),reasons:d(b(1,e(Va))),cRLIssuer:d(b(2,e(C)))}),za=m(Sc),Wa=f({accessMethod:k,accessLocation:B}),xb=function(a,b){var d=I({extnID:k,
critical:V(ba,!1),extnValue:function(a){return g(P(a))}},"extnID","extnValue"),e=t(d(a),{object:{get:function(){var a=this._get(e.super,"object");a&&"object"===typeof a.extnValue&&this.defineValue(a.extnValue);return a},set:function(a){this._set(e.super,"object",a);a&&a.extnValue&&(void 0!==a.extnValue.critical?this.critical=a.extnValue.critical:void 0===this.critical&&b&&(this.critical=b(this.extnID,a.extnValue)))}},extnValue:{get:function(){var a=this._get(e.super,"extnValue");"object"===typeof a&&
this.defineValue(a);return a},set:function(a){this._set(e.super,"extnValue",a);a&&(void 0!==a.critical?this.critical=a.critical:void 0===this.critical&&b&&(this.critical=b(this.extnID,a)))}},defineValue:function(a){if("object"===typeof a&&!Object.getOwnPropertyDescriptor(a,"critical")){var b=this;fa(a,"critical",{get:function(){return b.critical},set:function(a){b.critical=a},enumerable:!0,configurable:!1})}}});return e},la=m(xb,{typeName:"extnID",valueName:"extnValue"}),Aa=la({authorityKeyIdentifier:Ua,
subjectKeyIdentifier:g,keyUsage:Gc,privateKeyUsagePeriod:Lc,certificatePolicies:m(Nc),policyMappings:m(Oc),subjectAltName:C,issuerAltName:C,subjectDirectoryAttributes:Ma,basicConstraints:Fc,nameConstraints:Qc,policyConstraints:Rc,extKeyUsage:Hc,cRLDistributionPoints:za,inhibitAnyPolicy:h,freshestCRL:za,authorityInfoAccess:m(Wa),subjectInfoAccess:m(Wa)},function(a,b){return"keyUsage"===a||"basicConstraints"===a&&void 0===b.pathLenConstraint}),Tc=f({r:h,s:h}),yb=E(f({version:b(0,p(h)),serialNumber:h,
signature:Q,issuer:W,validity:mb,subject:W,subjectPublicKeyInfo:ka,issuerUniqueID:d(b(1,e(q))),subjectUniqueID:d(b(2,e(q))),extensions:d(b(3,p(Aa)))})),ia=f({tbsCertificate:yb,signatureAlgorithm:Q,signatureValue:q},"CERTIFICATE"),Uc=F({challengePassword:A(ha),extensionRequest:A(Aa),msCertExtensions:A(Aa),extendedCertificateAttributes:A(F)}),zb=E(f({version:h,subject:W,subjectPublicKeyInfo:ka,attributes:b(0,e(Uc))})),Ab=f({requestInfo:zb,signatureAlgorithm:Q,signatureValue:q},"CERTIFICATE REQUEST"),
Bb=jb({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),Vc=f({distributionPoint:d(b(0,p(wb))),onlyContainsUserCerts:V(b(1,e(ba)),!1),onlyContainsCACerts:V(b(2,e(ba)),!1),onlySomeReasons:d(b(3,e(Va))),indirectCRL:V(b(4,e(ba)),!1),onlyContainsAttributeCerts:V(b(5,e(ba)),!1)}),Wc=la({authorityKeyIdentifier:Ua,issuerAltName:C,cRLNumber:h,deltaCRLIndicator:h,issuingDistributionPoint:Vc,
freshestCRL:za},function(a){return"cRLNumber"===a}),Xc=la({cRLReason:Bb,instructionCode:k,invalidityDate:y,certificateIssuer:C}),Cb=E(f({version:d(h),signature:Q,issuer:W,thisUpdate:da,nextUpdate:d(da),revokedCertificates:d(m(f({userCertificate:h,revocationDate:da,crlEntryExtensions:d(Xc)}))),crlExtensions:d(b(0,p(Wc)))})),Xa=f({tbsCertList:Cb,signatureAlgorithm:Q,signatureValue:q},"CRL"),Ya=f({digestedObjectType:jb({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:d(k),digestAlgorithm:ja,
objectDigest:q}),Ba=f({issuer:C,serial:h,issuerUID:d(q)}),Yc=f({issuerName:d(C),baseCertificateID:d(b(0,e(Ba))),objectDigestInfo:d(b(1,e(Ya)))}),Zc=f({targetCertificate:Ba,targetName:d(B),certDigestInfo:d(Ya)}),$c=s({targetName:b(0,p(B)),targetGroup:b(1,p(B)),targetCert:b(2,e(Zc))}),ad=m($c),bd=la({auditIdentity:g,targetInformation:ad,authorityKeyIdentifier:Ua,authorityInfoAccess:m(Wa),cRLDistributionPoints:za,noRevAvail:na},function(a){return"auditIdentity"===a||"targetInformation"===a}),cd=f({baseCertificateID:d(b(0,
e(Ba))),entityName:d(b(1,e(C))),objectDigestInfo:d(b(2,e(Ya)))}),dd=s({v1Form:C,v2Form:b(0,e(Yc))},"v2Form"),Db=f({notBeforeTime:y,notAfterTime:y}),Eb=f({service:B,ident:B,authInfo:d(g)}),ed=f({roleAuthority:d(b(0,e(C))),roleName:b(1,p(B))}),fd=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),gd=f({type:b(0,e(k)),value:b(1,e(l))}),hd=f({policyId:b(0,e(k)),classList:V(b(1,e(fd)),["unclassified"]),securityCategories:d(b(2,e(z(gd))))}),Fb=f({policyAuthority:d(b(0,e(C))),
values:m(s({octets:g,oid:k,string:U},function(a){return ea?"octets":getIdentifier(a)?"oid":"string"}))}),Gb=E(f({version:h,holder:cd,issuer:dd,signature:Q,serialNumber:h,attrCertValidityPeriod:Db,attributes:Ma({authenticationInfo:z(Eb),accessIdentity:z(Eb),chargingIdentity:A(Fb),group:A(Fb),role:z(ed),clearance:z(hd)}),issuerUniqueID:d(q),extensions:d(bd)})),Hb=f({acinfo:Gb,signatureAlgorithm:Q,signatureValue:q},"ATTRIBUTE CERTIFICATE"),ma=g,qa=g;f({keyInfo:pb,entityUInfo:d(b(0,p(g))),suppPubInfo:b(2,
p(g))});var L=O(f({encryptedKey:g,maskKey:d(b(0,e(g))),macKey:g}),{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey,d=a.maskKey;a=a.macKey;if(d)for(var d=new Int32Array(d),e=new Int32Array(b),f=0,g=d.length/e.length;f<g;f++)for(var h=0,k=e.length;h<k;h++)e[h]=e[h]+d[k*f+h]&4294967295;d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);
d.set(new Uint8Array(a),32);return d.buffer}}),id=f({encryptionParamSet:k,ephemeralPublicKey:d(b(0,e(Sa))),ukm:g}),Ca=O(f({sessionEncryptedKey:L,transportParameters:d(b(0,e(id)))}),{encode:function(a){var b=a.algorithm;return{sessionEncryptedKey:a.sessionEncryptedKey,transportParameters:{encryptionParamSet:$.sBox[b.wrapping.sBox||"E-A"],ephemeralPublicKey:b["public"],ukm:b.ukm}}},decode:function(a){return{algorithm:{wrapping:aa[a.transportParameters.encryptionParamSet],ukm:a.transportParameters.ukm,
"public":a.transportParameters.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),Ib=O(f({sessionEncryptedKey:L,ukm:f({ephemeralPublicKey:Sa,addedukm:d(b(0,p(g)))})}),{encode:function(a){var b=a.algorithm;return{sessionEncryptedKey:a.sessionEncryptedKey,ukm:{ephemeralPublicKey:b["public"],addedukm:b.ukm}}},decode:function(a){return{algorithm:{ukm:a.ukm.addedukm,"public":a.ukm.ephemeralPublicKey},sessionEncryptedKey:a.sessionEncryptedKey}}}),jd=function(a){return function(b){return(b=
a[b.id])?P(b):l}}({"id-sc-gostR3410-2001":Ib,"id-sc-gostR3410-94":Ib,"id-GostR3410-2001":Ca,"id-GostR3410-94":Ca,"id-tc26-gost3410-12-256":Ca,"id-tc26-gost3410-12-512":Ca,"id-GostR3410-94-CryptoPro-ESDH":L,"id-GostR3410-2001-CryptoPro-ESDH":L,"id-tc26-agreement-gost-3410-12-256":L,"id-tc26-agreement-gost-3410-12-512":L,"id-sc-r3410-ESDH-r3411kdf":L,"id-Gost28147-89-None-KeyWrap":L,"id-Gost28147-89-CryptoPro-KeyWrap":L,"id-sc-cmsGostWrap":L,"id-sc-cmsGost28147Wrap":L}),kd=q({kccaSoftPassword:0,kccaReservePrimary:1,
kccaPrimaryKeyAbsent:2,kccaFKCShared:3}),ld=q({pkaExportable:0,pkaUserProtect:1,pkaExchange:2,pkaEphemeral:3,pkaNonCachable:4,pkaDhAllowed:5}),Jb=f({attributes:d(ld),privateKeyAlgorithm:d(b(0,e(Y)))}),Kb=f({path:ca,hmac:g}),md=f({containerAlgoritmIdentifier:d(b(0,e(r))),containerName:d(ca),attributes:kd,primaryPrivateKeyParameters:Jb,hmacPassword:d(b(2,e(g))),secondaryEncryptedPrivateKey:d(b(3,e(L))),secondaryPrivateKeyParameters:d(b(4,e(Jb))),primaryCertificate:d(b(5,e(g(P(ia))))),secondaryCertificate:d(b(6,
e(g(P(ia))))),encryptionContainerName:d(b(7,e(ca))),primaryCertificateLink:d(b(8,e(Kb))),secondaryCertificateLink:d(b(9,e(Kb))),primaryFP:d(b(10,e(g))),secondaryFP:d(b(11,e(g))),passwordPolicy:d(r),containerSecurityLevel:d(h),extensions:d(b(12,e(la({keyValidity:f({notBefore:d(b(0,e(y))),notAfter:d(b(1,e(y)))})})))),secondaryEncryptionContainerName:d(b(13,e(ca)))}),nd=f({keyContainerContent:md,hmacKeyContainerContent:g}),od=f({containerName:ca,extElem1:d(l)}),pd=f({primaryKey:g,secondaryKey:d(g),hmacKey:d(g)}),
qd=f({mask:g,randomStatus:g,hmacRandom:g}),Lb=f({keyClass:h,keyType:h,algorithm:d(b(0,p(Y))),serialNumber:d(b(1,p(g))),addSerialNumber:d(b(2,p(g))),certSerialNumber:d(b(3,p(g))),subjectUID:d(b(4,p(g))),recipientUID:d(b(5,p(g))),validity:d(b(6,p(s({validity:mb,keyValidity:f({notBefore:d(b(0,e(y))),notAfter:d(b(1,e(y)))})},function(){return"keyValidity"})))),keyUID:d(b(7,p(q))),flags:d(b(10,p(h)))}),rd=f({version:h,keyInfo:Lb,defenceKeyInfo:Lb,certificate:d(b(0,p(ia))),publicKey:d(b(1,p(g)))}),ra=k,
qa=g,Za=m(h),sd=f({bodyPartPath:Za,identifier:k,content:l}),Da=F({contentType:A(ra),messageDigest:A(g),signingTime:A(da)}),Mb=F(function(a){return{countersignature:z(td),unsignedData:z(sd)}[a]}),sa=f({issuer:W,serialNumber:h}),ud=s({issuerAndSerialNumber:sa,subjectKeyIdentifier:b(0,e(qa))},function(a){return ea(a)?"subjectKeyIdentifier":"issuerAndSerialNumber"}),Nb=f({version:h,sid:ud,digestAlgorithm:ja,signedAttrs:d(b(0,e(Da))),signatureAlgorithm:Q,signatureValue:g,unsignedAttrs:d(b(1,e(Mb)))}),
td=Nb,vd=z(Nb),wd=z(ja),xd=E(f({version:h,certificate:ia,attributes:F})),yd=f({extendedCertificateInfo:xd,signatureAlgorithm:Q,signatureValue:q}),zd=f({otherCertFormat:k,otherCert:l}),Ad=E(f({version:h,subject:s({baseCertificateID:b(0,e(Ba)),subjectName:b(1,e(C))},function(a){return a.issuer?"baseCertificateID":"subjectName"}),issuer:C,signature:Q,serialNumber:h,attCertValidityPeriod:Db,attributes:Ma,issuerUniqueID:d(q),extensions:d(Aa)})),Bd=f({acInfo:Ad,signatureAlgorithm:Q,signatureValue:q}),$a=
f({eContentType:ra,eContent:d(b(0,p(g)))}),Cd=s({certificate:ia,extendedCertificate:b(0,e(yd)),v1AttrCert:b(1,e(Bd)),v2AttrCert:b(2,e(Hb)),other:b(3,e(zd))},function(a){return a.holder?"AttributeCertificateV2":a.certificate?"ExtendedCertificate":a.otherCertFormat?"other":"certificate"}),Dd=f({otherRevInfoFormat:k,otherRevInfo:l}),Ed=s({crl:Xa,other:b(1,e(Dd))},function(a){return a.otherRevInfoFormat?"other":"crl"}),Ob=z(Cd),Pb=z(Ed),Fd=f({version:h,digestAlgorithms:wd,encapContentInfo:$a,certificates:d(b(0,
e(Ob))),crls:d(b(1,e(Pb))),signerInfos:vd}),Gd=s({issuerAndSerialNumber:sa,subjectKeyIdentifier:b(0,e(qa))},function(a){return ea(a)?"subjectKeyIdentifier":"issuerAndSerialNumber"}),Hd=f({version:h,rid:Gd,keyEncryptionAlgorithm:pa,encryptedKey:ma}),Qb=f({keyAttrId:k,keyAttr:d(l)}),Id=f({subjectKeyIdentifier:qa,date:d(y),other:d(Qb)}),Jd=s({issuerAndSerialNumber:sa,rKeyId:b(0,e(Id))},function(a){return ea(a)?"rKeyId":"issuerAndSerialNumber"}),Kd=f({rid:Jd,encryptedKey:ma}),Ld=m(Kd),Rb=f({algorithm:Y,
publicKey:q});f({ephemeralPublicKey:Rb,addedukm:d(b(0,p(g)))});var Md=s({issuerAndSerialNumber:sa,subjectKeyIdentifier:b(0,e(qa)),originatorKey:b(1,e(Rb))},function(a){return ea(a)?"subjectKeyIdentifier":a.algorithm?"originatorKey":"issuerAndSerialNumber"}),Nd=f({version:h,originator:b(0,p(Md)),ukm:d(b(1,p(g))),keyEncryptionAlgorithm:pa,recipientEncryptedKeys:Ld}),Od=f({keyIdentifier:g,date:d(y),other:d(Qb)}),Pd=f({version:h,kekid:Od,keyEncryptionAlgorithm:pa,encryptedKey:ma}),Qd=f({version:h,friendlyName:d(b(0,
e(Qa))),keyEncryptionAlgorithm:pa,encryptedKey:ma}),Rd=f({oriType:k,oriValue:l}),Sd=s({ktri:Hd,kari:b(1,e(Nd)),kekri:b(2,e(Pd)),pwri:b(3,e(Qd)),ori:b(4,e(Rd))},function(a){return a.rid?"ktri":a.originator?"kari":a.kekid?"kekri":a.oriType?"ori":"pwri"}),ab=f({certs:d(b(0,e(Ob))),crls:d(b(1,e(Pb)))}),bb=z(Sd),cb=f({contentType:ra,contentEncryptionAlgorithm:Ac,encryptedContent:d(b(0,e(g)))}),Ea=f({version:h,originatorInfo:d(b(0,e(ab))),recipientInfos:bb,encryptedContentInfo:cb,unprotectedAttrs:d(b(1,
e(F)))}),Td=f({version:h,digestAlgorithm:ja,encapContentInfo:$a,digest:g}),Sb=f({version:h,encryptedContentInfo:cb,unprotectedAttrs:d(b(1,e(F)))}),Ud=f({version:h,originatorInfo:d(b(0,e(ab))),recipientInfos:bb,macAlgorithm:Pa,digestAlgorithm:d(b(1,ja)),encapContentInfo:$a,authAttrs:d(b(2,e(Da))),mac:g,unauthAttrs:d(b(3,e(F)))}),Vd=f({version:h,originatorInfo:d(b(0,e(ab))),recipientInfos:bb,authEncryptedContentInfo:cb,authAttrs:d(b(1,e(Da))),mac:g,unauthAttrs:d(b(2,e(F)))}),Wd=s({encrypted:Sb,enveloped:b(0,
e(Ea)),authEnveloped:b(1,e(Vd))},function(a){return a.encryptedContentInfo?a.recipientInfos?"enveloped":"encrypted":"authEnveloped"}),ra=k,ta=I({contentType:ra,content:function(a){return b(0,p(a))}},"contentType","content",void 0,"CMS")({data:g,signedData:E(Fd),envelopedData:E(Ea),digestedData:E(Td),encryptedData:E(Sb),authData:E(Ud),encryptedKeyPkg:E(Wd),aKeyPackage:E(Dc)}),Xd=f({digestAlgorithm:ja,digest:g}),Yd=F({friendlyName:A(Ja),keyProviderNameAttr:A(Ja),localKeyId:A(g),certKeyIdentifierPropId:A(g)}),
Zd=I({certId:k,certValue:function(a){return b(0,p(a))}},"certId","certValue")({x509Certificate:g(P(ia)),sdsiCertificate:ca},g),$d=I({crlId:k,crlValue:function(a){return b(0,p(a))}},"crlId","crlValue")({x509CRL:g(P(Xa))},g),ae=I({secretTypeId:k,secretValue:function(a){return b(0,p(a))}},"secretTypeId","secretValue")({secret:g},g),be=I({bagId:k,bagValue:function(a){return b(0,p(a))},bagAttributes:d(Yd)},"bagId","bagValue")(function(a){return{keyBag:Ta,pkcs8ShroudedKeyBag:ub,certBag:Zd,crlBag:$d,secretBag:ae,
safeContentsBag:Tb}[a]}),Tb=m(be),ce=m(ta),de=f({mac:Xd,macSalt:g,iterations:V(h,1)}),ee=f({version:h,authSafe:ta,macData:d(de)},"PFX"),fe=f({issuer:B,serialNumber:h}),ge=f({intendedAlg:d(b(0,e(r))),symmAlg:d(b(1,e(r))),encSymmKey:d(b(2,e(q))),keyAlg:d(b(3,e(r))),valueHint:d(b(4,e(g))),encValue:q}),ma=s({encryptedValue:ge,envelopedData:b(0,e(Ea))},function(a){return a.encryptedContentInfo?"envelopedData":"encryptedValue"}),he=s({encryptedPrivKey:b(0,ma),keyGenParameters:b(1,e(g)),archiveRemGenPrivKey:b(2,
e(ba))}),ie=f({pubMethod:h({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:d(B)}),Ub=f({action:h({dontPublish:0,pleasePublish:1}),pubInfos:d(m(ie))}),je=h({encrCert:0,challengeResp:1}),Wb=s({thisMessage:b(0,e(q)),subsequentMessage:b(1,e(je)),dhMAC:b(2,e(q)),agreeMAC:b(3,e(Vb)),encryptedKey:b(4,e(Ea))});f({salt:g,owf:r,iterationCount:h,mac:r});var Vb=f({algId:r,value:q}),ke=f({authInfo:s({sender:b(0,p(B)),publicKeyMAC:Vb}),publicKey:ka}),le=f({poposkInput:d(b(0,ke)),algorithmIdentifier:r,signature:q}),
me=s({raVerified:b(0,e(na)),signature:b(1,e(le)),keyEncipherment:b(2,e(Wb)),keyAgreement:b(3,e(Wb))}),ne=m(Ka({regToken:U,authenticator:U,pkiPublicationInfo:Ub,pkiArchiveOptions:he,oldCertID:fe,protocolEncrKey:ka})),oe=f({notBefore:d(b(0,e(da))),notAfter:d(b(1,e(da)))}),Xb=f({version:d(b(0,e(h))),serialNumber:d(b(1,e(h))),signingAlg:d(b(2,e(r))),issuer:d(b(3,e(W))),validity:d(b(4,e(oe))),subject:d(b(5,e(W))),publicKey:d(b(6,e(ka))),issuerUID:d(b(7,e(q))),subjectUID:d(b(8,e(q))),extensions:d(b(9,e(la)))}),
Yb=f({certReqId:h,certTemplate:Xb,controls:d(ne)}),pe=f({privateKey:Ta,identifier:d(s({string:U,generalName:B},function(a){return"string"===typeof a||a instanceof String?"string":"generalName"}))}),Zb=f({certReq:Yb,popo:d(me),regInfo:d(m(Ka({utf8Pairs:U,certReq:Yb,encKeyWithID:pe})))});m(Zb);var $b=f({pendToken:g,pendTime:y}),ac=h({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,partial:7}),bc=h({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,
mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),qe=f({cMCStatus:ac,bodyList:m(h),statusString:d(U),otherInfo:d(s({failInfo:bc,pendInfo:$b}))}),re=f({pkiDataReference:h,certReferences:m(h),extensions:m(xb)}),se=f({pkiDataBodyid:h,bodyIds:m(h)}),te=f({issuerName:B,serialNumber:h}),ue=f({issuerName:W,cRLName:d(B),time:d(y),reasons:d(Va)}),ve=f({issuerName:W,serialNumber:h,reason:Bb,invalidityDate:d(y),passphrase:d(g),comment:d(U)}),
we=f({bodyPartID:h,thePOPAlgID:r,thePOP:g}),cc=s({bodyPartID:h,bodyPartPath:Za}),xe=f({cMCStatus:ac,bodyList:m(cc),statusString:d(U),otherInfo:d(s({failInfo:bc,pendInfo:$b,extendedFailInfo:f({failInfoOID:k,failInfoValue:l})}))}),ye=f({seqNumber:h,hashAlgorithm:r,anchorHashes:m(g)}),db=m(h),ze=f({hashAlg:r,certHashes:m(g),pubInfo:Ub}),Ae=f({pkiDataReference:Za,certReferences:db,replace:V(ba,!0),certTemplate:Xb}),Be=f({bodyList:m(cc)}),Ce=f({proofAlgID:r,macAlgId:r,witness:g}),De=f({keyGenAlgorithm:r,
macAlgorithm:r,witness:g}),Ee=f({bodyPartID:h,certificationRequest:Ab}),dc=f({bodyPartID:h,contentInfo:ta}),ec=f({bodyPartID:h,otherMsgType:k,otherMsgValue:l}),fc=s({tcr:b(0,e(Ee)),crm:b(1,e(Zb)),orm:b(2,e(f({bodyPartID:h,requestMessageType:k,requestMessageValue:l})))}),Fe=f({request:fc,cms:ta,thePOPAlgID:r,witnessAlgID:r,witness:g}),gc=I({bodyPartID:h,attrType:k,attrValues:function(a){return z(a)}},"attrType","attrValues",l)({statusInfo:qe,identification:U,identityProof:g,dataReturn:g,transactionId:h,
senderNonce:g,recipientNonce:g,addExtensions:re,encryptedPOP:Fe,decryptedPOP:we,lraPOPWitness:se,getCert:te,getCRL:ue,revokeRequest:ve,regInfo:g,responseInfo:g,queryPending:g,popLinkRandom:g,popLinkWitness:g,confirmCertAcceptance:sa,statusInfoV2:xe,trustedAnchors:ye,authPublish:h,batchRequests:db,batchResponses:db,publishCert:ze,modCertTemplate:Ae,controlProcessed:Be,popLinkWitnessV2:De,identityProofV2:Ce}),Ge=f({controlSequence:m(gc),reqSequence:m(fc),cmsSequence:m(dc),otherMsgSequence:m(ec)},"PKI REQUEST"),
He=f({controlSequence:m(gc),cmsSequence:m(dc),otherMsgSequence:m(ec)},"PKI RESPONSE");Ia.prototype={GostPrivateKeyInfo:Ec,GostSubjectPublicKeyInfo:Sa,GostKeyContainer:nd,GostKeyContainerName:od,GostPrivateKeys:pd,GostPrivateMasks:qd,ViPNetInfo:rd,GostSignature:Tc,GostEncryptedKey:jd,GostWrappedPrivateKey:Bc,PrivateKeyInfo:Ta,EncryptedPrivateKeyInfo:ub,SubjectPublicKeyInfo:ka,TBSCertificate:yb,Certificate:ia,CertificationRequestInfo:zb,CertificationRequest:Ab,TBSCertList:Cb,CertificateList:Xa,AttributeCertificateInfo:Gb,
AttributeCertificate:Hb,SignedAttributes:Da,UnsignedAttributes:Mb,ContentInfo:ta,SafeContents:Tb,AuthenticatedSafe:ce,PFX:ee,PKIData:Ge,PKIResponse:He};x.asn1=new Ia;return Ia});
