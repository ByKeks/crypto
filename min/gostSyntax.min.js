/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(B,w){"function"===typeof define&&define.amd?define(["gostObject","gostCoding"],w):"object"===typeof exports?module.exports=w(require("gostObject"),require("gostCoding")):B.gostSyntax=w(B.gostObject,B.gostCoding)})(this,function(B,w){function E(a){return(B||(B=C.gostObject)).algorithms[a]}function Ea(a){return(B||(B=C.gostObject)).names[a]}function eb(a){return(B||(B=C.gostObject)).identifiers[a]}function ba(a){return(B||(B=C.gostObject)).attributes[a]}function ca(a){return(B||(B=C.gostObject)).parameters[a]}
function U(){return(w||(w=C.gostCoding)).BER}function x(){for(var a={},c=0,g=arguments.length;c<g;c++){var b=arguments[c];if("object"===typeof b)for(var d in b)a[d]=b[d]}return a}function V(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),g=0,b=a.length;g<b;g++)c[b-g-1]=a[g];return c.buffer}function ec(a,c){return a.length>=c?a:Array(c-a.length+1).join("0")+a}function Fa(a){return 2>=a?a:4>=a?4:8>=a?8:16>=a?16:32>=a?32:64>=a?64:128>=a?128:256>=a?256:512>a?512:
1024>a?1024:void 0}function N(a,c,g,b){var d;if("undefined"===typeof a)throw new I("Invalid value");null===a?d=new String(""):"string"===typeof a||a instanceof String?d=new String(a.toString()):"number"===typeof a||a instanceof Number?d=new Number(a.toString()):"boolean"===typeof a||a instanceof Boolean?d=new Boolean(a?!0:!1):a instanceof Array?d=a.slice(0):a instanceof Date?d=new Date(a.getTime()):a instanceof ArrayBuffer?d=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&
(d=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);d.tagNumber="undefined"!==typeof c?c:5;d.tagClass="undefined"!==typeof g?g:0;d.tagConstructed="undefined"!==typeof b?b:!1;return d}function O(a,c,g,b){if("undefined"===typeof a)throw new I("Invalid value");g="undefined"!==typeof g?g:0;b="undefined"!==typeof b?b:!1;if(void 0!==a.tagClass&&(c!==a.tagNumber&&!(c instanceof Array&&0<=c.indexOf(a.tagNumber))||g!==a.tagClass||b!==a.tagConstructed))throw new I("Invalid format");
b=a;0===g&&5===c?b=null:a instanceof String?b=a.toString():a instanceof Number?b=parseFloat(a):a instanceof Boolean?b=a?!0:!1:a instanceof Array?(b=a.slice(0),b.buffer=a.buffer?a.buffer:(new Uint8Array(new Uint8Array(a.header.buffer,a.header.byteOffset,a.header.byteLength+a.content.byteLength))).buffer):a instanceof Date?b=new Date(a.getTime()):a instanceof ArrayBuffer?b=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(b=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,
a.byteLength))).buffer);return b}var C=this,I=C.DataError||Error,fb=C.NotSupportedError||Error,P={encode:function(a,c){return"0x"+(w||(w=C.gostCoding)).Hex.encode(a,c)},decode:function(a,c,g){a=a.replace("0x","");g=g||Fa(a.length);return(w||(w=C.gostCoding)).Hex.decode(ec(a,g),c)}},Q=function(a){return{encode:function(c){return N(c,a)},decode:function(c){return O(c,a)}}},W=Q(1),Ga=Q(22),sa=Q(19),fc=Q(20),R=Q(12),gc=Q(23),J=Q(24),hc=Q(28),gb=Q(30),ma={encode:function(){return N(null,5)},decode:function(a){return O(a,
5)}},hb=function(a){var c=Q(a);a=function(a){return{encode:function(b){b=a[b];if("undefined"===typeof b)throw new I("Invalid value");return c.encode(b)},decode:function(b){b=c.decode(b);for(var d in a)if(b===a[d])return d}}};a.encode=c.encode;a.decode=c.decode;return a},h=hb(2),ib=hb(10),jb=function(a,c){var g=function(g){c&&c.call&&(g=c(g));return{encode:function(c){g&&(c=g.encode(c));return N(c,a)},decode:function(c){c=O(c,a);g&&(c=g.decode(c));return c}}};g.encode=function(c){return N(c,a)};g.decode=
function(c){return O(c,a)};return g},k=jb(4),q=jb(3,function(a){if(!a||a.encode&&a.decode)return a;var c=[],g;for(g in a)c[a[g]]=g;return{encode:function(a){if(a instanceof Array){for(var g="",b=0;b<c.length;b++)g=c[b]&&0<=a.indexOf(c[b])?g+"1":g+"0";for(;1<g.length&&"0"===g.charAt(g.length-1);)g=g.substring(0,g.length-1)}else g="0";return g},decode:function(a){for(var g=[],b=0;b<a.length;b++)"1"===a.charAt(b)&&c[b]&&g.push(c[b]);return g}}}),d=function(a){return{encode:function(c){var g=[],b;for(b in a){var d=
a[b].encode(c[b]);void 0!==d&&g.push(d)}return N(g,16,0,!0)},decode:function(c){c=O(c,16,0,!0);var g={},b=0,d;for(d in a){var e=a[d].decode(c[b]);void 0!==e&&(g[d]=e,b++)}g.buffer=c.buffer;return g}}},l={encode:function(a){if(!/^(\d+\.)+\d+$/.test(a)&&(a=eb(a),!a))throw new I("Invalid object identifier value");return N(a,6)},decode:function(a){a=O(a,6);return Ea(a)||a}},b=function(a,c){return{encode:function(g){g=c.encode(g);return N(g,a,2,g instanceof Array)},decode:function(g){return c.decode(O(g,
a,2,g instanceof Array))}}},kb=function(a){return function(c,g,b){c=c||y;var d=function(d,e){var f=c.call?c(d):c;return{encode:function(c){var b=[];if(g)for(var d in c)"buffer"!==d&&b.push(f.encode(g(d,c[d],e)));else{d=0;for(var h=c.length;d<h;d++)b.push(f.encode(c[d]))}return N(b,a,0,!0)},decode:function(c){var g=b?{}:[];c=O(c,a,0,!0);if(b)for(var d=0;d<c.length;d++)b(g,f.decode(c[d]));else for(var d=0,e=c.length;d<e;d++)g.push(f.decode(c[d]));g.buffer=c.buffer;return g}}};d.encode=function(g){for(var b=
[],d=0,e=g.length;d<e;d++)b.push(c.encode(g[d]));return N(b,a,0,!0)};d.decode=function(g){g=O(g,a,0,!0);for(var b=[],d=0,e=g.length;d<e;d++)b.push(c.decode(g[d]));b.buffer=g.buffer;return b};return d}},m=kb(16),D=kb(17),F=function(a){return{encode:function(c){return N([a.encode(c)],17,0,!0)},decode:function(c){c=O(c,17,0,!0);return a.decode(c[0])}}},p=function(a,c,g){return a instanceof Array?{encode:function(b){if(c){var d=c(b);if(void 0!==d&&0<=d&&d<a.length){var e=g?g.encode(b,d):b,f=a[d].encode(e);
if(void 0!==f)return f}}for(d=0;d<a.length;d++)try{if(e=g?g.encode(b,d):b,f=a[d].encode(e),void 0!==f)return f}catch(h){}throw new I("Invalid format");},decode:function(c){for(var b=0;b<a.length;b++)try{var d=a[b].decode(c);if(void 0!==d)return g?g.decode(d,b):d}catch(e){}throw new I("Invalid format");}}:{encode:function(c){for(var b in a){var g=c[b];if(void 0!==g)return a[b].encode(g)}throw new I("Invalid format");},decode:function(c){var b={},g;for(g in a)try{var d=a[g].decode(c);if(void 0!==d)return b[g]=
d,b}catch(e){}throw new I("Invalid format");}}},K=function(){var a=function(a){return{encode:function(b){b=a.encode(b);return U().encode(b)},decode:function(b){b=U().decode(b);return a.decode(b)}}};a.encode=function(a){return U().encode(a)};a.decode=function(a){return U().decode(a)};return a}(),f=function(a){return{encode:function(c){return a.encode(c)},decode:function(c){return a.decode(c)}}},t=function(a){return{encode:function(c){return[a.encode(c)]},decode:function(c){return a.decode(c[0])}}},
y={encode:function(a){return a},decode:function(a){return a}},L=function(a,c){return{encode:function(b){return b===c||void 0===b?void 0:a.encode(b)},decode:function(b){if(void 0===b)return c;try{return a.decode(b)}catch(d){}}}},e=function(a){return{encode:function(c){return void 0===c?void 0:a.encode(c)},decode:function(c){if(void 0!==c)try{return a.decode(c)}catch(b){}}}},lb=function(a,c,b){b=b||y;var d=function(d,e){d=d||{};e=e||b;var f=function(a){var c;d&&(c=d.call?d(a):d[a]);return c||e};return{encode:function(b){var d=
f(c.encode(b));return a(d).encode(b)},decode:function(b){var d=f(c.decode(b));return a(d).decode(b)}}};d.encode=function(c){return a(b).encode(c)};d.decode=function(c){return a(b).decode(c)};return d},X=function(a,c,b,e){c=c||"type";b=b||l;return lb(function(c){return d(a(c))},{encode:function(a){return a[c]},decode:function(a){return b.decode(a[0])}},e)},da=p([R,sa,fc,hc,gb],function(a){if(a&&1<a.length){var c=a.charCodeAt(a.length-1);if(5>c)return c}return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?
1:0},{encode:function(a){return a.replace(/[\u0000-\u0004]/g,"")},decode:function(a,c){return a+String.fromCharCode(c)}}),Y=p([J,gc],function(a){return 2050<=a.getYear()?0:1}),Ha=y,Ia=X(function(a){return{type:l,value:a}},"type",l,Ha),mb=F(Ia({serialName:sa,countryName:sa,dnQualifier:sa,emailAddress:Ga,domainComponent:Ga},da)),ic=m(mb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value})(),S=p([ic]),jc=function(){var a={commonName:"CN",serialName:"SN",countryName:"C",localityName:"L",
stateOrProvinceName:"ST",streetAddress:"STREET",organizationName:"O",organizationalUnitName:"OU",title:"TITLE",name:"NAME",givenName:"GNAME",initials:"INITIALS",distinguishedName:"DN",emailAddress:"EMAIL"},c=[],b;for(b in a)c[a[b]]=b;return{encode:function(c){var b=[],d;for(d in c)"buffer"!==d&&b.push((a[d]||eb(d))+"="+c[d]);return b.join(",")},decode:function(a){a=a.split(",");for(var b=0,d=a.length;b<d;b++){var g=a[b].split("="),e=g[0].trim();g[1].trim();c[e]||Ea(e)}}}}(),kc=d({notBefore:Y,notAfter:Y}),
nb=X(function(a){return{type:l,value:a}}),G=D(nb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),Ja=m(nb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),lc=d({a:h,b:h,seed:e(q)}),mc=k({encode:function(a){var c=Math.max(Fa(a.x.length-2),Fa(a.y.length-2))/2,b=new Uint8Array(2*c+1);b[0]=4;b.set(new Uint8Array(P.decode(a.x,!1,c)),1);b.set(new Uint8Array(P.decode(a.y,!1,c)),c+1);return b.buffer},decode:function(a){var c=(a.length-1)/2;return{x:P.encode(new Uint8Array(a,
1,c)),y:P.encode(new Uint8Array(a,c+1,c))}}}),nc=d({fieldType:l,parameters:h}),oc=d({version:h,fieldID:nc,curve:lc,base:mc,order:h,cofactor:e(h)}),pc=d({publicKeyParamSet:l,digestParamSet:l,encryptionParamSet:L(l,"id-Gost28147-89-CryptoPro-A-ParamSet")}),qc=function(a,c){return{encode:function(b){return b===c||void 0===b?ma.encode(null):a.encode(b)},decode:function(b){return void 0===b?void 0:null===b?c:a.decode(b)}}}(l,"id-GostR3411-94-CryptoProParamSet"),rc=p({namedParameters:l,ecParameters:oc,
implicitly:e(ma)}),n=function(){var a=function(a){return d({algorithm:l,parameters:e(a)})},c=function(c){return{encode:function(b){var d=c[b.id];if(d)return a(d.paramType).encode(d.encode(b));throw new fb("Algorithm not supported");},decode:function(b){var d=c[Ea(b[0])];if(d)return d.decode(a(d.paramType).decode(b));throw new fb("Algorithm not supported");}}};c.encode=function(c){return a(y).encode(c)};c.decode=function(c){return a(y).decode(c)};return c}(),Z={paramType:rc,encode:function(a){var c;
c="string"===typeof a.namedCurve?{namedParameters:ba("namedCurve")[a.namedCurve]}:{ecParameters:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.p},curve:{a:a.a,b:a.b},base:{x:a.x,y:a.y},order:a.q,cofactor:1}};return{algorithm:a.id,parameters:c}},decode:function(a){var c=a.parameters;a=E(a.algorithm);if(c.namedParameters)a=x(a,ca(c.namedParameters));else if(c.ecParameters)a=x(a,{p:c.ecParameters.fieldID.parameters,a:c.ecParameters.curve.a,b:c.ecParameters.curve.b,x:c.ecParameters.base.x,
y:c.ecParameters.base.y,q:c.ecParameters.order});else throw new I("Invalid key paramters");return a}},H={paramType:pc,encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:ba(c)[a[c]],digestParamSet:ba("sBox")[b]}}},decode:function(a){var c=a.parameters;return x(E(a.algorithm),
ca(c.publicKeyParamSet),ca(c.digestParamSet))}},r={encode:function(a){return{algorithm:a.id}},decode:function(a){return E(a.algorithm)}},u={paramType:ma,encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return E(a.algorithm)}},ob={paramType:qc,encode:function(a){return{algorithm:a.id,parameters:ba("sBox")[a.sBox||"D-A"]}},decode:function(a){return x(E(a.algorithm),ca(a.parameters))}},ta=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":H,"id-GostR3410-94":H,
"id-tc26-gost3410-12-256":H,"id-tc26-gost3410-12-512":H}),M=n({noSignature:u,rsaEncryption:u,sha1withRSAEncryption:u,sha256withRSAEncryption:u,sha384withRSAEncryption:u,sha512withRSAEncryption:u,ecdsa:r,"ecdsa-with-SHA1":r,"ecdsa-with-SHA256":r,"ecdsa-with-SHA384":r,"ecdsa-with-SHA512":r,"id-GostR3410-94":u,"id-GostR3410-2001":u,"id-GostR3411-94-with-GostR3410-2001":r,"id-GostR3411-94-with-GostR3410-94":r,"id-tc26-gost3410-12-256":u,"id-tc26-gost3410-12-512":u,"id-tc26-signwithdigest-gost3410-12-94":r,
"id-tc26-signwithdigest-gost3410-12-256":r,"id-tc26-signwithdigest-gost3410-12-512":r,"id-sc-gostR3410-94":u,"id-sc-gostR3410-2001":u,"id-sc-gostR3411-94-with-gostR3410-94":u,"id-sc-gostR3411-94-with-gostR3410-2001":u}),ea=n({sha1:u,sha256:u,sha384:u,sha512:u,"id-GostR3411-94":ob,"id-tc26-gost3411-94":ob,"id-tc26-gost3411-12-256":u,"id-tc26-gost3411-12-512":u,"id-sc-gostR3411-94":r}),pb=d({iv:k,encryptionParamSet:l}),sc=d({encryptionParamSet:l,ukm:e(k)}),Ka={paramType:pb,encode:function(a){return{algorithm:a.id,
parameters:{iv:a.iv,encryptionParamSet:ba("sBox")[a.sBox||"E-A"]}}},decode:function(a){var c=x(E(a.algorithm),ca(a.parameters.encryptionParamSet));c.iv=a.parameters.iv;return c}},La={paramType:k,encode:function(a){return{algorithm:a.id,parameters:a.iv}},decode:function(a){var c=x(E(a.algorithm));c.iv=a.parameters||new Uint8Array([0,0,0,0,0,0,0,0]);return c}},fa={paramType:sc,encode:function(a){return{algorithm:a.id,parameters:{encryptionParamSet:ba("sBox")[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=
x(E(a.algorithm),ca(a.parameters.encryptionParamSet));a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}},qb=n({"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa}),$={paramType:qb,encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=x(E(a.algorithm));c.wrapping=a.parameters;return c}},ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":H,"id-GostR3410-94":H,"id-tc26-gost3410-12-256":H,"id-tc26-gost3410-12-512":H,
"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r}),tc=n({"id-sc-gost28147-gfb":La,"id-Gost28147-89":Ka}),Ma=n({"id-Gost28147-89-MAC":pb,"id-HMACGostR3411-94":r,"id-tc26-hmac-gost-3411-12-256":r,"id-tc26-hmac-gost-3411-12-512":r,hmacWithSHA1:r,hmacWithSHA224:r,
hmacWithSHA256:r,hmacWithSHA384:r,hmacWithSHA512:r,"id-sc-gost28147-mac":r,"id-sc-hmacWithGostR3411":r}),uc={paramType:d({salt:p({specified:k,otherSource:n}),iterationCount:h,keyLength:e(h),prf:Ma}),encode:function(a){return{algorithm:a.id,parameters:{salt:{specified:a.salt},iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.salt=a.parameters.salt.specified;c.iterations=a.parameters.iterationCount;c.hmac=a.parameters.prf;return c}},Na=n({PBKDF2:uc}),s={paramType:d({salt:k,
iterationCount:h}),encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=x(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}},Oa={paramType:d({keyDerivationFunc:Na,encryptionScheme:tc}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,encryptionScheme:a.encryption}}},decode:function(a){var c=x(E(a.algorithm));
c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}};n({"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Oa});var vc={paramType:d({keyDerivationFunc:Na,messageAuthScheme:Ma}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,
messageAuthScheme:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;return c}};n({PBMAC1:vc});var wc=n({"id-sc-gost28147-gfb":La,"id-Gost28147-89":Ka,"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Oa}),
ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gost28147-gfb":La,"id-Gost28147-89":Ka,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":H,"id-GostR3410-94":H,"id-tc26-gost3410-12-256":H,"id-tc26-gost3410-12-512":H,"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r,
"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Oa}),xc=k({encode:function(a){var c=new Uint8Array(a.byteLength+1),b=V(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){var c=new Uint8Array(a.byteLength-1),b=c.byteLength/
2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,1,b),b);return V(c)}}),aa=d({algorithm:ta,subjectPublicKey:q}),Pa=function(a){return{encode:function(c){return aa.encode({algorithm:c.algorithm,subjectPublicKey:K.encode(a[c.algorithm.id].encode(c.buffer))})},decode:function(c){c=aa.decode(c);return{algorithm:c.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a[c.algorithm.id].decode(K.decode(c.subjectPublicKey))}}}}({"id-sc-gostR3410-2001":xc,"id-sc-gostR3410-94":{encode:function(a){return h.encode((w||
(w=C.gostCoding)).Int16.encode(V(a)))},decode:function(a){return V((w||(w=C.gostCoding)).Int16.decode(h.decode(a)))}},"id-GostR3410-2001":k,"id-GostR3410-94":k,"id-tc26-gost3410-12-256":k,"id-tc26-gost3410-12-512":k}),rb={encode:function(a){return K(h).encode(P.encode(a,!0))},decode:function(a){return P.decode(K(h).decode(a),!0)}},ua=y,na=d({version:h,privateKeyAlgorithm:ta,privateKey:k,attributes:e(b(0,f(G)))}),yc=d({version:h,privateKeyAlgorithm:ta,privateKey:k,attributes:e(b(0,f(G))),publicKey:e(b(1,
f(q)))}),zc=m(yc),Ac=function(a){return{encode:function(c){return na.encode({version:0,privateKeyAlgorithm:c.algorithm,privateKey:a[c.algorithm.id].encode(c.buffer)})},decode:function(c){c=na.decode(c);return{algorithm:c.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:a[c.privateKeyAlgorithm.id].decode(c.privateKey)}}}}({"id-sc-gostR3410-2001":rb,"id-sc-gostR3410-94":rb,"id-GostR3410-2001":ua,"id-GostR3410-94":ua,"id-tc26-gost3410-12-256":ua,"id-tc26-gost3410-12-512":ua}),
sb=d({encryptionAlgorithm:ga,encryptedData:k}),Bc=d({cA:L(W,!1),pathLenConstraint:e(h)}),Cc=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Dc=m(l),Ec=m({type:l,value:b(0,t(y))}),Fc=d({nameAssigner:e(b(0,f(da))),partyName:e(b(1,f(da)))}),Gc=d({}),z=p({otherName:b(0,f(Ec)),rfc822Name:b(1,f(da)),dNSName:b(2,f(da)),x400Address:b(3,f(Gc)),directoryName:b(4,t(S)),ediPartyName:b(5,f(Fc)),uniformResourceIdentifier:b(6,
f(da)),iPAddress:b(7,f(k)),registeredID:b(8,f(l))}),A=m(z),Qa=d({keyIdentifier:e(b(0,f(k))),authorityCertIssuer:e(b(1,f(A))),authorityCertSerialNumber:e(b(2,f(h)))}),Hc=d({notBefore:e(b(0,f(J))),notAfter:e(b(1,f(J)))}),Ic=d({policyQualifierId:l,qualifier:y}),Jc=d({policyIdentifier:l,policyQualifiers:e(m(Ic))}),Kc=d({issuerDomainPolicy:l,subjectDomainPolicy:l}),Lc=d({base:z,minimum:L(b(0,f(h)),0),maximum:e(b(1,f(h)))}),tb=m(Lc),Mc=d({permittedSubtrees:e(b(0,f(tb))),excludedSubtrees:e(b(1,f(tb)))}),
Nc=d({requireExplicitPolicy:e(b(0,f(h))),inhibitPolicyMapping:e(b(1,f(h)))}),Ra=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),ub=p({fullName:b(0,f(A)),nameRelativeToCRLIssuer:b(1,f(mb))}),Oc=d({distributionPoint:e(b(0,t(ub))),reasons:e(b(1,f(Ra))),cRLIssuer:e(b(2,f(A)))}),va=m(Oc),Sa=d({accessMethod:l,accessLocation:z}),vb=X(function(a){return{extnID:l,critical:L(W,!1),extnValue:k(K(a))}},
"extnID"),oa=m(vb,function(a,c,b){return{extnID:a,critical:b&&b(a,c),extnValue:c}},function(a,c){return a[c.extnID]=c.extnValue}),wa=oa({authorityKeyIdentifier:Qa,subjectKeyIdentifier:k,keyUsage:Cc,privateKeyUsagePeriod:Hc,certificatePolicies:m(Jc),policyMappings:m(Kc),subjectAltName:A,issuerAltName:A,subjectDirectoryAttributes:Ja,basicConstraints:Bc,nameConstraints:Mc,policyConstraints:Nc,extKeyUsage:Dc,cRLDistributionPoints:va,inhibitAnyPolicy:h,freshestCRL:va,authorityInfoAccess:m(Sa),subjectInfoAccess:m(Sa)},
function(a,c){return"keyUsage"===a||"basicConstraints"===a&&void 0===c.pathLenConstraint}),xa=function(){var a=d({r:h,s:h});return{encode:function(c){c=V(c);var b=c.byteLength/2,d=P.encode(new Uint8Array(c,0,b));c=P.encode(new Uint8Array(c,b,b));return U().encode(a.encode({r:c,s:d}))},decode:function(c){var b=a.decode(U().decode(c));c=new Uint8Array(P.decode(b.r));var b=new Uint8Array(P.decode(b.s)),d=new Uint8Array(b.length+c.length);d.set(b,0);d.set(c,b.length);return V(d.buffer)}}}(),T={encode:function(a){return V(a)},
decode:function(a){return V(a)}},wb=function(a){return function(c){var b=a[c.id];return{encode:function(a){b&&(a=b.encode(a));return a},decode:function(a){if(a instanceof ArrayBuffer)return b&&(a=b.decode(a)),a;throw new I("Invalid signature value");}}}}({noSignature:k,"id-GostR3410-94":T,"id-GostR3410-2001":T,"id-GostR3411-94-with-GostR3410-2001":T,"id-GostR3411-94-with-GostR3410-94":T,"id-tc26-gost3410-12-256":T,"id-tc26-gost3410-12-512":T,"id-tc26-signwithdigest-gost3410-12-94":T,"id-tc26-signwithdigest-gost3410-12-256":T,
"id-tc26-signwithdigest-gost3410-12-512":T,"id-sc-gostR3410-94":xa,"id-sc-gostR3410-2001":xa,"id-sc-gostR3411-94-with-gostR3410-94":xa,"id-sc-gostR3411-94-with-gostR3410-2001":xa}),ha=function(a){return{encode:function(c){c=x(c);c.signatureValue=wb(c.signatureAlgorithm).encode(c.signatureValue);return a.encode(c)},decode:function(c){c=a.decode(c);c.signatureValue=wb(c.signatureAlgorithm).decode(c.signatureValue);return c}}},xb=d({version:b(0,t(h)),serialNumber:h,signature:M,issuer:S,validity:kc,subject:S,
subjectPublicKeyInfo:aa,issuerUniqueID:e(b(1,f(q))),subjectUniqueID:e(b(2,f(q))),extensions:e(b(3,t(wa)))}),ya=ha(d({tbsCertificate:xb,signatureAlgorithm:M,signatureValue:q})),Pc=G({challengePassword:F(da),extensionRequest:F(wa),msCertExtensions:F(wa),extendedCertificateAttributes:F(G)}),yb=d({version:h,subject:S,subjectPublicKeyInfo:aa,attributes:b(0,f(Pc))}),zb=ha(d({requestInfo:yb,signatureAlgorithm:M,signatureValue:q})),Ab=ib({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,
superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),Qc=d({distributionPoint:e(b(0,t(ub))),onlyContainsUserCerts:L(b(1,f(W)),!1),onlyContainsCACerts:L(b(2,f(W)),!1),onlySomeReasons:e(b(3,f(Ra))),indirectCRL:L(b(4,f(W)),!1),onlyContainsAttributeCerts:L(b(5,f(W)),!1)}),Rc=oa({authorityKeyIdentifier:Qa,issuerAltName:A,cRLNumber:h,deltaCRLIndicator:h,issuingDistributionPoint:Qc,freshestCRL:va},function(a){return"cRLNumber"===a}),Sc=oa({cRLReason:Ab,
instructionCode:l,invalidityDate:J,certificateIssuer:A}),Bb=d({version:e(h),signature:M,issuer:S,thisUpdate:Y,nextUpdate:e(Y),revokedCertificates:e(m(d({userCertificate:h,revocationDate:Y,crlEntryExtensions:e(Sc)}))),crlExtensions:e(b(0,t(Rc)))}),Ta=ha(d({tbsCertList:Bb,signatureAlgorithm:M,signatureValue:q})),Ua=d({digestedObjectType:ib({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:e(l),digestAlgorithm:ea,objectDigest:q}),za=d({issuer:A,serial:h,issuerUID:e(q)}),Tc=d({issuerName:e(A),
baseCertificateID:e(b(0,f(za))),objectDigestInfo:e(b(1,f(Ua)))}),Uc=d({targetCertificate:za,targetName:e(z),certDigestInfo:e(Ua)}),Vc=p({targetName:b(0,t(z)),targetGroup:b(1,t(z)),targetCert:b(2,f(Uc))}),Wc=m(Vc),Xc=oa({auditIdentity:k,targetInformation:Wc,authorityKeyIdentifier:Qa,authorityInfoAccess:m(Sa),cRLDistributionPoints:va,noRevAvail:ma},function(a){return"auditIdentity"===a||"targetInformation"===a}),Yc=d({baseCertificateID:e(b(0,f(za))),entityName:e(b(1,f(A))),objectDigestInfo:e(b(2,f(Ua)))}),
Zc=p({v1Form:A,v2Form:b(0,f(Tc))}),Cb=d({notBeforeTime:J,notAfterTime:J}),Db=d({service:z,ident:z,authInfo:e(k)}),$c=d({roleAuthority:e(b(0,f(A))),roleName:b(1,t(z))}),ad=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),bd=d({type:b(0,f(l)),value:b(1,f(y))}),cd=d({policyId:b(0,f(l)),classList:L(b(1,f(ad)),["unclassified"]),securityCategories:e(b(2,f(D(bd))))}),Eb=d({policyAuthority:e(b(0,f(A))),values:m(p({octets:k,oid:l,string:R}))}),Fb=d({version:h,holder:Yc,issuer:Zc,
signature:M,serialNumber:h,attrCertValidityPeriod:Cb,attributes:Ja({authenticationInfo:D(Db),accessIdentity:D(Db),chargingIdentity:F(Eb),group:F(Eb),role:D($c),clearance:D(cd)}),issuerUniqueID:e(q),extensions:e(Xc)}),Gb=ha(d({acinfo:Fb,signatureAlgorithm:M,signatureValue:q})),ia=k,pa=k;d({ephemeralPublicKey:Hb,addedukm:e(b(0,t(k)))});d({keyInfo:qb,entityUInfo:e(b(0,t(k))),suppPubInfo:b(2,t(k))});var ja=d({encryptedKey:k,maskKey:e(b(0,f(k))),macKey:k}),dd=d({encryptionParamSet:l,ephemeralPublicKey:e(b(0,
f(Pa))),ukm:k}),Ib=d({sessionEncryptedKey:ja,transportParameters:e(b(0,f(dd)))}),Jb=d({sessionEncryptedKey:ja,ukm:d({ephemeralPublicKey:Pa,addedukm:e(b(0,t(k)))})}),Va=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,8,32))).buffer;a=(new Uint8Array(new Uint8Array(a,40,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(c){var b=a.ukm,d=c.encryptedKey;c=c.macKey;var e=new Uint8Array(b.byteLength+d.byteLength+c.byteLength);e.set(new Uint8Array(b),0);e.set(new Uint8Array(d),
8);e.set(new Uint8Array(c),40);return e}}},ka=function(a){var c=Va(a);return{encode:function(a){return ja.encode(c.encode(a))},decode:function(a){return c.decode(ja.decode(a))}}},Aa=function(a){return{encode:function(c){return Ib.encode({sessionEncryptedKey:Va(a).encode(c),transportParameters:{encryptionParamSet:ba("sBox")[a.wrapping.sBox||"E-A"],ephemeralPublicKey:a["public"],ukm:a.ukm}})},decode:function(c){c=Ib.decode(c);a.wrapping=ca(c.transportParameters.encryptionParamSet);a.ukm=c.transportParameters.ukm;
a["public"]=c.transportParameters.ephemeralPublicKey;return Va(a).decode(c.sessionEncryptedKey)}}},Wa=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey;a=a.macKey;var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),32);return d}}},Kb=function(a){return{encode:function(c){return Jb.encode({sessionEncryptedKey:Wa(a).encode(c),
ukm:{ephemeralPublicKey:a["public"],addedukm:a.ukm}})},decode:function(c){c=Jb.decode(c);a.ukm=c.ukm.addedukm;a["public"]=c.ukm.ephemeralPublicKey;return Wa(a).decode(c.sessionEncryptedKey)}}},Xa=function(a){var c=Wa(a);return{encode:function(a){return ja.encode(c.encode(a))},decode:function(a){return c.decode(ja.decode(a))}}},Ba=function(a){return function(c){var b=a[c.id],b=b&&b.call&&b(c)||b;return{encode:function(a){b&&(a=b.encode(a));return a},decode:function(a){b&&(a=b.decode(a));return a}}}}({"id-sc-gostR3410-2001":Kb,
"id-sc-gostR3410-94":Kb,"id-GostR3410-2001":Aa,"id-GostR3410-94":Aa,"id-tc26-gost3410-12-256":Aa,"id-tc26-gost3410-12-512":Aa,"id-GostR3410-94-CryptoPro-ESDH":ka,"id-GostR3410-2001-CryptoPro-ESDH":ka,"id-tc26-agreement-gost-3410-12-256":ka,"id-tc26-agreement-gost-3410-12-512":ka,"id-sc-r3410-ESDH-r3411kdf":Xa,"id-Gost28147-89-None-KeyWrap":ka,"id-Gost28147-89-CryptoPro-KeyWrap":ka,"id-sc-cmsGostWrap":Xa,"id-sc-cmsGost28147Wrap":Xa}),Ya=function(a){return{encode:function(c){c=x(c);c.encryptedKey=K(Ba(c.keyEncryptionAlgorithm)).encode(c.encryptedKey);
return a.encode(c)},decode:function(c){c=a.decode(c);c.encryptedKey=K(Ba(c.keyEncryptionAlgorithm)).decode(c.encryptedKey);return c}}},la=l,pa=k,Za=m(h),ed=d({bodyPartPath:Za,identifier:l,content:y}),Ca=G({contentType:F(la),messageDigest:F(k),signingTime:F(Y)}),gd=G({countersignature:D(fd),unsignedData:D(ed)}),qa=d({issuer:S,serialNumber:h}),hd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),Lb=ha(d({version:h,sid:hd,digestAlgorithm:ea,signedAttrs:e(b(0,f(Ca))),signatureAlgorithm:M,
signatureValue:k,unsignedAttrs:e(b(1,f(gd)))})),fd=Lb,id=D(Lb),jd=D(ea),kd=d({version:h,certificate:ya,attributes:G}),ld=d({extendedCertificateInfo:kd,signatureAlgorithm:M,signatureValue:q}),md=d({otherCertFormat:l,otherCert:y}),nd=d({version:h,subject:p({baseCertificateID:b(0,f(za)),subjectName:b(1,f(A))}),issuer:A,signature:M,serialNumber:h,attCertValidityPeriod:Cb,attributes:Ja,issuerUniqueID:e(q),extensions:e(wa)}),od=ha(d({acInfo:nd,signatureAlgorithm:M,signatureValue:q})),$a=d({eContentType:la,
eContent:e(b(0,t(k)))}),pd=p({certificate:ya,extendedCertificate:b(0,f(ld)),v1AttrCert:b(1,f(od)),v2AttrCert:b(2,f(Gb)),other:b(3,f(md))}),qd=d({otherRevInfoFormat:l,otherRevInfo:y}),rd=p({crl:Ta,other:b(1,f(qd))}),Mb=D(pd),Nb=D(rd),sd=d({version:h,digestAlgorithms:jd,encapContentInfo:$a,certificates:e(b(0,f(Mb))),crls:e(b(1,f(Nb))),signerInfos:id}),td=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),ud=Ya(d({version:h,rid:td,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Ob=d({keyAttrId:l,
keyAttr:e(y)}),vd=d({subjectKeyIdentifier:pa,date:e(J),other:e(Ob)}),wd=p({issuerAndSerialNumber:qa,rKeyId:b(0,f(vd))}),xd=d({rid:wd,encryptedKey:ia}),yd=m(xd),Hb=d({algorithm:ta,publicKey:q}),zd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa)),originatorKey:b(1,f(Hb))}),Ad=function(a){return{encode:function(c){c=x(c);var b=c.keyEncryptionAlgorithm,d=K(Ba(b));c.recipientEncryptedKeys=c.recipientEncryptedKeys.map(function(a){a=x(a);a.encryptedKey=d.encode(a.encryptedKey);return a});c.ukm=
c.ukm||b.ukm;return a.encode(c)},decode:function(c){c=a.decode(c);var b=c.keyEncryptionAlgorithm;b.ukm=b.ukm||c.ukm;var d=K(Ba(b));c.recipientEncryptedKeys.forEach(function(a){a.encryptedKey=d.decode(a.encryptedKey)});return c}}}(d({version:h,originator:b(0,t(zd)),ukm:e(b(1,t(k))),keyEncryptionAlgorithm:ga,recipientEncryptedKeys:yd})),Bd=d({keyIdentifier:k,date:e(J),other:e(Ob)}),Cd=Ya(d({version:h,kekid:Bd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Dd=Ya(d({version:h,keyDerivationAlgorithm:e(b(0,
f(Na))),keyEncryptionAlgorithm:ga,encryptedKey:ia})),Ed=d({oriType:l,oriValue:y}),Fd=p({ktri:ud,kari:b(1,f(Ad)),kekri:b(2,f(Cd)),pwri:b(3,f(Dd)),ori:b(4,f(Ed))}),ab=d({certs:e(b(0,f(Mb))),crls:e(b(1,f(Nb)))}),bb=D(Fd),cb=d({contentType:la,contentEncryptionAlgorithm:wc,encryptedContent:e(b(0,f(k)))}),Da=d({version:h,originatorInfo:e(b(0,f(ab))),recipientInfos:bb,encryptedContentInfo:cb,unprotectedAttrs:e(b(1,f(G)))}),Gd=d({version:h,digestAlgorithm:ea,encapContentInfo:$a,digest:k}),Pb=d({version:h,
encryptedContentInfo:cb,unprotectedAttrs:e(b(1,f(G)))}),Hd=d({version:h,originatorInfo:e(b(0,f(ab))),recipientInfos:bb,macAlgorithm:Ma,digestAlgorithm:e(b(1,ea)),encapContentInfo:$a,authAttrs:e(b(2,f(Ca))),mac:k,unauthAttrs:e(b(3,f(G)))}),Id=d({version:h,originatorInfo:e(b(0,f(ab))),recipientInfos:bb,authEncryptedContentInfo:cb,authAttrs:e(b(1,f(Ca))),mac:k,unauthAttrs:e(b(2,f(G)))}),Jd=p({encrypted:Pb,enveloped:b(0,f(Da)),authEnveloped:b(1,f(Id))}),la=l,ra=X(function(a){return{contentType:la,content:b(0,
t(a))}},"contentType",la)({data:k,signedData:sd,envelopedData:Da,digestedData:Gd,encryptedData:Pb,authData:Hd,encryptedKeyPkg:Jd,aKeyPackage:zc}),Kd=d({digestAlgorithm:ea,digest:k}),Ld=G({friendlyName:F(gb),localKeyId:F(k)}),Md=X(function(a){return{certId:l,certValue:b(0,t(a))}},"certId",l)({x509Certificate:k(K(ya)),sdsiCertificate:Ga},k),Nd=X(function(a){return{crlId:l,crlValue:b(0,t(a))}},"crlId",l)({x509CRL:k(K(Ta))},k),Od=X(function(a){return{secretTypeId:l,secretValue:b(0,t(a))}},"secretTypeId",
l)({secret:k},k),Pd=X(function(a){return{bagId:l,bagValue:b(0,t(a)),bagAttributes:e(Ld)}},"bagId",l)(function(a){return{keyBag:na,pkcs8ShroudedKeyBag:sb,certBag:Md,crlBag:Nd,secretBag:Od,safeContentsBag:Qb}[a]}),Qb=m(Pd),Qd=m(ra),Rd=d({mac:Kd,macSalt:k,iterations:L(h,1)}),Sd=d({version:h,authSafe:ra,macData:e(Rd)}),Td=d({issuer:z,serialNumber:h}),Ud=d({intendedAlg:e(b(0,f(n))),symmAlg:e(b(1,f(n))),encSymmKey:e(b(2,f(q))),keyAlg:e(b(3,f(n))),valueHint:e(b(4,f(k))),encValue:q}),ia=p({encryptedValue:Ud,
envelopedData:b(0,f(Da))}),Vd=p({encryptedPrivKey:b(0,ia),keyGenParameters:b(1,f(k)),archiveRemGenPrivKey:b(2,f(W))}),Wd=d({pubMethod:h({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:e(z)}),Rb=d({action:h({dontPublish:0,pleasePublish:1}),pubInfos:e(m(Wd))}),Xd=h({encrCert:0,challengeResp:1}),Tb=p({thisMessage:b(0,f(q)),subsequentMessage:b(1,f(Xd)),dhMAC:b(2,f(q)),agreeMAC:b(3,f(Sb)),encryptedKey:b(4,f(Da))});d({salt:k,owf:n,iterationCount:h,mac:n});var Sb=d({algId:n,value:q}),Yd=d({authInfo:p({sender:b(0,
t(z)),publicKeyMAC:Sb}),publicKey:aa}),Zd=d({poposkInput:e(b(0,Yd)),algorithmIdentifier:n,signature:q}),$d=p({raVerified:b(0,f(ma)),signature:b(1,f(Zd)),keyEncipherment:b(2,f(Tb)),keyAgreement:b(3,f(Tb))}),ae=m(Ia({regToken:R,authenticator:R,pkiPublicationInfo:Rb,pkiArchiveOptions:Vd,oldCertID:Td,protocolEncrKey:aa})),be=d({notBefore:e(b(0,f(Y))),notAfter:e(b(1,f(Y)))}),Ub=d({version:e(b(0,f(h))),serialNumber:e(b(1,f(h))),signingAlg:e(b(2,f(n))),issuer:e(b(3,f(S))),validity:e(b(4,f(be))),subject:e(b(5,
f(S))),publicKey:e(b(6,f(aa))),issuerUID:e(b(7,f(q))),subjectUID:e(b(8,f(q))),extensions:e(b(9,f(oa)))}),Vb=d({certReqId:h,certTemplate:Ub,controls:e(ae)}),ce=d({privateKey:na,identifier:e(p([R,z]))}),Wb=d({certReq:Vb,popo:e($d),regInfo:e(m(Ia({utf8Pairs:R,certReq:Vb,encKeyWithID:ce})))});m(Wb);var Xb=d({pendToken:k,pendTime:J}),Yb=h({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,partial:7}),Zb=h({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,
mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),de=d({cMCStatus:Yb,bodyList:m(h),statusString:e(R),otherInfo:e(p({failInfo:Zb,pendInfo:Xb}))}),ee=d({pkiDataReference:h,certReferences:m(h),extensions:m(vb)}),fe=d({request:$b,cms:ra,thePOPAlgID:n,witnessAlgID:n,witness:k}),ge=d({pkiDataBodyid:h,bodyIds:m(h)}),he=d({issuerName:z,serialNumber:h}),ie=d({issuerName:S,cRLName:e(z),time:e(J),reasons:e(Ra)}),je=d({issuerName:S,serialNumber:h,
reason:Ab,invalidityDate:e(J),passphrase:e(k),comment:e(R)}),ke=d({bodyPartID:h,thePOPAlgID:n,thePOP:k}),ac=p({bodyPartID:h,bodyPartPath:Za}),le=d({cMCStatus:Yb,bodyList:m(ac),statusString:e(R),otherInfo:e(p({failInfo:Zb,pendInfo:Xb,extendedFailInfo:d({failInfoOID:l,failInfoValue:Ha})}))}),me=d({seqNumber:h,hashAlgorithm:n,anchorHashes:m(k)}),db=m(h),ne=d({hashAlg:n,certHashes:m(k),pubInfo:Rb}),oe=d({pkiDataReference:Za,certReferences:db,replace:L(W,!0),certTemplate:Ub}),pe=d({bodyList:m(ac)}),qe=
d({proofAlgID:n,macAlgId:n,witness:k}),re=d({keyGenAlgorithm:n,macAlgorithm:n,witness:k}),bc=lb(function(a){return d({bodyPartID:h,attrType:l,attrValues:D(a)},{encode:function(a){return a.attrType},decode:function(a){return l.decode(a[1])}},Ha)({statusInfo:de,identification:R,identityProof:k,dataReturn:k,transactionId:h,senderNonce:k,recipientNonce:k,addExtensions:ee,encryptedPOP:fe,decryptedPOP:ke,lraPOPWitness:ge,getCert:he,getCRL:ie,revokeRequest:je,regInfo:k,responseInfo:k,queryPending:k,popLinkRandom:k,
popLinkWitness:k,confirmCertAcceptance:qa,statusInfoV2:le,trustedAnchors:me,authData:h,batchRequests:db,batchResponses:db,publishCert:ne,modCertTemplate:oe,controlProcessed:pe,popLinkWitnessV2:re,identityProofV2:qe})}),se=d({bodyPartID:h,certificationRequest:zb}),cc=d({bodyPartID:h,contentInfo:ra}),dc=d({bodyPartID:h,otherMsgType:l,otherMsgValue:y}),$b=p({tcr:b(0,f(se)),crm:b(1,f(Wb)),orm:b(2,f(d({bodyPartID:h,requestMessageType:l,requestMessageValue:y})))}),te=d({controlSequence:m(bc),reqSequence:m($b),
cmsSequence:m(cc),otherMsgSequence:m(dc)}),ue=d({controlSequence:m(bc),cmsSequence:m(cc),otherMsgSequence:m(dc)}),v=function(a,c){return{encode:function(b,d){b=a.encode(b);b=U().encode(b);"PEM"===(d||"DER").toUpperCase()&&(b=(w||(w=C.gostCoding)).PEM.encode(b,c));return b},decode:function(b){if("string"===typeof b||b instanceof String)b=(w||(w=C.gostCoding)).PEM.decode(b,c);b=U().decode(b);return a.decode(b)}}};return{CanocicalName:jc,GostPrivateKeyInfo:v(Ac,"PRIVATE KEY"),GostSubjectPublicKeyInfo:v(Pa,
"PUBLIC KEY"),PrivateKeyInfo:v(na,"PRIVATE KEY"),EncryptedPrivateKeyInfo:v(sb,"ENCRYPTED PRIVATE KEY"),SubjectPublicKeyInfo:v(aa,"PUBLIC KEY"),TBSCertificate:v(xb),Certificate:v(ya,"CERTIFICATE"),CertificationRequestInfo:v(yb),CertificationRequest:v(zb,"CERTIFICATE REQUEST"),TBSCertList:v(Bb),CertificateList:v(Ta,"CRL"),AttributeCertificateInfo:v(Fb),AttributeCertificate:v(Gb,"ATTRIBUTE CERTIFICATE"),SignedAttributes:v(Ca),ContentInfo:v(ra,"CMS"),SafeContents:v(Qb),AuthenticatedSafe:v(Qd),PFX:v(Sd,
"PFX"),PKIData:v(te,"PKI REQUEST"),PKIResponse:v(ue,"PKI RESPONSE")}});
