/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(d,e){"function"===typeof define&&define.amd?define(e):"object"===typeof exports?module.exports=e():d.gostRandom=e()})(this,function(){var d=this.crypto||this.msCrypto,e=this.TypeMismatchError||Error,h=this.QuotaExceededError||Error,f={seed:new Uint8Array(1024),getIndex:0,setIndex:0,set:function(a){1024<=this.setIndex&&(this.setIndex=0);this.seed[this.setIndex++]=a},get:function(){1024<=this.getIndex&&(this.getIndex=0);return this.seed[this.getIndex++]}};if("undefiend"!==typeof document){try{document.addEventListener("mousemove",
function(a){f.set((new Date).getTime()&255^(a.clientX||a.pageX)&255^(a.clientY||a.pageY)&255)},!1)}catch(k){}try{document.addEventListener("keydown",function(a){f.set((new Date).getTime()&255^a.keyCode&255)},!1)}catch(l){}}return{getRandomValues:function(a){if(!a.byteLength)throw new e("Array is not of an integer type (Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, or Uint32Array)");if(65536<a.byteLength)throw new h("Byte length of array can't be greate then 65536");var c=new Uint8Array(a.buffer,
a.byteOffset,a.byteLength);if(d&&d.getRandomValues)d.getRandomValues(c);else for(var b=0,g=c.length;b<g;b++)c[b]=Math.floor(256*Math.random())&255;b=0;for(g=c.length;b<g;b++)c[b]^=f.get();return a}}});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(e,c){"function"===typeof define&&define.amd?define(c):"object"===typeof exports?module.exports=c():e.gostObject=c()})(this,function(){var e=this,c={"1.2.643.2.2":"CryptoPro","1.2.643.2.2.3":"id-GostR3411-94-with-GostR3410-2001","1.2.643.2.2.4":"id-GostR3411-94-with-GostR3410-94","1.2.643.2.2.9":"id-GostR3411-94","1.2.643.2.2.10":"id-HMACGostR3411-94","1.2.643.2.2.13.0":"id-Gost28147-89-None-KeyWrap","1.2.643.2.2.13.1":"id-Gost28147-89-CryptoPro-KeyWrap","1.2.643.2.2.14.0":"id-Gost28147-89-None-KeyMeshing",
"1.2.643.2.2.14.1":"id-Gost28147-89-CryptoPro-KeyMeshing","1.2.643.2.2.19":"id-GostR3410-2001","1.2.643.2.2.20":"id-GostR3410-94","1.2.643.2.2.20.1":"id-GostR3410-94-a","1.2.643.2.2.20.2":"id-GostR3410-94-aBis","1.2.643.2.2.20.3":"id-GostR3410-94-b","1.2.643.2.2.20.4":"id-GostR3410-94-bBis","1.2.643.2.2.21":"id-Gost28147-89","1.2.643.2.2.22":"id-Gost28147-89-MAC","1.2.643.2.2.30.0":"id-GostR3411-94-TestParamSet","1.2.643.2.2.30.1":"id-GostR3411-94-CryptoProParamSet","1.2.643.2.2.30.2":"id-GostR3411-94-CryptoPro-A-ParamSet",
"1.2.643.2.2.30.3":"id-GostR3411-94-CryptoPro-B-ParamSet","1.2.643.2.2.30.4":"id-GostR3411-94-CryptoPro-C-ParamSet","1.2.643.2.2.31.0":"id-Gost28147-89-TestParamSet","1.2.643.2.2.31.1":"id-Gost28147-89-CryptoPro-A-ParamSet","1.2.643.2.2.31.2":"id-Gost28147-89-CryptoPro-B-ParamSet","1.2.643.2.2.31.3":"id-Gost28147-89-CryptoPro-C-ParamSet","1.2.643.2.2.31.4":"id-Gost28147-89-CryptoPro-D-ParamSet","1.2.643.2.2.31.5":"id-Gost28147-89-CryptoPro-Oscar-1-1-ParamSet","1.2.643.2.2.31.6":"id-Gost28147-89-CryptoPro-Oscar-1-0-ParamSet",
"1.2.643.2.2.31.7":"id-Gost28147-89-CryptoPro-RIC-1-ParamSet ","1.2.643.2.2.31.12":"id-Gost28147-89-CryptoPro-tc26-1","1.2.643.2.2.31.13":"id-Gost28147-89-CryptoPro-tc26-2","1.2.643.2.2.31.14":"id-Gost28147-89-CryptoPro-tc26-3","1.2.643.2.2.31.15":"id-Gost28147-89-CryptoPro-tc26-4","1.2.643.2.2.31.16":"id-Gost28147-89-CryptoPro-tc26-5","1.2.643.2.2.31.17":"id-Gost28147-89-CryptoPro-tc26-6","1.2.643.2.2.32.0":"id-GostR3410-94-TestParamSet","1.2.643.2.2.32.2":"id-GostR3410-94-CryptoPro-A-ParamSet",
"1.2.643.2.2.32.3":"id-GostR3410-94-CryptoPro-B-ParamSet","1.2.643.2.2.32.4":"id-GostR3410-94-CryptoPro-C-ParamSet","1.2.643.2.2.32.5":"id-GostR3410-94-CryptoPro-D-ParamSet","1.2.643.2.2.33.1":"id-GostR3410-94-CryptoPro-XchA-ParamSet","1.2.643.2.2.33.2":"id-GostR3410-94-CryptoPro-XchB-ParamSet","1.2.643.2.2.33.3":"id-GostR3410-94-CryptoPro-XchC-ParamSet","1.2.643.2.2.34.2":"temporaryAccessToRC","1.2.643.2.2.34.3":"internetContentSignature","1.2.643.2.2.34.4":"adminRC","1.2.643.2.2.34.5":"operatorRC",
"1.2.643.2.2.34.6":"userRC","1.2.643.2.2.34.7":"clientRC","1.2.643.2.2.34.8":"serverRC","1.2.643.2.2.34.9":"sysAdminRC","1.2.643.2.2.34.10":"arcAdminRC","1.2.643.2.2.34.11":"authorityPersonRC","1.2.643.2.2.34.12":"clientCC","1.2.643.2.2.34.13":"sysAdminCC","1.2.643.2.2.34.14":"arcAdminCC","1.2.643.2.2.34.15":"accessIPSecCA","1.2.643.2.2.34.16":"auditAdminHSM","1.2.643.2.2.34.21":"adminHSM","1.2.643.2.2.34.22":"serverAdminHSH","1.2.643.2.2.34.24":"winlogonCA","1.2.643.2.2.34.25":"timestampServiceUser",
"1.2.643.2.2.34.26":"statusServiceUser","1.2.643.2.2.34.27":"arcAdminHSM","1.2.643.2.2.34.28":"auditorHSM","1.2.643.2.2.35.0":"id-GostR3410-2001-CryptoPro-TestParamSet","1.2.643.2.2.35.1":"id-GostR3410-2001-CryptoPro-A-ParamSet","1.2.643.2.2.35.2":"id-GostR3410-2001-CryptoPro-B-ParamSet","1.2.643.2.2.35.3":"id-GostR3410-2001-CryptoPro-C-ParamSet","1.2.643.2.2.36.0":"id-GostR3410-2001-CryptoPro-XchA-ParamSet","1.2.643.2.2.36.1":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","1.2.643.2.2.37.3.1":"intermediateCertificates",
"1.2.643.2.2.37.3.2":"trustedCertificatesSignature","1.2.643.2.2.37.3.3":"trustedCertificatesExchange","1.2.643.2.2.38.1":"personalBaseProlicy","1.2.643.2.2.38.2":"networkBasePolicy","1.2.643.2.2.47.1":"id-CryptoPro-ocsp-treats-exp-key-or-exp-cert-rev","1.2.643.2.2.47.2":"id-CryptoPro-ocsp-crl-locator","1.2.643.2.2.47.3":"id-CryptoPro-ocsp-instant-revocation-indicator","1.2.643.2.2.47.4":"id-CryptoPro-ocsp-revocation-announcement-reference","1.2.643.2.2.47.5":"id-CryptoPro-ocsp-historical-request",
"1.2.643.2.2.49.2":"limitedLicense","1.2.643.2.2.96":"id-GostR3410-2001-CryptoPro-ESDH","1.2.643.2.2.97":"id-GostR3410-94-CryptoPro-ESDH","1.2.643.2.2.98":"id-GostR3410-2001DH","1.2.643.2.2.99":"id-GostR3410-94DH","1.2.643.3.131.1.1":"INN","1.2.643.3.141.1.1":"RNS FSS","1.2.643.3.141.1.2":"KP FSS","1.2.643.7.1":"tc26","1.2.643.7.1.1.1.1":"id-tc26-gost3410-12-256","1.2.643.7.1.1.1.2":"id-tc26-gost3410-12-512","1.2.643.7.1.1.2.1":"id-tc26-gost3411-94","1.2.643.7.1.1.2.2":"id-tc26-gost3411-12-256","1.2.643.7.1.1.2.3":"id-tc26-gost3411-12-512",
"1.2.643.7.1.1.3.1":"id-tc26-signwithdigest-gost3410-12-94","1.2.643.7.1.1.3.2":"id-tc26-signwithdigest-gost3410-12-256","1.2.643.7.1.1.3.3":"id-tc26-signwithdigest-gost3410-12-512","1.2.643.7.1.1.4.1":"id-tc26-hmac-gost-3411-12-256","1.2.643.7.1.1.4.2":"id-tc26-hmac-gost-3411-12-512","1.2.643.7.1.1.6.1":"id-tc26-agreement-gost-3410-12-256","1.2.643.7.1.1.6.2":"id-tc26-agreement-gost-3410-12-512","1.2.643.7.1.2.1.1.0":"id-tc26-gost-3410-12-256-paramSetTest","1.2.643.7.1.2.1.1.1":"id-tc26-gost-3410-12-256-paramSetA",
"1.2.643.7.1.2.1.1.2":"id-tc26-gost-3410-12-256-paramSetB","1.2.643.7.1.2.1.2.0":"id-tc26-gost-3410-12-512-paramSetTest","1.2.643.7.1.2.1.2.1":"id-tc26-gost-3410-12-512-paramSetA","1.2.643.7.1.2.1.2.2":"id-tc26-gost-3410-12-512-paramSetB","1.2.643.7.1.2.1.2.3":"id-tc26-gost-3410-12-512-paramSetC","1.2.643.7.1.2.1.2.4":"id-tc26-gost-3410-12-512-paramSetD","1.2.643.7.1.2.5.1.1":"id-tc26-gost-28147-param-Z","1.2.643.100.1":"OGRN","1.2.643.100.2.1":"SMEV-person","1.2.643.100.2.2":"SMEV-government","1.2.643.100.3":"SNILS",
"1.2.643.100.4":"KPP","1.2.643.100.5":"OGRNIP","1.2.643.100.6":"internal-government","1.2.643.100.111":"subjectSignTool","1.2.643.100.112":"issuerSignTool","1.2.643.100.113.1":"signToolClassKC1","1.2.643.100.113.2":"signToolClassKC2","1.2.643.100.113.3":"signToolClassKC3","1.2.643.100.113.4":"signToolClassKB1","1.2.643.100.113.5":"signToolClassKB2","1.2.643.100.113.6":"signToolClassKA1","1.2.643.100.114.1":"issuerToolClassKC1","1.2.643.100.114.2":"issuerToolClassKC2","1.2.643.100.114.3":"issuerToolClassKC3",
"1.2.643.100.114.4":"issuerToolClassKB2","1.2.643.100.114.5":"issuerToolClassKB1","1.2.643.100.114.6":"issuerToolClassKA1","1.2.840.10040.4":"x9cm","1.2.840.10040.4.1":"dsa","1.2.840.10040.4.3":"dsa-with-SHA1","1.2.840.10045":"ansi-x962","1.2.840.10045.1":"id-fieldType","1.2.840.10045.1.1":"id-prime-Field","1.2.840.10045.1.2":"id-characteristic-two-field","1.2.840.10045.2.1":"ecPublicKey","1.2.840.10045.3.0":"characteristicTwo","1.2.840.10045.3.1.1":"secp192r1","1.2.840.10045.3.1.2":"prime192v2",
"1.2.840.10045.3.1.3":"prime192v3","1.2.840.10045.3.1.4":"prime239v1","1.2.840.10045.3.1.5":"prime239v2","1.2.840.10045.3.1.6":"prime239v3","1.2.840.10045.3.1.7":"secp256r1","1.2.840.10045.4":"ecdsa","1.2.840.10045.4.1":"ecdsa-with-SHA1","1.2.840.10045.4.2":"ecdsa-with-Recommended","1.2.840.10045.4.4":"ecdsa-with-SHA2","1.2.840.10045.4.4.1":"ecdsa-with-SHA224","1.2.840.10045.4.4.2":"ecdsa-with-SHA256","1.2.840.10045.4.4.3":"ecdsa-with-SHA384","1.2.840.10045.4.4.4":"ecdsa-with-SHA512","1.2.840.113533.7.66.13":"PasswordBasedMac",
"1.3.6.1.4.1.22554.1.1.2.1.2":"pbeWithSHAAndAES128-CBC","1.3.6.1.4.1.22554.1.1.2.1.22":"pbeWithSHAAndAES192-CBC","1.3.6.1.4.1.22554.1.1.2.1.42":"pbeWithSHAAndAES256-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.2":"pbeWithSHA256AndAES128-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.22":"pbeWithSHA256AndAES192-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.42":"pbeWithSHA256AndAES256-CBC","1.2.840.113549":"rsa","1.2.840.113549.1.1.1":"rsaEncryption","1.2.840.113549.1.1.2":"md2withRSAEncryption","1.2.840.113549.1.1.3":"md4withRSAEncryption",
"1.2.840.113549.1.1.4":"md5withRSAEncryption","1.2.840.113549.1.1.5":"sha1withRSAEncryption","1.2.840.113549.1.1.7":"rsaes-oaep","1.2.840.113549.1.1.8":"mgf1","1.2.840.113549.1.1.9":"pSpecified","1.2.840.113549.1.1.10":"rsassa-pss","1.2.840.113549.1.1.11":"sha256withRSAEncryption","1.2.840.113549.1.1.12":"sha384withRSAEncryption","1.2.840.113549.1.1.13":"sha512withRSAEncryption","1.2.840.113549.1.2.7":"hmacWithSHA1","1.2.840.113549.1.2.8":"hmacWithSHA224","1.2.840.113549.1.2.9":"hmacWithSHA256","1.2.840.113549.1.2.10":"hmacWithSHA384",
"1.2.840.113549.1.2.11":"hmacWithSHA512","1.2.840.113549.1.3.1":"dhKeyAgreement","1.2.840.113549.1.5.12":"PBKDF2","1.2.840.113549.1.5.13":"PBES2","1.2.840.113549.1.5.14":"PBMAC1","1.2.840.113549.1.7.1":"data","1.2.840.113549.1.7.2":"signedData","1.2.840.113549.1.7.3":"envelopedData","1.2.840.113549.1.7.4":"signedAndEnvelopedData","1.2.840.113549.1.7.5":"digestedData","1.2.840.113549.1.7.6":"encryptedData","1.2.840.113549.1.9.1":"emailAddress","1.2.840.113549.1.9.2":"unstructuredName","1.2.840.113549.1.9.3":"contentType",
"1.2.840.113549.1.9.4":"messageDigest","1.2.840.113549.1.9.5":"signingTime","1.2.840.113549.1.9.6":"countersignature","1.2.840.113549.1.9.7":"challengePassword","1.2.840.113549.1.9.8":"unstructuredAddress","1.2.840.113549.1.9.9":"extendedCertificateAttributes","1.2.840.113549.1.9.10":"issuerAndSerialNumber","1.2.840.113549.1.9.11":"passwordCheck","1.2.840.113549.1.9.12":"publicKey","1.2.840.113549.1.9.13":"signingDescription","1.2.840.113549.1.9.14":"extensionRequest","1.2.840.113549.1.9.15":"sMimeCapabilities",
"1.2.840.113549.1.9.16":"sMimeObjectIdentifierRegistry","1.2.840.113549.1.9.16.1.2":"authData","1.2.840.113549.1.9.16.1.4 ":"timestampToken","1.2.840.113549.1.9.16.1.17 ":"firmwareLoadReceipt","1.2.840.113549.1.9.16.1.21":"encKeyWithID","1.2.840.113549.1.9.16.1.23":"authEnvelopedData","1.2.840.113549.1.9.16.2":"sMimeAttributes","1.2.840.113549.1.9.16.2.1":"receiptRequest","1.2.840.113549.1.9.16.2.12":"signingCertificate","1.2.840.113549.1.9.16.2.14":"timeStampToken","1.2.840.113549.1.9.16.2.2":"securityLabel",
"1.2.840.113549.1.9.16.2.3":"mlExpansionHistory","1.2.840.113549.1.9.16.2.34":"unsignedData","1.2.840.113549.1.9.16.2.47":"signingCertificateV2","1.2.840.113549.1.9.16.3.5":"ESDH","1.2.840.113549.1.9.20":"friendlyName","1.2.840.113549.1.9.21":"localKeyId","1.2.840.113549.1.9.22":"certTypes","1.2.840.113549.1.9.22.1":"x509Certificate","1.2.840.113549.1.9.22.2":"sdsiCertificate","1.2.840.113549.1.9.23":"crlTypes","1.2.840.113549.1.9.23.1":"x509CRL","1.2.840.113549.1.9.24":"secretTypes","1.2.840.113549.1.9.24.1":"secret",
"1.2.840.113549.1.9.25.1":"pkcs15Token","1.2.840.113549.1.9.25.2":"encryptedPrivateKeyInfo","1.2.840.113549.1.9.25.3":"randomNonce","1.2.840.113549.1.9.25.4":"sequenceNumber","1.2.840.113549.1.9.25.5":"pkcs7PDU","1.2.840.113549.1.9.26.1":"pkcs9String","1.2.840.113549.1.9.26.2":"signingTime","1.2.840.113549.1.9.27.1":"caseIgnoreMatch","1.2.840.113549.1.9.27.2":"signingTimeMatch","1.2.840.113549.1.12.0.1":"pkcs-12","1.2.840.113549.1.12.1":"pbe","1.2.840.113549.1.12.1.1":"pbeWithSHAAnd128BitRC4","1.2.840.113549.1.12.1.2":"pbeWithSHAAnd40BitRC4",
"1.2.840.113549.1.12.1.3":"pbeWithSHAAnd3-KeyTripleDES-CBC","1.2.840.113549.1.12.1.4":"pbeWithSHAAnd2-KeyTripleDES-CBC","1.2.840.113549.1.12.1.5":"pbeWithSHAAnd128BitRC2-CBC","1.2.840.113549.1.12.1.6":"pbewithSHAAnd40BitRC2-CBC","1.2.840.113549.1.12.2.1":"pkcs8-key-shrouding","1.2.840.113549.1.12.3.1":"keyBagId","1.2.840.113549.1.12.3.2":"certAndCRLBagId","1.2.840.113549.1.12.3.3":"secretBagId","1.2.840.113549.1.12.3.4":"safeContentsId","1.2.840.113549.1.12.3.5":"pkcs-8ShroudedKeyBagId","1.2.840.113549.1.12.4.1":"x509CertCRLBagId",
"1.2.840.113549.1.12.4.2":"pkcs-12-SDSICertBag","1.2.840.113549.1.12.10.1.1":"keyBag","1.2.840.113549.1.12.10.1.2":"pkcs8ShroudedKeyBag","1.2.840.113549.1.12.10.1.3":"certBag","1.2.840.113549.1.12.10.1.4":"crlBag","1.2.840.113549.1.12.10.1.5":"secretBag","1.2.840.113549.1.12.10.1.6":"safeContentsBag","1.2.840.113549.2.5":"md-5","1.2.840.113549.3.7":"des-EDE3-CBC","1.3.132.0.34":"secp384r1","1.3.132.0.35":"secp521r1","1.3.132.112":"ecDH","1.3.14.3.2.26":"sha1","1.3.6.1.4.1.311.2.1.14":"msCertExtensions",
"1.3.6.1.4.1.311.17.1":"pkcs-12-key-provider-name-attr","1.3.6.1.4.1.5849":"SignalCom","1.3.6.1.4.1.5849.1.1.1":"id-sc-gost28147-ecb","1.3.6.1.4.1.5849.1.1.2":"id-sc-gost28147-gamma","1.3.6.1.4.1.5849.1.1.3":"id-sc-gost28147-gfb","1.3.6.1.4.1.5849.1.1.4":"id-sc-gost28147-mac","1.3.6.1.4.1.5849.1.1.5":"id-sc-gostR3410-94","1.3.6.1.4.1.5849.1.1.6.1.1.1":"id-sc-gostR3410-94-default","1.3.6.1.4.1.5849.1.1.6.1.1.2":"id-sc-gostR3410-94-test","1.3.6.1.4.1.5849.1.2.1":"id-sc-gostR3411-94","1.3.6.1.4.1.5849.1.3.1":"id-sc-gostR3411-94-with-gostR3410-94",
"1.3.6.1.4.1.5849.1.3.2":"id-sc-gostR3411-94-with-gostR3410-2001","1.3.6.1.4.1.5849.1.4.1":"id-sc-cmsGostWrap","1.3.6.1.4.1.5849.1.4.2":"id-sc-cmsGost28147Wrap","1.3.6.1.4.1.5849.1.5.1":"id-sc-pbeWithGost3411AndGost28147","1.3.6.1.4.1.5849.1.5.2":"id-sc-pbeWithGost3411AndGost28147CFB","1.3.6.1.4.1.5849.1.6.2":"id-sc-gostR3410-2001","1.3.6.1.4.1.5849.1.7.2":"id-sc-hmacWithGostR3411","1.3.6.1.4.1.5849.1.8.1":"id-sc-r3410-ESDH-r3411kdf","1.3.6.1.4.1.5849.1.8.3":"id-sc-ecdh-singlePass-cofactor-r3411kdf",
"1.3.6.1.4.1.5849.2.2.1":"id-sc-gostR3410-2001-publicKey","1.3.6.1.5.5.7.0.12":"attribute-cert","1.3.6.1.5.5.7.1.1":"authorityInfoAccess","1.3.6.1.5.5.7.1.4":"auditIdentity","1.3.6.1.5.5.7.1.6":"aaControls","1.3.6.1.5.5.7.1.10":"ac-proxying","1.3.6.1.5.5.7.1.11":"subjectInfoAccess","1.3.6.1.5.5.7.3.1":"serverAuth","1.3.6.1.5.5.7.3.2":"clientAuth","1.3.6.1.5.5.7.3.3":"codeSigning","1.3.6.1.5.5.7.3.4":"emailProtection","1.3.6.1.5.5.7.3.5":"ipsecEndSystem","1.3.6.1.5.5.7.3.6":"ipsecTunnel","1.3.6.1.5.5.7.3.7":"ipsecUser",
"1.3.6.1.5.5.7.3.8":"timeStamping","1.3.6.1.5.5.7.3.9":"OCSPSigning","1.3.6.1.5.5.7.5.1":"regCtrl","1.3.6.1.5.5.7.5.1.1":"regToken","1.3.6.1.5.5.7.5.1.2":"authenticator","1.3.6.1.5.5.7.5.1.3":"pkiPublicationInfo","1.3.6.1.5.5.7.5.1.4":"pkiArchiveOptions","1.3.6.1.5.5.7.5.1.5":"oldCertID","1.3.6.1.5.5.7.5.1.6":"protocolEncrKey","1.3.6.1.5.5.7.5.2":"regInfo","1.3.6.1.5.5.7.5.2.1":"UTF8Pairs","1.3.6.1.5.5.7.5.2.2":"certReq","1.3.6.1.5.5.7.6.2":"noSignature","1.3.6.1.5.5.7.7.1":"statusInfo","1.3.6.1.5.5.7.7.2":"identification",
"1.3.6.1.5.5.7.7.3":"identityProof","1.3.6.1.5.5.7.7.4":"dataReturn","1.3.6.1.5.5.7.7.5":"transactionId","1.3.6.1.5.5.7.7.6":"senderNonce","1.3.6.1.5.5.7.7.7":"recipientNonce","1.3.6.1.5.5.7.7.8":"addExtensions","1.3.6.1.5.5.7.7.9":"encryptedPOP","1.3.6.1.5.5.7.7.10":"decryptedPOP","1.3.6.1.5.5.7.7.11":"lraPOPWitness","1.3.6.1.5.5.7.7.15":"getCert","1.3.6.1.5.5.7.7.16":"getCRL","1.3.6.1.5.5.7.7.17":"revokeRequest","1.3.6.1.5.5.7.7.18":"regInfo","1.3.6.1.5.5.7.7.19":"responseInfo","1.3.6.1.5.5.7.7.21":"queryPending",
"1.3.6.1.5.5.7.7.22":"popLinkRandom","1.3.6.1.5.5.7.7.23":"popLinkWitness","1.3.6.1.5.5.7.7.24":"confirmCertAcceptance","1.3.6.1.5.5.7.7.25":"statusInfoV2","1.3.6.1.5.5.7.7.26":"trustedAnchors","1.3.6.1.5.5.7.7.27":"authData","1.3.6.1.5.5.7.7.28":"batchRequests","1.3.6.1.5.5.7.7.29":"batchResponses","1.3.6.1.5.5.7.7.30":"publishCert","1.3.6.1.5.5.7.7.31":"modCertTemplate","1.3.6.1.5.5.7.7.32":"controlProcessed","1.3.6.1.5.5.7.7.33":"popLinkWitnessV2","1.3.6.1.5.5.7.7.34":"identityProofV2","1.3.6.1.5.5.7.9.1":"dateOfBirth",
"1.3.6.1.5.5.7.9.2":"placeOfBirth","1.3.6.1.5.5.7.9.3":"gender","1.3.6.1.5.5.7.9.4":"countryOfCitizenship","1.3.6.1.5.5.7.9.5":"countryOfResidence","1.3.6.1.5.5.7.10.1":"authenticationInfo","1.3.6.1.5.5.7.10.2":"accessIdentity","1.3.6.1.5.5.7.10.3":"chargingIdentity","1.3.6.1.5.5.7.10.4":"group","1.3.6.1.5.5.7.10.6":"encAttrs","1.3.6.1.5.5.7.12.2":"PKIData","1.3.6.1.5.5.7.12.3":"PKIResponse","1.3.6.1.5.5.7.48.1.1":"ocsp-basic","1.3.6.1.5.5.7.48.1.2":"ocsp-nonce","1.3.6.1.5.5.7.48.1.3":"ocsp-crl",
"1.3.6.1.5.5.7.48.1.4":"ocsp-response","1.3.6.1.5.5.7.48.1.5":"ocsp-nocheck","1.3.6.1.5.5.7.48.1.6":"ocsp-archive-cutoff","1.3.6.1.5.5.7.48.1.7":"ocsp-service-locator","2.16.840.1.101.2.1.2.78.2":"encryptedKeyPkg","2.16.840.1.101.2.1.2.78.3":"keyPackageReceipt","2.16.840.1.101.2.1.2.78.5":"aKeyPackage","2.16.840.1.101.2.1.2.78.6":"keyPackageError","2.16.840.1.101.3.4":"nistAlgorithms","2.16.840.1.101.3.4.1":"aes","2.16.840.1.101.3.4.1.1":"aes128-ECB","2.16.840.1.101.3.4.1.2":"aes128-CBC","2.16.840.1.101.3.4.1.3":"aes128-OFB",
"2.16.840.1.101.3.4.1.4":"aes128-CFB","2.16.840.1.101.3.4.1.5":"aes128-wrap","2.16.840.1.101.3.4.1.6":"aes128-GCM","2.16.840.1.101.3.4.1.7":"aes128-CCM","2.16.840.1.101.3.4.1.8":"aes128-wrap-pad","2.16.840.1.101.3.4.1.21":"aes192-ECB","2.16.840.1.101.3.4.1.22":"aes192-CBC","2.16.840.1.101.3.4.1.23":"aes192-OFB","2.16.840.1.101.3.4.1.24":"aes192-CFB","2.16.840.1.101.3.4.1.25":"aes192-wrap","2.16.840.1.101.3.4.1.26":"aes192-GCM","2.16.840.1.101.3.4.1.27":"aes192-CCM","2.16.840.1.101.3.4.1.28":"aes192-wrap-pad",
"2.16.840.1.101.3.4.1.41":"aes256-ECB","2.16.840.1.101.3.4.1.42":"aes256-CBC","2.16.840.1.101.3.4.1.43":"aes256-OFB","2.16.840.1.101.3.4.1.44":"aes256-CFB","2.16.840.1.101.3.4.1.45":"aes256-wrap","2.16.840.1.101.3.4.1.46":"aes256-GCM","2.16.840.1.101.3.4.1.47":"aes256-CCM","2.16.840.1.101.3.4.1.48":"aes256-wrap-pad","2.16.840.1.101.3.4.2.1":"sha256","2.16.840.1.101.3.4.2.2":"sha384","2.16.840.1.101.3.4.2.3":"sha512","2.16.840.1.113730.3.1.216":"userPKCS12","2.5.1.5.55":"clearance","2.5.4.0":"objectClass",
"2.5.4.1":"aliasedEntryName","2.5.4.2":"knowldgeinformation","2.5.4.3":"commonName","2.5.4.5":"serialName","2.5.4.6":"countryName","2.5.4.7":"localityName","2.5.4.8":"stateOrProvinceName","2.5.4.9":"streetAddress","2.5.4.10":"organizationName","2.5.4.11":"organizationalUnitName","2.5.4.12":"title","2.5.4.13":"description","2.5.4.14":"searchGuide","2.5.4.15":"businessCategory","2.5.4.16":"postalAddress","2.5.4.17":"postalCode","2.5.4.18":"postOfficeBox","2.5.4.19":"physicalDeliveryOfficeName","2.5.4.20":"telephoneNumber",
"2.5.4.21":"telexNumber","2.5.4.22":"teletexTerminalIdentifie","2.5.4.23":"facsimileTelephoneNumber","2.5.4.24":"x121Address","2.5.4.25":"internationalISDNNumber","2.5.4.26":"registeredAddress","2.5.4.27":"destinationIndicator","2.5.4.28":"preferredDeliveryMethod","2.5.4.29":"presentationAddress","2.5.4.30":"supportedApplicationContext","2.5.4.31":"member","2.5.4.32":"owner","2.5.4.33":"roleOccupant","2.5.4.34":"seeAlso","2.5.4.35":"userPassword","2.5.4.36":"userCertificate","2.5.4.37":"cACertificate",
"2.5.4.38":"authorityRevocationList","2.5.4.39":"certificateRevocationList","2.5.4.40":"crossCertificatePair","2.5.4.41":"name","2.5.4.42":"givenName","2.5.4.43":"initials","2.5.4.44":"generationQualifier","2.5.4.45":"uniqueIdentifier","2.5.4.46":"dnQualifier","2.5.4.47":"enhancedSearchGuide","2.5.4.48":"protocolInformation","2.5.4.49":"distinguishedName","2.5.4.50":"uniqueMember","2.5.4.51":"houseIdentifier","2.5.4.52":"supportedAlgorithms","2.5.4.53":"deltaRevocationList","2.5.4.58":"attributeCertificate",
"2.5.4.65":"pseudonym","2.5.4.72":"role","2.5.29.1":"authorityKeyIdentifier","2.5.29.2":"keyAttributes","2.5.29.3":"certificatePolicies","2.5.29.4":"keyUsageRestriction","2.5.29.5":"policyMapping","2.5.29.6":"subtreesConstraint","2.5.29.7":"subjectAltName","2.5.29.8":"issuerAltName","2.5.29.9":"subjectDirectoryAttributes","2.5.29.10":"basicConstraints","2.5.29.11":"nameConstraints","2.5.29.12":"policyConstraints","2.5.29.13":"basicConstraints","2.5.29.14":"subjectKeyIdentifier","2.5.29.15":"keyUsage",
"2.5.29.16":"privateKeyUsagePeriod","2.5.29.17":"subjectAltName","2.5.29.18":"issuerAltName","2.5.29.19":"basicConstraints","2.5.29.20":"cRLNumber","2.5.29.21":"cRLReason","2.5.29.22":"expirationDate","2.5.29.23":"instructionCode","2.5.29.24":"invalidityDate","2.5.29.25":"cRLDistributionPoints","2.5.29.26":"issuingDistributionPoint","2.5.29.27":"deltaCRLIndicator","2.5.29.28":"issuingDistributionPoint","2.5.29.29":"certificateIssuer","2.5.29.30":"nameConstraints","2.5.29.31":"cRLDistributionPoints",
"2.5.29.32":"certificatePolicies","2.5.29.33":"policyMappings","2.5.29.34":"policyConstraints","2.5.29.35":"authorityKeyIdentifier","2.5.29.36":"policyConstraints","2.5.29.37":"extKeyUsage","2.5.29.46":"freshestCRL","2.5.29.54":"inhibitAnyPolicy","2.5.29.55":"targetInformation","2.5.29.56":"noRevAvail"},g={},d;for(d in c)g[c[d]]=d;var a={"id-GostR3411-94-with-GostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94","id-GostR3411-94-with-GostR3410-94":"GOST R 34.10-94/GOST R 34.11-94","id-GostR3411-94":"GOST R 34.11-94",
"id-HMACGostR3411-94":"GOST R 34.11-94-HMAC","id-Gost28147-89-None-KeyWrap":"GOST 28147-89-KW","id-Gost28147-89-CryptoPro-KeyWrap":"GOST 28147-89-CPKW","id-GostR3410-2001":"GOST R 34.10-2001","id-GostR3410-94":"GOST R 34.10-94","id-GostR3410-94-a":"GOST R 34.10-94","id-GostR3410-94-aBis":"GOST R 34.10-94","id-GostR3410-94-b":"GOST R 34.10-94","id-GostR3410-94-bBis":"GOST R 34.10-94","id-Gost28147-89":"GOST 28147-89","id-Gost28147-89-MAC":"GOST 28147-89-MAC","id-GostR3410-2001-CryptoPro-ESDH":"GOST R 34.10-2001-DH/GOST R 34.11-94",
"id-GostR3410-94-CryptoPro-ESDH":"GOST R 34.10-94-DH/GOST R 34.11-94","id-GostR3410-2001DH":"GOST R 34.10-2001-DH","id-GostR3410-94DH":"GOST R 34.10-94-DH","id-tc26-gost3410-12-256":"GOST R 34.10-256","id-tc26-gost3410-12-512":"GOST R 34.10-512","id-tc26-gost3411-94":"GOST R 34.11-94","id-tc26-gost3411-12-256":"GOST R 34.11-256","id-tc26-gost3411-12-512":"GOST R 34.11-512","id-tc26-signwithdigest-gost3410-12-94":"GOST R 34.10-256/GOST R 34.11-94","id-tc26-signwithdigest-gost3410-12-256":"GOST R 34.10-256/GOST R 34.11-256",
"id-tc26-signwithdigest-gost3410-12-512":"GOST R 34.10-512/GOST R 34.11-512","id-tc26-hmac-gost-3411-12-256":"GOST R 34.11-256-HMAC","id-tc26-hmac-gost-3411-12-512":"GOST R 34.11-512-HMAC","id-tc26-agreement-gost-3410-12-256":"GOST R 34.10-256-DH/GOST R 34.11-256","id-tc26-agreement-gost-3410-12-512":"GOST R 34.10-512-DH/GOST R 34.11-512","id-sc-gost28147-ecb":"GOST 28147-89-ECB/E-SC","id-sc-gost28147-gamma":"GOST 28147-89-CTR/E-SC","id-sc-gost28147-gfb":"GOST 28147-89-CFB/E-SC","id-sc-gost28147-mac":"GOST 28147-89-MAC/E-SC",
"id-sc-gostR3410-94":"GOST R 34.10-94","id-sc-gostR3410-94-default":"GOST R 34.10-94","id-sc-gostR3410-94-test":"GOST R 34.10-94/S-TEST","id-sc-gostR3411-94":"GOST R 34.11-94/D-SC","id-sc-gostR3411-94-with-gostR3410-94":"GOST R 34.10-94/GOST R 34.11-94/D-SC","id-sc-gostR3411-94-with-gostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94/D-SC","id-sc-cmsGostWrap":"GOST 28147-89-SCKW/E-SC","id-sc-cmsGost28147Wrap":"GOST 28147-89-KW/E-SC","id-sc-pbeWithGost3411AndGost28147":{derivation:{name:"GOST R 34.11-94-PBKDF2/D-SC"},
encryption:{name:"GOST 28147-ECB/E-SC"}},"id-sc-pbeWithGost3411AndGost28147CFB":{derivation:{name:"GOST R 34.11-94-PBKDF2/D-SC"},encryption:{name:"GOST 28147-CFB/E-SC"}},"id-sc-gostR3410-2001":"GOST R 34.10-2001","id-sc-hmacWithGostR3411":"GOST R 34.11-94-HMAC/D-SC","id-sc-r3410-ESDH-r3411kdf":"GOST R 34.10-2001/GOST R 34.11-94/D-SC","id-sc-ecdh-singlePass-cofactor-r3411kdf":"GOST R 34.10-2001-SINGLEPASS/GOST R 34.11-94-KDF/D-SC",rsaEncryption:"RSASSA-PKCS1-v1_5",sha1withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",
hash:{name:"sha-1"}},sha256withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"sha-256"}},sha384withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"sha-384"}},sha512withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"sha-512"}},"rsaes-oaep":"RSA-OAEP","rsassa-pss":"RSA-PSS",ecdsa:"ECDSA","ecdsa-with-SHA1":{name:"ECDSA",hash:{name:"sha-1"}},"ecdsa-with-SHA256":{name:"ECDSA",hash:{name:"sha-256"}},"ecdsa-with-SHA384":{name:"ECDSA",hash:{name:"sha-384"}},"ecdsa-with-SHA512":{name:"ECDSA",
hash:{name:"sha-512"}},"pbeWithSHAAndAES128-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-1"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHAAndAES192-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-1"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHAAndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-1"}},encryption:{name:"AES-CBC",length:256}},"pbeWithSHA256AndAES128-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-256"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHA256AndAES192-CBC":{derivation:{name:"PBKDF2",
hash:{name:"sha-256"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHA256AndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"sha-256"}},encryption:{name:"AES-CBC",length:256}},ecDH:"ECDH",dhKeyAgreement:"DH","aes128-CBC":{name:"AES-CBC",length:128},"aes128-CFB":{name:"AES-CFB",length:128},"aes128-GCM":{name:"AES-GCM",length:128},"aes128-wrap":{name:"AES-KW",length:128},"aes192-CBC":{name:"AES-CBC",length:192},"aes192-CFB":{name:"AES-CFB",length:192},"aes192-GCM":{name:"AES-GCM",length:192},
"aes192-wrap":{name:"AES-KW",length:192},"aes256-CBC":{name:"AES-CBC",length:256},"aes256-CFB":{name:"AES-CFB",length:256},"aes256-GCM":{name:"AES-GCM",length:256},"aes256-wrap":{name:"AES-KW",length:256},sha1:"sha-1",sha256:"sha-256",sha384:"sha-384",sha512:"sha-512",PBKDF2:"PBKDF2",PBES2:{derivation:{name:"PBKDF2"},encryption:{}},PBMAC1:{derivation:{name:"PBKDF2"},hmac:{}},hmacWithSHA1:{name:"HMAC",hash:{name:"sha-1"}},hmacWithSHA256:{name:"HMAC",hash:{name:"sha-256"}},hmacWithSHA384:{name:"HMAC",
hash:{name:"sha-384"}},hmacWithSHA512:{name:"HMAC",hash:{name:"sha-512"}}};for(d in a){var f=a[d];"string"===typeof f&&(f={name:f});f.id=d;a[d]=f}var b={"CP-94":{signature:a["id-GostR3411-94-with-GostR3410-94"],generation:{id:"id-GostR3410-94",name:"GOST R 34.10-94",namedParam:"X-A"},digest:a["id-GostR3411-94"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-HMACGostR3411-94"],agreement:a["id-GostR3410-94-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",
name:"GOST 28147-89",block:"CFB",sBox:"E-A",keyMeshing:"CP"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:1E3}},"CP-01":{signature:a["id-GostR3411-94-with-GostR3410-2001"],generation:{id:"id-GostR3410-2001",name:"GOST R 34.10-2001",namedCurve:"X-256-A"},digest:{id:"id-GostR3411-94",name:"GOST R 34.11-94",sBox:"D-A"},wrapping:{id:"id-Gost28147-89-None-KeyWrap",name:"GOST 28147-89-KW",sBox:"E-A"},transwrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},
hmac:a["id-HMACGostR3411-94"],agreement:a["id-GostR3410-2001-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:1E3}},"TC-256":{signature:a["id-tc26-signwithdigest-gost3410-12-256"],generation:{id:"id-tc26-gost3410-12-256",name:"GOST R 34.10-2012",namedCurve:"X-256-A"},digest:a["id-tc26-gost3411-12-256"],wrapping:{id:"id-Gost28147-89-None-KeyWrap",name:"GOST 28147-89-KW",sBox:"E-A"},transwrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",
name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-tc26-hmac-gost-3411-12-256"],agreement:a["id-tc26-agreement-gost-3410-12-256"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-256-12-PBKDF2",iterations:1E3}},"TC-512":{signature:a["id-tc26-signwithdigest-gost3410-12-512"],generation:{id:"id-tc26-gost3410-12-512",name:"GOST R 34.10-2012-512",namedCurve:"T-512-A"},digest:a["id-tc26-gost3411-12-512"],wrapping:{id:"id-Gost28147-89-None-KeyWrap",
name:"GOST 28147-89-KW",sBox:"E-A"},transwrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-tc26-hmac-gost-3411-12-512"],agreement:a["id-tc26-agreement-gost-3410-12-512"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-512-PBKDF2",iterations:1E3}},"SC-94":{signature:a["id-sc-gostR3411-94-with-gostR3410-94"],generation:{id:"id-sc-gostR3410-94",name:"GOST R 34.10-94",namedParam:"S-A"},
digest:a["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/E-SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])},hmac:a["id-sc-hmacWithGostR3411"],wrapping:["id-sc-cmsGostWrap"],agreement:a["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:1E3},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/D-SC",iterations:1E3},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/E-SC",iv:new Uint8Array([0,
0,0,0,0,0,0,0])}}},"SC-01":{signature:a["id-sc-gostR3411-94-with-gostR3410-2001"],generation:{id:"id-sc-gostR3410-2001",name:"GOST R 34.10-2001",namedCurve:"P-256"},digest:a["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/E-SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])},hmac:a["id-sc-hmacWithGostR3411"],wrapping:a["id-sc-cmsGostWrap"],agreement:a["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:1E3},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",
derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/D-SC",iterations:1E3},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/E-SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])}}},"RSA-1024":{signature:a.sha1withRSAEncryption,generation:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:1024,publicExponent:new Uint8Array([1,0,1])},digest:a.sha1,encryption:a["aes128-CFB"],hmac:a.hmacWithSHA1},"RSA-2048":{signature:a.sha256withRSAEncryption,generation:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",
modulusLength:2048,publicExponent:new Uint8Array([1,0,1])},digest:a.sha256,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA256},"RSA-4096":{signature:a.sha512withRSAEncryption,generation:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:4096,publicExponent:new Uint8Array([1,0,1])},digest:a.sha512,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA512},"ECDSA-256":{signature:a["ecdsa-with-SHA256"],generation:{id:"ecdsa",name:"ECDSA",namedCurve:"P-256"},digest:a.sha256,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA256,
agreement:a.ecDH},"ECDSA-384":{signature:a["ecdsa-with-SHA384"],generation:{id:"ecdsa",name:"ECDSA",namedCurve:"P-384"},digest:a.sha384,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA384,agreement:a.ecDH},"ECDSA-521":{signature:a["ecdsa-with-SHA512"],generation:{id:"ecdsa",name:"ECDSA",namedCurve:"P-521"},digest:a.sha512,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA512,agreement:a.ecDH}};"CP-94 CP-01 TC-256 TC-512 SC-94 SC-01".split(" ").forEach(function(a){a=b[a];a.hmac.hash=a.digest;a.derivation.hash=
a.digest;a.derivation.hmac=a.hmac;a.pbes=a.pbes||{id:"PBES2",derivation:a.derivation,encryption:a.encryption};a.pbmac=a.pbmac||{id:"PBMAC1",derivation:a.derivation,hmac:a.hmac}});"RSA-1024 RSA-2048 RSA-4096 ECDSA-256 ECDSA-384 ECDSA-521".split(" ").forEach(function(a){a=b[a];a.derivation=a.derivation||{id:"PBKDF2",name:"PBKDF2",iterations:1E3,hash:a.digest};a.pbes=a.pbes||{id:"PBES2",derivation:a.derivation,encryption:a.encryption};a.pbmac=a.pbmac||{id:"PBMAC1",derivation:a.derivation,hmac:a.hmac}});
e.crypto&&e.crypto.subtle&&setTimeout(function(){e.crypto.subtle.generateKey(b["RSA-2048"].generation)["catch"](function(){b["RSA-1024"].generation.hash=b["RSA-1024"].digest;b["RSA-2048"].generation.hash=b["RSA-2048"].digest;b["RSA-4096"].generation.hash=b["RSA-4096"].digest;a.rsaEncryption.hash=b["RSA-2048"].digest})});return{names:c,identifiers:g,algorithms:a,parameters:{"id-GostR3410-94-TestParamSet":{namedParam:"S-TEST"},"id-GostR3410-94-CryptoPro-A-ParamSet":{namedParam:"S-A"},"id-GostR3410-94-CryptoPro-B-ParamSet":{namedParam:"S-B"},
"id-GostR3410-94-CryptoPro-C-ParamSet":{namedParam:"S-C"},"id-GostR3410-94-CryptoPro-D-ParamSet":{namedParam:"S-D"},"id-GostR3410-94-CryptoPro-XchA-ParamSet":{namedParam:"X-A"},"id-GostR3410-94-CryptoPro-XchB-ParamSet":{namedParam:"X-B"},"id-GostR3410-94-CryptoPro-XchC-ParamSet":{namedParam:"X-C"},"id-GostR3410-2001-CryptoPro-TestParamSet":{namedCurve:"S-256-TEST"},"id-GostR3410-2001-CryptoPro-A-ParamSet":{namedCurve:"S-256-A"},"id-GostR3410-2001-CryptoPro-B-ParamSet":{namedCurve:"S-256-B"},"id-GostR3410-2001-CryptoPro-C-ParamSet":{namedCurve:"S-256-C"},
"id-GostR3410-2001-CryptoPro-XchA-ParamSet":{namedCurve:"X-256-A"},"id-GostR3410-2001-CryptoPro-XchB-ParamSet":{namedCurve:"X-256-B"},"id-tc26-gost-3410-12-256-paramSetTest":{namedCurve:"T-256-TEST"},"id-tc26-gost-3410-12-256-paramSetA":{namedCurve:"T-256-A"},"id-tc26-gost-3410-12-256-paramSetB":{namedCurve:"T-256-B"},"id-tc26-gost-3410-12-512-paramSetTest":{namedCurve:"T-512-TEST"},"id-tc26-gost-3410-12-512-paramSetA":{namedCurve:"T-512-A"},"id-tc26-gost-3410-12-512-paramSetB":{namedCurve:"T-512-B"},
"id-tc26-gost-3410-12-512-paramSetC":{namedCurve:"T-512-C"},"id-tc26-gost-3410-12-512-paramSetD":{namedCurve:"T-512-D"},secp256r1:{namedCurve:"P-256"},secp384r:{namedCurve:"P-384"},secp521r:{namedCurve:"P-521"},"id-GostR3411-94-TestParamSet":{sBox:"D-TEST"},"id-GostR3411-94-CryptoProParamSet":{sBox:"D-A"},"id-GostR3411-94-CryptoPro-A-ParamSet":{sBox:"D-B"},"id-GostR3411-94-CryptoPro-B-ParamSet":{sBox:"D-C"},"id-GostR3411-94-CryptoPro-C-ParamSet":{sBox:"D-D"},"id-Gost28147-89-TestParamSet":{block:"CTR",
sBox:"E-TEST"},"id-Gost28147-89-CryptoPro-A-ParamSet":{block:"CFB",sBox:"E-A",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-B-ParamSet":{block:"CFB",sBox:"E-B",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-C-ParamSet":{block:"CFB",sBox:"E-C",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-D-ParamSet":{block:"CFB",sBox:"E-D",keyMeshing:"CP"},"id-Gost28147-89-None-KeyMeshing":{keyMeshing:"NO"},"id-Gost28147-89-CryptoPro-KeyMeshing":{keyMeshing:"CP"},"id-tc26-gost-28147-param-Z":{sBox:"E-Z"}},attributes:{sBox:{"D-TEST":"id-GostR3411-94-TestParamSet",
"D-A":"id-GostR3411-94-CryptoProParamSet","D-B":"id-GostR3411-94-CryptoPro-A-ParamSet","D-C":"id-GostR3411-94-CryptoPro-B-ParamSet","D-D":"id-GostR3411-94-CryptoPro-C-ParamSet","E-TEST":"id-Gost28147-89-TestParamSet","E-A":"id-Gost28147-89-CryptoPro-A-ParamSet","E-B":"id-Gost28147-89-CryptoPro-B-ParamSet","E-C":"id-Gost28147-89-CryptoPro-C-ParamSet","E-D":"id-Gost28147-89-CryptoPro-D-ParamSet","E-Z":"id-tc26-gost-28147-param-Z","D-256":"id-tc26-gost3411-12-256","D-512":"id-tc26-gost3411-12-512"},
namedParam:{"S-TEST":"id-GostR3410-94-TestParamSet","S-A":"id-GostR3410-94-CryptoPro-A-ParamSet","S-B":"id-GostR3410-94-CryptoPro-B-ParamSet","S-C":"id-GostR3410-94-CryptoPro-C-ParamSet","S-D":"id-GostR3410-94-CryptoPro-D-ParamSet","X-A":"id-GostR3410-94-CryptoPro-XchA-ParamSet","X-B":"id-GostR3410-94-CryptoPro-XchB-ParamSet","X-C":"id-GostR3410-94-CryptoPro-XchC-ParamSet"},namedCurve:{"S-256-TEST":"id-GostR3410-2001-CryptoPro-TestParamSet","S-256-A":"id-GostR3410-2001-CryptoPro-A-ParamSet","S-256-B":"id-GostR3410-2001-CryptoPro-B-ParamSet",
"S-256-C":"id-GostR3410-2001-CryptoPro-C-ParamSet","X-256-A":"id-GostR3410-2001-CryptoPro-XchA-ParamSet","X-256-B":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","P-256":"secp256r1","T-256-TEST":"id-tc26-gost-3410-12-256-paramSetTest","T-256-A":"id-tc26-gost-3410-12-256-paramSetA","T-256-B":"id-tc26-gost-3410-12-256-paramSetB","T-512-TEST":"id-tc26-gost-3410-12-512-paramSetTest","T-512-A":"id-tc26-gost-3410-12-512-paramSetA","T-512-B":"id-tc26-gost-3410-12-512-paramSetB"}},providers:b}});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(u,t){"function"===typeof define&&define.amd?define(t):"object"===typeof exports?module.exports=t():u.gostCoding=t()})(this,function(){function u(c){if(c instanceof ArrayBuffer)return c;if(c&&c.buffer&&c.buffer instanceof ArrayBuffer)return 0===c.byteOffset&&c.byteLength===c.buffer.byteLength?c.buffer:(new Uint8Array(new Uint8Array(c,c.byteOffset,c.byteLength))).buffer;throw new (t.DataError||Error)("ArrayBuffer or TypedArray required");}var t=this,s={Base64:{decode:function(c){c=c.replace(/[^A-Za-z0-9\+\/]/g,
"");for(var p=c.length,q=3*p+1>>2,b=new Uint8Array(q),m,e=0,d=0,g=0;g<p;g++){m=g&3;var a=c.charCodeAt(g),a=64<a&&91>a?a-65:96<a&&123>a?a-71:47<a&&58>a?a+4:43===a?62:47===a?63:0,e=e|a<<18-6*m;if(3===m||1===p-g){for(m=0;3>m&&d<q;m++,d++)b[d]=e>>>(16>>>m&24)&255;e=0}}return b.buffer},encode:function(c){c=new Uint8Array(u(c));for(var p=2,q="",b=c.length,m=0,e=0;e<b;e++)if(p=e%3,0<e&&0===4*e/3%96&&(q+="\r\n"),m|=c[e]<<(16>>>p&24),2===p||1===b-e){for(var d=18;0<=d;d-=6)var g=m>>>d&63,g=26>g?g+65:52>g?g+
71:62>g?g-4:62===g?43:63===g?47:65,q=q+String.fromCharCode(g);m=0}return q.substr(0,q.length-2+p)+(2===p?"":1===p?"=":"==")}}};s.Chars=function(){var c={1026:128,1027:129,8218:130,1107:131,8222:132,8230:133,8224:134,8225:135,8364:136,8240:137,1033:138,8249:139,1034:140,1036:141,1035:142,1039:143,1106:144,8216:145,8217:146,8220:147,8221:148,8226:149,8211:150,8212:151,8482:153,1113:154,8250:155,1114:156,1116:157,1115:158,1119:159,160:160,1038:161,1118:162,1032:163,164:164,1168:165,166:166,167:167,1025:168,
169:169,1028:170,171:171,172:172,173:173,174:174,1031:175,176:176,177:177,1030:178,1110:179,1169:180,181:181,182:182,183:183,1105:184,8470:185,1108:186,187:187,1112:188,1029:189,1109:190,1111:191},p={},q;for(q in c)p[c[q]]=q;return{decode:function(b,m){m=(m||"win1251").toLowerCase().replace("-","");for(var e=[],d=0,g=b.length;d<g;d++){var a=b.charCodeAt(d);if("utf8"===m)128>a?e.push(a):(2048>a?e.push(192+(a>>>6)):(65536>a?e.push(224+(a>>>12)):(2097152>a?e.push(240+(a>>>18)):(67108864>a?e.push(248+
(a>>>24)):(e.push(252+(a>>>30)),e.push(128+(a>>>24&63))),e.push(128+(a>>>18&63))),e.push(128+(a>>>12&63))),e.push(128+(a>>>6&63))),e.push(128+(a&63)));else if("uncode"===m||"ucs2"===m||"utf16"===m)if(55296>a||57344<=a&&65536>=a)e.push(a>>>8),e.push(a&255);else{if(65536<=a&&1114112>a){var a=a-65536,f=((1047552&a)>>10)+55296,a=(1023&a)+56320;e.push(f>>>8);e.push(f&255);e.push(a>>>8);e.push(a&255)}}else"utf32"===m||"ucs4"===m?(e.push(a>>>24&255),e.push(a>>>16&255),e.push(a>>>8&255),e.push(a&255)):"win1251"===
m?(128<=a&&(a=1040<=a&&1104>a?a-848:c[a]||0),e.push(a)):e.push(a&255)}return(new Uint8Array(e)).buffer},encode:function(b,c){c=(c||"win1251").toLowerCase().replace("-","");for(var e=[],d=new Uint8Array(u(b)),g=0,a=d.length;g<a;g++){var f=d[g];if("utf8"===c)f=252<=f&&254>f&&g+5<a?1073741824*(f-252)+(d[++g]-128<<24)+(d[++g]-128<<18)+(d[++g]-128<<12)+(d[++g]-128<<6)+d[++g]-128:f>>248&&252>f&&g+4<a?(f-248<<24)+(d[++g]-128<<18)+(d[++g]-128<<12)+(d[++g]-128<<6)+d[++g]-128:f>>240&&248>f&&g+3<a?(f-240<<18)+
(d[++g]-128<<12)+(d[++g]-128<<6)+d[++g]-128:224<=f&&240>f&&g+2<a?(f-224<<12)+(d[++g]-128<<6)+d[++g]-128:192<=f&&224>f&&g+1<a?(f-192<<6)+d[++g]-128:f;else if("uncode"===c||"ucs2"===c||"utf16"===c){if(f=(f<<8)+d[++g],55296<=f&&57344>f)var k=f-55296<<10,f=d[++g],f=(f<<8)+d[++g],f=k+(f-56320)+65536}else"utf32"===c||"ucs4"===c?(f=(f<<8)+d[++g],f=(f<<8)+d[++g],f=(f<<8)+d[++g]):"win1251"===c&&128<=f&&(f=192<=f&&256>f?f+848:p[f]||0);e.push(String.fromCharCode(f))}return e.join("")}}}();s.Hex={decode:function(c,
p){c=c.replace(/[^A-fa-f0-9]/g,"");var q=Math.ceil(c.length/2),b=new Uint8Array(q);c=(0<c.length%2?"0":"")+c;if(p&&("string"!==typeof p||0>p.toLowerCase().indexOf("little")))for(var m=0;m<q;m++)b[m]=parseInt(c.substr(2*(q-m-1),2),16);else for(m=0;m<q;m++)b[m]=parseInt(c.substr(2*m,2),16);return b.buffer},encode:function(c,p){var q=[],b=new Uint8Array(u(c)),m=b.length;if(p&&("string"!==typeof p||0>p.toLowerCase().indexOf("little")))for(var e=0;e<m;e++){var d=m-e-1;q[d]=(0<d&&0===d%32?"\r\n":"")+("00"+
b[e].toString(16)).slice(-2)}else for(e=0;e<m;e++)q[e]=(0<e&&0===e%32?"\r\n":"")+("00"+b[e].toString(16)).slice(-2);return q.join("")}};s.Int16={decode:function(c){c=(c||"").replace(/[^\-A-fa-f0-9]/g,"");0===c.length&&(c="0");var p=!1;"-"===c.charAt(0)&&(p=!0,c=c.substring(1));for(;"0"===c.charAt(0)&&1<c.length;)c=c.substring(1);c=(0<c.length%2?"0":"")+c;if(!p&&!/^[0-7]/.test(c)||p&&!/^[0-7]|8[0]+$/.test(c))c="00"+c;for(var q=c.length/2,b=new Uint8Array(q),m=0,q=q-1;0<=q;--q){var e=parseInt(c.substr(2*
q,2),16);p&&0<e+m&&(e=256-e-m,m=1);b[q]=e}return b.buffer},encode:function(c){c=new Uint8Array(u(c));if(0===c.length)return"0x00";for(var p=[],q=127<c[0],b=0,m=c.length-1;0<=m;--m){var e=c[m];q&&0<e+b&&(e=256-e-b,b=1);p[m]=("00"+e.toString(16)).slice(-2)}for(p=p.join("");"0"===p.charAt(0);)p=p.substring(1);return(q?"-":"")+"0x"+p}};s.BER=function(){function c(b,m){"undefined"===typeof b||null===b?b=new String(""):"string"===typeof b?b=new String(b):"number"===typeof b?b=new Number(b):"boolean"===
typeof b&&(b=new Boolean(b));var e=b.tagClass=b.tagClass||0,d;0===e&&(d=b.tagNumber);if("undefined"===typeof d)if(b instanceof String)d=0===e?""===b.toString()?5:/^\-?0x[0-9a-fA-F]+$/.test(b)?2:/^(\d+\.)+\d+$/.test(b)?6:/^[01]+$/.test(b)?3:/^(true|false)$/.test(b)?1:/^[0-9a-fA-F]+$/.test(b)?4:19:/^[0-9a-fA-F]+$/.test(b)?4:19;else if(b instanceof Number)d=2;else if(b instanceof Date)d=24;else if(b instanceof Boolean)d=1;else if(b instanceof Array)d=16;else if(b instanceof ArrayBuffer||b.buffer instanceof
ArrayBuffer)d=4;else throw new (t.DataError||Error)("Unrecognized type for "+b);var g=b.tagConstructed;"undefined"===typeof g&&(g=b.tagConstructed=b instanceof Array);var a;if(b instanceof ArrayBuffer||b.buffer instanceof ArrayBuffer){if(a=new Uint8Array(u(b)),3===d){var f=new Uint8Array(u(a));a=new Uint8Array(f.length+1);a[0]=0;a.set(f,1)}}else if(g)if(b instanceof Array){a=0;for(var k=[],h=f=0,n=b.length;h<n;h++)k[h]=c(b[h],m),a+=k[h].length;g&&"CER"===m&&(k[n]=new Uint8Array(2),a+=2);a=new Uint8Array(a);
h=0;for(n=k.length;h<n;h++)a.set(k[h],f),f+=k[h].length}else throw new (t.DataError||Error)("Constracted block can't be primitive");else switch(d){case 1:a=new Uint8Array(1);a[0]="true"===b.toString()?1:0;break;case 2:case 10:a=s.Int16.decode(b instanceof Number?"0x"+b.toString(16):b.toString());break;case 3:if("string"===typeof b||b instanceof String)for(h=7-(b.length+7)%8,n=Math.ceil(b.length/8),a=new Uint8Array(n+1),a[0]=h,h=0;h<n;h++){for(k=f=0;8>k;k++)var l=8*h+k,f=(f<<1)+(l<b.length?"1"===b.charAt(l)?
1:0:0);a[h+1]=f}break;case 4:a=s.Hex.decode(b instanceof Number?b.toString(16):b);break;case 6:f=b.match(/\d+/g);a=[];for(h=1;h<f.length;h++){n=+f[h];l=[];1===h&&(n+=40*f[0]);do l.push(n&127),n>>>=7;while(n);for(k=l.length-1;0<=k;--k)a.push(l[k]+(0===k?0:128))}a=new Uint8Array(a);break;case 12:a=s.Chars.decode(b,"utf8");break;case 18:case 22:case 19:case 20:case 21:case 25:case 26:case 27:h=0;for(n=b.length;h<n;h++)255<b.charCodeAt(h)&&(d=12);a=12===d?s.Chars.decode(b,"utf8"):s.Chars.decode(b,"ascii");
break;case 23:case 24:a=new Date(b);a.setMinutes(a.getMinutes()+a.getTimezoneOffset());a=(23===d?a.getYear().toString().slice(-2):a.getFullYear().toString())+("00"+(a.getMonth()+1)).slice(-2)+("00"+a.getDate()).slice(-2)+("00"+a.getHours()).slice(-2)+("00"+a.getMinutes()).slice(-2)+("00"+a.getSeconds()).slice(-2)+"Z";a=s.Chars.decode(a,"ascii");break;case 28:a=s.Chars.decode(b,"utf32");break;case 30:a=s.Chars.decode(b,"utf16")}a||(a=new Uint8Array(0));a instanceof ArrayBuffer&&(a=new Uint8Array(a));
b.tagNumber=0===e?d:d=b.tagNumber||0;b.content=a;h=[];n=3===e?192:2===e?128:1===e?64:0;g&&(n|=32);if(31>d)h.push(n|d&31);else{n|=31;h.push(n);n=d;f=[];do f.push(n&127),n>>>=7;while(n);for(k=f.length-1;0<=k;--k)h.push(f[k]+(0===k?0:128))}if(g&&"CER"===m)h.push(128);else if(g=a.length,127<g){n=g;g=[];do g.push(n&255),n>>>=8;while(n);h.push(g.length+128);for(k=g.length-1;0<=k;--k)h.push(g[k])}else h.push(g);g=b.header=new Uint8Array(h);b.typeName=1===e?"Application_"+d:2===e?"["+d.toString()+"]":3===
e?"Private_"+d:q[d]||"Universal_"+d.toString();e=new Uint8Array(g.length+a.length);e.set(g,0);e.set(a,g.length);return e}function p(b,c){var e=c||0,d=b[e++],g=d>>6,a=0!==(d&32),f=d&31;if(31===f){f=0;do{if(9007199254740864<f)throw new (t.DataError||Error)("Convertor not supported tag number more then (2^53 - 1) at position "+c);d=b[e++];f=(f<<7)+(d&127)}while(d&128)}var d=b[e++],k=d&127;if(k!==d){if(6<k)throw new (t.DataError||Error)("Length over 48 bits not supported at position "+c);if(0===k)k=null;
else{for(var h=d=0;h<k;++h)d=(d<<8)+b[e++];k=d}}var n=e,h=null;if(a)if(h=[],null!==k){for(d=n+k;e<d;){var l=p(b,e);h.push(l);e+=l.header.length+l.content.length}if(e!==d)throw new (t.DataError||Error)("Content size is not correct for container starting at offset "+n);}else try{for(;;){l=p(b,e);e+=l.header.length+l.content.length;if(0===l.tagClass&&0===l.tagNumber)break;h.push(l)}k=e-n}catch(u){throw new (t.DataError||Error)("Exception "+u+" while decoding undefined length content at offset "+n);}l=
new String("");e=new Uint8Array(b.buffer,c,n-c);d=new Uint8Array(b.buffer,n,k);if(null===h){if(null===k)throw new (t.DataError||Error)("Invalid tag with undefined length at offset "+n);if(0===g)switch(f){case 1:l=new Boolean(0!==b[n]);break;case 2:case 10:if(6<k)l=new String(s.Int16.encode(d));else{var r=d[0];127<d[0]&&(r-=256);for(h=1;h<k;h++)r=256*r+d[h];l=new Number(r)}break;case 3:if(5<k)l=(new Uint8Array(d.subarray(1))).buffer;else{n=d[0];l=[];for(h=k-1;1<=h;--h){for(k=d[h];8>n;++n)l.push(k>>
n&1?"1":"0");n=0}l=new String(l.reverse().join(""))}break;case 4:l=(new Uint8Array(d)).buffer;break;case 6:for(var l="",v=0,w=0,h=0;h<k;++h)r=d[h],v=(v<<7)+(r&127),w+=7,r&128||(""===l?(r=80>v?40>v?0:1:2,l=r+"."+(v-40*r)):l+="."+v.toString(),w=v=0);if(0<w)throw new (t.DataError||Error)("Incompleted OID at offset "+n);l=new String(l);break;case 16:case 17:l=[];break;case 12:l=new String(s.Chars.encode(d,"utf8"));break;case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:l=new String(s.Chars.encode(d,
"ascii"));break;case 28:l=new String(s.Chars.encode(d,"utf32"));break;case 30:l=new String(s.Chars.encode(d,"utf16"));break;case 23:case 24:k=23===f;l=s.Chars.encode(d,"ascii");r=(k?/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/:/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/).exec(l);if(!r)throw new (t.DataError||
Error)('Unrecognized time format "'+l+'" at offset '+n);k&&(r[1]=+r[1],r[1]+=70>r[1]?2E3:1900);l=new Date(r[1],+r[2]-1,+r[3],+(r[4]||0),+(r[5]||0),+(r[6]||0),+(r[7]||0));k=l.getTimezoneOffset();if(r[8]||23===f)"Z"!==r[8].toUpperCase()&&r[9]&&(k+=parseInt(r[9])),l.setMinutes(l.getMinutes()-k)}else l=(new Uint8Array(d)).buffer}else l=h;k=1===g?"Application_"+f:2===g?"["+f.toString()+"]":3===g?"Private_"+f:q[f]||"Universal_"+f.toString();l.tagConstructed=a;l.tagClass=g;l.tagNumber=f;l.header=e;l.content=
d;l.typeName=k;return l}var q={0:"EOC",1:"BOOLEAN",2:"INTEGER",3:"BIT STRING",4:"OCTET STRING",5:"NULL",6:"OBJECT IDENTIFIER",7:"ObjectDescriptor",8:"EXTERNAL",9:"REAL",10:"ENUMERATED",11:"EMBEDDED PDV",12:"UTF8String",16:"SEQUENCE",17:"SET",18:"NumericString",19:"PrintableString",20:"TeletexString",21:"VideotexString",22:"IA5String",23:"UTCTime",24:"GeneralizedTime",25:"GraphicString",26:"VisibleString",27:"GeneralString",28:"UniversalString",30:"BMPString"};return{encode:function(b,m){return c(b,
m).buffer},decode:function(b){return p(new Uint8Array(u(b)),0)}}}();s.PEM={encode:function(c,p){return(p?"-----BEGIN "+p.toUpperCase()+"-----\r\n":"")+s.Base64.encode(c instanceof ArrayBuffer?c:s.BER.encode(c))+(p?"\r\n-----END "+p.toUpperCase()+"-----":"")},decode:function(c,p,q){var b=/([A-Za-z0-9\+\/\s\=]+)/g.exec(c);b[1].length!==c.length&&(b=!1);!b&&p&&(b=(new RegExp("-----\\s?BEGIN "+p.toUpperCase()+"-----([A-Za-z0-9\\+\\/\\s\\=]+)-----\\s?END "+p.toUpperCase()+"-----","g")).exec(c));b||(b=
RegExp("-----\\s?BEGIN [A-Z0-9\\s]+-----([A-Za-z0-9\\+\\/\\s\\=]+)-----\\s?END [A-Z0-9\\s]+-----","g").exec(c));if(b)c=b[1];else throw new (t.DataError||Error)("Not valid PEM format");c=s.Base64.decode(c);q&&(c=s.BER.decode(c));return c}};return s});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(B,w){"function"===typeof define&&define.amd?define(["gostObject","gostCoding"],w):"object"===typeof exports?module.exports=w(require("gostObject"),require("gostCoding")):B.gostSyntax=w(B.gostObject,B.gostCoding)})(this,function(B,w){function E(a){return(B||(B=D.gostObject)).algorithms[a]}function Da(a){return(B||(B=D.gostObject)).names[a]}function ab(a){return(B||(B=D.gostObject)).identifiers[a]}function ba(a){return(B||(B=D.gostObject)).attributes[a]}function ca(a){return(B||(B=D.gostObject)).parameters[a]}
function T(){return(w||(w=D.gostCoding)).BER}function U(){return(w||(w=D.gostCoding)).Hex}function x(){for(var a={},c=0,l=arguments.length;c<l;c++){var b=arguments[c];if("object"===typeof b)for(var d in b)a[d]=b[d]}return a}function V(a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));for(var c=new Uint8Array(a.length),l=0,b=a.length;l<b;l++)c[b-l-1]=a[l];return c.buffer}function O(a,c,l,b){var d;if("undefined"===typeof a)throw new J("Invalid value");null===a?d=new String(""):"string"===typeof a||
a instanceof String?d=new String(a.toString()):"number"===typeof a||a instanceof Number?d=new Number(a.toString()):"boolean"===typeof a||a instanceof Boolean?d=new Boolean(a?!0:!1):a instanceof Array?d=a.slice(0):a instanceof Date?d=new Date(a.getTime()):a instanceof ArrayBuffer?d=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(d=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);d.tagNumber="undefined"!==typeof c?c:5;d.tagClass="undefined"!==
typeof l?l:0;d.tagConstructed="undefined"!==typeof b?b:!1;return d}function P(a,c,l,b){if("undefined"===typeof a)throw new J("Invalid value");l="undefined"!==typeof l?l:0;b="undefined"!==typeof b?b:!1;if(void 0!==a.tagClass&&(c!==a.tagNumber&&!(c instanceof Array&&0<=c.indexOf(a.tagNumber))||l!==a.tagClass||b!==a.tagConstructed))throw new J("Invalid format");b=a;0===l&&5===c?b=null:a instanceof String?b=a.toString():a instanceof Number?b=parseFloat(a):a instanceof Boolean?b=a?!0:!1:a instanceof Array?
(b=a.slice(0),b.buffer=a.buffer?a.buffer:(new Uint8Array(new Uint8Array(a.header.buffer,a.header.byteOffset,a.header.byteLength+a.content.byteLength))).buffer):a instanceof Date?b=new Date(a.getTime()):a instanceof ArrayBuffer?b=(new Uint8Array(new Uint8Array(a))).buffer:a.buffer instanceof ArrayBuffer&&(b=(new Uint8Array(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))).buffer);return b}var D=this,J=D.DataError||Error,bb=D.NotSupportedError||Error,Q=function(a){return{encode:function(c){return O(c,
a)},decode:function(c){return P(c,a)}}},W=Q(1),Ea=Q(22),cb=Q(19),dc=Q(20),K=Q(12),db=Q(23),F=Q(24),ec=Q(28),eb=Q(30),ma={encode:function(){return O(null,5)},decode:function(a){return P(a,5)}},fb=function(a){var c=Q(a);a=function(a){return{encode:function(b){b=a[b];if("undefined"===typeof b)throw new J("Invalid value");return c.encode(b)},decode:function(b){b=c.decode(b);for(var d in a)if(b===a[d])return d}}};a.encode=c.encode;a.decode=c.decode;return a},g=fb(2),gb=fb(10),hb=function(a,c){var b=function(b){c&&
c.call&&(b=c(b));return{encode:function(c){b&&(c=b.encode(c));return O(c,a)},decode:function(c){c=P(c,a);b&&(c=b.decode(c));return c}}};b.encode=function(c){return O(c,a)};b.decode=function(c){return P(c,a)};return b},h=hb(4),q=hb(3,function(a){if(!a||a.encode&&a.decode)return a;var c=[],b;for(b in a)c[a[b]]=b;return{encode:function(a){if(a instanceof Array){for(var b="",l=0;l<c.length;l++)b=c[l]&&0<=a.indexOf(c[l])?b+"1":b+"0";for(;1<b.length&&"0"===b.charAt(b.length-1);)b=b.substring(0,b.length-
1)}else b="0";return b},decode:function(a){for(var b=[],l=0;l<a.length;l++)"1"===a.charAt(l)&&c[l]&&b.push(c[l]);return b}}}),d=function(a){return{encode:function(c){var b=[],d;for(d in a){var e=a[d].encode(c[d]);void 0!==e&&b.push(e)}return O(b,16,0,!0)},decode:function(c){c=P(c,16,0,!0);var b={},d=0,e;for(e in a){var f=a[e].decode(c[d]);void 0!==f&&(b[e]=f,d++)}b.buffer=c.buffer;return b}}},k={encode:function(a){if(!/^(\d+\.)+\d+$/.test(a)&&(a=ab(a),!a))throw new J("Invalid object identifier value");
return O(a,6)},decode:function(a){a=P(a,6);return Da(a)||a}},b=function(a,c){return{encode:function(b){b=c.encode(b);return O(b,a,2,b instanceof Array)},decode:function(b){return c.decode(P(b,a,2,b instanceof Array))}}},ib=function(a){return function(c,b,d){c=c||y;var e=function(e,f){var g=c.call?c(e):c;return{encode:function(c){var d=[];if(b)for(var e in c)"buffer"!==e&&d.push(g.encode(b(e,c[e],f)));else{e=0;for(var h=c.length;e<h;e++)d.push(g.encode(c[e]))}return O(d,a,0,!0)},decode:function(c){var b=
d?{}:[];c=P(c,a,0,!0);if(d)for(var l=0;l<c.length;l++)d(b,g.decode(c[l]));else for(var l=0,e=c.length;l<e;l++)b.push(g.decode(c[l]));b.buffer=c.buffer;return b}}};e.encode=function(b){for(var l=[],d=0,e=b.length;d<e;d++)l.push(c.encode(b[d]));return O(l,a,0,!0)};e.decode=function(b){b=P(b,a,0,!0);for(var l=[],d=0,e=b.length;d<e;d++)l.push(c.decode(b[d]));l.buffer=b.buffer;return l};return e}},m=ib(16),C=ib(17),G=function(a){return{encode:function(c){return O([a.encode(c)],17,0,!0)},decode:function(c){c=
P(c,17,0,!0);return a.decode(c[0])}}},p=function(a,c){return a instanceof Array?{encode:function(b){if(c)return c(b).encode(b);for(var d=0;d<a.length;d++)try{var e=a[d].encode(b);if(void 0!==e)return e}catch(f){}throw new J("Invalid format");},decode:function(c){for(var b=0;b<a.length;b++)try{var d=a[b].decode(c);if(void 0!==d)return d}catch(e){}throw new J("Invalid format");}}:{encode:function(c){for(var b in a){var d=c[b];if(void 0!==d)return a[b].encode(d)}throw new J("Invalid format");},decode:function(c){var b=
{},d;for(d in a)try{var e=a[d].decode(c);if(void 0!==e)return b[d]=e,b}catch(f){}throw new J("Invalid format");}}},L=function(){var a=function(a){return{encode:function(b){b=a.encode(b);return T().encode(b)},decode:function(b){b=T().decode(b);return a.decode(b)}}};a.encode=function(a){return T().encode(a)};a.decode=function(a){return T().decode(a)};return a}(),f=function(a){return{encode:function(c){return a.encode(c)},decode:function(c){return a.decode(c)}}},t=function(a){return{encode:function(c){return[a.encode(c)]},
decode:function(c){return a.decode(c[0])}}},y={encode:function(a){return a},decode:function(a){return a}},M=function(a,c){return{encode:function(b){return b===c||void 0===b?void 0:a.encode(b)},decode:function(b){if(void 0===b)return c;try{return a.decode(b)}catch(d){}}}},e=function(a){return{encode:function(c){return void 0===c?void 0:a.encode(c)},decode:function(c){if(void 0!==c)try{return a.decode(c)}catch(b){}}}},jb=function(a,c,b){b=b||y;var d=function(d,e){d=d||{};e=e||b;var f=function(a){var c;
d&&(c=d.call?d(a):d[a]);return c||e};return{encode:function(b){var d=f(c.encode(b));return a(d).encode(b)},decode:function(b){var d=f(c.decode(b));return a(d).decode(b)}}};d.encode=function(c){return a(b).encode(c)};d.decode=function(c){return a(b).decode(c)};return d},X=function(a,c,b,e){c=c||"type";b=b||k;return jb(function(c){return d(a(c))},{encode:function(a){return a[c]},decode:function(a){return b.decode(a[0])}},e)},da=p([K,cb,dc,ec,eb],function(a){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(a)?
cb:K}),Y=p([F,db],function(a){return 2050<=a.getYear()?F:db}),Fa=y,Ga=X(function(a){return{type:k,value:a}},"type",k,Fa),kb=G(Ga({emailAddress:Ea,domainComponent:Ea},da)),fc=m(kb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value})(),R=p([fc]),gc=function(){var a={commonName:"CN",serialName:"SN",countryName:"C",localityName:"L",stateOrProvinceName:"ST",streetAddress:"STREET",organizationName:"O",organizationalUnitName:"OU",title:"TITLE",name:"NAME",givenName:"GNAME",initials:"INITIALS",
distinguishedName:"DN",emailAddress:"EMAIL"},c=[],b;for(b in a)c[a[b]]=b;return{encode:function(c){var b=[],d;for(d in c)"buffer"!==d&&b.push((a[d]||ab(d))+"="+c[d]);return b.join(",")},decode:function(a){a=a.split(",");for(var b=0,d=a.length;b<d;b++){var e=a[b].split("="),l=e[0].trim();e[1].trim();c[l]||Da(l)}}}}(),hc=d({notBefore:Y,notAfter:Y}),lb=X(function(a){return{type:k,value:a}}),H=C(lb,function(a,c){return{type:a,value:c}},function(a,c){a[c.type]=c.value}),Ha=m(lb,function(a,c){return{type:a,
value:c}},function(a,c){a[c.type]=c.value}),ic=d({a:g,b:g,seed:e(q)}),jc=h({encode:function(a){return U().decode("04"+a.x.replace("0x","")+a.y.replace("0x",""))},decode:function(a){a=U().encode(a).replace(/[^A-fa-f0-9]/g,"").substring(2);return{x:"0x"+a.substring(0,a.length/2),y:"0x"+a.substring(a.length/2)}}}),kc=d({fieldType:k,parameters:g}),lc=d({version:g,fieldID:kc,curve:ic,base:jc,order:g,cofactor:e(g)}),mc=d({publicKeyParamSet:k,digestParamSet:k,encryptionParamSet:M(k,"id-Gost28147-89-CryptoPro-A-ParamSet")}),
nc=function(a,c){return{encode:function(b){return b===c||void 0===b?ma.encode(null):a.encode(b)},decode:function(b){return void 0===b?void 0:null===b?c:a.decode(b)}}}(k,"id-GostR3411-94-CryptoProParamSet"),oc=p({namedParameters:k,ecParameters:lc,implicitly:e(ma)}),n=function(){var a=function(a){return d({algorithm:k,parameters:e(a)})},c=function(c){return{encode:function(b){var d=c[b.id];if(d)return a(d.paramType).encode(d.encode(b));throw new bb("Algorithm not supported");},decode:function(b){var d=
c[Da(b[0])];if(d)return d.decode(a(d.paramType).decode(b));throw new bb("Algorithm not supported");}}};c.encode=function(c){return a(y).encode(c)};c.decode=function(c){return a(y).decode(c)};return c}(),Z={paramType:oc,encode:function(a){var c;c="string"===typeof a.namedCurve?{namedParameters:ba("namedCurve")[a.namedCurve]}:{ecParameters:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:a.p},curve:{a:a.a,b:a.b},base:{x:a.x,y:a.y},order:a.q,cofactor:1}};return{algorithm:a.id,parameters:c}},
decode:function(a){var c=a.parameters;a=E(a.algorithm);if(c.namedParameters)a=x(a,ca(c.namedParameters));else if(c.ecParameters)a=x(a,{p:c.ecParameters.fieldID.parameters,a:c.ecParameters.curve.a,b:c.ecParameters.curve.b,x:c.ecParameters.base.x,y:c.ecParameters.base.y,q:c.ecParameters.order});else throw new J("Invalid key paramters");return a}},I={paramType:mc,encode:function(a){var c=a.namedCurve?"namedCurve":"namedParam",b=0<=a.name.indexOf("-94")||0<=a.name.indexOf("-2001")||1994===a.version||
2001===a.version?a.sBox||"D-A":0<=a.name.indexOf("-512")||512===a.length?"D-512":"D-256";return{algorithm:a.id,parameters:{publicKeyParamSet:ba(c)[a[c]],digestParamSet:ba("sBox")[b]}}},decode:function(a){var c=a.parameters;return x(E(a.algorithm),ca(c.publicKeyParamSet),ca(c.digestParamSet))}},r={encode:function(a){return{algorithm:a.id}},decode:function(a){return E(a.algorithm)}},u={paramType:ma,encode:function(a){return{algorithm:a.id,parameters:null}},decode:function(a){return E(a.algorithm)}},
mb={paramType:nc,encode:function(a){return{algorithm:a.id,parameters:ba("sBox")[a.sBox||"D-A"]}},decode:function(a){return x(E(a.algorithm),ca(a.parameters))}},sa=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":I,"id-GostR3410-94":I,"id-tc26-gost3410-12-256":I,"id-tc26-gost3410-12-512":I}),N=n({noSignature:u,rsaEncryption:u,sha1withRSAEncryption:u,sha256withRSAEncryption:u,sha384withRSAEncryption:u,sha512withRSAEncryption:u,ecdsa:r,"ecdsa-with-SHA1":r,"ecdsa-with-SHA256":r,
"ecdsa-with-SHA384":r,"ecdsa-with-SHA512":r,"id-GostR3410-94":u,"id-GostR3410-2001":u,"id-GostR3411-94-with-GostR3410-2001":r,"id-GostR3411-94-with-GostR3410-94":r,"id-tc26-gost3410-12-256":u,"id-tc26-gost3410-12-512":u,"id-tc26-signwithdigest-gost3410-12-94":r,"id-tc26-signwithdigest-gost3410-12-256":r,"id-tc26-signwithdigest-gost3410-12-512":r,"id-sc-gostR3410-94":u,"id-sc-gostR3410-2001":u,"id-sc-gostR3411-94-with-gostR3410-94":u,"id-sc-gostR3411-94-with-gostR3410-2001":u}),ea=n({sha1:u,sha256:u,
sha384:u,sha512:u,"id-GostR3411-94":mb,"id-tc26-gost3411-94":mb,"id-tc26-gost3411-12-256":u,"id-tc26-gost3411-12-512":u,"id-sc-gostR3411-94":r}),nb=d({iv:h,encryptionParamSet:k}),pc=d({encryptionParamSet:k,ukm:e(h)}),ob={paramType:nb,encode:function(a){return{algorithm:a.id,parameters:{iv:a.iv,encryptionParamSet:ba("sBox")[a.sBox||"E-A"]}}},decode:function(a){var c=x(E(a.algorithm),ca(a.parameters.encryptionParamSet));c.iv=a.parameters.iv;return c}},fa={paramType:pc,encode:function(a){return{algorithm:a.id,
parameters:{encryptionParamSet:ba("sBox")[a.sBox||"E-A"],ukm:a.ukm}}},decode:function(a){var c=x(E(a.algorithm),ca(a.parameters.encryptionParamSet));a.parameters.ukm&&(c.ukm=a.parameters.ukm);return c}},pb=n({"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa}),$={paramType:pb,encode:function(a){return{algorithm:a.id,parameters:a.wrapping}},decode:function(a){var c=x(E(a.algorithm));c.wrapping=a.parameters;return c}},ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":I,
"id-GostR3410-94":I,"id-tc26-gost3410-12-256":I,"id-tc26-gost3410-12-512":I,"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r}),qc=n({"id-sc-gost28147-gfb":r,"id-Gost28147-89":ob}),Ia=n({"id-Gost28147-89-MAC":nb,"id-HMACGostR3411-94":r,"id-tc26-hmac-gost-3411-12-256":r,
"id-tc26-hmac-gost-3411-12-512":r,hmacWithSHA1:r,hmacWithSHA224:r,hmacWithSHA256:r,hmacWithSHA384:r,hmacWithSHA512:r,"id-sc-gost28147-mac":r,"id-sc-hmacWithGostR3411":r}),rc={paramType:d({salt:p({specified:h,otherSource:n}),iterationCount:g,keyLength:e(g),prf:Ia}),encode:function(a){return{algorithm:a.id,parameters:{salt:{specified:a.salt},iterationCount:a.iterations,prf:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.salt=a.parameters.salt.specified;c.iterations=a.parameters.iterationCount;
c.hmac=a.parameters.prf;return c}},Ja=n({PBKDF2:rc}),s={paramType:d({salt:h,iterationCount:g}),encode:function(a){return{algorithm:a.id,parameters:{salt:a.derivation.salt,iterationCount:a.derivation.iterations}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=x(c.derivation,{salt:a.parameters.salt,iterations:a.parameters.iterationCount});return c}},Ka={paramType:d({keyDerivationFunc:Ja,encryptionScheme:qc}),encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,
encryptionScheme:a.encryption}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=a.parameters.keyDerivationFunc;c.encryption=a.parameters.encryptionScheme;return c}};n({"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Ka});var sc={paramType:d({keyDerivationFunc:Ja,messageAuthScheme:Ia}),
encode:function(a){return{algorithm:a.id,parameters:{keyDerivationFunc:a.derivation,messageAuthScheme:a.hmac}}},decode:function(a){var c=x(E(a.algorithm));c.derivation=a.parameters.keyDerivationFunc;c.hmac=a.parameters.messageAuthScheme;return c}};n({PBMAC1:sc});var tc=n({"id-sc-gost28147-gfb":r,"id-Gost28147-89":ob,"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,
"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Ka}),ga=n({ecdsa:Z,rsaEncryption:u,"id-sc-gostR3410-2001":Z,"id-GostR3410-2001":I,"id-GostR3410-94":I,"id-tc26-gost3410-12-256":I,"id-tc26-gost3410-12-512":I,"id-GostR3410-94-CryptoPro-ESDH":$,"id-GostR3410-2001-CryptoPro-ESDH":$,"id-tc26-agreement-gost-3410-12-256":$,"id-tc26-agreement-gost-3410-12-512":$,"id-sc-r3410-ESDH-r3411kdf":Z,"id-Gost28147-89-None-KeyWrap":fa,"id-Gost28147-89-CryptoPro-KeyWrap":fa,"id-sc-cmsGostWrap":r,"id-sc-cmsGost28147Wrap":r,
"pbeWithSHAAndAES128-CBC":s,"pbeWithSHAAndAES192-CBC":s,"pbeWithSHAAndAES256-CBC":s,"pbeWithSHA256AndAES128-CBC":s,"pbeWithSHA256AndAES192-CBC":s,"pbeWithSHA256AndAES256-CBC":s,"id-sc-pbeWithGost3411AndGost28147":s,"id-sc-pbeWithGost3411AndGost28147CFB":s,PBES2:Ka}),uc=h({encode:function(a){var c=new Uint8Array(a.byteLength+1),b=V(a);a=a.byteLength/2;c[0]=4;c.set(new Uint8Array(b,a,a),1);c.set(new Uint8Array(b,0,a),a+1);return c.buffer},decode:function(a){var c=new Uint8Array(a.byteLength-1),b=c.byteLength/
2;c.set(new Uint8Array(a,b+1,b),0);c.set(new Uint8Array(a,1,b),b);return V(c)}}),aa=d({algorithm:sa,subjectPublicKey:q}),La=function(a){return{encode:function(c){return aa.encode({algorithm:c.algorithm,subjectPublicKey:L.encode(a[c.algorithm.id].encode(c.buffer))})},decode:function(c){c=aa.decode(c);return{algorithm:c.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:a[c.algorithm.id].decode(L.decode(c.subjectPublicKey))}}}}({"id-sc-gostR3410-2001":uc,"id-sc-gostR3410-94":{encode:function(a){return g.encode((w||
(w=D.gostCoding)).Int16.encode(V(a)))},decode:function(a){return V((w||(w=D.gostCoding)).Int16.decode(g.decode(a)))}},"id-GostR3410-2001":h,"id-GostR3410-94":h,"id-tc26-gost3410-12-256":h,"id-tc26-gost3410-12-512":h}),qb={encode:function(a){return L(g).encode("0x"+U().encode(a,!0))},decode:function(a){return U().decode(L(g).decode(a).replace("0x",""),!0)}},ta=y,na=d({version:g,privateKeyAlgorithm:sa,privateKey:h,attributes:e(b(0,f(H)))}),vc=d({version:g,privateKeyAlgorithm:sa,privateKey:h,attributes:e(b(0,
f(H))),publicKey:e(b(1,f(q)))}),wc=m(vc),xc=function(a){return{encode:function(c){return na.encode({version:0,privateKeyAlgorithm:c.algorithm,privateKey:a[c.algorithm.id].encode(c.buffer)})},decode:function(c){c=na.decode(c);return{algorithm:c.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:a[c.privateKeyAlgorithm.id].decode(c.privateKey)}}}}({"id-sc-gostR3410-2001":qb,"id-sc-gostR3410-94":qb,"id-GostR3410-2001":ta,"id-GostR3410-94":ta,"id-tc26-gost3410-12-256":ta,
"id-tc26-gost3410-12-512":ta}),rb=d({encryptionAlgorithm:ga,encryptedData:h}),yc=d({cA:M(W,!1),pathLenConstraint:e(g)}),zc=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),Ac=m(k),Bc=m({type:k,value:b(0,t(y))}),Cc=d({nameAssigner:e(b(0,f(da))),partyName:e(b(1,f(da)))}),Dc=d({}),z=p({otherName:b(0,f(Bc)),rfc822Name:b(1,f(da)),dNSName:b(2,f(da)),x400Address:b(3,f(Dc)),directoryName:b(4,t(R)),ediPartyName:b(5,
f(Cc)),uniformResourceIdentifier:b(6,f(da)),iPAddress:b(7,f(h)),registeredID:b(8,f(k))}),A=m(z),Ma=d({keyIdentifier:e(b(0,f(h))),authorityCertIssuer:e(b(1,f(A))),authorityCertSerialNumber:e(b(2,f(g)))}),Ec=d({notBefore:e(b(0,f(F))),notAfter:e(b(1,f(F)))}),Fc=d({policyQualifierId:k,qualifier:y}),Gc=d({policyIdentifier:k,policyQualifiers:e(m(Fc))}),Hc=d({issuerDomainPolicy:k,subjectDomainPolicy:k}),Ic=d({base:z,minimum:M(b(0,f(g)),0),maximum:e(b(1,f(g)))}),sb=m(Ic),Jc=d({permittedSubtrees:e(b(0,f(sb))),
excludedSubtrees:e(b(1,f(sb)))}),Kc=d({requireExplicitPolicy:e(b(0,f(g))),inhibitPolicyMapping:e(b(1,f(g)))}),Na=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),tb=p({fullName:b(0,f(A)),nameRelativeToCRLIssuer:b(1,f(kb))}),Lc=d({distributionPoint:e(b(0,t(tb))),reasons:e(b(1,f(Na))),cRLIssuer:e(b(2,f(A)))}),ua=m(Lc),Oa=d({accessMethod:k,accessLocation:z}),ub=X(function(a){return{extnID:k,critical:M(W,
!1),extnValue:h(L(a))}},"extnID"),oa=m(ub,function(a,c,b){return{extnID:a,critical:b&&b(a,c),extnValue:c}},function(a,c){return a[c.extnID]=c.extnValue}),va=oa({authorityKeyIdentifier:Ma,subjectKeyIdentifier:h,keyUsage:zc,privateKeyUsagePeriod:Ec,certificatePolicies:m(Gc),policyMappings:m(Hc),subjectAltName:A,issuerAltName:A,subjectDirectoryAttributes:Ha,basicConstraints:yc,nameConstraints:Jc,policyConstraints:Kc,extKeyUsage:Ac,cRLDistributionPoints:ua,inhibitAnyPolicy:g,freshestCRL:ua,authorityInfoAccess:m(Oa),
subjectInfoAccess:m(Oa)},function(a,c){return"keyUsage"===a||"basicConstraints"===a&&void 0===c.pathLenConstraint}),wa=function(){var a=d({r:g,s:g});return{encode:function(c){c=V(c);var b=c.byteLength/2,d="0x"+U().encode(new Uint8Array(c,0,b));c="0x"+U().encode(new Uint8Array(c,b,b));return T().encode(a.encode({r:c,s:d}))},decode:function(c){var b=a.decode(T().decode(c));c=new Uint8Array(U().decode(b.r.replace("0x","")));var b=new Uint8Array(U().decode(b.s.replace("0x",""))),d=new Uint8Array(b.length+
c.length);d.set(b,0);d.set(c,b.length);return V(d.buffer)}}}(),S={encode:function(a){return V(a)},decode:function(a){return V(a)}},vb=function(a){return function(c){var b=a[c.id];return{encode:function(a){b&&(a=b.encode(a));return a},decode:function(a){if(a instanceof ArrayBuffer)return b&&(a=b.decode(a)),a;throw new J("Invalid signature value");}}}}({noSignature:h,"id-GostR3410-94":S,"id-GostR3410-2001":S,"id-GostR3411-94-with-GostR3410-2001":S,"id-GostR3411-94-with-GostR3410-94":S,"id-tc26-gost3410-12-256":S,
"id-tc26-gost3410-12-512":S,"id-tc26-signwithdigest-gost3410-12-94":S,"id-tc26-signwithdigest-gost3410-12-256":S,"id-tc26-signwithdigest-gost3410-12-512":S,"id-sc-gostR3410-94":wa,"id-sc-gostR3410-2001":wa,"id-sc-gostR3411-94-with-gostR3410-94":wa,"id-sc-gostR3411-94-with-gostR3410-2001":wa}),ha=function(a){return{encode:function(c){c=x(c);c.signatureValue=vb(c.signatureAlgorithm).encode(c.signatureValue);return a.encode(c)},decode:function(c){c=a.decode(c);c.signatureValue=vb(c.signatureAlgorithm).decode(c.signatureValue);
return c}}},wb=d({version:b(0,t(g)),serialNumber:g,signature:N,issuer:R,validity:hc,subject:R,subjectPublicKeyInfo:aa,issuerUniqueID:e(b(1,f(q))),subjectUniqueID:e(b(2,f(q))),extensions:e(b(3,t(va)))}),xa=ha(d({tbsCertificate:wb,signatureAlgorithm:N,signatureValue:q})),Mc=H({challengePassword:G(da),extensionRequest:G(va),msCertExtensions:G(va),extendedCertificateAttributes:G(H)}),xb=d({version:g,subject:R,subjectPublicKeyInfo:aa,attributes:b(0,f(Mc))}),yb=ha(d({requestInfo:xb,signatureAlgorithm:N,
signatureValue:q})),zb=gb({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),Nc=d({distributionPoint:e(b(0,t(tb))),onlyContainsUserCerts:M(b(1,f(W)),!1),onlyContainsCACerts:M(b(2,f(W)),!1),onlySomeReasons:e(b(3,f(Na))),indirectCRL:M(b(4,f(W)),!1),onlyContainsAttributeCerts:M(b(5,f(W)),!1)}),Oc=oa({authorityKeyIdentifier:Ma,issuerAltName:A,cRLNumber:g,deltaCRLIndicator:g,issuingDistributionPoint:Nc,
freshestCRL:ua},function(a){return"cRLNumber"===a}),Pc=oa({cRLReason:zb,instructionCode:k,invalidityDate:F,certificateIssuer:A}),Ab=d({version:e(g),signature:N,issuer:R,thisUpdate:Y,nextUpdate:e(Y),revokedCertificates:e(m(d({userCertificate:g,revocationDate:Y,crlEntryExtensions:e(Pc)}))),crlExtensions:e(b(0,t(Oc)))}),Pa=ha(d({tbsCertList:Ab,signatureAlgorithm:N,signatureValue:q})),Qa=d({digestedObjectType:gb({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:e(k),digestAlgorithm:ea,
objectDigest:q}),ya=d({issuer:A,serial:g,issuerUID:e(q)}),Qc=d({issuerName:e(A),baseCertificateID:e(b(0,f(ya))),objectDigestInfo:e(b(1,f(Qa)))}),Rc=d({targetCertificate:ya,targetName:e(z),certDigestInfo:e(Qa)}),Sc=p({targetName:b(0,t(z)),targetGroup:b(1,t(z)),targetCert:b(2,f(Rc))}),Tc=m(Sc),Uc=oa({auditIdentity:h,targetInformation:Tc,authorityKeyIdentifier:Ma,authorityInfoAccess:m(Oa),cRLDistributionPoints:ua,noRevAvail:ma},function(a){return"auditIdentity"===a||"targetInformation"===a}),Vc=d({baseCertificateID:e(b(0,
f(ya))),entityName:e(b(1,f(A))),objectDigestInfo:e(b(2,f(Qa)))}),Wc=p({v1Form:A,v2Form:b(0,f(Qc))}),Bb=d({notBeforeTime:F,notAfterTime:F}),Cb=d({service:z,ident:z,authInfo:e(h)}),Xc=d({roleAuthority:e(b(0,f(A))),roleName:b(1,t(z))}),Yc=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),Zc=d({type:b(0,f(k)),value:b(1,f(y))}),$c=d({policyId:b(0,f(k)),classList:M(b(1,f(Yc)),["unclassified"]),securityCategories:e(b(2,f(C(Zc))))}),Db=d({policyAuthority:e(b(0,f(A))),values:m(p({octets:h,
oid:k,string:K}))}),Eb=d({version:g,holder:Vc,issuer:Wc,signature:N,serialNumber:g,attrCertValidityPeriod:Bb,attributes:Ha({authenticationInfo:C(Cb),accessIdentity:C(Cb),chargingIdentity:G(Db),group:G(Db),role:C(Xc),clearance:C($c)}),issuerUniqueID:e(q),extensions:e(Uc)}),Fb=ha(d({acinfo:Eb,signatureAlgorithm:N,signatureValue:q})),ia=h,pa=h;d({ephemeralPublicKey:Gb,addedukm:e(b(0,t(h)))});d({keyInfo:pb,entityUInfo:e(b(0,t(h))),suppPubInfo:b(2,t(h))});var ja=d({encryptedKey:h,maskKey:e(b(0,f(h))),
macKey:h}),ad=d({encryptionParamSet:k,ephemeralPublicKey:e(b(0,f(La))),ukm:h}),Hb=d({sessionEncryptedKey:ja,transportParameters:e(b(0,f(ad)))}),Ib=d({sessionEncryptedKey:ja,ukm:d({ephemeralPublicKey:La,addedukm:e(b(0,t(h)))})}),Ra=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,8,32))).buffer;a=(new Uint8Array(new Uint8Array(a,40,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(c){var b=a.ukm,d=c.encryptedKey;c=c.macKey;var e=new Uint8Array(b.byteLength+d.byteLength+
c.byteLength);e.set(new Uint8Array(b),0);e.set(new Uint8Array(d),8);e.set(new Uint8Array(c),40);return e}}},ka=function(a){var c=Ra(a);return{encode:function(a){return ja.encode(c.encode(a))},decode:function(a){return c.decode(ja.decode(a))}}},za=function(a){return{encode:function(c){return Hb.encode({sessionEncryptedKey:Ra(a).encode(c),transportParameters:{encryptionParamSet:ba("sBox")[a.wrapping.sBox||"E-A"],ephemeralPublicKey:a["public"],ukm:a.ukm}})},decode:function(c){c=Hb.decode(c);a.wrapping=
ca(c.transportParameters.encryptionParamSet);a.ukm=c.transportParameters.ukm;a["public"]=c.transportParameters.ephemeralPublicKey;return Ra(a).decode(c.sessionEncryptedKey)}}},Sa=function(a){return{encode:function(a){var b=(new Uint8Array(new Uint8Array(a,0,32))).buffer;a=(new Uint8Array(new Uint8Array(a,32,4))).buffer;return{encryptedKey:b,macKey:a}},decode:function(a){var b=a.encryptedKey;a=a.macKey;var d=new Uint8Array(b.byteLength+a.byteLength);d.set(new Uint8Array(b),0);d.set(new Uint8Array(a),
32);return d}}},Jb=function(a){return{encode:function(b){return Ib.encode({sessionEncryptedKey:Sa(a).encode(b),ukm:{ephemeralPublicKey:a["public"],addedukm:a.ukm}})},decode:function(b){b=Ib.decode(b);a.ukm=b.ukm.addedukm;a["public"]=b.ukm.ephemeralPublicKey;return Sa(a).decode(b.sessionEncryptedKey)}}},Ta=function(a){var b=Sa(a);return{encode:function(a){return ja.encode(b.encode(a))},decode:function(a){return b.decode(ja.decode(a))}}},Aa=function(a){return function(b){var d=a[b.id],d=d&&d.call&&
d(b)||d;return{encode:function(a){d&&(a=d.encode(a));return a},decode:function(a){d&&(a=d.decode(a));return a}}}}({"id-sc-gostR3410-2001":Jb,"id-sc-gostR3410-94":Jb,"id-GostR3410-2001":za,"id-GostR3410-94":za,"id-tc26-gost3410-12-256":za,"id-tc26-gost3410-12-512":za,"id-GostR3410-94-CryptoPro-ESDH":ka,"id-GostR3410-2001-CryptoPro-ESDH":ka,"id-tc26-agreement-gost-3410-12-256":ka,"id-tc26-agreement-gost-3410-12-512":ka,"id-sc-r3410-ESDH-r3411kdf":Ta,"id-Gost28147-89-None-KeyWrap":ka,"id-Gost28147-89-CryptoPro-KeyWrap":ka,
"id-sc-cmsGostWrap":Ta,"id-sc-cmsGost28147Wrap":Ta}),Ua=function(a){return{encode:function(b){b=x(b);b.encryptedKey=L(Aa(b.keyEncryptionAlgorithm)).encode(b.encryptedKey);return a.encode(b)},decode:function(b){b=a.decode(b);b.encryptedKey=L(Aa(b.keyEncryptionAlgorithm)).decode(b.encryptedKey);return b}}},la=k,pa=h,Va=m(g),bd=d({bodyPartPath:Va,identifier:k,content:y}),Ba=H({contentType:G(la),messageDigest:G(h),signingTime:G(Y)}),dd=H({countersignature:C(cd),unsignedData:C(bd)}),qa=d({issuer:R,serialNumber:g}),
ed=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),Kb=ha(d({version:g,sid:ed,digestAlgorithm:ea,signedAttrs:e(b(0,f(Ba))),signatureAlgorithm:N,signatureValue:h,unsignedAttrs:e(b(1,f(dd)))})),cd=Kb,fd=C(Kb),gd=C(ea),hd=d({version:g,certificate:xa,attributes:H}),id=d({extendedCertificateInfo:hd,signatureAlgorithm:N,signatureValue:q}),jd=d({otherCertFormat:k,otherCert:y}),kd=d({version:g,subject:p({baseCertificateID:b(0,f(ya)),subjectName:b(1,f(A))}),issuer:A,signature:N,serialNumber:g,
attCertValidityPeriod:Bb,attributes:Ha,issuerUniqueID:e(q),extensions:e(va)}),ld=ha(d({acInfo:kd,signatureAlgorithm:N,signatureValue:q})),Wa=d({eContentType:la,eContent:e(b(0,t(h)))}),md=p({certificate:xa,extendedCertificate:b(0,f(id)),v1AttrCert:b(1,f(ld)),v2AttrCert:b(2,f(Fb)),other:b(3,f(jd))}),nd=d({otherRevInfoFormat:k,otherRevInfo:y}),od=p({crl:Pa,other:b(1,f(nd))}),Lb=C(md),Mb=C(od),pd=d({version:g,digestAlgorithms:gd,encapContentInfo:Wa,certificates:e(b(0,f(Lb))),crls:e(b(1,f(Mb))),signerInfos:fd}),
qd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa))}),rd=Ua(d({version:g,rid:qd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Nb=d({keyAttrId:k,keyAttr:e(y)}),sd=d({subjectKeyIdentifier:pa,date:e(F),other:e(Nb)}),td=p({issuerAndSerialNumber:qa,rKeyId:b(0,f(sd))}),ud=d({rid:td,encryptedKey:ia}),vd=m(ud),Gb=d({algorithm:sa,publicKey:q}),wd=p({issuerAndSerialNumber:qa,subjectKeyIdentifier:b(0,f(pa)),originatorKey:b(1,f(Gb))}),xd=function(a){return{encode:function(b){b=x(b);var d=b.keyEncryptionAlgorithm,
e=L(Aa(d));b.recipientEncryptedKeys=b.recipientEncryptedKeys.map(function(a){a=x(a);a.encryptedKey=e.encode(a.encryptedKey);return a});b.ukm=b.ukm||d.ukm;return a.encode(b)},decode:function(b){b=a.decode(b);var d=b.keyEncryptionAlgorithm;d.ukm=d.ukm||b.ukm;var e=L(Aa(d));b.recipientEncryptedKeys.forEach(function(a){a.encryptedKey=e.decode(a.encryptedKey)});return b}}}(d({version:g,originator:b(0,t(wd)),ukm:e(b(1,t(h))),keyEncryptionAlgorithm:ga,recipientEncryptedKeys:vd})),yd=d({keyIdentifier:h,date:e(F),
other:e(Nb)}),zd=Ua(d({version:g,kekid:yd,keyEncryptionAlgorithm:ga,encryptedKey:ia})),Ad=Ua(d({version:g,keyDerivationAlgorithm:e(b(0,f(Ja))),keyEncryptionAlgorithm:ga,encryptedKey:ia})),Bd=d({oriType:k,oriValue:y}),Cd=p({ktri:rd,kari:b(1,f(xd)),kekri:b(2,f(zd)),pwri:b(3,f(Ad)),ori:b(4,f(Bd))}),Xa=d({certs:e(b(0,f(Lb))),crls:e(b(1,f(Mb)))}),Ya=C(Cd),Za=d({contentType:la,contentEncryptionAlgorithm:tc,encryptedContent:e(b(0,f(h)))}),Ca=d({version:g,originatorInfo:e(b(0,f(Xa))),recipientInfos:Ya,encryptedContentInfo:Za,
unprotectedAttrs:e(b(1,f(H)))}),Dd=d({version:g,digestAlgorithm:ea,encapContentInfo:Wa,digest:h}),Ob=d({version:g,encryptedContentInfo:Za,unprotectedAttrs:e(b(1,f(H)))}),Ed=d({version:g,originatorInfo:e(b(0,f(Xa))),recipientInfos:Ya,macAlgorithm:Ia,digestAlgorithm:e(b(1,ea)),encapContentInfo:Wa,authAttrs:e(b(2,f(Ba))),mac:h,unauthAttrs:e(b(3,f(H)))}),Fd=d({version:g,originatorInfo:e(b(0,f(Xa))),recipientInfos:Ya,authEncryptedContentInfo:Za,authAttrs:e(b(1,f(Ba))),mac:h,unauthAttrs:e(b(2,f(H)))}),
Gd=p({encrypted:Ob,enveloped:b(0,f(Ca)),authEnveloped:b(1,f(Fd))}),la=k,ra=X(function(a){return{contentType:la,content:b(0,t(a))}},"contentType",la)({data:h,signedData:pd,envelopedData:Ca,digestedData:Dd,encryptedData:Ob,authData:Ed,encryptedKeyPkg:Gd,aKeyPackage:wc}),Hd=d({digestAlgorithm:ea,digest:h}),Id=H({friendlyName:G(eb),localKeyId:G(h)}),Jd=X(function(a){return{certId:k,certValue:b(0,t(a))}},"certId",k)({x509Certificate:h(L(xa)),sdsiCertificate:Ea},h),Kd=X(function(a){return{crlId:k,crlValue:b(0,
t(a))}},"crlId",k)({x509CRL:h(L(Pa))},h),Ld=X(function(a){return{secretTypeId:k,secretValue:b(0,t(a))}},"secretTypeId",k)({secret:h},h),Md=X(function(a){return{bagId:k,bagValue:b(0,t(a)),bagAttributes:e(Id)}},"bagId",k)(function(a){return{keyBag:na,pkcs8ShroudedKeyBag:rb,certBag:Jd,crlBag:Kd,secretBag:Ld,safeContentsBag:Pb}[a]}),Pb=m(Md),Nd=m(ra),Od=d({mac:Hd,macSalt:h,iterations:M(g,1)}),Pd=d({version:g,authSafe:ra,macData:e(Od)}),Qd=d({issuer:z,serialNumber:g}),Rd=d({intendedAlg:e(b(0,f(n))),symmAlg:e(b(1,
f(n))),encSymmKey:e(b(2,f(q))),keyAlg:e(b(3,f(n))),valueHint:e(b(4,f(h))),encValue:q}),ia=p({encryptedValue:Rd,envelopedData:b(0,f(Ca))}),Sd=p({encryptedPrivKey:b(0,ia),keyGenParameters:b(1,f(h)),archiveRemGenPrivKey:b(2,f(W))}),Td=d({pubMethod:g({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:e(z)}),Qb=d({action:g({dontPublish:0,pleasePublish:1}),pubInfos:e(m(Td))}),Ud=g({encrCert:0,challengeResp:1}),Sb=p({thisMessage:b(0,f(q)),subsequentMessage:b(1,f(Ud)),dhMAC:b(2,f(q)),agreeMAC:b(3,f(Rb)),encryptedKey:b(4,
f(Ca))});d({salt:h,owf:n,iterationCount:g,mac:n});var Rb=d({algId:n,value:q}),Vd=d({authInfo:p({sender:b(0,t(z)),publicKeyMAC:Rb}),publicKey:aa}),Wd=d({poposkInput:e(b(0,Vd)),algorithmIdentifier:n,signature:q}),Xd=p({raVerified:b(0,f(ma)),signature:b(1,f(Wd)),keyEncipherment:b(2,f(Sb)),keyAgreement:b(3,f(Sb))}),Yd=m(Ga({regToken:K,authenticator:K,pkiPublicationInfo:Qb,pkiArchiveOptions:Sd,oldCertID:Qd,protocolEncrKey:aa})),Zd=d({notBefore:e(b(0,f(Y))),notAfter:e(b(1,f(Y)))}),Tb=d({version:e(b(0,f(g))),
serialNumber:e(b(1,f(g))),signingAlg:e(b(2,f(n))),issuer:e(b(3,f(R))),validity:e(b(4,f(Zd))),subject:e(b(5,f(R))),publicKey:e(b(6,f(aa))),issuerUID:e(b(7,f(q))),subjectUID:e(b(8,f(q))),extensions:e(b(9,f(oa)))}),Ub=d({certReqId:g,certTemplate:Tb,controls:e(Yd)}),$d=d({privateKey:na,identifier:e(p([K,z]))}),Vb=d({certReq:Ub,popo:e(Xd),regInfo:e(m(Ga({utf8Pairs:K,certReq:Ub,encKeyWithID:$d})))});m(Vb);var Wb=d({pendToken:h,pendTime:F}),Xb=g({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,
popRequired:6,partial:7}),Yb=g({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),ae=d({cMCStatus:Xb,bodyList:m(g),statusString:e(K),otherInfo:e(p({failInfo:Yb,pendInfo:Wb}))}),be=d({pkiDataReference:g,certReferences:m(g),extensions:m(ub)}),ce=d({request:Zb,cms:ra,thePOPAlgID:n,witnessAlgID:n,witness:h}),de=d({pkiDataBodyid:g,bodyIds:m(g)}),ee=d({issuerName:z,
serialNumber:g}),fe=d({issuerName:R,cRLName:e(z),time:e(F),reasons:e(Na)}),ge=d({issuerName:R,serialNumber:g,reason:zb,invalidityDate:e(F),passphrase:e(h),comment:e(K)}),he=d({bodyPartID:g,thePOPAlgID:n,thePOP:h}),$b=p({bodyPartID:g,bodyPartPath:Va}),ie=d({cMCStatus:Xb,bodyList:m($b),statusString:e(K),otherInfo:e(p({failInfo:Yb,pendInfo:Wb,extendedFailInfo:d({failInfoOID:k,failInfoValue:Fa})}))}),je=d({seqNumber:g,hashAlgorithm:n,anchorHashes:m(h)}),$a=m(g),ke=d({hashAlg:n,certHashes:m(h),pubInfo:Qb}),
le=d({pkiDataReference:Va,certReferences:$a,replace:M(W,!0),certTemplate:Tb}),me=d({bodyList:m($b)}),ne=d({proofAlgID:n,macAlgId:n,witness:h}),oe=d({keyGenAlgorithm:n,macAlgorithm:n,witness:h}),ac=jb(function(a){return d({bodyPartID:g,attrType:k,attrValues:C(a)},{encode:function(a){return a.attrType},decode:function(a){return k.decode(a[1])}},Fa)({statusInfo:ae,identification:K,identityProof:h,dataReturn:h,transactionId:g,senderNonce:h,recipientNonce:h,addExtensions:be,encryptedPOP:ce,decryptedPOP:he,
lraPOPWitness:de,getCert:ee,getCRL:fe,revokeRequest:ge,regInfo:h,responseInfo:h,queryPending:h,popLinkRandom:h,popLinkWitness:h,confirmCertAcceptance:qa,statusInfoV2:ie,trustedAnchors:je,authData:g,batchRequests:$a,batchResponses:$a,publishCert:ke,modCertTemplate:le,controlProcessed:me,popLinkWitnessV2:oe,identityProofV2:ne})}),pe=d({bodyPartID:g,certificationRequest:yb}),bc=d({bodyPartID:g,contentInfo:ra}),cc=d({bodyPartID:g,otherMsgType:k,otherMsgValue:y}),Zb=p({tcr:b(0,f(pe)),crm:b(1,f(Vb)),orm:b(2,
f(d({bodyPartID:g,requestMessageType:k,requestMessageValue:y})))}),qe=d({controlSequence:m(ac),reqSequence:m(Zb),cmsSequence:m(bc),otherMsgSequence:m(cc)}),re=d({controlSequence:m(ac),cmsSequence:m(bc),otherMsgSequence:m(cc)}),v=function(a,b){return{encode:function(d,e){d=a.encode(d);d=T().encode(d);"PEM"===(e||"DER").toUpperCase()&&(d=(w||(w=D.gostCoding)).PEM.encode(d,b));return d},decode:function(d){if("string"===typeof d||d instanceof String)d=(w||(w=D.gostCoding)).PEM.decode(d,b);d=T().decode(d);
return a.decode(d)}}};return{CanocicalName:gc,GostPrivateKeyInfo:v(xc,"PRIVATE KEY"),GostSubjectPublicKeyInfo:v(La,"PUBLIC KEY"),PrivateKeyInfo:v(na,"PRIVATE KEY"),EncryptedPrivateKeyInfo:v(rb,"ENCRYPTED PRIVATE KEY"),SubjectPublicKeyInfo:v(aa,"PUBLIC KEY"),TBSCertificate:v(wb),Certificate:v(xa,"CERTIFICATE"),CertificationRequestInfo:v(xb),CertificationRequest:v(yb,"CERTIFICATE REQUEST"),TBSCertList:v(Ab),CertificateList:v(Pa,"CRL"),AttributeCertificateInfo:v(Eb),AttributeCertificate:v(Fb,"ATTRIBUTE CERTIFICATE"),
SignedAttributes:v(Ba),ContentInfo:v(ra,"CMS"),SafeContents:v(Pb),AuthenticatedSafe:v(Nd),PFX:v(Pd,"PFX"),PKIData:v(qe,"PKI REQUEST"),PKIResponse:v(re,"PKI RESPONSE")}});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(s,h){"function"===typeof define&&define.amd?define(["gostRandom"],h):"object"===typeof exports?module.exports=h(require("gostRandom")):s.gostCrypto=h(s.gostRandom)})(this,function(s){function h(a,c){if("string"===typeof a||a instanceof String)a={name:a};var d=a.name;if(!d)throw new u("Algorithm name not defined");var e=d.split("/"),e=e[0].split("-").concat(e.slice(1)),b={},d=e[0].replace(/[\.\s]/g,""),e=e.slice(1);if(0<=d.indexOf("GOST")&&0<=d.indexOf("28147"))b={name:"GOST 28147",version:1989,
mode:(a.mode||("sign"===c||"verify"===c?"MAC":"wrapKey"===c||"unwrapKey"===c?"KW":"ES")).toUpperCase(),length:a.length||64};else if(0<=d.indexOf("GOST")&&0<=d.indexOf("3411"))b={name:"GOST R 34.11",version:2012,mode:(a.mode||("deriveKey"===c||"deriveBits"===c?"KDF":"sign"===c||"verify"===c?"HMAC":"HASH")).toUpperCase(),length:a.length||256};else if(0<=d.indexOf("GOST")&&0<=d.indexOf("3410"))b={name:"GOST R 34.10",version:2012,mode:(a.mode||("deriveKey"===c||"deriveBits"===c?"DH":"SIGN")).toUpperCase(),
length:a.length||256};else throw new p("Algorithm not supported");e.forEach(function(a){a=a.toUpperCase();if(/^[0-9]+$/.test(a))if(0<=["8","16","32"].indexOf(a)||"128"===b.length&&"64"===a)if("ES"===b.mode)b.shiftBits=parseInt(a);else if("MAC"===b.mode)b.macLength=parseInt(a);else throw new p("Algorithm "+b.name+" mode "+a+" not supported");else 0<="89 94 01 12 15 1989 1994 2001 2012 2015".split(" ").indexOf(a)?(a=parseInt(a),b.version=1900>a?80>a?2E3+a:1900+a:a):0<=["64","128","256","512"].indexOf(a)?
b.length=parseInt(a):0<=["1000","2000"].indexOf(a)&&(b.iterations=parseInt(a));else if(0<="E-DEFAULT E-TEST E-A E-B E-C E-D E-SC E-Z D-TEST D-A D-SC".split(" ").indexOf(a))b.sBox=a;else if(0<="S-TEST S-A S-B S-C S-D X-A X-B X-C".split(" ").indexOf(a))b.namedParam=a;else if(0<="S-256-TEST S-256-A S-256-B S-256-C P-256 T-512-TEST T-512-A T-512-B X-256-A X-256-B T-256-TEST T-256-A T-256-B S-256-B T-256-C S-256-C".split(" ").indexOf(a))b.namedCurve=a;else if("GOST 28147"===b.name)if(0<=["ES","MAC","KW"].indexOf(a))b.mode=
a;else if(0<=["ECB","CFB","OFB","CTR","CBC"].indexOf(a))b.mode="ES",b.block=a;else if(0<=["CPKW","NOKW","SCKW"].indexOf(a))b.mode="KW",b.keyWrapping=a.replace("KW","");else if(0<=["ZEROPADDING","PKCS5PADDING","NOPADDING","RANDOMPADDING","BITPADDING"].indexOf(a))b.padding=a.replace("PADDING","");else if(0<=["NOKM","CPKM"].indexOf(a))b.keyMeshing=a.replace("KM","");else throw new p("Algorithm "+b.name+" mode "+a+" not supported");else if("GOST R 34.11"===b.name)if(0<=["HASH","KDF","HMAC","PBKDF2"].indexOf(a))b.mode=
a;else throw new p("Algorithm "+b.name+" mode "+a+" not supported");else if("GOST R 34.10"===b.name){var d=a.replace(/[\.\s]/g,"");if(0<=d.indexOf("GOST")&&0<=d.indexOf("3411"))b.hash=a;else if(["SIGN","DH"].indexOf(a))b.mode=a;else throw new p("Algorithm "+b.name+" mode "+a+" not supported");}});if("ES"===b.mode&&(a.block&&(b.block=a.block),b.block&&(b.block=b.block.toUpperCase()),a.padding&&(b.padding=a.padding),b.padding&&(b.padding=b.padding.toUpperCase()),a.shiftBits&&(b.shiftBits=a.shiftBits),
a.keyMeshing&&(b.keyMeshing=a.keyMeshing),b.keyMeshing&&(b.keyMeshing=b.keyMeshing.toUpperCase()),"importKey"!==c&&"generateKey"!==c)){b.block=b.block||"ECB";b.padding=b.padding||("CBC"===b.block||"ECB"===b.block?"ZERO":"NO");if("CFB"===b.block||"OFB"===b.block)b.shiftBits=b.shiftBits||b.length;b.keyMeshing=b.keyMeshing||"NO"}"KW"===b.mode&&(a.keyWrapping&&(b.keyWrapping=a.keyWrapping),b.keyWrapping&&(b.keyWrapping=b.keyWrapping.toUpperCase()),"importKey"!==c&&"generateKey"!==c&&(b.keyWrapping=b.keyWrapping||
"NO"));a.sBox&&(b.sBox=a.sBox);a.namedParam&&(b.namedParam=a.namedParam);a.namedCurve&&(b.namedCurve=a.namedCurve);"importKey"!==c&&"generateKey"!==c&&("GOST 28147"===b.name&&1989===b.version?b.sBox=b.sBox||"E-A":"GOST 28147"===b.name&&2015===b.version?b.sBox="E-DEFAULT":"GOST R 34.11"===b.name&&1994===b.version?b.sBox=b.sBox||"D-A":"GOST R 34.10"===b.name&&1994===b.version?b.namedParam=b.namedParam||("EC-DH"===b.mode?"X-A":"S-A"):"GOST R 34.10"===b.name&&2001===b.version?b.namedCurve=b.namedCurve||
(256===b.length?"EC-DH"===b.mode?"X-256-A":"S-256-A":"T-512-A"===b.mode):"GOST R 34.10"===b.name&&2012===b.version&&(b.namedCurve=b.namedCurve||(256===b.length?"EC-DH"===b.mode?"X-256-A":"S-256-A":"T-512-A"===b.mode)));switch(b.mode){case "DH":a.ukm&&(b.ukm=a.ukm);a["public"]&&(b["public"]=a["public"]);break;case "SIGN":case "KW":a.ukm&&(b.ukm=a.ukm);break;case "ES":case "MAC":a.iv&&(b.iv=a.iv);break;case "PBKDF2":a.salt&&(b.salt=a.salt);a.iterations&&(b.iterations=a.iterations);break;case "KDF":a.label&&
(b.label=a.label),a.contex&&(b.context=a.contex)}if(c&&("ES"!==b.mode&&"SIGN"!==b.mode&&"MAC"!==b.mode&&"HMAC"!==b.mode&&"KW"!==b.mode&&"generateKey"===c||"ES"!==b.mode&&("encrypt"===c||"decrypt"===c)||"SIGN"!==b.mode&&"MAC"!==b.mode&&"HMAC"!==b.mode&&("sign"===c||"verify"===c)||"HASH"!==b.mode&&"digest"===c||"KW"!==b.mode&&("wrapKey"===c||"unwrapKey"===c)||"DH"!==b.mode&&"PBKDF2"!==b.mode&&"KDF"!==b.mode&&("deriveKey"===c||"deriveBits"===c)))throw new p("Algorithm mode "+b.mode+" not valid for method "+
c);a.hash&&(b.hash=a.hash);b.hash&&(b.hash=h(b.hash,"digest"));a.id&&(b.id=a.id);return b}function l(a){return k&&k.subtle&&a&&(("string"===typeof a||a instanceof String)&&-1===a.toUpperCase().indexOf("GOST")||a.name&&-1===a.name.toUpperCase().indexOf("GOST")||a.hash&&a.hash.name&&-1===a.hash.name.toUpperCase().indexOf("GOST"))}function E(a,c){if(!a.algorithm)throw new u("Key algorithm not defined");if(!a.algorithm.name)throw new u("Key algorithm name not defined");var d=a.algorithm.name,e="GOST 28147"===
d,b="GOST R 34.11"===d,f="GOST R 34.10"===d;if(!e&&!f&&!b)throw new p("Key algorithm "+d+" is unsupproted");if(!a.type)throw new u("Key type not defined");if((e||b)&&"secret"!==a.type||f&&"public"!==a.type&&"private"!==a.type)throw new F("Key type "+a.type+" is not valid for algorithm "+d);if(!a.usages||!a.usages.indexOf)throw new u("Key usages not defined");d=0;for(e=a.usages.length;d<e;d++)if(b=a.usages[d],("wrapKey"===b||"unwrapKey"===b||"encrypt"===b||"decrypt"===b)&&"secret"!==a.type||"sign"===
b&&"public"===a.type||"verify"===b&&"private"===a.type)throw new H("Key type "+a.type+" is not valid for "+b);if(c&&-1===a.usages.indexOf(c))throw new G("Key usages is not contain method "+c);if(!a.buffer)throw new u("Key buffer is not defined");d=8*a.buffer.byteLength;if("secret"===a.type&&256!==d&&(0<=a.usages.indexOf("encrypt")||0<=a.usages.indexOf("decrypt"))||"private"===a.type&&256!==d&&512!==d||"public"===a.type&&512!==d&&1024!==d)throw new u("Key buffer has wrong size "+d+" bit");}function n(a,
c,d){E(d,a);if(c){var e;switch(c.mode){case "ES":e=["sBox","keyMeshing","padding","block"];break;case "SIGN":e=["namedCurve","namedParam","sBox"];break;case "MAC":e=["sBox"];break;case "KW":e=["keyWrapping","ukm"];break;case "DH":e=["namedCurve","namedParam","sBox","ukm"];break;case "PBKDF2":e=["sBox","iterations","salt"];break;case "KDF":e=["context","label"]}e&&e.forEach(function(a){d.algorithm[a]&&(c[a]=d.algorithm[a])})}return d.buffer}function x(a,c,d,e,b){a={type:b||"secret",extractable:c||
"false",algorithm:a,usages:d||[],buffer:e};E(a);return a}function I(a,c,d,e,b){if(!d||!d.indexOf)throw new u("Key usages not defined");var f=d.filter(function(a){return"sign"!==a});d=d.filter(function(a){return"verify"!==a});return{publicKey:x(a,c,f,e,"public"),privateKey:x(a,c,d,b,"private")}}function y(){for(var a=0,c=arguments.length;a<c;a++){var d=arguments[a].split("."),d=z+d[0]+A+"."+d[1],e=document.querySelector('script[src="'+d+'"]');e||(e=document.createElement("script"),e.setAttribute("src",
d),document.head.appendChild(e))}}function t(a,c,d){return new Promise(function(e,b){try{if(w){var D=++J;v.push({id:D,resolve:e,reject:b});w.postMessage({id:D,algorithm:a,method:c,args:d})}else f.gostEngine?e(f.gostEngine.execute(a,c,d)):b(new B("Module gostEngine not found"))}catch(m){b(m)}})}function r(a){try{a()}catch(c){}}function g(){}var f=this,k=f.crypto||f.msCrypto,u=f.SyntaxError||Error,F=f.DataError||Error,p=f.NotSupportedError||Error,B=f.OperationError||Error,H=f.InvalidAccessError||Error,
G=f.InvalidAccessError||Error;f.Promise||(f.Promise=function(){function a(a){return a&&null===a.oncomplete&&null===a.onerror?new c(function(c,b){a.oncomplete=function(){c(a.result)};a.onerror=function(){b(new B(a.toString()))}}):a}function c(d){function e(a){try{a()}catch(b){}}var b="pending",f,m=[],h=[];try{d(function(a){"pending"===b&&(b="fulfilled",f=a,m.forEach(e))},function(a){"pending"===b&&(b="rejected",f=a,h.forEach(e))})}catch(k){"pending"===b&&(b="rejected",f=k,h.forEach(e))}this.then=function(d,
e){return new c(function(c,k){function q(){var b;try{b=d?d(f):f}catch(e){k(e);return}(b=a(b))&&b.then&&b.then.call?b.then(c,k):c(b)}function g(){var b;try{b=e?e(f):f}catch(d){k(d);return}(b=a(b))&&b.then&&b.then.call?b.then(c,k):k(b)}"fulfilled"===b?q():"rejected"===b?g():(m.push(q),h.push(g))})};this["catch"]=function(a){return this.then(void 0,a)}}c.all=function(a){return new c(function(c,b){function f(a){q++;return function(b){h[a]=b;q--;0===q&&c(h)}}function k(a){0<q&&b(a);q=0}for(var h=[],q=
0,g=0,p=a.length;g<p;g++){var l=a[g];l.then&&l.then.call?l.then(f(g),k):h[g]=l}0===q&&c(h)})};return c}());var z="",A="";"undefined"!==typeof document&&function(){for(var a=/^(.*)gostCrypto(.*)\.js$/i,c=document.querySelectorAll("script"),d=0,e=c.length;d<e;d++){var b=c[d].getAttribute("src");if(b=a.exec(b))z=b[1],A=b[2]}}();var w,v=[],J=0;if(!f.importScripts&&!f.gostEngine)try{w=new Worker(z+"gostEngine"+A+".js"),w.onmessage=function(a){for(var c=a.data.id,d=0,e=v.length;d<e&&v[d].id!==c;d++);d<
e&&(c=v[d],v.splice(d,1),a.data.error?c.reject(new B(a.data.error)):c.resolve(a.data.result))},w.onerror=function(a){for(var c=0,d=v.length;c<d;c++)v[c].reject(a.error);v=[]}}catch(K){w=!1}f.importScripts||(f.importScripts=y);w||f.gostEngine||y("gostEngine.js");g.prototype.encrypt=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.encrypt(a,c,d);a=h(a,"encrypt");return t(a,"encrypt",[n("encrypt",a,c),d])})};g.prototype.decrypt=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.decrypt(a,
c,d);a=h(a,"decrypt");return t(a,"decrypt",[n("decrypt",a,c),d])})};g.prototype.sign=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.sign(a,c,d);a=h(a,"sign");return t(a,"sign",[n("sign",a,c),d])})};g.prototype.verify=function(a,c,d,e){return(new Promise(r)).then(function(){if(l(a))return k.subtle.verify(a,c,d,e);a=h(a,"verify");return t(a,"verify",[n("verify",a,c),d,e])})};g.prototype.digest=function(a,c){return(new Promise(r)).then(function(){if(l(a))return k.subtle.digest(a,
c);a=h(a,"digest");return t(a,"digest",[c])})};g.prototype.generateKey=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.generateKey(a,c,d);a=h(a,"generateKey");return t(a,"generateKey",[]).then(function(e){return e.publicKey&&e.privateKey?I(a,c,d,e.publicKey,e.privateKey):x(a,c,d,e)})})};g.prototype.deriveKey=function(a,c,d,e,b){return(new Promise(r)).then(function(){if(l(a))return k.subtle.deriveKey(a,c,d,e,b);a=h(a,"deriveKey");d=h(d,"generateKey");a["public"]&&(a["public"].algorithm=
h(a["public"].algorithm),a["public"]=n("deriveKey",a,a["public"]));return t(a,"deriveKey",[n("deriveKey",a,c)]).then(function(a){return x(d,e,b,a)})})};g.prototype.deriveBits=function(a,c,d){return(new Promise(r)).then(function(){if(l(a))return k.subtle.deriveBits(a,c,d);a=h(a,"deriveBits");a["public"]&&(a["public"]=n("deriveBits",a,a["public"]));return t(a,"deriveBits",[n("deriveBits",a,c),d])})};g.prototype.importKey=function(a,c,d,e,b){return(new Promise(r)).then(function(){if(l(d))return k.subtle.importKey(a,
c,d,e,b);var g,m,n;if("raw"===a)d=h(d,"importKey"),n=c,b&&b.indexOf&&(m=d.name.toUpperCase().replace(/[\.\s]/g,""),0<=m.indexOf("3410")&&0<=b.indexOf("sign")?g="private":0<=m.indexOf("3410")&&0<=b.indexOf("verify")&&(g="public"));else{if("pkcs8"===a&&f.gostSyntax&&f.gostCoding)m=f.gostSyntax.GostPrivateKeyInfo.decode(c);else if("spki"===a&&f.gostSyntax&&f.gostCoding)m=f.gostSyntax.GostSubjectPublicKeyInfo.decode(c);else throw new p("Key format not supported");d=h(m.algorithm,"importKey");n=m.buffer;
g=m.type;e=e||m.extractable;if(b)for(var q=0;q<b.length;q++){if(0>m.usages.indexOf(b[q]))throw F("Key usage not valid for this key");}else b=m.usages}return x(d,e,b,n,g)})};g.prototype.exportKey=function(a,c){return(new Promise(r)).then(function(){if(c&&l(c.algorithm))return k.subtle.exportKey(a,c);if(!c.extractable)throw new G("Key not extractable");var d=n(null,null,c);if("raw"===a)return d;if("pkcs8"===a&&c.algorithm&&c.algorithm.id&&f.gostSyntax&&f.gostCoding)return f.gostSyntax.GostPrivateKeyInfo.encode(c);
if("spki"===a&&c.algorithm&&c.algorithm.id&&f.gostSyntax&&f.gostCoding)return f.gostSyntax.GostSubjectPublicKeyInfo.encode(c);throw new p("Key format not supported");})};g.prototype.wrapKey=function(a,c,d,e){return(new Promise(r)).then(function(){if(l(e))return k.subtle.wrapKey(a,c,d,e);e=h(e,"wrapKey");return t(e,"wrapKey",[n("wrapKey",e,d),n(null,null,c)]).then(function(b){if("raw"===a)return b;throw new p("Key format not supported");})})};g.prototype.unwrapKey=function(a,c,d,e,b,f,g){return(new Promise(r)).then(function(){if(l(e))return k.subtle.unwrapKey(a,
c,d,e,b,f,g);e=h(e,"unwrapKey");b=h(b,"importKey");if("raw"!==a)throw new p("Key format not supported");return t(e,"unwrapKey",[n("unwrapKey",e,d),c]).then(function(a){var c;if(b&&b.name){var d=b.name.toUpperCase().replace(/[\.\s]/g,"");0<=d.indexOf("3410")&&0<=g.indexOf("sign")?c="private":0<=d.indexOf("3410")&&0<=g.indexOf("verify")&&(c="public")}return x(b,f,g,a,c)})})};var C={};C.subtle=new g;s||k&&k.getRandomValues||y("gostRandom.js");C.getRandomValues=function(a){s=s||f.gostRandom;!s&&k&&k.getRandomValues&&
(s=k);if(s)s.getRandomValues(a);else throw new p("Random generator not found");};return C});
/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(u,w){"function"===typeof define&&define.amd?define(["gostObject","gostCoding","gostSyntax","gostCrypto"],w):"object"===typeof exports?module.exports=w(require("gostObject"),require("gostCoding"),require("gostSyntax"),require("gostCrypto")):u.GostPKIX=w(u.gostObject,u.gostCoding,u.gostSyntax,u.gostCrypto)})(this,function(u,w,Q,F){function n(a){return(Q||(Q=m.gostSyntax))[a]}function l(){return(F||(F=m.gostCrypto)).subtle}function q(a){try{a()}catch(b){}}function t(a,b){return"string"===typeof a||
a instanceof String||a instanceof ArrayBuffer?n(b).decode(a):a}function B(a){if("string"===typeof a||a instanceof String)a=(w||(w=m.gostCoding)).PEM.decode(a);if(!(a instanceof ArrayBuffer))throw Error("Type of data must be FormatedData");return a}function C(a){a=new Uint8Array(a);(F||(F=m.gostCrypto)).getRandomValues(a);return a.buffer}function A(a,b){for(var f in a)if("buffer"!==f&&("undefined"===typeof b[f]||a[f]!==b[f]))return!1;for(f in b)if("buffer"!==f&&("undefined"===typeof a[f]||a[f]!==b[f]))return!1;
return!0}function N(a){var b=typeof a;if("undefined"===b||""===a)return"0";a="number"===b||a instanceof Number?a.toString(16):a.replace("0x","");return a.toLowerCase()}function O(a,b){a=N(a);b=N(b);var f=Math.max(a.length,b.length),c=a;a=(Array(f+1).join("0")+c).slice(-f);c=b;b=(Array(f+1).join("0")+c).slice(-f);return a>b?1:a<b?-1:0}function R(a,b){var f=new Uint8Array(a),c=new Uint8Array(b);if(f.length>c.length)return 1;if(f.length<c.length)return-1;for(var e=0,d=f.length;e<d;e++){if(f[e]>c[e])return 1;
if(f[e]<c[e])return-1}return 0}function S(a,b){return a&&b&&(!b.issuer||A(a.tbsCertificate.issuer,b.issuer))&&(!b.serialNumber||0===O(a.tbsCertificate.serialNumber,b.serialNumber))&&(!b.subjectKeyIdentifier||0===R(a.tbsCertificate.extensions.subjectKeyIdentifier,b.subjectKeyIdentifier))&&(!b.subject||A(a.tbsCertificate.subject,b.subject))&&(!b.date||a.tbsCertificate.validity.notBefore.getTime()<b.date.getTime()&&a.tbsCertificate.validity.notAfter.getTime()>b.date.getTime())}function J(a,b){for(var f=
[],c=0,e=a.length;c<e;c++)S(a[c],b)&&f.push(a[c]);return f}function D(a,b){return J(a.getAllCertificates(),b)}function T(a,b){for(var f=[],c=0,e=a.length;c<e;c++){var d=a[c],g=b;g.issuer&&!A(d.tbsCertList.issuer,g.issuer)||g.date&&!(d.tbsCertList.thisUpdate.getTime()<g.date.getTime())||f.push(a[c])}return f}function U(a,b,f,c){for(var e=[];a;){e.push(a);var d={subject:a.tbsCertificate.issuer,date:c};if(a.tbsCertificate.extensions&&a.tbsCertificate.extensions.authorityKeyIdentifier){var g=a.tbsCertificate.extensions.authorityKeyIdentifier;
d.subjectKeyIdentifier=g.keyIdentifier;g.authorityCertIssuer[0].directoryName&&(d.issuer=g.authorityCertIssuer[0].directoryName);d.serialNumber=(w||(w=m.gostCoding)).Int16.encode(g.authorityCertSerialNumber)}if(A(a.tbsCertificate.subject,a.tbsCertificate.issuer))a=!1;else if((a=J(b,d))&&0<a.length){a=a[0];if(d=f)a:{for(var g=a,d=f,d=T(d,{issuer:g.tbsCertificate.issuer,date:void 0}),g=g.tbsCertificate.serialNumber,h=0,k=d.length;h<k;h++)for(var s=d[h],P=0,p=s.tbsCertList.revokedCertificates.length;P<
p;P++)if(0===O(s.tbsCertList.revokedCertificates[P].userCertificate,g)){d=!0;break a}d=!1}d&&(a=!1)}else a=!1}return e}function X(a,b){var f=a.getCertificate(b);return f?U(f,a.getAllCertificates(),a.getAllCRLs()):[]}function r(){for(var a={},b=0,f=arguments.length;b<f;b++){var c=arguments[b];if("object"===typeof c)for(var e in c)a[e]=c[e]}return a}function K(a){a=t(a,"Certificate");a=a.tbsCertificate.subjectPublicKeyInfo;var b="rsaEncryption"===a.algorithm.id?["verify"]:["verify","deriveKey","deriveBits"];
return l().importKey("spki",a.buffer,a.algorithm,!0,b)}function L(a,b,f,c){return K(a).then(function(a){return l().verify(b,a,f,c)})}function E(a,b,f){var c,e,d,g;return(new m.Promise(q)).then(function(){var e=a.keyStore.getKey(b);if(!e)throw Error("Private key not found");if(e.encryptionAlgorithm){if(!f)throw Error("Password required to decrypt key");d=e.encryptionAlgorithm.derivation;g=e.encryptionAlgorithm.encryption;c=e.encryptedData;return l().importKey("raw",w.Chars.decode(f,"utf8"),d,!1,["deriveKey"])}c=
e instanceof ArrayBuffer?e:n("PrivateKeyInfo").encode(e)}).then(function(a){return d&&l().deriveKey(d,a,g,!0,["decrypt"])}).then(function(a){return g?l().decrypt(g,a,c):c}).then(function(b){try{e=n("PrivateKeyInfo").decode(b)}catch(d){e=b}if(e.privateKeyAlgorithm){var c="rsaEncryption"===e.privateKeyAlgorithm.id?["sign"]:["sign","deriveKey","deriveBits"];return l().importKey("pkcs8",b,e.privateKeyAlgorithm,!0,c)}c=["encrypt","decrypt","wrapKey","unwrapKey"];return l().importKey("raw",b,a.provider.encryption,
!0,c)})}function G(a,b,f,c){var e,d,g,h,k=b.type;return(new m.Promise(q)).then(function(){return"secret"===k?l().exportKey("raw",b):l().exportKey("pkcs8",b)}).then(function(b){e=b;if(c)return g=r(a.provider.pbes.derivation,{salt:C(32),iterations:1}),h=r(a.provider.pbes.encryption),h.iv||(h.iv=C(8)),l().importKey("raw",w.Chars.decode(c,"utf8"),g,!1,["deriveKey"]);d="secret"===k?e:n("PrivateKeyInfo").decode(e)}).then(function(a){return g&&l().deriveKey(g,a,h,!0,["encrypt"])}).then(function(a){return h&&
l().encrypt(h,a,e)}).then(function(b){h&&(d={encryptionAlgorithm:r(a.provider.pbes,{derivation:g,encryption:h}),encryptedData:b});f&&a.keyStore.setKey(f,d);return d})}function V(){this.entries={}}function W(a,b,f){this.provider=(u||(u=m.gostObject)).providers[a];this.format=(b||"DER").toUpperCase();this.keyStore=f||new V}var m=this;V.prototype={aliases:function(){var a=[],b;for(b in this.entries)a.push(b);return a},containsAlias:function(a){return a in this.entries},deleteEntry:function(a){delete this.entires[a]},
getCertificate:function(a){if(a=this.entries[a])return a.cert},getCRL:function(a){if(a=this.entries[a])return a.crl},getRequest:function(a){if(a=this.entries[a])return a.request},getKey:function(a){if(a=this.entries[a])return a.key},setCertificate:function(a,b){(this.entries[a]||(this.entries[a]={})).cert=t(b,"Certificate")},setCRL:function(a,b){(this.entries[a]||(this.entries[a]={})).crl=t(b,"CertificateList")},setRequest:function(a,b){(this.entries[a]||(this.entries[a]={})).request=t(b,"CertificationRequest")},
setKey:function(a,b){try{b=t(b,"PrivateKeyInfo")}catch(f){try{b=t(b,"EncryptedPrivateKeyInfo")}catch(c){b=B(b)}}(this.entries[a]||(this.entries[a]={})).key=b},getAllCertificates:function(){var a=[],b;for(b in this.entries){var f=this.entries[b];f.cert&&a.push(f.cert)}return a},getAllCRLs:function(){var a=[],b;for(b in this.entries){var f=this.entries[b];f.crl&&a.push(f.crl)}return a}};W.prototype={importKeyStore:function(a,b){var f=this,c=f.keyStore,e,d,g,h,k;return(new m.Promise(q)).then(function(){a=
t(a,"PFX");h=a.authSafe;if(b&&!a.macData)throw Error("Password based MAC must present");if("signedData"!==h.contentType&&"data"!==h.contentType)throw Error("Unsupported format");if(b)return e=r(f.provider.pbmac.derivation,{salt:a.macData.macSalt,iterations:a.macData.iterations}),d=r(f.provider.pbmac.hmac),l().importKey("raw",w.Chars.decode(b,"utf8"),e,!1,["deriveKey"])}).then(function(a){return e&&l().deriveKey(e,a,d,!0,["verify"])}).then(function(b){g=b;return d&&l().verify(d,g,a.macData.mac.digest,
h.buffer)}).then(function(a){if(!a)throw Error("MAC not verified");return"signedData"===h.contentType?f.verifyData(h):h}).then(function(a){h=a;if("data"!==h.contentType)throw Error("Unsupported format");k=n("AuthenticatedSafe").decode(h.content);return Promise.all(k.map(function(a){if("encryptedData"===a.contentType)return f.decryptData(a,b);if("data"===a.contentType)return a;throw Error("Format not supported");}))}).then(function(b){k=b;var e=function(a){a.forEach(function(a){var b=a.bagAttributes&&
a.bagAttributes.friendlyName||(w||(w=m.gostCoding)).PEM.encode(C(12));switch(a.bagId){case "keyBag":case "pkcs8ShroudedKeyBag":c.setKey(b,a.bagValue);break;case "certBag":"x509Certificate"===a.bagValue.certId&&c.setCertificate(b,a.bagValue.certValue);break;case "crlBag":"x509CRL"===a.bagValue.crlId&&c.setCRL(b,a.bagValue.crlValue);break;case "safeContentsBag":e(a.bagValue)}})};k.forEach(function(a){e(n("SafeContents").decode(a.content))});return a})},exportKeyStore:function(a,b){var f=this,c=f.keyStore,
e,d,g,h,k;return(new m.Promise(q)).then(function(){for(var d=c.aliases(),k=[],p=0,I=d.length;p<I;p++){var v=d[p],m=c.getKey(v),z;m&&(m.privateKeyAlgorithm?z={bagId:"keyBag",bagValue:t(m,"PrivateKeyInfo")}:m.encryptionAlgorithm&&(z={bagId:"pkcs8ShroudedKeyBag",bagValue:m}),z.bagAttributes={localKeyId:p.toString(16),friendlyName:v},k.push(z));(m=c.getCertificate(v))&&k.push({bagId:"certBag",bagValue:{certId:"x509Certificate",certValue:m},bagAttributes:{friendlyName:v}});(m=c.getCRL(v))&&k.push({bagId:"crlBag",
bagValue:{crlId:"x509CRL",crlValue:m},bagAttributes:{friendlyName:v}})}e=n("SafeContents").encode(k);b=(b||"mac").toLowerCase();if(a)return g=r(f.provider.pbmac.derivation,{salt:C(32),iterations:1}),h=r(f.provider.pbmac.hmac),l().importKey("raw",w.Chars.decode(a,"utf8"),g,!1,["deriveKey"]);if("encrypt"===b)throw Error("Password required for MAC calculation");}).then(function(a){return g&&l().deriveKey(g,a,h,!0,["sign"])}).then(function(d){k=d;return"encrypt"===b?f.encryptData(e,"pbes",a):{contentType:"data",
content:e}}).then(function(a){a=t(a,"ContentInfo");d={contentType:"data",content:n("AuthenticatedSafe").encode([a])};d.buffer=n("ContentInfo").encode(d);return h&&l().sign(h,k,d.buffer)}).then(function(a){var b={version:3,authSafe:d};a&&(b.macData={mac:{digestAlgorithm:h.hash,digest:a},macSalt:g.salt,iterations:g.iterations});return n("PFX").encode(b,f.format)})},exportKey:function(a,b,f){var c=this;return(new m.Promise(q)).then(function(){return E(c,a,f)}).then(function(a){b=(b||"p8").toLowerCase();
switch(b){case "p8":return G(c,a);case "p8e":if(!f)throw Error("Password required for export to encrypted format");return G(c,a,void 0,f);case "p12":throw Error("Not yet implemented");}}).then(function(a){switch(b){case "p8":return n("PrivateKeyInfo").encode(a,c.format);case "p8e":return n("EncryptedPrivateKeyInfo").encode(a,c.format)}})},importKey:function(a,b,f){var c=this;return(new m.Promise(q)).then(function(){try{a=t(a,"PrivateKeyInfo")}catch(e){try{a=t(a,"EncryptedPrivateKeyInfo")}catch(d){a=
B(a)}}c.keyStore.setKey(b,a);if(!a.encryptionAlgorithm&&f)return E(c,b)}).then(function(e){return e?G(c,e,b,f):a})},createCertificate:function(a,b,f){var c=this,e={},d={},g,h;return(new m.Promise(q)).then(function(){a=a||{};e.version=2;d.signatureAlgorithm=e.signature=a.signature||c.provider.signature;if(!e.signature)throw Error("Signature Algorithm not defined");var b=c.provider.generation;if(!b)throw Error("Key Algorithm not defined");return l().generateKey(b,!0,["sign","verify"])}).then(function(a){g=
a.publicKey;h=a.privateKey;return l().exportKey("spki",g)}).then(function(a){e.subjectPublicKeyInfo=n("SubjectPublicKeyInfo").decode(a);return l().digest(c.provider.digest,a)}).then(function(b){b=(new Uint8Array(new Uint8Array(b,0,20))).buffer;e.subject=a.subject||a.issure;e.issuer=e.subject;if(!e.subject)throw Error("Subject or issuer not defined");e.serialNumber=a.serialNumber||1;var c={};a.validity&&a.validity.notBefore?c.notBefore=a.validity.notBefore:(c.notBefore=new Date,c.notBefore.setHours(0,
0,0,0));a.validity&&a.validity.notAfter?c.notAfter=a.validity.notAfter:(c.notAfter=new Date(c.notBefore),c.notAfter.setFullYear(c.notAfter.getFullYear()+25));e.validity=c;c=a.extensions||{};c.keyUsage=c.keyUsage||"digitalSignature nonRepudiation keyEncipherment dataEncipherment keyAgreement keyCertSign cRLSign".split(" ");c.basicConstraints=c.basicConstraints||{cA:!0};c.extKeyUsage=c.extKeyUsage||"serverAuth clientAuth codeSigning emailProtection ipsecEndSystem ipsecTunnel ipsecUser timeStamping OCSPSigning".split(" ");
c.subjectKeyIdentifier=b;c.authorityKeyIdentifier={keyIdentifier:b,authorityCertIssuer:[{directoryName:e.issuer}],authorityCertSerialNumber:e.serialNumber};e.extensions=c;e.buffer=n("TBSCertificate").encode(e);return l().sign(d.signatureAlgorithm,h,e.buffer)}).then(function(a){d.tbsCertificate=e;d.signatureValue=a;d.buffer=n("Certificate").encode(d);return G(c,h,b,f)}).then(function(){c.keyStore.setCertificate(b,d);return n("Certificate").encode(d,c.format)})},issueCertificate:function(a,b,f,c){var e=
this,d=e.keyStore,g={},h={},k,s;return(new m.Promise(q)).then(function(){s=d.getRequest(b);k=s.requestInfo;g.version=2;g.signature=s.signatureAlgorithm;g.subjectPublicKeyInfo=k.subjectPublicKeyInfo;return l().importKey("spki",k.subjectPublicKeyInfo.buffer,k.subjectPublicKeyInfo.algorithm,!0,["verify"])}).then(function(a){return l().verify(s.signatureAlgorithm,a,s.signatureValue,k.buffer)}).then(function(a){if(!a)throw Error("Request signature is not valid");return l().digest(e.provider.digest,g.subjectPublicKeyInfo.buffer)}).then(function(b){b=
(new Uint8Array(new Uint8Array(b,0,20))).buffer;g.subject=k.subject;if(!g.subject)throw Error("Subject not defined");var p=d.getCertificate(f);if(!p)throw Error("Authority certificate not found");var s=p.tbsCertificate.extensions&&p.tbsCertificate.extensions.keyUsage;if(s&&0>s.indexOf("keyCertSign"))throw Error("Issuer key can't be used for sign certificate");var v;a.validity&&a.validity.notBefore?v=a.validity.notBefore:(v=new Date,v.setHours(0,0,0,0));var l=p.tbsCertificate.validity;if(!l||l.notBefore.getTime()>
v.getTime())throw Error("Issuer certificate is not released");if(!l||l.notAfter.getTime()<v.getTime())throw Error("Issuer certificate expired");g.issuer=p.tbsCertificate.issuer;var s=p.tbsCertificate.serialNumber,n=(p.tbsCertificate.extensions||{}).subjectKeyIdentifier,m=(p.tbsCertificate.extensions||{}).basicConstraints,m=(m=m&&m.pathLenConstraint)?m+1:0,r=p.tbsCertificate.issuer;h.signatureAlgorithm=p.tbsCertificate.signature;if(a.serialNumber)g.serialNumber=a.serialNumber;else{for(var p=D(d,{issuer:g.issuer}),
x=1,M=0,w=p.length;M<w;M++)if(0<=O(p[M].tbsCertificate.serialNumber,x)){for(var x=p[M].tbsCertificate.serialNumber,x=N(x),q="",t=1,u=x.length-1;0<=u;--u){var H=x.charCodeAt(u);1===t&&(102===H?H=48:(t=0,57===H?H=97:H++));q=String.fromCharCode(H)+q}1===t&&(q="1"+q);x="0x"+q}g.serialNumber=x}p={};p.notBefore=v;p.notAfter=a.validity&&a.validity.notAfter?a.validity.notAfter:l.notAfter;g.validity=p;v=a.extensions||{};l=k.attributes&&(k.attributes.extensionRequest||k.attributes.msCertExtensions)||{};v.keyUsage=
v.keyUsage||l.keyUsage||["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement"];v.basicConstraints=v.basicConstraints||l.basicConstraints||{cA:0<=v.keyUsage.indexOf("keyCertSign"),pathLenConstraint:m};v.extKeyUsage=v.extKeyUsage||l.extKeyUsage||["clientAuth","emailProtection"];v.subjectKeyIdentifier=b;v.authorityKeyIdentifier={keyIdentifier:n,authorityCertIssuer:[{directoryName:r}],authorityCertSerialNumber:s};g.extensions=v;return E(e,f,c)}).then(function(a){g.buffer=
n("TBSCertificate").encode(g);return l().sign(h.signatureAlgorithm,a,g.buffer)}).then(function(a){h.tbsCertificate=g;h.signatureValue=a;h.buffer=n("Certificate").encode(h);return d.setCertificate(b,h)}).then(function(){return n("Certificate").encode(h,e.format)})},exportCertificate:function(a,b){var f=this;return(new m.Promise(q)).then(function(){var c=f.keyStore.getCertificate(a);if(!c)throw Error("Certificate not found");switch((b||"x509").toLowerCase()){case "p7c":return n("ContentInfo").encode({contentType:"signedData",
content:{version:1,digestAlgorithms:[],encapContentInfo:{eContentType:"data"},certificates:[c],signerInfos:[]}},f.format);case "p12":return n("PFX").encode({version:3,authSafe:{contentType:"data",content:n("SafeContents").encode([{bagId:"certBag",crltValue:{certId:"x509Certificate",certValue:c},bagAttributes:"string"===typeof a?{friendlyName:a}:void 0}])}},f.format);default:return n("Certificate").encode(c,f.format)}})},importCertificate:function(a,b){var f=this.keyStore,c;return(new m.Promise(q)).then(function(){try{a=
t(a,"ContentInfo")}catch(b){a=t(a,"Certificate")}if(a.contentType&&("signedData"===a.contentType&&(a=a.content.certificates[0]),!a))throw Error("Invalid format");c=a.tbsCertificate;if(!c)throw Error("Invalid format");var d;if(A(a.tbsCertificate.subject,a.tbsCertificate.issuer))d=a;else if(f){d={subject:a.tbsCertificate.issuer};if(a.tbsCertificate.extensions&&a.tbsCertificate.extensions.authorityKeyIdentifier){var g=a.tbsCertificate.extensions.authorityKeyIdentifier;d.subjectKeyIdentifier=g.keyIdentifier;
g.authorityCertIssuer[0].directoryName&&(d.issuer=g.authorityCertIssuer[0].directoryName);d.serialNumber=(w||(w=m.gostCoding)).Int16.encode(g.authorityCertSerialNumber)}if((d=D(f,d))&&0<d.length)d=d[0];else throw Error("Issuer for certificate not found in store");}return L(d,a.signatureAlgorithm,a.signatureValue,c.buffer)}).then(function(c){if(!c)throw Error("Certificate has invalid signature");b&&f.setCertificate(b,a);return a})},validateCertificate:function(a,b){var f=this.keyStore,c=[];return(new m.Promise(q)).then(function(){var e=
a;e instanceof Array||(e=[a]);e=e.map(function(a){return t(a,"Certificate")});b=b||new Date;c=U(e[0],e.concat(f.getAllCertificates()),f.getAllCRLs(),b);for(var d=!1,e=c.length-1;0<=e;--e)if(0<D(f,{issuer:c[e].tbsCertificate.issuer,serialNumber:c[e].tbsCertificate.serialNumber}).length){d=!0;break}if(!d)throw Error("There are not trusted certificates in validation path");for(var d=[],e=0,g=c.length;e<g;e++){var h=c[e],k=e+1;k===g&&A(h.tbsCertificate.issuer,h.tbsCertificate.subject)&&(k=e);k<g&&d.push(L(c[k],
h.signatureAlgorithm,h.signatureValue,h.tbsCertificate.buffer))}return Promise.all(d)}).then(function(a){for(var b=0,f=a.length;b<f;b++)if(!0!==a[b])throw Error("Certificate in path has invalid signature");return c})},createRequest:function(a,b,f){var c=this,e={},d={},g,h;return(new m.Promise(q)).then(function(){a=a||{};e.signatureAlgorithm=a.signatureAlgorithm||c.provider.signature;var b=c.provider.generation;if(!e.signatureAlgorithm)throw Error("Signature Algorithm not defined");if(!b)throw Error("Key Algorithm not defined");
return l().generateKey(b,!0,["sign","verify"])}).then(function(a){g=a.publicKey;h=a.privateKey;return l().exportKey("spki",g)}).then(function(b){d.subjectPublicKeyInfo=n("SubjectPublicKeyInfo").decode(b);d.subject=a.subject;if(!d.subject)throw Error("Subject not defined");d.version=0;b=a.extensions||{};b.keyUsage=b.keyUsage||["digitalSignature","nonRepudiation","dataEncipherment","keyAgreement"];b.extKeyUsage=["clientAuth","emailProtection"];d.attributes={extensionRequest:b};d.buffer=n("CertificationRequestInfo").encode(d);
return l().sign(e.signatureAlgorithm,h,d.buffer)}).then(function(a){e.requestInfo=d;e.signatureValue=a;e.buffer=n("CertificationRequest").encode(e);return G(c,h,b,f)}).then(function(){c.keyStore.setRequest(b,e);return n("CertificationRequest").encode(e,c.format)})},exportRequest:function(a){var b=this,f;return(new m.Promise(q)).then(function(){f=b.keyStore.getRequest(a);if(!f)throw Error("Certification request not found");return n("CertificationRequest").encode(f,b.format)})},importRequest:function(a,
b){var f=this,c;return(new m.Promise(q)).then(function(){a=t(a,"CertificationRequest");c=a.requestInfo;var b=c.subjectPublicKeyInfo;return l().importKey("spki",b.buffer,b.algorithm,!0,["verify"])}).then(function(b){return l().verify(a.signatureAlgorithm,b,a.signatureValue,c.buffer)}).then(function(c){if(!c)throw Error("Request signature is not valid");b&&f.keyStore.setRequest(b,a);return a})},updateCRL:function(a,b,f){var c=this,e=c.keyStore,d={};return(new m.Promise(q)).then(function(){a=a||{};var g=
e.getCertificate(b);if(!g)throw Error("Issuer certificate not found");if(0>((g.tbsCertificate.extensions||{}).keyUsage||[]).indexOf("cRLSign"))throw Error("Issuer has not rights for CRL sign");var h=g.tbsCertificate.extensions&&g.tbsCertificate.extensions.keyUsage;if(h&&0>h.indexOf("cRLSign"))throw Error("Issuer key can't be used for sign CRL");if(a.issuer&&A(a.issuer,g.tbsCertificate.issue))throw Error("CRL prototype and authority certificate have different issuers");(h=e.getCRL(b))?d=h.tbsCertList:
(h=T(e.getAllCRLs,{issuer:g.tbsCertificate.issuer}))&&0<h.length?d=h[0].tbsCertList:(d.issuer=g.tbsCertificate.issuer,d.revokedCertificates=[]);d.version=1;d.signature=g.tbsCertificate.signature;a.thisUpdate?d.thisUpdate=a.thisUpdate:(d.thisUpdate=new Date,d.thisUpdate.setHours(0,0,0,0));a.nextUpdate?d.nextUpdate=a.nextUpdate:(d.nextUpdate=new Date(d.thisUpdate),d.nextUpdate.setFullYear(d.nextUpdate.getFullYear()+25));h=g.tbsCertificate.validity;if(!h||h.notBefore.getTime()>d.thisUpdate.getTime())throw Error("Issuer certificate is not released");
if(!h||h.notAfter.getTime()<d.thisUpdate.getTime())throw Error("Issuer certificate expired");h=d.revokedCertificates;if(a.revokedCertificates)for(var k=0,l=a.revokedCertificates.length;k<l;k++){var m=a.revokedCertificates[k],p={};if(!m.userCertificate)throw Error("Serail number of revoked certificate not found");p.userCertificate=m.userCertificate;m.revocationDate?p.revocationDate=m.revocationDate:(p.revocationDate=new Date,p.revocationDate.setHours(0,0,0,0));m=m.crlEntryExtensions||{};m.cRLReason=
m.cRLReason||"unspecified";p.crlEntryExtensions=m;h.push(p)}h=a.crlExtensions||{};h.authorityKeyIdentifier={keyIdentifier:(g.tbsCertificate.extensions||{}).subjectKeyIdentifier||"0",authorityCertIssuer:[{directoryName:g.tbsCertificate.issuer}],authorityCertSerialNumber:g.tbsCertificate.serialNumber};h.cRLNumber=h.cRLNumber||0;d.crlExtensions=h;return E(c,b,f)}).then(function(a){d.buffer=n("TBSCertList").encode(d);return l().sign(d.signature,a,d.buffer)}).then(function(a){a={tbsCertList:d,signatureAlgorithm:d.signature,
signatureValue:a};a.buffer=n("CertificateList").encode(a);e.setCRL(b,a);return n("CertificateList").encode(a,c.format)})},exportCRL:function(a,b){var f=this;return(new m.Promise(q)).then(function(){var c=[f.keyStore.getCRL(a)];if(!c)throw Error("CRL not found");switch((b||"x509").toLowerCase()){case "p7c":return n("ContentInfo").encode({contentType:"signedData",content:{version:4,digestAlgorithms:[],encapContentInfo:{eContentType:"data"},crls:[{crl:c}],signerInfos:[]}},f.format);case "p12":return n("PFX").encode({version:3,
authSafe:{contentType:"data",content:n("SafeContents").encode([{bagId:"crlBag",crltValue:{crlId:"x509CRL",crltValue:c},bagAttributes:"string"===typeof a?{friendlyName:a}:void 0}])}},f.format);default:return n("CertificateList").encode(c,f.format)}})},importCRL:function(a,b){var f=this.keyStore,c,e;return(new m.Promise(q)).then(function(){try{a=t(a,"ContentInfo")}catch(b){a=t(a,"CertificateList")}if(a.contentType&&("signedData"===a.contentType&&(a=a.content.crls[0]),!a))throw Error("Invalid format");
c=a.tbsCertList;if(!c)throw Error("Invalid format");var g=D(f,{issuer:c.issuer});if(g&&0<g.length)e=g[0];else throw Error("Issuer certificate not found");return L(e,a.signatureAlgorithm,a.signatureValue,c.buffer)}).then(function(c){if(!c)throw Error("Certification list has invalid signature");b&&f.setCRL(b,a);return a})},signData:function(a,b,f,c){var e=this,d=e.keyStore,g,h,k;b=b||[];b instanceof Array||(b=[b]);b=b.map(function(a){return(a||"").toLowerCase()});return(new m.Promise(q)).then(function(){try{a=
t(a,"ContentInfo")}catch(c){a={contentType:"data",content:B(a)}}var m=d.getCertificate(f);if(!m)throw Error("Signer certificate not found");h={version:1,digestAlgorithm:e.provider.digest,sid:{issuerAndSerialNumber:{issuer:m.tbsCertificate.issuer,serialNumber:m.tbsCertificate.serialNumber}}};if("signedData"===a.contentType){g=a;k=a.encapContentInfo.eContent;g.signerInfos=(g.signerInfos||[]).push(h);var p;g.digestAlgorithms=g.digestAlgorithms||[];g.digestAlgorithms.forEach(function(a){a.id===g.digestAlgorithm.id&&
(p=!0)});p||g.digestAlgorithms.push(g.digestAlgorithm);0<=b.indexOf("detached")&&(a.encapContentInfo.eContent=void 0)}else k=a.content.buffer||a.content,g={version:1,digestAlgorithms:[h.digestAlgorithm],encapContentInfo:{eContentType:a.contentType,eContent:0<=b.indexOf("detached")?void 0:k},signerInfos:[h]};if(0<=b.indexOf("certpath")){g.certificates=g.certificates||[];var n=g.certificates.map(function(a){return a.certificate});X(d,f).forEach(function(a){0===J(n,{issuer:a.tbsCertificate.issuer,serialNumber:a.tbsCertificate.serialNumber}).length&&
g.certificates.push({certificate:a})})}if(0<=b.indexOf("attrs"))return l().digest(h.digestAlgorithm,k)}).then(function(a){a&&(h.signedAttrs={contentType:g.encapContentInfo.eContentType,messageDigest:a,signingTime:new Date},k=h.signedAttrs.buffer=n("SignedAttributes").encode(h.signedAttrs));return E(e,f,c)}).then(function(a){h.signatureAlgorithm=e.provider.generation;var b=r(h.signatureAlgorithm,{hash:h.digestAlgorithm});return l().sign(b,a,k)}).then(function(a){h.signatureValue=a;return n("ContentInfo").encode({contentType:"signedData",
content:g},e.format)})},encryptData:function(a,b,f,c,e){var d=this,g=d.keyStore,h,k,s,t,p,I,v,u,z,A,y;return(new m.Promise(q)).then(function(){a=B(a);b=(b||"keyagree").toLowerCase();if("keyagree"!==b&&"keytrans"!==b&&"kek"!==b&&"pbkek"!==b&&"keyman"!==b&&"pbes"!==b)throw Error("Invalid envelop mode");switch(b){case "keyagree":case "keytrans":s=f instanceof Array?f:[f];s=s.map(function(a){return g.getCertificate(a)});break;case "kek":case "keyman":e=c;c=f;if(!c||"string"!==typeof c)throw Error("Alias of secret key must be specified as 4th parameter");
s=[f];break;case "pbkek":case "pbes":e=f;if(!e||"string"!==typeof e)throw Error("Password must be specified as 4th parameter");s=[f]}z=s.map(function(a,b){return C(8)});y="pbes"!==b&&"keyman"!==b;if("pbes"===b)return F.subtle.importKey("raw",w.Chars.decode(e,"utf8"),d.provider.derivation,!0,["deriveKey"])}).then(function(a){h=r(d.provider.encryption);switch(b){case "keyman":return E(d,c,e);case "pbes":return l().deriveKey(r(d.provider.derivation,{salt:z[0]}),a,h,!0,["encrypt"]);default:return l().generateKey(h,
!0,["encrypt"])}}).then(function(b){t=b;h.iv||(h.iv=C(8));return l().encrypt(h,t,a)}).then(function(a){p={contentType:"data",contentEncryptionAlgorithm:h,encryptedContent:a};switch(b){case "keyagree":case "keytrans":return Promise.all(s.map(function(a){return K(a)}));case "pbes":a=r(d.provider.pbes,{derivation:r(d.provider.derivation,{salt:z[0]}),encryption:h}),p.contentEncryptionAlgorithm=a}}).then(function(a){switch(b){case "keyagree":case "keytrans":v=a;case "kek":return c?E(d,c,e):l().generateKey(d.provider.generation,
!0,["deriveKey"]);case "pbkek":return F.subtle.importKey("raw",w.Chars.decode(e,"utf8"),d.provider.derivation,!0,["deriveKey"])}}).then(function(a){if(y){I=a.privateKey||a;var d=c&&g.getCertificate(c);switch(b){case "keyagree":return c?d.tbsCertificate.subjectPublicKeyInfo:l().exportKey("spki",a.publicKey);case "keytrans":return c?K(d):a.publicKey}d&&d.tbsCertificate&&d.tbsCertificate.extensions&&(A=d.tbsCertificate.extensions.subjectKeyIdentifier)}}).then(function(a){if(y)return u=a,k="keytrans"===
b&&d.provider.transwrapping||d.provider.wrapping,Promise.all(s.map(function(a,c){var e;switch(b){case "kek":return I;case "pbkek":e=r(d.provider.derivation,{salt:z[c]});break;default:e=r(d.provider.agreement,{"public":v[c],ukm:z[c]})}return l().deriveKey(e,I,k,!0,["wrapKey"])}))}).then(function(a){if(y)return Promise.all(s.map(function(b,c){return l().wrapKey("raw",t,a[c],r(k,{ukm:z[c]}))}))}).then(function(a){if(y){var e=s.map(function(e,f){var g=s[f].tbsCertificate,g=g?{issuerAndSerialNumber:{issuer:g.issuer,
serialNumber:g.serialNumber}}:void 0;switch(b){case "keyagree":var h=n("SubjectPublicKeyInfo").decode(u),l=r(h.algorithm,d.provider.agreement,{wrapping:r(k)});return{kari:{version:3,originator:{originatorKey:{algorithm:h.algorithm,publicKey:h.subjectPublicKey}},ukm:z[f],keyEncryptionAlgorithm:l,recipientEncryptedKeys:[{rid:g,encryptedKey:a[f]}]}};case "keytrans":return l=r(u.algorithm,{ukm:z[f],"public":u,wrapping:r(k)}),{ktri:{version:0,rid:g,keyEncryptionAlgorithm:l,encryptedKey:a[f]}};case "kek":return{kekri:{version:4,
kekid:{keyIdentifier:A||(w||(w=m.gostCoding)).BER.encode(c)},keyEncryptionAlgorithm:r(k,{ukm:z[f]}),encryptedKey:a[f]}};case "pbkek":return{pwri:{version:0,keyDerivationAlgorithm:r(d.provider.derivation,{salt:z[f]}),keyEncryptionAlgorithm:r(k,{ukm:z[f]}),encryptedKey:a[f]}}}}),e={version:b=3,recipientInfos:e,encryptedContentInfo:p};return n("ContentInfo").encode({contentType:"envelopedData",content:e},d.format)}return n("ContentInfo").encode({contentType:"encryptedData",content:{version:0,encryptedContentInfo:p}},
d.format)})},verifyData:function(a,b){var f=this,c=f.keyStore,e,d,g;return(new m.Promise(q)).then(function(){var h=t(a,"ContentInfo");if("signedData"!==h.contentType)throw Error("Invalid signed data format");e=h.content;b&&(b=B(b));d=(g=e.encapContentInfo)&&g.eContent&&g.eContent||b;return Promise.all(e.signerInfos.map(function(a){a=a.sid.issuerAndSerialNumber;a={issuer:a.issuer,serialNumber:a.serialNumber};var b=D(c,a);if(0<b.length)return b;var d=(e.certificates||[]).map(function(a){return a.certificate}),
b=J(d,a);if(0===b.length)throw Error("Certificate for verification not found");return f.validateCertificate(b.concat(d))}))}).then(function(a){return Promise.all(e.signerInfos.map(function(b,c){var e=d;if(b.signedAttrs){if(!b.signedAttrs.messageDigest)throw Error("Message digest must present in signed attributes");e=n("SignedAttributes").encode(b.signedAttrs)}if(!e)throw Error("Data for verification not found");var f=r(b.signatureAlgorithm,{hash:b.digestAlgorithm});return L(a[c][0],f,b.signatureValue,
e)}))}).then(function(a){for(var b=0,c=a.length;b<c;b++)if(!0!==a[b])throw Error("Signature not verified");return Promise.all(e.signerInfos.map(function(a){return a.signedAttrs&&d?l().digest(a.digestAlgorithm,d):!1}))}).then(function(a){e.signerInfos.forEach(function(b,c){if(b.signedAttrs&&d&&0!==R(a[c],b.signedAttrs.messageDigest))throw Error("Data digest not verified");});return{contentType:g&&g.eContentType||"data",content:d}})},decryptData:function(a,b,f){var c=this,e=c.keyStore,d,g,h,k,s,u,p;
return(new m.Promise(q)).then(function(){var h=t(a,"ContentInfo");if("envelopedData"!==h.contentType&&"encryptedData"!==h.contentType)throw Error("Invalid enveloped or encrypted data format");d=h.content;var l=function(a){a:{for(var d=c.keyStore,e=d.aliases(),f=0,g=e.length;f<g;f++){var h=e[f];if(S(d.getCertificate(h),a)){a=h;break a}}a=void 0}if(b&&b===a)return!0;a&&n.push(a)};p=d.encryptedContentInfo.contentEncryptionAlgorithm;if("envelopedData"===h.contentType){for(var h=d.recipientInfos,n=[],
q=0,u=h.length;q<u;q++){var y=h[q];if(y.ktri){g="keytrans";var x=y.ktri.rid;if(x&&x.issuerAndSerialNumber&&l({issuer:x.issuerAndSerialNumber.issuer,serialNumber:x.issuerAndSerialNumber.serialNumber})||x.subjectKeyIdentifier&&l({subjectKeyIdentifier:x.subjectKeyIdentifier}))k=y.ktri}else if(y.kari){g="keyagree";for(var A=y.kari.recipientEncryptedKeys,C=0,D=A.length;C<D;C++)if((x=A[q].rid)&&x.issuerAndSerialNumber&&l({issuer:x.issuerAndSerialNumber.issuer,serialNumber:x.issuerAndSerialNumber.serialNumber})||
x.subjectKeyIdentifier&&l({subjectKeyIdentifier:x.subjectKeyIdentifier})){k={originator:y.kari.originator,keyEncryptionAlgorithm:y.kari.keyEncryptionAlgorithm,ukm:y.kari.ukm,encryptedKey:A[q].encryptedKey};break}}else if(y.kekri){g="kek";x=y.kekri.kekid.keyIdentifier;try{var B=(w||(w=m.gostCoding)).BER.decode(x);B instanceof String&&e.containsAlias(B)&&(b===B.toString()?k=y.kekri:n.push(B))}catch(G){l({subjectKeyIdentifier:x})&&(k=y.kekri)}}else if(y.pwri){g="pbkek";f=b;if(!f||"string"!==typeof f)throw Error("Password required");
k=y.pwri}if(k)break}if(!k){if(0<n.length)throw Error("Recipient key required ["+n.join(",")+"]");throw Error("No recipient found in store");}}else if("PBES2"===p.id||"id-sc-pbeWithGost3411AndGost28147"===p.id||"id-sc-pbeWithGost3411AndGost28147CFB"===p.id){if(g="pbes",f=b,!f||"string"!==typeof f)throw Error("Password required");}else if(g="keyman",!b)throw Error("Secret key alias required");switch(g){case "keytrans":case "keyagree":case "kek":case "keyman":return E(c,b,f);case "pbkek":s=r(c.provider.derivation,
{salt:k.keyDerivationAlgorithm.salt,iterations:k.keyDerivationAlgorithm.iterations,hmac:k.keyDerivationAlgorithm.hmac});break;case "pbes":l=p,s=r(c.provider.derivation,{salt:l.derivation.salt,iterations:l.derivation.iterations,hmac:l.derivation.hmac}),p=l.encryption}return F.subtle.importKey("raw",w.Chars.decode(f,"utf8"),s,!0,["deriveKey"])}).then(function(a){h=a;switch(g){case "keyagree":a=k.originator;if(a.originatorKey){var b=n("SubjectPublicKeyInfo").encode({algorithm:a.originatorKey.algorithm,
subjectPublicKey:a.originatorKey.publicKey});return l().importKey("spki",b,a.originatorKey.algorithm,!0,["verify","deriveKey"])}if((a=D(e,a.issuerAndSerialNumber?{issuer:a.issuerAndSerialNumber.issuer,serialNumber:a.issuerAndSerialNumber.serialNumber}:{subjectKeyIdentifier:a.subjectKeyIdentifier}))&&0<a.length)return K(a[0]);throw Error("Originator certificate not found in key stores");}}).then(function(a){switch(g){case "keytrans":s=r(c.provider.agreement,{ukm:k.keyEncryptionAlgorithm.ukm,"public":k.keyEncryptionAlgorithm["public"],
sBox:k.keyEncryptionAlgorithm.sBox});u=r(c.provider.transwrapping||c.provider.wrapping,k.keyEncryptionAlgorithm.wrapping,{ukm:k.keyEncryptionAlgorithm.ukm});break;case "keyagree":s=r(k.keyEncryptionAlgorithm,{ukm:k.ukm,"public":a});u=r(k.keyEncryptionAlgorithm.wrapping||c.provider.wrapping,{ukm:k.ukm});break;case "kek":return u=r(k.keyEncryptionAlgorithm),h;case "keyman":return h;case "pbkek":u=r(k.keyEncryptionAlgorithm);break;case "pbes":u=p}return l().deriveKey(s,h,u,!0,["unwrapKey","decrypt"])}).then(function(a){switch(g){case "pbes":case "keyman":return a;
default:return l().unwrapKey("raw",k.encryptedKey,a,u,p,!0,["decrypt"])}}).then(function(a){return l().decrypt(p,a,d.encryptedContentInfo.encryptedContent)}).then(function(a){return{contentType:d.encryptedContentInfo.contentType,content:a}})},extractData:function(a,b,f){var c=this;return(new m.Promise(q)).then(function(){var e=t(a,"ContentInfo");switch(e.contentType){case "data":return e.content;case "signedData":return c.verifyData(a);case "encryptedData":case "envelopedData":return c.decryptData(a,
b,f);default:throw Error("Data format not supported");}})}};return W});
